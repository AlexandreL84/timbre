import{a as po,b as tt}from"./chunk-RR67BWGC.js";import{a as Zt,b as Qi,c as Li,d as Ct,e as Co,f as An,g as En,h as Tc,i as So,j as Zi,k as Rn,l as Rh}from"./chunk-B4ZNLNLR.js";import{e as xo}from"./chunk-RSMFB3T2.js";import{a as ec,d as wn,e as xt,f as vc,h as Bn}from"./chunk-BHYO3NGN.js";import{$b as yn,$c as Qt,A as be,Aa as lr,Ab as Ht,Bb as Wt,C as we,Ca as U,Cb as zu,Cc as ic,D as uo,Da as N,Db as Yu,Dc as Kt,Ea as Je,Eb as Ku,Fb as Vt,Gb as _n,Gc as nc,H as q,Hb as Gt,I as P,Ib as Ai,Jb as Ei,Jc as _o,Ka as Pt,Kc as vo,La as $t,Lb as kt,Lc as rc,Ma as Re,Mb as jt,Mc as oc,Nb as Qu,Nc as lc,Ob as go,Oc as sc,Pa as De,Pb as vn,Pc as ac,Q as hn,Qa as fo,Qc as uc,R as co,Rc as cc,S as h,Sb as ht,Sc as mc,T as W,Ta as ku,Tb as Ri,Tc as fc,Ub as Di,Uc as pc,Vb as _t,Vc as dc,Wb as Oi,Wc as gc,Xb as Tn,Xc as bc,Y as L,Yb as xn,Yc as hc,Z as _,Zb as Cn,Zc as os,_b as Sn,_c,ac as Mn,ad as To,ba as v,bc as bo,c as me,ca as x,cc as Zu,da as k,dc as zt,ea as Te,ec as Xu,fa as xe,fc as Ju,g as Ft,gc as ho,h as ze,ha as se,ia as j,ja as y,ka as Vu,kb as ju,la as zi,lb as S,ma as Yi,mb as et,na as Ki,oa as Ce,pa as R,qa as mo,qb as re,ra as Y,rb as Ii,s as F,sb as wi,sc as In,ta as Gu,tc as vt,u as so,ua as Be,uc as tc,va as Ae,vc as Yt,wa as Ee,x as qt,xc as Tt,y as ao,zb as Bi}from"./chunk-E6QTGJW5.js";import{d as Eh,e as rs,f as ne}from"./chunk-KBHVVLYT.js";var ss=Eh((Un,pr)=>{(function(){var l,o="4.17.21",n=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",u="Expected a function",f="Invalid `variable` option passed into `_.template`",T="__lodash_hash_undefined__",A=500,E="__lodash_placeholder__",J=1,oe=2,ae=4,We=1,Jt=2,Ve=1,Et=2,cs=4,Rt=8,Ji=16,Dt=32,en=64,ei=128,Fn=256,No=512,Lc=30,Uc="...",Nc=800,Fc=16,ms=1,qc=2,Pc=3,Fi=1/0,gi=9007199254740991,$c=17976931348623157e292,dr=NaN,Ot=4294967295,Hc=Ot-1,Wc=Ot>>>1,Vc=[["ary",ei],["bind",Ve],["bindKey",Et],["curry",Rt],["curryRight",Ji],["flip",No],["partial",Dt],["partialRight",en],["rearg",Fn]],tn="[object Arguments]",gr="[object Array]",Gc="[object AsyncFunction]",qn="[object Boolean]",Pn="[object Date]",kc="[object DOMException]",br="[object Error]",hr="[object Function]",fs="[object GeneratorFunction]",yt="[object Map]",$n="[object Number]",jc="[object Null]",ti="[object Object]",ps="[object Promise]",zc="[object Proxy]",Hn="[object RegExp]",Mt="[object Set]",Wn="[object String]",_r="[object Symbol]",Yc="[object Undefined]",Vn="[object WeakMap]",Kc="[object WeakSet]",Gn="[object ArrayBuffer]",nn="[object DataView]",Fo="[object Float32Array]",qo="[object Float64Array]",Po="[object Int8Array]",$o="[object Int16Array]",Ho="[object Int32Array]",Wo="[object Uint8Array]",Vo="[object Uint8ClampedArray]",Go="[object Uint16Array]",ko="[object Uint32Array]",Qc=/\b__p \+= '';/g,Zc=/\b(__p \+=) '' \+/g,Xc=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ds=/&(?:amp|lt|gt|quot|#39);/g,gs=/[&<>"']/g,Jc=RegExp(ds.source),em=RegExp(gs.source),tm=/<%-([\s\S]+?)%>/g,im=/<%([\s\S]+?)%>/g,bs=/<%=([\s\S]+?)%>/g,nm=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,rm=/^\w*$/,om=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,jo=/[\\^$.*+?()[\]{}|]/g,lm=RegExp(jo.source),zo=/^\s+/,sm=/\s/,am=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,um=/\{\n\/\* \[wrapped with (.+)\] \*/,cm=/,? & /,mm=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,fm=/[()=,{}\[\]\/\s]/,pm=/\\(\\)?/g,dm=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,hs=/\w*$/,gm=/^[-+]0x[0-9a-f]+$/i,bm=/^0b[01]+$/i,hm=/^\[object .+?Constructor\]$/,_m=/^0o[0-7]+$/i,vm=/^(?:0|[1-9]\d*)$/,Tm=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,vr=/($^)/,xm=/['\n\r\u2028\u2029\\]/g,Tr="\\ud800-\\udfff",Cm="\\u0300-\\u036f",Sm="\\ufe20-\\ufe2f",ym="\\u20d0-\\u20ff",_s=Cm+Sm+ym,vs="\\u2700-\\u27bf",Ts="a-z\\xdf-\\xf6\\xf8-\\xff",Mm="\\xac\\xb1\\xd7\\xf7",Im="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",wm="\\u2000-\\u206f",Bm=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",xs="A-Z\\xc0-\\xd6\\xd8-\\xde",Cs="\\ufe0e\\ufe0f",Ss=Mm+Im+wm+Bm,Yo="['\u2019]",Am="["+Tr+"]",ys="["+Ss+"]",xr="["+_s+"]",Ms="\\d+",Em="["+vs+"]",Is="["+Ts+"]",ws="[^"+Tr+Ss+Ms+vs+Ts+xs+"]",Ko="\\ud83c[\\udffb-\\udfff]",Rm="(?:"+xr+"|"+Ko+")",Bs="[^"+Tr+"]",Qo="(?:\\ud83c[\\udde6-\\uddff]){2}",Zo="[\\ud800-\\udbff][\\udc00-\\udfff]",rn="["+xs+"]",As="\\u200d",Es="(?:"+Is+"|"+ws+")",Dm="(?:"+rn+"|"+ws+")",Rs="(?:"+Yo+"(?:d|ll|m|re|s|t|ve))?",Ds="(?:"+Yo+"(?:D|LL|M|RE|S|T|VE))?",Os=Rm+"?",Ls="["+Cs+"]?",Om="(?:"+As+"(?:"+[Bs,Qo,Zo].join("|")+")"+Ls+Os+")*",Lm="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Um="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Us=Ls+Os+Om,Nm="(?:"+[Em,Qo,Zo].join("|")+")"+Us,Fm="(?:"+[Bs+xr+"?",xr,Qo,Zo,Am].join("|")+")",qm=RegExp(Yo,"g"),Pm=RegExp(xr,"g"),Xo=RegExp(Ko+"(?="+Ko+")|"+Fm+Us,"g"),$m=RegExp([rn+"?"+Is+"+"+Rs+"(?="+[ys,rn,"$"].join("|")+")",Dm+"+"+Ds+"(?="+[ys,rn+Es,"$"].join("|")+")",rn+"?"+Es+"+"+Rs,rn+"+"+Ds,Um,Lm,Ms,Nm].join("|"),"g"),Hm=RegExp("["+As+Tr+_s+Cs+"]"),Wm=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Vm=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Gm=-1,de={};de[Fo]=de[qo]=de[Po]=de[$o]=de[Ho]=de[Wo]=de[Vo]=de[Go]=de[ko]=!0,de[tn]=de[gr]=de[Gn]=de[qn]=de[nn]=de[Pn]=de[br]=de[hr]=de[yt]=de[$n]=de[ti]=de[Hn]=de[Mt]=de[Wn]=de[Vn]=!1;var pe={};pe[tn]=pe[gr]=pe[Gn]=pe[nn]=pe[qn]=pe[Pn]=pe[Fo]=pe[qo]=pe[Po]=pe[$o]=pe[Ho]=pe[yt]=pe[$n]=pe[ti]=pe[Hn]=pe[Mt]=pe[Wn]=pe[_r]=pe[Wo]=pe[Vo]=pe[Go]=pe[ko]=!0,pe[br]=pe[hr]=pe[Vn]=!1;var km={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},jm={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},zm={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Ym={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Km=parseFloat,Qm=parseInt,Ns=typeof global=="object"&&global&&global.Object===Object&&global,Zm=typeof self=="object"&&self&&self.Object===Object&&self,Ue=Ns||Zm||Function("return this")(),Jo=typeof Un=="object"&&Un&&!Un.nodeType&&Un,qi=Jo&&typeof pr=="object"&&pr&&!pr.nodeType&&pr,Fs=qi&&qi.exports===Jo,el=Fs&&Ns.process,ut=function(){try{var g=qi&&qi.require&&qi.require("util").types;return g||el&&el.binding&&el.binding("util")}catch{}}(),qs=ut&&ut.isArrayBuffer,Ps=ut&&ut.isDate,$s=ut&&ut.isMap,Hs=ut&&ut.isRegExp,Ws=ut&&ut.isSet,Vs=ut&&ut.isTypedArray;function nt(g,M,C){switch(C.length){case 0:return g.call(M);case 1:return g.call(M,C[0]);case 2:return g.call(M,C[0],C[1]);case 3:return g.call(M,C[0],C[1],C[2])}return g.apply(M,C)}function Xm(g,M,C,O){for(var z=-1,le=g==null?0:g.length;++z<le;){var Oe=g[z];M(O,Oe,C(Oe),g)}return O}function ct(g,M){for(var C=-1,O=g==null?0:g.length;++C<O&&M(g[C],C,g)!==!1;);return g}function Jm(g,M){for(var C=g==null?0:g.length;C--&&M(g[C],C,g)!==!1;);return g}function Gs(g,M){for(var C=-1,O=g==null?0:g.length;++C<O;)if(!M(g[C],C,g))return!1;return!0}function bi(g,M){for(var C=-1,O=g==null?0:g.length,z=0,le=[];++C<O;){var Oe=g[C];M(Oe,C,g)&&(le[z++]=Oe)}return le}function Cr(g,M){var C=g==null?0:g.length;return!!C&&on(g,M,0)>-1}function tl(g,M,C){for(var O=-1,z=g==null?0:g.length;++O<z;)if(C(M,g[O]))return!0;return!1}function ge(g,M){for(var C=-1,O=g==null?0:g.length,z=Array(O);++C<O;)z[C]=M(g[C],C,g);return z}function hi(g,M){for(var C=-1,O=M.length,z=g.length;++C<O;)g[z+C]=M[C];return g}function il(g,M,C,O){var z=-1,le=g==null?0:g.length;for(O&&le&&(C=g[++z]);++z<le;)C=M(C,g[z],z,g);return C}function ef(g,M,C,O){var z=g==null?0:g.length;for(O&&z&&(C=g[--z]);z--;)C=M(C,g[z],z,g);return C}function nl(g,M){for(var C=-1,O=g==null?0:g.length;++C<O;)if(M(g[C],C,g))return!0;return!1}var tf=rl("length");function nf(g){return g.split("")}function rf(g){return g.match(mm)||[]}function ks(g,M,C){var O;return C(g,function(z,le,Oe){if(M(z,le,Oe))return O=le,!1}),O}function Sr(g,M,C,O){for(var z=g.length,le=C+(O?1:-1);O?le--:++le<z;)if(M(g[le],le,g))return le;return-1}function on(g,M,C){return M===M?bf(g,M,C):Sr(g,js,C)}function of(g,M,C,O){for(var z=C-1,le=g.length;++z<le;)if(O(g[z],M))return z;return-1}function js(g){return g!==g}function zs(g,M){var C=g==null?0:g.length;return C?ll(g,M)/C:dr}function rl(g){return function(M){return M==null?l:M[g]}}function ol(g){return function(M){return g==null?l:g[M]}}function Ys(g,M,C,O,z){return z(g,function(le,Oe,fe){C=O?(O=!1,le):M(C,le,Oe,fe)}),C}function lf(g,M){var C=g.length;for(g.sort(M);C--;)g[C]=g[C].value;return g}function ll(g,M){for(var C,O=-1,z=g.length;++O<z;){var le=M(g[O]);le!==l&&(C=C===l?le:C+le)}return C}function sl(g,M){for(var C=-1,O=Array(g);++C<g;)O[C]=M(C);return O}function sf(g,M){return ge(M,function(C){return[C,g[C]]})}function Ks(g){return g&&g.slice(0,Js(g)+1).replace(zo,"")}function rt(g){return function(M){return g(M)}}function al(g,M){return ge(M,function(C){return g[C]})}function kn(g,M){return g.has(M)}function Qs(g,M){for(var C=-1,O=g.length;++C<O&&on(M,g[C],0)>-1;);return C}function Zs(g,M){for(var C=g.length;C--&&on(M,g[C],0)>-1;);return C}function af(g,M){for(var C=g.length,O=0;C--;)g[C]===M&&++O;return O}var uf=ol(km),cf=ol(jm);function mf(g){return"\\"+Ym[g]}function ff(g,M){return g==null?l:g[M]}function ln(g){return Hm.test(g)}function pf(g){return Wm.test(g)}function df(g){for(var M,C=[];!(M=g.next()).done;)C.push(M.value);return C}function ul(g){var M=-1,C=Array(g.size);return g.forEach(function(O,z){C[++M]=[z,O]}),C}function Xs(g,M){return function(C){return g(M(C))}}function _i(g,M){for(var C=-1,O=g.length,z=0,le=[];++C<O;){var Oe=g[C];(Oe===M||Oe===E)&&(g[C]=E,le[z++]=C)}return le}function yr(g){var M=-1,C=Array(g.size);return g.forEach(function(O){C[++M]=O}),C}function gf(g){var M=-1,C=Array(g.size);return g.forEach(function(O){C[++M]=[O,O]}),C}function bf(g,M,C){for(var O=C-1,z=g.length;++O<z;)if(g[O]===M)return O;return-1}function hf(g,M,C){for(var O=C+1;O--;)if(g[O]===M)return O;return O}function sn(g){return ln(g)?vf(g):tf(g)}function It(g){return ln(g)?Tf(g):nf(g)}function Js(g){for(var M=g.length;M--&&sm.test(g.charAt(M)););return M}var _f=ol(zm);function vf(g){for(var M=Xo.lastIndex=0;Xo.test(g);)++M;return M}function Tf(g){return g.match(Xo)||[]}function xf(g){return g.match($m)||[]}var Cf=function g(M){M=M==null?Ue:vi.defaults(Ue.Object(),M,vi.pick(Ue,Vm));var C=M.Array,O=M.Date,z=M.Error,le=M.Function,Oe=M.Math,fe=M.Object,cl=M.RegExp,Sf=M.String,mt=M.TypeError,Mr=C.prototype,yf=le.prototype,an=fe.prototype,Ir=M["__core-js_shared__"],wr=yf.toString,ce=an.hasOwnProperty,Mf=0,ea=function(){var e=/[^.]+$/.exec(Ir&&Ir.keys&&Ir.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Br=an.toString,If=wr.call(fe),wf=Ue._,Bf=cl("^"+wr.call(ce).replace(jo,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ar=Fs?M.Buffer:l,Ti=M.Symbol,Er=M.Uint8Array,ta=Ar?Ar.allocUnsafe:l,Rr=Xs(fe.getPrototypeOf,fe),ia=fe.create,na=an.propertyIsEnumerable,Dr=Mr.splice,ra=Ti?Ti.isConcatSpreadable:l,jn=Ti?Ti.iterator:l,Pi=Ti?Ti.toStringTag:l,Or=function(){try{var e=Gi(fe,"defineProperty");return e({},"",{}),e}catch{}}(),Af=M.clearTimeout!==Ue.clearTimeout&&M.clearTimeout,Ef=O&&O.now!==Ue.Date.now&&O.now,Rf=M.setTimeout!==Ue.setTimeout&&M.setTimeout,Lr=Oe.ceil,Ur=Oe.floor,ml=fe.getOwnPropertySymbols,Df=Ar?Ar.isBuffer:l,oa=M.isFinite,Of=Mr.join,Lf=Xs(fe.keys,fe),Le=Oe.max,qe=Oe.min,Uf=O.now,Nf=M.parseInt,la=Oe.random,Ff=Mr.reverse,fl=Gi(M,"DataView"),zn=Gi(M,"Map"),pl=Gi(M,"Promise"),un=Gi(M,"Set"),Yn=Gi(M,"WeakMap"),Kn=Gi(fe,"create"),Nr=Yn&&new Yn,cn={},qf=ki(fl),Pf=ki(zn),$f=ki(pl),Hf=ki(un),Wf=ki(Yn),Fr=Ti?Ti.prototype:l,Qn=Fr?Fr.valueOf:l,sa=Fr?Fr.toString:l;function c(e){if(ve(e)&&!K(e)&&!(e instanceof te)){if(e instanceof ft)return e;if(ce.call(e,"__wrapped__"))return au(e)}return new ft(e)}var mn=function(){function e(){}return function(t){if(!he(t))return{};if(ia)return ia(t);e.prototype=t;var i=new e;return e.prototype=l,i}}();function qr(){}function ft(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=l}c.templateSettings={escape:tm,evaluate:im,interpolate:bs,variable:"",imports:{_:c}},c.prototype=qr.prototype,c.prototype.constructor=c,ft.prototype=mn(qr.prototype),ft.prototype.constructor=ft;function te(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ot,this.__views__=[]}function Vf(){var e=new te(this.__wrapped__);return e.__actions__=Ke(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Ke(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Ke(this.__views__),e}function Gf(){if(this.__filtered__){var e=new te(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function kf(){var e=this.__wrapped__.value(),t=this.__dir__,i=K(e),r=t<0,a=i?e.length:0,m=nd(0,a,this.__views__),p=m.start,d=m.end,b=d-p,I=r?d:p-1,w=this.__iteratees__,B=w.length,D=0,$=qe(b,this.__takeCount__);if(!i||!r&&a==b&&$==b)return Ra(e,this.__actions__);var V=[];e:for(;b--&&D<$;){I+=t;for(var Z=-1,G=e[I];++Z<B;){var ee=w[Z],ie=ee.iteratee,st=ee.type,je=ie(G);if(st==qc)G=je;else if(!je){if(st==ms)continue e;break e}}V[D++]=G}return V}te.prototype=mn(qr.prototype),te.prototype.constructor=te;function $i(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function jf(){this.__data__=Kn?Kn(null):{},this.size=0}function zf(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Yf(e){var t=this.__data__;if(Kn){var i=t[e];return i===T?l:i}return ce.call(t,e)?t[e]:l}function Kf(e){var t=this.__data__;return Kn?t[e]!==l:ce.call(t,e)}function Qf(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=Kn&&t===l?T:t,this}$i.prototype.clear=jf,$i.prototype.delete=zf,$i.prototype.get=Yf,$i.prototype.has=Kf,$i.prototype.set=Qf;function ii(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function Zf(){this.__data__=[],this.size=0}function Xf(e){var t=this.__data__,i=Pr(t,e);if(i<0)return!1;var r=t.length-1;return i==r?t.pop():Dr.call(t,i,1),--this.size,!0}function Jf(e){var t=this.__data__,i=Pr(t,e);return i<0?l:t[i][1]}function ep(e){return Pr(this.__data__,e)>-1}function tp(e,t){var i=this.__data__,r=Pr(i,e);return r<0?(++this.size,i.push([e,t])):i[r][1]=t,this}ii.prototype.clear=Zf,ii.prototype.delete=Xf,ii.prototype.get=Jf,ii.prototype.has=ep,ii.prototype.set=tp;function ni(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function ip(){this.size=0,this.__data__={hash:new $i,map:new(zn||ii),string:new $i}}function np(e){var t=Zr(this,e).delete(e);return this.size-=t?1:0,t}function rp(e){return Zr(this,e).get(e)}function op(e){return Zr(this,e).has(e)}function lp(e,t){var i=Zr(this,e),r=i.size;return i.set(e,t),this.size+=i.size==r?0:1,this}ni.prototype.clear=ip,ni.prototype.delete=np,ni.prototype.get=rp,ni.prototype.has=op,ni.prototype.set=lp;function Hi(e){var t=-1,i=e==null?0:e.length;for(this.__data__=new ni;++t<i;)this.add(e[t])}function sp(e){return this.__data__.set(e,T),this}function ap(e){return this.__data__.has(e)}Hi.prototype.add=Hi.prototype.push=sp,Hi.prototype.has=ap;function wt(e){var t=this.__data__=new ii(e);this.size=t.size}function up(){this.__data__=new ii,this.size=0}function cp(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i}function mp(e){return this.__data__.get(e)}function fp(e){return this.__data__.has(e)}function pp(e,t){var i=this.__data__;if(i instanceof ii){var r=i.__data__;if(!zn||r.length<n-1)return r.push([e,t]),this.size=++i.size,this;i=this.__data__=new ni(r)}return i.set(e,t),this.size=i.size,this}wt.prototype.clear=up,wt.prototype.delete=cp,wt.prototype.get=mp,wt.prototype.has=fp,wt.prototype.set=pp;function aa(e,t){var i=K(e),r=!i&&ji(e),a=!i&&!r&&Mi(e),m=!i&&!r&&!a&&gn(e),p=i||r||a||m,d=p?sl(e.length,Sf):[],b=d.length;for(var I in e)(t||ce.call(e,I))&&!(p&&(I=="length"||a&&(I=="offset"||I=="parent")||m&&(I=="buffer"||I=="byteLength"||I=="byteOffset")||si(I,b)))&&d.push(I);return d}function ua(e){var t=e.length;return t?e[yl(0,t-1)]:l}function dp(e,t){return Xr(Ke(e),Wi(t,0,e.length))}function gp(e){return Xr(Ke(e))}function dl(e,t,i){(i!==l&&!Bt(e[t],i)||i===l&&!(t in e))&&ri(e,t,i)}function Zn(e,t,i){var r=e[t];(!(ce.call(e,t)&&Bt(r,i))||i===l&&!(t in e))&&ri(e,t,i)}function Pr(e,t){for(var i=e.length;i--;)if(Bt(e[i][0],t))return i;return-1}function bp(e,t,i,r){return xi(e,function(a,m,p){t(r,a,i(a),p)}),r}function ca(e,t){return e&&Ut(t,Ne(t),e)}function hp(e,t){return e&&Ut(t,Ze(t),e)}function ri(e,t,i){t=="__proto__"&&Or?Or(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}function gl(e,t){for(var i=-1,r=t.length,a=C(r),m=e==null;++i<r;)a[i]=m?l:Kl(e,t[i]);return a}function Wi(e,t,i){return e===e&&(i!==l&&(e=e<=i?e:i),t!==l&&(e=e>=t?e:t)),e}function pt(e,t,i,r,a,m){var p,d=t&J,b=t&oe,I=t&ae;if(i&&(p=a?i(e,r,a,m):i(e)),p!==l)return p;if(!he(e))return e;var w=K(e);if(w){if(p=od(e),!d)return Ke(e,p)}else{var B=Pe(e),D=B==hr||B==fs;if(Mi(e))return La(e,d);if(B==ti||B==tn||D&&!a){if(p=b||D?{}:Ja(e),!d)return b?Yp(e,hp(p,e)):zp(e,ca(p,e))}else{if(!pe[B])return a?e:{};p=ld(e,B,d)}}m||(m=new wt);var $=m.get(e);if($)return $;m.set(e,p),Bu(e)?e.forEach(function(G){p.add(pt(G,t,i,G,e,m))}):Iu(e)&&e.forEach(function(G,ee){p.set(ee,pt(G,t,i,ee,e,m))});var V=I?b?Ul:Ll:b?Ze:Ne,Z=w?l:V(e);return ct(Z||e,function(G,ee){Z&&(ee=G,G=e[ee]),Zn(p,ee,pt(G,t,i,ee,e,m))}),p}function _p(e){var t=Ne(e);return function(i){return ma(i,e,t)}}function ma(e,t,i){var r=i.length;if(e==null)return!r;for(e=fe(e);r--;){var a=i[r],m=t[a],p=e[a];if(p===l&&!(a in e)||!m(p))return!1}return!0}function fa(e,t,i){if(typeof e!="function")throw new mt(u);return rr(function(){e.apply(l,i)},t)}function Xn(e,t,i,r){var a=-1,m=Cr,p=!0,d=e.length,b=[],I=t.length;if(!d)return b;i&&(t=ge(t,rt(i))),r?(m=tl,p=!1):t.length>=n&&(m=kn,p=!1,t=new Hi(t));e:for(;++a<d;){var w=e[a],B=i==null?w:i(w);if(w=r||w!==0?w:0,p&&B===B){for(var D=I;D--;)if(t[D]===B)continue e;b.push(w)}else m(t,B,r)||b.push(w)}return b}var xi=Pa(Lt),pa=Pa(hl,!0);function vp(e,t){var i=!0;return xi(e,function(r,a,m){return i=!!t(r,a,m),i}),i}function $r(e,t,i){for(var r=-1,a=e.length;++r<a;){var m=e[r],p=t(m);if(p!=null&&(d===l?p===p&&!lt(p):i(p,d)))var d=p,b=m}return b}function Tp(e,t,i,r){var a=e.length;for(i=Q(i),i<0&&(i=-i>a?0:a+i),r=r===l||r>a?a:Q(r),r<0&&(r+=a),r=i>r?0:Eu(r);i<r;)e[i++]=t;return e}function da(e,t){var i=[];return xi(e,function(r,a,m){t(r,a,m)&&i.push(r)}),i}function Fe(e,t,i,r,a){var m=-1,p=e.length;for(i||(i=ad),a||(a=[]);++m<p;){var d=e[m];t>0&&i(d)?t>1?Fe(d,t-1,i,r,a):hi(a,d):r||(a[a.length]=d)}return a}var bl=$a(),ga=$a(!0);function Lt(e,t){return e&&bl(e,t,Ne)}function hl(e,t){return e&&ga(e,t,Ne)}function Hr(e,t){return bi(t,function(i){return ai(e[i])})}function Vi(e,t){t=Si(t,e);for(var i=0,r=t.length;e!=null&&i<r;)e=e[Nt(t[i++])];return i&&i==r?e:l}function ba(e,t,i){var r=t(e);return K(e)?r:hi(r,i(e))}function Ge(e){return e==null?e===l?Yc:jc:Pi&&Pi in fe(e)?id(e):gd(e)}function _l(e,t){return e>t}function xp(e,t){return e!=null&&ce.call(e,t)}function Cp(e,t){return e!=null&&t in fe(e)}function Sp(e,t,i){return e>=qe(t,i)&&e<Le(t,i)}function vl(e,t,i){for(var r=i?tl:Cr,a=e[0].length,m=e.length,p=m,d=C(m),b=1/0,I=[];p--;){var w=e[p];p&&t&&(w=ge(w,rt(t))),b=qe(w.length,b),d[p]=!i&&(t||a>=120&&w.length>=120)?new Hi(p&&w):l}w=e[0];var B=-1,D=d[0];e:for(;++B<a&&I.length<b;){var $=w[B],V=t?t($):$;if($=i||$!==0?$:0,!(D?kn(D,V):r(I,V,i))){for(p=m;--p;){var Z=d[p];if(!(Z?kn(Z,V):r(e[p],V,i)))continue e}D&&D.push(V),I.push($)}}return I}function yp(e,t,i,r){return Lt(e,function(a,m,p){t(r,i(a),m,p)}),r}function Jn(e,t,i){t=Si(t,e),e=nu(e,t);var r=e==null?e:e[Nt(gt(t))];return r==null?l:nt(r,e,i)}function ha(e){return ve(e)&&Ge(e)==tn}function Mp(e){return ve(e)&&Ge(e)==Gn}function Ip(e){return ve(e)&&Ge(e)==Pn}function er(e,t,i,r,a){return e===t?!0:e==null||t==null||!ve(e)&&!ve(t)?e!==e&&t!==t:wp(e,t,i,r,er,a)}function wp(e,t,i,r,a,m){var p=K(e),d=K(t),b=p?gr:Pe(e),I=d?gr:Pe(t);b=b==tn?ti:b,I=I==tn?ti:I;var w=b==ti,B=I==ti,D=b==I;if(D&&Mi(e)){if(!Mi(t))return!1;p=!0,w=!1}if(D&&!w)return m||(m=new wt),p||gn(e)?Qa(e,t,i,r,a,m):ed(e,t,b,i,r,a,m);if(!(i&We)){var $=w&&ce.call(e,"__wrapped__"),V=B&&ce.call(t,"__wrapped__");if($||V){var Z=$?e.value():e,G=V?t.value():t;return m||(m=new wt),a(Z,G,i,r,m)}}return D?(m||(m=new wt),td(e,t,i,r,a,m)):!1}function Bp(e){return ve(e)&&Pe(e)==yt}function Tl(e,t,i,r){var a=i.length,m=a,p=!r;if(e==null)return!m;for(e=fe(e);a--;){var d=i[a];if(p&&d[2]?d[1]!==e[d[0]]:!(d[0]in e))return!1}for(;++a<m;){d=i[a];var b=d[0],I=e[b],w=d[1];if(p&&d[2]){if(I===l&&!(b in e))return!1}else{var B=new wt;if(r)var D=r(I,w,b,e,t,B);if(!(D===l?er(w,I,We|Jt,r,B):D))return!1}}return!0}function _a(e){if(!he(e)||cd(e))return!1;var t=ai(e)?Bf:hm;return t.test(ki(e))}function Ap(e){return ve(e)&&Ge(e)==Hn}function Ep(e){return ve(e)&&Pe(e)==Mt}function Rp(e){return ve(e)&&ro(e.length)&&!!de[Ge(e)]}function va(e){return typeof e=="function"?e:e==null?Xe:typeof e=="object"?K(e)?Ca(e[0],e[1]):xa(e):Hu(e)}function xl(e){if(!nr(e))return Lf(e);var t=[];for(var i in fe(e))ce.call(e,i)&&i!="constructor"&&t.push(i);return t}function Dp(e){if(!he(e))return dd(e);var t=nr(e),i=[];for(var r in e)r=="constructor"&&(t||!ce.call(e,r))||i.push(r);return i}function Cl(e,t){return e<t}function Ta(e,t){var i=-1,r=Qe(e)?C(e.length):[];return xi(e,function(a,m,p){r[++i]=t(a,m,p)}),r}function xa(e){var t=Fl(e);return t.length==1&&t[0][2]?tu(t[0][0],t[0][1]):function(i){return i===e||Tl(i,e,t)}}function Ca(e,t){return Pl(e)&&eu(t)?tu(Nt(e),t):function(i){var r=Kl(i,e);return r===l&&r===t?Ql(i,e):er(t,r,We|Jt)}}function Wr(e,t,i,r,a){e!==t&&bl(t,function(m,p){if(a||(a=new wt),he(m))Op(e,t,p,i,Wr,r,a);else{var d=r?r(Hl(e,p),m,p+"",e,t,a):l;d===l&&(d=m),dl(e,p,d)}},Ze)}function Op(e,t,i,r,a,m,p){var d=Hl(e,i),b=Hl(t,i),I=p.get(b);if(I){dl(e,i,I);return}var w=m?m(d,b,i+"",e,t,p):l,B=w===l;if(B){var D=K(b),$=!D&&Mi(b),V=!D&&!$&&gn(b);w=b,D||$||V?K(d)?w=d:ye(d)?w=Ke(d):$?(B=!1,w=La(b,!0)):V?(B=!1,w=Ua(b,!0)):w=[]:or(b)||ji(b)?(w=d,ji(d)?w=Ru(d):(!he(d)||ai(d))&&(w=Ja(b))):B=!1}B&&(p.set(b,w),a(w,b,r,m,p),p.delete(b)),dl(e,i,w)}function Sa(e,t){var i=e.length;if(i)return t+=t<0?i:0,si(t,i)?e[t]:l}function ya(e,t,i){t.length?t=ge(t,function(m){return K(m)?function(p){return Vi(p,m.length===1?m[0]:m)}:m}):t=[Xe];var r=-1;t=ge(t,rt(H()));var a=Ta(e,function(m,p,d){var b=ge(t,function(I){return I(m)});return{criteria:b,index:++r,value:m}});return lf(a,function(m,p){return jp(m,p,i)})}function Lp(e,t){return Ma(e,t,function(i,r){return Ql(e,r)})}function Ma(e,t,i){for(var r=-1,a=t.length,m={};++r<a;){var p=t[r],d=Vi(e,p);i(d,p)&&tr(m,Si(p,e),d)}return m}function Up(e){return function(t){return Vi(t,e)}}function Sl(e,t,i,r){var a=r?of:on,m=-1,p=t.length,d=e;for(e===t&&(t=Ke(t)),i&&(d=ge(e,rt(i)));++m<p;)for(var b=0,I=t[m],w=i?i(I):I;(b=a(d,w,b,r))>-1;)d!==e&&Dr.call(d,b,1),Dr.call(e,b,1);return e}function Ia(e,t){for(var i=e?t.length:0,r=i-1;i--;){var a=t[i];if(i==r||a!==m){var m=a;si(a)?Dr.call(e,a,1):wl(e,a)}}return e}function yl(e,t){return e+Ur(la()*(t-e+1))}function Np(e,t,i,r){for(var a=-1,m=Le(Lr((t-e)/(i||1)),0),p=C(m);m--;)p[r?m:++a]=e,e+=i;return p}function Ml(e,t){var i="";if(!e||t<1||t>gi)return i;do t%2&&(i+=e),t=Ur(t/2),t&&(e+=e);while(t);return i}function X(e,t){return Wl(iu(e,t,Xe),e+"")}function Fp(e){return ua(bn(e))}function qp(e,t){var i=bn(e);return Xr(i,Wi(t,0,i.length))}function tr(e,t,i,r){if(!he(e))return e;t=Si(t,e);for(var a=-1,m=t.length,p=m-1,d=e;d!=null&&++a<m;){var b=Nt(t[a]),I=i;if(b==="__proto__"||b==="constructor"||b==="prototype")return e;if(a!=p){var w=d[b];I=r?r(w,b,d):l,I===l&&(I=he(w)?w:si(t[a+1])?[]:{})}Zn(d,b,I),d=d[b]}return e}var wa=Nr?function(e,t){return Nr.set(e,t),e}:Xe,Pp=Or?function(e,t){return Or(e,"toString",{configurable:!0,enumerable:!1,value:Xl(t),writable:!0})}:Xe;function $p(e){return Xr(bn(e))}function dt(e,t,i){var r=-1,a=e.length;t<0&&(t=-t>a?0:a+t),i=i>a?a:i,i<0&&(i+=a),a=t>i?0:i-t>>>0,t>>>=0;for(var m=C(a);++r<a;)m[r]=e[r+t];return m}function Hp(e,t){var i;return xi(e,function(r,a,m){return i=t(r,a,m),!i}),!!i}function Vr(e,t,i){var r=0,a=e==null?r:e.length;if(typeof t=="number"&&t===t&&a<=Wc){for(;r<a;){var m=r+a>>>1,p=e[m];p!==null&&!lt(p)&&(i?p<=t:p<t)?r=m+1:a=m}return a}return Il(e,t,Xe,i)}function Il(e,t,i,r){var a=0,m=e==null?0:e.length;if(m===0)return 0;t=i(t);for(var p=t!==t,d=t===null,b=lt(t),I=t===l;a<m;){var w=Ur((a+m)/2),B=i(e[w]),D=B!==l,$=B===null,V=B===B,Z=lt(B);if(p)var G=r||V;else I?G=V&&(r||D):d?G=V&&D&&(r||!$):b?G=V&&D&&!$&&(r||!Z):$||Z?G=!1:G=r?B<=t:B<t;G?a=w+1:m=w}return qe(m,Hc)}function Ba(e,t){for(var i=-1,r=e.length,a=0,m=[];++i<r;){var p=e[i],d=t?t(p):p;if(!i||!Bt(d,b)){var b=d;m[a++]=p===0?0:p}}return m}function Aa(e){return typeof e=="number"?e:lt(e)?dr:+e}function ot(e){if(typeof e=="string")return e;if(K(e))return ge(e,ot)+"";if(lt(e))return sa?sa.call(e):"";var t=e+"";return t=="0"&&1/e==-Fi?"-0":t}function Ci(e,t,i){var r=-1,a=Cr,m=e.length,p=!0,d=[],b=d;if(i)p=!1,a=tl;else if(m>=n){var I=t?null:Xp(e);if(I)return yr(I);p=!1,a=kn,b=new Hi}else b=t?[]:d;e:for(;++r<m;){var w=e[r],B=t?t(w):w;if(w=i||w!==0?w:0,p&&B===B){for(var D=b.length;D--;)if(b[D]===B)continue e;t&&b.push(B),d.push(w)}else a(b,B,i)||(b!==d&&b.push(B),d.push(w))}return d}function wl(e,t){return t=Si(t,e),e=nu(e,t),e==null||delete e[Nt(gt(t))]}function Ea(e,t,i,r){return tr(e,t,i(Vi(e,t)),r)}function Gr(e,t,i,r){for(var a=e.length,m=r?a:-1;(r?m--:++m<a)&&t(e[m],m,e););return i?dt(e,r?0:m,r?m+1:a):dt(e,r?m+1:0,r?a:m)}function Ra(e,t){var i=e;return i instanceof te&&(i=i.value()),il(t,function(r,a){return a.func.apply(a.thisArg,hi([r],a.args))},i)}function Bl(e,t,i){var r=e.length;if(r<2)return r?Ci(e[0]):[];for(var a=-1,m=C(r);++a<r;)for(var p=e[a],d=-1;++d<r;)d!=a&&(m[a]=Xn(m[a]||p,e[d],t,i));return Ci(Fe(m,1),t,i)}function Da(e,t,i){for(var r=-1,a=e.length,m=t.length,p={};++r<a;){var d=r<m?t[r]:l;i(p,e[r],d)}return p}function Al(e){return ye(e)?e:[]}function El(e){return typeof e=="function"?e:Xe}function Si(e,t){return K(e)?e:Pl(e,t)?[e]:su(ue(e))}var Wp=X;function yi(e,t,i){var r=e.length;return i=i===l?r:i,!t&&i>=r?e:dt(e,t,i)}var Oa=Af||function(e){return Ue.clearTimeout(e)};function La(e,t){if(t)return e.slice();var i=e.length,r=ta?ta(i):new e.constructor(i);return e.copy(r),r}function Rl(e){var t=new e.constructor(e.byteLength);return new Er(t).set(new Er(e)),t}function Vp(e,t){var i=t?Rl(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}function Gp(e){var t=new e.constructor(e.source,hs.exec(e));return t.lastIndex=e.lastIndex,t}function kp(e){return Qn?fe(Qn.call(e)):{}}function Ua(e,t){var i=t?Rl(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}function Na(e,t){if(e!==t){var i=e!==l,r=e===null,a=e===e,m=lt(e),p=t!==l,d=t===null,b=t===t,I=lt(t);if(!d&&!I&&!m&&e>t||m&&p&&b&&!d&&!I||r&&p&&b||!i&&b||!a)return 1;if(!r&&!m&&!I&&e<t||I&&i&&a&&!r&&!m||d&&i&&a||!p&&a||!b)return-1}return 0}function jp(e,t,i){for(var r=-1,a=e.criteria,m=t.criteria,p=a.length,d=i.length;++r<p;){var b=Na(a[r],m[r]);if(b){if(r>=d)return b;var I=i[r];return b*(I=="desc"?-1:1)}}return e.index-t.index}function Fa(e,t,i,r){for(var a=-1,m=e.length,p=i.length,d=-1,b=t.length,I=Le(m-p,0),w=C(b+I),B=!r;++d<b;)w[d]=t[d];for(;++a<p;)(B||a<m)&&(w[i[a]]=e[a]);for(;I--;)w[d++]=e[a++];return w}function qa(e,t,i,r){for(var a=-1,m=e.length,p=-1,d=i.length,b=-1,I=t.length,w=Le(m-d,0),B=C(w+I),D=!r;++a<w;)B[a]=e[a];for(var $=a;++b<I;)B[$+b]=t[b];for(;++p<d;)(D||a<m)&&(B[$+i[p]]=e[a++]);return B}function Ke(e,t){var i=-1,r=e.length;for(t||(t=C(r));++i<r;)t[i]=e[i];return t}function Ut(e,t,i,r){var a=!i;i||(i={});for(var m=-1,p=t.length;++m<p;){var d=t[m],b=r?r(i[d],e[d],d,i,e):l;b===l&&(b=e[d]),a?ri(i,d,b):Zn(i,d,b)}return i}function zp(e,t){return Ut(e,ql(e),t)}function Yp(e,t){return Ut(e,Za(e),t)}function kr(e,t){return function(i,r){var a=K(i)?Xm:bp,m=t?t():{};return a(i,e,H(r,2),m)}}function fn(e){return X(function(t,i){var r=-1,a=i.length,m=a>1?i[a-1]:l,p=a>2?i[2]:l;for(m=e.length>3&&typeof m=="function"?(a--,m):l,p&&ke(i[0],i[1],p)&&(m=a<3?l:m,a=1),t=fe(t);++r<a;){var d=i[r];d&&e(t,d,r,m)}return t})}function Pa(e,t){return function(i,r){if(i==null)return i;if(!Qe(i))return e(i,r);for(var a=i.length,m=t?a:-1,p=fe(i);(t?m--:++m<a)&&r(p[m],m,p)!==!1;);return i}}function $a(e){return function(t,i,r){for(var a=-1,m=fe(t),p=r(t),d=p.length;d--;){var b=p[e?d:++a];if(i(m[b],b,m)===!1)break}return t}}function Kp(e,t,i){var r=t&Ve,a=ir(e);function m(){var p=this&&this!==Ue&&this instanceof m?a:e;return p.apply(r?i:this,arguments)}return m}function Ha(e){return function(t){t=ue(t);var i=ln(t)?It(t):l,r=i?i[0]:t.charAt(0),a=i?yi(i,1).join(""):t.slice(1);return r[e]()+a}}function pn(e){return function(t){return il(Pu(qu(t).replace(qm,"")),e,"")}}function ir(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var i=mn(e.prototype),r=e.apply(i,t);return he(r)?r:i}}function Qp(e,t,i){var r=ir(e);function a(){for(var m=arguments.length,p=C(m),d=m,b=dn(a);d--;)p[d]=arguments[d];var I=m<3&&p[0]!==b&&p[m-1]!==b?[]:_i(p,b);if(m-=I.length,m<i)return ja(e,t,jr,a.placeholder,l,p,I,l,l,i-m);var w=this&&this!==Ue&&this instanceof a?r:e;return nt(w,this,p)}return a}function Wa(e){return function(t,i,r){var a=fe(t);if(!Qe(t)){var m=H(i,3);t=Ne(t),i=function(d){return m(a[d],d,a)}}var p=e(t,i,r);return p>-1?a[m?t[p]:p]:l}}function Va(e){return li(function(t){var i=t.length,r=i,a=ft.prototype.thru;for(e&&t.reverse();r--;){var m=t[r];if(typeof m!="function")throw new mt(u);if(a&&!p&&Qr(m)=="wrapper")var p=new ft([],!0)}for(r=p?r:i;++r<i;){m=t[r];var d=Qr(m),b=d=="wrapper"?Nl(m):l;b&&$l(b[0])&&b[1]==(ei|Rt|Dt|Fn)&&!b[4].length&&b[9]==1?p=p[Qr(b[0])].apply(p,b[3]):p=m.length==1&&$l(m)?p[d]():p.thru(m)}return function(){var I=arguments,w=I[0];if(p&&I.length==1&&K(w))return p.plant(w).value();for(var B=0,D=i?t[B].apply(this,I):w;++B<i;)D=t[B].call(this,D);return D}})}function jr(e,t,i,r,a,m,p,d,b,I){var w=t&ei,B=t&Ve,D=t&Et,$=t&(Rt|Ji),V=t&No,Z=D?l:ir(e);function G(){for(var ee=arguments.length,ie=C(ee),st=ee;st--;)ie[st]=arguments[st];if($)var je=dn(G),at=af(ie,je);if(r&&(ie=Fa(ie,r,a,$)),m&&(ie=qa(ie,m,p,$)),ee-=at,$&&ee<I){var Me=_i(ie,je);return ja(e,t,jr,G.placeholder,i,ie,Me,d,b,I-ee)}var At=B?i:this,ci=D?At[e]:e;return ee=ie.length,d?ie=bd(ie,d):V&&ee>1&&ie.reverse(),w&&b<ee&&(ie.length=b),this&&this!==Ue&&this instanceof G&&(ci=Z||ir(ci)),ci.apply(At,ie)}return G}function Ga(e,t){return function(i,r){return yp(i,e,t(r),{})}}function zr(e,t){return function(i,r){var a;if(i===l&&r===l)return t;if(i!==l&&(a=i),r!==l){if(a===l)return r;typeof i=="string"||typeof r=="string"?(i=ot(i),r=ot(r)):(i=Aa(i),r=Aa(r)),a=e(i,r)}return a}}function Dl(e){return li(function(t){return t=ge(t,rt(H())),X(function(i){var r=this;return e(t,function(a){return nt(a,r,i)})})})}function Yr(e,t){t=t===l?" ":ot(t);var i=t.length;if(i<2)return i?Ml(t,e):t;var r=Ml(t,Lr(e/sn(t)));return ln(t)?yi(It(r),0,e).join(""):r.slice(0,e)}function Zp(e,t,i,r){var a=t&Ve,m=ir(e);function p(){for(var d=-1,b=arguments.length,I=-1,w=r.length,B=C(w+b),D=this&&this!==Ue&&this instanceof p?m:e;++I<w;)B[I]=r[I];for(;b--;)B[I++]=arguments[++d];return nt(D,a?i:this,B)}return p}function ka(e){return function(t,i,r){return r&&typeof r!="number"&&ke(t,i,r)&&(i=r=l),t=ui(t),i===l?(i=t,t=0):i=ui(i),r=r===l?t<i?1:-1:ui(r),Np(t,i,r,e)}}function Kr(e){return function(t,i){return typeof t=="string"&&typeof i=="string"||(t=bt(t),i=bt(i)),e(t,i)}}function ja(e,t,i,r,a,m,p,d,b,I){var w=t&Rt,B=w?p:l,D=w?l:p,$=w?m:l,V=w?l:m;t|=w?Dt:en,t&=~(w?en:Dt),t&cs||(t&=~(Ve|Et));var Z=[e,t,a,$,B,V,D,d,b,I],G=i.apply(l,Z);return $l(e)&&ru(G,Z),G.placeholder=r,ou(G,e,t)}function Ol(e){var t=Oe[e];return function(i,r){if(i=bt(i),r=r==null?0:qe(Q(r),292),r&&oa(i)){var a=(ue(i)+"e").split("e"),m=t(a[0]+"e"+(+a[1]+r));return a=(ue(m)+"e").split("e"),+(a[0]+"e"+(+a[1]-r))}return t(i)}}var Xp=un&&1/yr(new un([,-0]))[1]==Fi?function(e){return new un(e)}:ts;function za(e){return function(t){var i=Pe(t);return i==yt?ul(t):i==Mt?gf(t):sf(t,e(t))}}function oi(e,t,i,r,a,m,p,d){var b=t&Et;if(!b&&typeof e!="function")throw new mt(u);var I=r?r.length:0;if(I||(t&=~(Dt|en),r=a=l),p=p===l?p:Le(Q(p),0),d=d===l?d:Q(d),I-=a?a.length:0,t&en){var w=r,B=a;r=a=l}var D=b?l:Nl(e),$=[e,t,i,r,a,w,B,m,p,d];if(D&&pd($,D),e=$[0],t=$[1],i=$[2],r=$[3],a=$[4],d=$[9]=$[9]===l?b?0:e.length:Le($[9]-I,0),!d&&t&(Rt|Ji)&&(t&=~(Rt|Ji)),!t||t==Ve)var V=Kp(e,t,i);else t==Rt||t==Ji?V=Qp(e,t,d):(t==Dt||t==(Ve|Dt))&&!a.length?V=Zp(e,t,i,r):V=jr.apply(l,$);var Z=D?wa:ru;return ou(Z(V,$),e,t)}function Ya(e,t,i,r){return e===l||Bt(e,an[i])&&!ce.call(r,i)?t:e}function Ka(e,t,i,r,a,m){return he(e)&&he(t)&&(m.set(t,e),Wr(e,t,l,Ka,m),m.delete(t)),e}function Jp(e){return or(e)?l:e}function Qa(e,t,i,r,a,m){var p=i&We,d=e.length,b=t.length;if(d!=b&&!(p&&b>d))return!1;var I=m.get(e),w=m.get(t);if(I&&w)return I==t&&w==e;var B=-1,D=!0,$=i&Jt?new Hi:l;for(m.set(e,t),m.set(t,e);++B<d;){var V=e[B],Z=t[B];if(r)var G=p?r(Z,V,B,t,e,m):r(V,Z,B,e,t,m);if(G!==l){if(G)continue;D=!1;break}if($){if(!nl(t,function(ee,ie){if(!kn($,ie)&&(V===ee||a(V,ee,i,r,m)))return $.push(ie)})){D=!1;break}}else if(!(V===Z||a(V,Z,i,r,m))){D=!1;break}}return m.delete(e),m.delete(t),D}function ed(e,t,i,r,a,m,p){switch(i){case nn:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Gn:return!(e.byteLength!=t.byteLength||!m(new Er(e),new Er(t)));case qn:case Pn:case $n:return Bt(+e,+t);case br:return e.name==t.name&&e.message==t.message;case Hn:case Wn:return e==t+"";case yt:var d=ul;case Mt:var b=r&We;if(d||(d=yr),e.size!=t.size&&!b)return!1;var I=p.get(e);if(I)return I==t;r|=Jt,p.set(e,t);var w=Qa(d(e),d(t),r,a,m,p);return p.delete(e),w;case _r:if(Qn)return Qn.call(e)==Qn.call(t)}return!1}function td(e,t,i,r,a,m){var p=i&We,d=Ll(e),b=d.length,I=Ll(t),w=I.length;if(b!=w&&!p)return!1;for(var B=b;B--;){var D=d[B];if(!(p?D in t:ce.call(t,D)))return!1}var $=m.get(e),V=m.get(t);if($&&V)return $==t&&V==e;var Z=!0;m.set(e,t),m.set(t,e);for(var G=p;++B<b;){D=d[B];var ee=e[D],ie=t[D];if(r)var st=p?r(ie,ee,D,t,e,m):r(ee,ie,D,e,t,m);if(!(st===l?ee===ie||a(ee,ie,i,r,m):st)){Z=!1;break}G||(G=D=="constructor")}if(Z&&!G){var je=e.constructor,at=t.constructor;je!=at&&"constructor"in e&&"constructor"in t&&!(typeof je=="function"&&je instanceof je&&typeof at=="function"&&at instanceof at)&&(Z=!1)}return m.delete(e),m.delete(t),Z}function li(e){return Wl(iu(e,l,mu),e+"")}function Ll(e){return ba(e,Ne,ql)}function Ul(e){return ba(e,Ze,Za)}var Nl=Nr?function(e){return Nr.get(e)}:ts;function Qr(e){for(var t=e.name+"",i=cn[t],r=ce.call(cn,t)?i.length:0;r--;){var a=i[r],m=a.func;if(m==null||m==e)return a.name}return t}function dn(e){var t=ce.call(c,"placeholder")?c:e;return t.placeholder}function H(){var e=c.iteratee||Jl;return e=e===Jl?va:e,arguments.length?e(arguments[0],arguments[1]):e}function Zr(e,t){var i=e.__data__;return ud(t)?i[typeof t=="string"?"string":"hash"]:i.map}function Fl(e){for(var t=Ne(e),i=t.length;i--;){var r=t[i],a=e[r];t[i]=[r,a,eu(a)]}return t}function Gi(e,t){var i=ff(e,t);return _a(i)?i:l}function id(e){var t=ce.call(e,Pi),i=e[Pi];try{e[Pi]=l;var r=!0}catch{}var a=Br.call(e);return r&&(t?e[Pi]=i:delete e[Pi]),a}var ql=ml?function(e){return e==null?[]:(e=fe(e),bi(ml(e),function(t){return na.call(e,t)}))}:is,Za=ml?function(e){for(var t=[];e;)hi(t,ql(e)),e=Rr(e);return t}:is,Pe=Ge;(fl&&Pe(new fl(new ArrayBuffer(1)))!=nn||zn&&Pe(new zn)!=yt||pl&&Pe(pl.resolve())!=ps||un&&Pe(new un)!=Mt||Yn&&Pe(new Yn)!=Vn)&&(Pe=function(e){var t=Ge(e),i=t==ti?e.constructor:l,r=i?ki(i):"";if(r)switch(r){case qf:return nn;case Pf:return yt;case $f:return ps;case Hf:return Mt;case Wf:return Vn}return t});function nd(e,t,i){for(var r=-1,a=i.length;++r<a;){var m=i[r],p=m.size;switch(m.type){case"drop":e+=p;break;case"dropRight":t-=p;break;case"take":t=qe(t,e+p);break;case"takeRight":e=Le(e,t-p);break}}return{start:e,end:t}}function rd(e){var t=e.match(um);return t?t[1].split(cm):[]}function Xa(e,t,i){t=Si(t,e);for(var r=-1,a=t.length,m=!1;++r<a;){var p=Nt(t[r]);if(!(m=e!=null&&i(e,p)))break;e=e[p]}return m||++r!=a?m:(a=e==null?0:e.length,!!a&&ro(a)&&si(p,a)&&(K(e)||ji(e)))}function od(e){var t=e.length,i=new e.constructor(t);return t&&typeof e[0]=="string"&&ce.call(e,"index")&&(i.index=e.index,i.input=e.input),i}function Ja(e){return typeof e.constructor=="function"&&!nr(e)?mn(Rr(e)):{}}function ld(e,t,i){var r=e.constructor;switch(t){case Gn:return Rl(e);case qn:case Pn:return new r(+e);case nn:return Vp(e,i);case Fo:case qo:case Po:case $o:case Ho:case Wo:case Vo:case Go:case ko:return Ua(e,i);case yt:return new r;case $n:case Wn:return new r(e);case Hn:return Gp(e);case Mt:return new r;case _r:return kp(e)}}function sd(e,t){var i=t.length;if(!i)return e;var r=i-1;return t[r]=(i>1?"& ":"")+t[r],t=t.join(i>2?", ":" "),e.replace(am,`{
/* [wrapped with `+t+`] */
`)}function ad(e){return K(e)||ji(e)||!!(ra&&e&&e[ra])}function si(e,t){var i=typeof e;return t=t??gi,!!t&&(i=="number"||i!="symbol"&&vm.test(e))&&e>-1&&e%1==0&&e<t}function ke(e,t,i){if(!he(i))return!1;var r=typeof t;return(r=="number"?Qe(i)&&si(t,i.length):r=="string"&&t in i)?Bt(i[t],e):!1}function Pl(e,t){if(K(e))return!1;var i=typeof e;return i=="number"||i=="symbol"||i=="boolean"||e==null||lt(e)?!0:rm.test(e)||!nm.test(e)||t!=null&&e in fe(t)}function ud(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function $l(e){var t=Qr(e),i=c[t];if(typeof i!="function"||!(t in te.prototype))return!1;if(e===i)return!0;var r=Nl(i);return!!r&&e===r[0]}function cd(e){return!!ea&&ea in e}var md=Ir?ai:ns;function nr(e){var t=e&&e.constructor,i=typeof t=="function"&&t.prototype||an;return e===i}function eu(e){return e===e&&!he(e)}function tu(e,t){return function(i){return i==null?!1:i[e]===t&&(t!==l||e in fe(i))}}function fd(e){var t=io(e,function(r){return i.size===A&&i.clear(),r}),i=t.cache;return t}function pd(e,t){var i=e[1],r=t[1],a=i|r,m=a<(Ve|Et|ei),p=r==ei&&i==Rt||r==ei&&i==Fn&&e[7].length<=t[8]||r==(ei|Fn)&&t[7].length<=t[8]&&i==Rt;if(!(m||p))return e;r&Ve&&(e[2]=t[2],a|=i&Ve?0:cs);var d=t[3];if(d){var b=e[3];e[3]=b?Fa(b,d,t[4]):d,e[4]=b?_i(e[3],E):t[4]}return d=t[5],d&&(b=e[5],e[5]=b?qa(b,d,t[6]):d,e[6]=b?_i(e[5],E):t[6]),d=t[7],d&&(e[7]=d),r&ei&&(e[8]=e[8]==null?t[8]:qe(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=a,e}function dd(e){var t=[];if(e!=null)for(var i in fe(e))t.push(i);return t}function gd(e){return Br.call(e)}function iu(e,t,i){return t=Le(t===l?e.length-1:t,0),function(){for(var r=arguments,a=-1,m=Le(r.length-t,0),p=C(m);++a<m;)p[a]=r[t+a];a=-1;for(var d=C(t+1);++a<t;)d[a]=r[a];return d[t]=i(p),nt(e,this,d)}}function nu(e,t){return t.length<2?e:Vi(e,dt(t,0,-1))}function bd(e,t){for(var i=e.length,r=qe(t.length,i),a=Ke(e);r--;){var m=t[r];e[r]=si(m,i)?a[m]:l}return e}function Hl(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var ru=lu(wa),rr=Rf||function(e,t){return Ue.setTimeout(e,t)},Wl=lu(Pp);function ou(e,t,i){var r=t+"";return Wl(e,sd(r,hd(rd(r),i)))}function lu(e){var t=0,i=0;return function(){var r=Uf(),a=Fc-(r-i);if(i=r,a>0){if(++t>=Nc)return arguments[0]}else t=0;return e.apply(l,arguments)}}function Xr(e,t){var i=-1,r=e.length,a=r-1;for(t=t===l?r:t;++i<t;){var m=yl(i,a),p=e[m];e[m]=e[i],e[i]=p}return e.length=t,e}var su=fd(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(om,function(i,r,a,m){t.push(a?m.replace(pm,"$1"):r||i)}),t});function Nt(e){if(typeof e=="string"||lt(e))return e;var t=e+"";return t=="0"&&1/e==-Fi?"-0":t}function ki(e){if(e!=null){try{return wr.call(e)}catch{}try{return e+""}catch{}}return""}function hd(e,t){return ct(Vc,function(i){var r="_."+i[0];t&i[1]&&!Cr(e,r)&&e.push(r)}),e.sort()}function au(e){if(e instanceof te)return e.clone();var t=new ft(e.__wrapped__,e.__chain__);return t.__actions__=Ke(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function _d(e,t,i){(i?ke(e,t,i):t===l)?t=1:t=Le(Q(t),0);var r=e==null?0:e.length;if(!r||t<1)return[];for(var a=0,m=0,p=C(Lr(r/t));a<r;)p[m++]=dt(e,a,a+=t);return p}function vd(e){for(var t=-1,i=e==null?0:e.length,r=0,a=[];++t<i;){var m=e[t];m&&(a[r++]=m)}return a}function Td(){var e=arguments.length;if(!e)return[];for(var t=C(e-1),i=arguments[0],r=e;r--;)t[r-1]=arguments[r];return hi(K(i)?Ke(i):[i],Fe(t,1))}var xd=X(function(e,t){return ye(e)?Xn(e,Fe(t,1,ye,!0)):[]}),Cd=X(function(e,t){var i=gt(t);return ye(i)&&(i=l),ye(e)?Xn(e,Fe(t,1,ye,!0),H(i,2)):[]}),Sd=X(function(e,t){var i=gt(t);return ye(i)&&(i=l),ye(e)?Xn(e,Fe(t,1,ye,!0),l,i):[]});function yd(e,t,i){var r=e==null?0:e.length;return r?(t=i||t===l?1:Q(t),dt(e,t<0?0:t,r)):[]}function Md(e,t,i){var r=e==null?0:e.length;return r?(t=i||t===l?1:Q(t),t=r-t,dt(e,0,t<0?0:t)):[]}function Id(e,t){return e&&e.length?Gr(e,H(t,3),!0,!0):[]}function wd(e,t){return e&&e.length?Gr(e,H(t,3),!0):[]}function Bd(e,t,i,r){var a=e==null?0:e.length;return a?(i&&typeof i!="number"&&ke(e,t,i)&&(i=0,r=a),Tp(e,t,i,r)):[]}function uu(e,t,i){var r=e==null?0:e.length;if(!r)return-1;var a=i==null?0:Q(i);return a<0&&(a=Le(r+a,0)),Sr(e,H(t,3),a)}function cu(e,t,i){var r=e==null?0:e.length;if(!r)return-1;var a=r-1;return i!==l&&(a=Q(i),a=i<0?Le(r+a,0):qe(a,r-1)),Sr(e,H(t,3),a,!0)}function mu(e){var t=e==null?0:e.length;return t?Fe(e,1):[]}function Ad(e){var t=e==null?0:e.length;return t?Fe(e,Fi):[]}function Ed(e,t){var i=e==null?0:e.length;return i?(t=t===l?1:Q(t),Fe(e,t)):[]}function Rd(e){for(var t=-1,i=e==null?0:e.length,r={};++t<i;){var a=e[t];r[a[0]]=a[1]}return r}function fu(e){return e&&e.length?e[0]:l}function Dd(e,t,i){var r=e==null?0:e.length;if(!r)return-1;var a=i==null?0:Q(i);return a<0&&(a=Le(r+a,0)),on(e,t,a)}function Od(e){var t=e==null?0:e.length;return t?dt(e,0,-1):[]}var Ld=X(function(e){var t=ge(e,Al);return t.length&&t[0]===e[0]?vl(t):[]}),Ud=X(function(e){var t=gt(e),i=ge(e,Al);return t===gt(i)?t=l:i.pop(),i.length&&i[0]===e[0]?vl(i,H(t,2)):[]}),Nd=X(function(e){var t=gt(e),i=ge(e,Al);return t=typeof t=="function"?t:l,t&&i.pop(),i.length&&i[0]===e[0]?vl(i,l,t):[]});function Fd(e,t){return e==null?"":Of.call(e,t)}function gt(e){var t=e==null?0:e.length;return t?e[t-1]:l}function qd(e,t,i){var r=e==null?0:e.length;if(!r)return-1;var a=r;return i!==l&&(a=Q(i),a=a<0?Le(r+a,0):qe(a,r-1)),t===t?hf(e,t,a):Sr(e,js,a,!0)}function Pd(e,t){return e&&e.length?Sa(e,Q(t)):l}var $d=X(pu);function pu(e,t){return e&&e.length&&t&&t.length?Sl(e,t):e}function Hd(e,t,i){return e&&e.length&&t&&t.length?Sl(e,t,H(i,2)):e}function Wd(e,t,i){return e&&e.length&&t&&t.length?Sl(e,t,l,i):e}var Vd=li(function(e,t){var i=e==null?0:e.length,r=gl(e,t);return Ia(e,ge(t,function(a){return si(a,i)?+a:a}).sort(Na)),r});function Gd(e,t){var i=[];if(!(e&&e.length))return i;var r=-1,a=[],m=e.length;for(t=H(t,3);++r<m;){var p=e[r];t(p,r,e)&&(i.push(p),a.push(r))}return Ia(e,a),i}function Vl(e){return e==null?e:Ff.call(e)}function kd(e,t,i){var r=e==null?0:e.length;return r?(i&&typeof i!="number"&&ke(e,t,i)?(t=0,i=r):(t=t==null?0:Q(t),i=i===l?r:Q(i)),dt(e,t,i)):[]}function jd(e,t){return Vr(e,t)}function zd(e,t,i){return Il(e,t,H(i,2))}function Yd(e,t){var i=e==null?0:e.length;if(i){var r=Vr(e,t);if(r<i&&Bt(e[r],t))return r}return-1}function Kd(e,t){return Vr(e,t,!0)}function Qd(e,t,i){return Il(e,t,H(i,2),!0)}function Zd(e,t){var i=e==null?0:e.length;if(i){var r=Vr(e,t,!0)-1;if(Bt(e[r],t))return r}return-1}function Xd(e){return e&&e.length?Ba(e):[]}function Jd(e,t){return e&&e.length?Ba(e,H(t,2)):[]}function e0(e){var t=e==null?0:e.length;return t?dt(e,1,t):[]}function t0(e,t,i){return e&&e.length?(t=i||t===l?1:Q(t),dt(e,0,t<0?0:t)):[]}function i0(e,t,i){var r=e==null?0:e.length;return r?(t=i||t===l?1:Q(t),t=r-t,dt(e,t<0?0:t,r)):[]}function n0(e,t){return e&&e.length?Gr(e,H(t,3),!1,!0):[]}function r0(e,t){return e&&e.length?Gr(e,H(t,3)):[]}var o0=X(function(e){return Ci(Fe(e,1,ye,!0))}),l0=X(function(e){var t=gt(e);return ye(t)&&(t=l),Ci(Fe(e,1,ye,!0),H(t,2))}),s0=X(function(e){var t=gt(e);return t=typeof t=="function"?t:l,Ci(Fe(e,1,ye,!0),l,t)});function a0(e){return e&&e.length?Ci(e):[]}function u0(e,t){return e&&e.length?Ci(e,H(t,2)):[]}function c0(e,t){return t=typeof t=="function"?t:l,e&&e.length?Ci(e,l,t):[]}function Gl(e){if(!(e&&e.length))return[];var t=0;return e=bi(e,function(i){if(ye(i))return t=Le(i.length,t),!0}),sl(t,function(i){return ge(e,rl(i))})}function du(e,t){if(!(e&&e.length))return[];var i=Gl(e);return t==null?i:ge(i,function(r){return nt(t,l,r)})}var m0=X(function(e,t){return ye(e)?Xn(e,t):[]}),f0=X(function(e){return Bl(bi(e,ye))}),p0=X(function(e){var t=gt(e);return ye(t)&&(t=l),Bl(bi(e,ye),H(t,2))}),d0=X(function(e){var t=gt(e);return t=typeof t=="function"?t:l,Bl(bi(e,ye),l,t)}),g0=X(Gl);function b0(e,t){return Da(e||[],t||[],Zn)}function h0(e,t){return Da(e||[],t||[],tr)}var _0=X(function(e){var t=e.length,i=t>1?e[t-1]:l;return i=typeof i=="function"?(e.pop(),i):l,du(e,i)});function gu(e){var t=c(e);return t.__chain__=!0,t}function v0(e,t){return t(e),e}function Jr(e,t){return t(e)}var T0=li(function(e){var t=e.length,i=t?e[0]:0,r=this.__wrapped__,a=function(m){return gl(m,e)};return t>1||this.__actions__.length||!(r instanceof te)||!si(i)?this.thru(a):(r=r.slice(i,+i+(t?1:0)),r.__actions__.push({func:Jr,args:[a],thisArg:l}),new ft(r,this.__chain__).thru(function(m){return t&&!m.length&&m.push(l),m}))});function x0(){return gu(this)}function C0(){return new ft(this.value(),this.__chain__)}function S0(){this.__values__===l&&(this.__values__=Au(this.value()));var e=this.__index__>=this.__values__.length,t=e?l:this.__values__[this.__index__++];return{done:e,value:t}}function y0(){return this}function M0(e){for(var t,i=this;i instanceof qr;){var r=au(i);r.__index__=0,r.__values__=l,t?a.__wrapped__=r:t=r;var a=r;i=i.__wrapped__}return a.__wrapped__=e,t}function I0(){var e=this.__wrapped__;if(e instanceof te){var t=e;return this.__actions__.length&&(t=new te(this)),t=t.reverse(),t.__actions__.push({func:Jr,args:[Vl],thisArg:l}),new ft(t,this.__chain__)}return this.thru(Vl)}function w0(){return Ra(this.__wrapped__,this.__actions__)}var B0=kr(function(e,t,i){ce.call(e,i)?++e[i]:ri(e,i,1)});function A0(e,t,i){var r=K(e)?Gs:vp;return i&&ke(e,t,i)&&(t=l),r(e,H(t,3))}function E0(e,t){var i=K(e)?bi:da;return i(e,H(t,3))}var R0=Wa(uu),D0=Wa(cu);function O0(e,t){return Fe(eo(e,t),1)}function L0(e,t){return Fe(eo(e,t),Fi)}function U0(e,t,i){return i=i===l?1:Q(i),Fe(eo(e,t),i)}function bu(e,t){var i=K(e)?ct:xi;return i(e,H(t,3))}function hu(e,t){var i=K(e)?Jm:pa;return i(e,H(t,3))}var N0=kr(function(e,t,i){ce.call(e,i)?e[i].push(t):ri(e,i,[t])});function F0(e,t,i,r){e=Qe(e)?e:bn(e),i=i&&!r?Q(i):0;var a=e.length;return i<0&&(i=Le(a+i,0)),oo(e)?i<=a&&e.indexOf(t,i)>-1:!!a&&on(e,t,i)>-1}var q0=X(function(e,t,i){var r=-1,a=typeof t=="function",m=Qe(e)?C(e.length):[];return xi(e,function(p){m[++r]=a?nt(t,p,i):Jn(p,t,i)}),m}),P0=kr(function(e,t,i){ri(e,i,t)});function eo(e,t){var i=K(e)?ge:Ta;return i(e,H(t,3))}function $0(e,t,i,r){return e==null?[]:(K(t)||(t=t==null?[]:[t]),i=r?l:i,K(i)||(i=i==null?[]:[i]),ya(e,t,i))}var H0=kr(function(e,t,i){e[i?0:1].push(t)},function(){return[[],[]]});function W0(e,t,i){var r=K(e)?il:Ys,a=arguments.length<3;return r(e,H(t,4),i,a,xi)}function V0(e,t,i){var r=K(e)?ef:Ys,a=arguments.length<3;return r(e,H(t,4),i,a,pa)}function G0(e,t){var i=K(e)?bi:da;return i(e,no(H(t,3)))}function k0(e){var t=K(e)?ua:Fp;return t(e)}function j0(e,t,i){(i?ke(e,t,i):t===l)?t=1:t=Q(t);var r=K(e)?dp:qp;return r(e,t)}function z0(e){var t=K(e)?gp:$p;return t(e)}function Y0(e){if(e==null)return 0;if(Qe(e))return oo(e)?sn(e):e.length;var t=Pe(e);return t==yt||t==Mt?e.size:xl(e).length}function K0(e,t,i){var r=K(e)?nl:Hp;return i&&ke(e,t,i)&&(t=l),r(e,H(t,3))}var Q0=X(function(e,t){if(e==null)return[];var i=t.length;return i>1&&ke(e,t[0],t[1])?t=[]:i>2&&ke(t[0],t[1],t[2])&&(t=[t[0]]),ya(e,Fe(t,1),[])}),to=Ef||function(){return Ue.Date.now()};function Z0(e,t){if(typeof t!="function")throw new mt(u);return e=Q(e),function(){if(--e<1)return t.apply(this,arguments)}}function _u(e,t,i){return t=i?l:t,t=e&&t==null?e.length:t,oi(e,ei,l,l,l,l,t)}function vu(e,t){var i;if(typeof t!="function")throw new mt(u);return e=Q(e),function(){return--e>0&&(i=t.apply(this,arguments)),e<=1&&(t=l),i}}var kl=X(function(e,t,i){var r=Ve;if(i.length){var a=_i(i,dn(kl));r|=Dt}return oi(e,r,t,i,a)}),Tu=X(function(e,t,i){var r=Ve|Et;if(i.length){var a=_i(i,dn(Tu));r|=Dt}return oi(t,r,e,i,a)});function xu(e,t,i){t=i?l:t;var r=oi(e,Rt,l,l,l,l,l,t);return r.placeholder=xu.placeholder,r}function Cu(e,t,i){t=i?l:t;var r=oi(e,Ji,l,l,l,l,l,t);return r.placeholder=Cu.placeholder,r}function Su(e,t,i){var r,a,m,p,d,b,I=0,w=!1,B=!1,D=!0;if(typeof e!="function")throw new mt(u);t=bt(t)||0,he(i)&&(w=!!i.leading,B="maxWait"in i,m=B?Le(bt(i.maxWait)||0,t):m,D="trailing"in i?!!i.trailing:D);function $(Me){var At=r,ci=a;return r=a=l,I=Me,p=e.apply(ci,At),p}function V(Me){return I=Me,d=rr(ee,t),w?$(Me):p}function Z(Me){var At=Me-b,ci=Me-I,Wu=t-At;return B?qe(Wu,m-ci):Wu}function G(Me){var At=Me-b,ci=Me-I;return b===l||At>=t||At<0||B&&ci>=m}function ee(){var Me=to();if(G(Me))return ie(Me);d=rr(ee,Z(Me))}function ie(Me){return d=l,D&&r?$(Me):(r=a=l,p)}function st(){d!==l&&Oa(d),I=0,r=b=a=d=l}function je(){return d===l?p:ie(to())}function at(){var Me=to(),At=G(Me);if(r=arguments,a=this,b=Me,At){if(d===l)return V(b);if(B)return Oa(d),d=rr(ee,t),$(b)}return d===l&&(d=rr(ee,t)),p}return at.cancel=st,at.flush=je,at}var X0=X(function(e,t){return fa(e,1,t)}),J0=X(function(e,t,i){return fa(e,bt(t)||0,i)});function eg(e){return oi(e,No)}function io(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new mt(u);var i=function(){var r=arguments,a=t?t.apply(this,r):r[0],m=i.cache;if(m.has(a))return m.get(a);var p=e.apply(this,r);return i.cache=m.set(a,p)||m,p};return i.cache=new(io.Cache||ni),i}io.Cache=ni;function no(e){if(typeof e!="function")throw new mt(u);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function tg(e){return vu(2,e)}var ig=Wp(function(e,t){t=t.length==1&&K(t[0])?ge(t[0],rt(H())):ge(Fe(t,1),rt(H()));var i=t.length;return X(function(r){for(var a=-1,m=qe(r.length,i);++a<m;)r[a]=t[a].call(this,r[a]);return nt(e,this,r)})}),jl=X(function(e,t){var i=_i(t,dn(jl));return oi(e,Dt,l,t,i)}),yu=X(function(e,t){var i=_i(t,dn(yu));return oi(e,en,l,t,i)}),ng=li(function(e,t){return oi(e,Fn,l,l,l,t)});function rg(e,t){if(typeof e!="function")throw new mt(u);return t=t===l?t:Q(t),X(e,t)}function og(e,t){if(typeof e!="function")throw new mt(u);return t=t==null?0:Le(Q(t),0),X(function(i){var r=i[t],a=yi(i,0,t);return r&&hi(a,r),nt(e,this,a)})}function lg(e,t,i){var r=!0,a=!0;if(typeof e!="function")throw new mt(u);return he(i)&&(r="leading"in i?!!i.leading:r,a="trailing"in i?!!i.trailing:a),Su(e,t,{leading:r,maxWait:t,trailing:a})}function sg(e){return _u(e,1)}function ag(e,t){return jl(El(t),e)}function ug(){if(!arguments.length)return[];var e=arguments[0];return K(e)?e:[e]}function cg(e){return pt(e,ae)}function mg(e,t){return t=typeof t=="function"?t:l,pt(e,ae,t)}function fg(e){return pt(e,J|ae)}function pg(e,t){return t=typeof t=="function"?t:l,pt(e,J|ae,t)}function dg(e,t){return t==null||ma(e,t,Ne(t))}function Bt(e,t){return e===t||e!==e&&t!==t}var gg=Kr(_l),bg=Kr(function(e,t){return e>=t}),ji=ha(function(){return arguments}())?ha:function(e){return ve(e)&&ce.call(e,"callee")&&!na.call(e,"callee")},K=C.isArray,hg=qs?rt(qs):Mp;function Qe(e){return e!=null&&ro(e.length)&&!ai(e)}function ye(e){return ve(e)&&Qe(e)}function _g(e){return e===!0||e===!1||ve(e)&&Ge(e)==qn}var Mi=Df||ns,vg=Ps?rt(Ps):Ip;function Tg(e){return ve(e)&&e.nodeType===1&&!or(e)}function xg(e){if(e==null)return!0;if(Qe(e)&&(K(e)||typeof e=="string"||typeof e.splice=="function"||Mi(e)||gn(e)||ji(e)))return!e.length;var t=Pe(e);if(t==yt||t==Mt)return!e.size;if(nr(e))return!xl(e).length;for(var i in e)if(ce.call(e,i))return!1;return!0}function Cg(e,t){return er(e,t)}function Sg(e,t,i){i=typeof i=="function"?i:l;var r=i?i(e,t):l;return r===l?er(e,t,l,i):!!r}function zl(e){if(!ve(e))return!1;var t=Ge(e);return t==br||t==kc||typeof e.message=="string"&&typeof e.name=="string"&&!or(e)}function yg(e){return typeof e=="number"&&oa(e)}function ai(e){if(!he(e))return!1;var t=Ge(e);return t==hr||t==fs||t==Gc||t==zc}function Mu(e){return typeof e=="number"&&e==Q(e)}function ro(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=gi}function he(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function ve(e){return e!=null&&typeof e=="object"}var Iu=$s?rt($s):Bp;function Mg(e,t){return e===t||Tl(e,t,Fl(t))}function Ig(e,t,i){return i=typeof i=="function"?i:l,Tl(e,t,Fl(t),i)}function wg(e){return wu(e)&&e!=+e}function Bg(e){if(md(e))throw new z(s);return _a(e)}function Ag(e){return e===null}function Eg(e){return e==null}function wu(e){return typeof e=="number"||ve(e)&&Ge(e)==$n}function or(e){if(!ve(e)||Ge(e)!=ti)return!1;var t=Rr(e);if(t===null)return!0;var i=ce.call(t,"constructor")&&t.constructor;return typeof i=="function"&&i instanceof i&&wr.call(i)==If}var Yl=Hs?rt(Hs):Ap;function Rg(e){return Mu(e)&&e>=-gi&&e<=gi}var Bu=Ws?rt(Ws):Ep;function oo(e){return typeof e=="string"||!K(e)&&ve(e)&&Ge(e)==Wn}function lt(e){return typeof e=="symbol"||ve(e)&&Ge(e)==_r}var gn=Vs?rt(Vs):Rp;function Dg(e){return e===l}function Og(e){return ve(e)&&Pe(e)==Vn}function Lg(e){return ve(e)&&Ge(e)==Kc}var Ug=Kr(Cl),Ng=Kr(function(e,t){return e<=t});function Au(e){if(!e)return[];if(Qe(e))return oo(e)?It(e):Ke(e);if(jn&&e[jn])return df(e[jn]());var t=Pe(e),i=t==yt?ul:t==Mt?yr:bn;return i(e)}function ui(e){if(!e)return e===0?e:0;if(e=bt(e),e===Fi||e===-Fi){var t=e<0?-1:1;return t*$c}return e===e?e:0}function Q(e){var t=ui(e),i=t%1;return t===t?i?t-i:t:0}function Eu(e){return e?Wi(Q(e),0,Ot):0}function bt(e){if(typeof e=="number")return e;if(lt(e))return dr;if(he(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=he(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Ks(e);var i=bm.test(e);return i||_m.test(e)?Qm(e.slice(2),i?2:8):gm.test(e)?dr:+e}function Ru(e){return Ut(e,Ze(e))}function Fg(e){return e?Wi(Q(e),-gi,gi):e===0?e:0}function ue(e){return e==null?"":ot(e)}var qg=fn(function(e,t){if(nr(t)||Qe(t)){Ut(t,Ne(t),e);return}for(var i in t)ce.call(t,i)&&Zn(e,i,t[i])}),Du=fn(function(e,t){Ut(t,Ze(t),e)}),lo=fn(function(e,t,i,r){Ut(t,Ze(t),e,r)}),Pg=fn(function(e,t,i,r){Ut(t,Ne(t),e,r)}),$g=li(gl);function Hg(e,t){var i=mn(e);return t==null?i:ca(i,t)}var Wg=X(function(e,t){e=fe(e);var i=-1,r=t.length,a=r>2?t[2]:l;for(a&&ke(t[0],t[1],a)&&(r=1);++i<r;)for(var m=t[i],p=Ze(m),d=-1,b=p.length;++d<b;){var I=p[d],w=e[I];(w===l||Bt(w,an[I])&&!ce.call(e,I))&&(e[I]=m[I])}return e}),Vg=X(function(e){return e.push(l,Ka),nt(Ou,l,e)});function Gg(e,t){return ks(e,H(t,3),Lt)}function kg(e,t){return ks(e,H(t,3),hl)}function jg(e,t){return e==null?e:bl(e,H(t,3),Ze)}function zg(e,t){return e==null?e:ga(e,H(t,3),Ze)}function Yg(e,t){return e&&Lt(e,H(t,3))}function Kg(e,t){return e&&hl(e,H(t,3))}function Qg(e){return e==null?[]:Hr(e,Ne(e))}function Zg(e){return e==null?[]:Hr(e,Ze(e))}function Kl(e,t,i){var r=e==null?l:Vi(e,t);return r===l?i:r}function Xg(e,t){return e!=null&&Xa(e,t,xp)}function Ql(e,t){return e!=null&&Xa(e,t,Cp)}var Jg=Ga(function(e,t,i){t!=null&&typeof t.toString!="function"&&(t=Br.call(t)),e[t]=i},Xl(Xe)),eb=Ga(function(e,t,i){t!=null&&typeof t.toString!="function"&&(t=Br.call(t)),ce.call(e,t)?e[t].push(i):e[t]=[i]},H),tb=X(Jn);function Ne(e){return Qe(e)?aa(e):xl(e)}function Ze(e){return Qe(e)?aa(e,!0):Dp(e)}function ib(e,t){var i={};return t=H(t,3),Lt(e,function(r,a,m){ri(i,t(r,a,m),r)}),i}function nb(e,t){var i={};return t=H(t,3),Lt(e,function(r,a,m){ri(i,a,t(r,a,m))}),i}var rb=fn(function(e,t,i){Wr(e,t,i)}),Ou=fn(function(e,t,i,r){Wr(e,t,i,r)}),ob=li(function(e,t){var i={};if(e==null)return i;var r=!1;t=ge(t,function(m){return m=Si(m,e),r||(r=m.length>1),m}),Ut(e,Ul(e),i),r&&(i=pt(i,J|oe|ae,Jp));for(var a=t.length;a--;)wl(i,t[a]);return i});function lb(e,t){return Lu(e,no(H(t)))}var sb=li(function(e,t){return e==null?{}:Lp(e,t)});function Lu(e,t){if(e==null)return{};var i=ge(Ul(e),function(r){return[r]});return t=H(t),Ma(e,i,function(r,a){return t(r,a[0])})}function ab(e,t,i){t=Si(t,e);var r=-1,a=t.length;for(a||(a=1,e=l);++r<a;){var m=e==null?l:e[Nt(t[r])];m===l&&(r=a,m=i),e=ai(m)?m.call(e):m}return e}function ub(e,t,i){return e==null?e:tr(e,t,i)}function cb(e,t,i,r){return r=typeof r=="function"?r:l,e==null?e:tr(e,t,i,r)}var Uu=za(Ne),Nu=za(Ze);function mb(e,t,i){var r=K(e),a=r||Mi(e)||gn(e);if(t=H(t,4),i==null){var m=e&&e.constructor;a?i=r?new m:[]:he(e)?i=ai(m)?mn(Rr(e)):{}:i={}}return(a?ct:Lt)(e,function(p,d,b){return t(i,p,d,b)}),i}function fb(e,t){return e==null?!0:wl(e,t)}function pb(e,t,i){return e==null?e:Ea(e,t,El(i))}function db(e,t,i,r){return r=typeof r=="function"?r:l,e==null?e:Ea(e,t,El(i),r)}function bn(e){return e==null?[]:al(e,Ne(e))}function gb(e){return e==null?[]:al(e,Ze(e))}function bb(e,t,i){return i===l&&(i=t,t=l),i!==l&&(i=bt(i),i=i===i?i:0),t!==l&&(t=bt(t),t=t===t?t:0),Wi(bt(e),t,i)}function hb(e,t,i){return t=ui(t),i===l?(i=t,t=0):i=ui(i),e=bt(e),Sp(e,t,i)}function _b(e,t,i){if(i&&typeof i!="boolean"&&ke(e,t,i)&&(t=i=l),i===l&&(typeof t=="boolean"?(i=t,t=l):typeof e=="boolean"&&(i=e,e=l)),e===l&&t===l?(e=0,t=1):(e=ui(e),t===l?(t=e,e=0):t=ui(t)),e>t){var r=e;e=t,t=r}if(i||e%1||t%1){var a=la();return qe(e+a*(t-e+Km("1e-"+((a+"").length-1))),t)}return yl(e,t)}var vb=pn(function(e,t,i){return t=t.toLowerCase(),e+(i?Fu(t):t)});function Fu(e){return Zl(ue(e).toLowerCase())}function qu(e){return e=ue(e),e&&e.replace(Tm,uf).replace(Pm,"")}function Tb(e,t,i){e=ue(e),t=ot(t);var r=e.length;i=i===l?r:Wi(Q(i),0,r);var a=i;return i-=t.length,i>=0&&e.slice(i,a)==t}function xb(e){return e=ue(e),e&&em.test(e)?e.replace(gs,cf):e}function Cb(e){return e=ue(e),e&&lm.test(e)?e.replace(jo,"\\$&"):e}var Sb=pn(function(e,t,i){return e+(i?"-":"")+t.toLowerCase()}),yb=pn(function(e,t,i){return e+(i?" ":"")+t.toLowerCase()}),Mb=Ha("toLowerCase");function Ib(e,t,i){e=ue(e),t=Q(t);var r=t?sn(e):0;if(!t||r>=t)return e;var a=(t-r)/2;return Yr(Ur(a),i)+e+Yr(Lr(a),i)}function wb(e,t,i){e=ue(e),t=Q(t);var r=t?sn(e):0;return t&&r<t?e+Yr(t-r,i):e}function Bb(e,t,i){e=ue(e),t=Q(t);var r=t?sn(e):0;return t&&r<t?Yr(t-r,i)+e:e}function Ab(e,t,i){return i||t==null?t=0:t&&(t=+t),Nf(ue(e).replace(zo,""),t||0)}function Eb(e,t,i){return(i?ke(e,t,i):t===l)?t=1:t=Q(t),Ml(ue(e),t)}function Rb(){var e=arguments,t=ue(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var Db=pn(function(e,t,i){return e+(i?"_":"")+t.toLowerCase()});function Ob(e,t,i){return i&&typeof i!="number"&&ke(e,t,i)&&(t=i=l),i=i===l?Ot:i>>>0,i?(e=ue(e),e&&(typeof t=="string"||t!=null&&!Yl(t))&&(t=ot(t),!t&&ln(e))?yi(It(e),0,i):e.split(t,i)):[]}var Lb=pn(function(e,t,i){return e+(i?" ":"")+Zl(t)});function Ub(e,t,i){return e=ue(e),i=i==null?0:Wi(Q(i),0,e.length),t=ot(t),e.slice(i,i+t.length)==t}function Nb(e,t,i){var r=c.templateSettings;i&&ke(e,t,i)&&(t=l),e=ue(e),t=lo({},t,r,Ya);var a=lo({},t.imports,r.imports,Ya),m=Ne(a),p=al(a,m),d,b,I=0,w=t.interpolate||vr,B="__p += '",D=cl((t.escape||vr).source+"|"+w.source+"|"+(w===bs?dm:vr).source+"|"+(t.evaluate||vr).source+"|$","g"),$="//# sourceURL="+(ce.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Gm+"]")+`
`;e.replace(D,function(G,ee,ie,st,je,at){return ie||(ie=st),B+=e.slice(I,at).replace(xm,mf),ee&&(d=!0,B+=`' +
__e(`+ee+`) +
'`),je&&(b=!0,B+=`';
`+je+`;
__p += '`),ie&&(B+=`' +
((__t = (`+ie+`)) == null ? '' : __t) +
'`),I=at+G.length,G}),B+=`';
`;var V=ce.call(t,"variable")&&t.variable;if(!V)B=`with (obj) {
`+B+`
}
`;else if(fm.test(V))throw new z(f);B=(b?B.replace(Qc,""):B).replace(Zc,"$1").replace(Xc,"$1;"),B="function("+(V||"obj")+`) {
`+(V?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(d?", __e = _.escape":"")+(b?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+B+`return __p
}`;var Z=$u(function(){return le(m,$+"return "+B).apply(l,p)});if(Z.source=B,zl(Z))throw Z;return Z}function Fb(e){return ue(e).toLowerCase()}function qb(e){return ue(e).toUpperCase()}function Pb(e,t,i){if(e=ue(e),e&&(i||t===l))return Ks(e);if(!e||!(t=ot(t)))return e;var r=It(e),a=It(t),m=Qs(r,a),p=Zs(r,a)+1;return yi(r,m,p).join("")}function $b(e,t,i){if(e=ue(e),e&&(i||t===l))return e.slice(0,Js(e)+1);if(!e||!(t=ot(t)))return e;var r=It(e),a=Zs(r,It(t))+1;return yi(r,0,a).join("")}function Hb(e,t,i){if(e=ue(e),e&&(i||t===l))return e.replace(zo,"");if(!e||!(t=ot(t)))return e;var r=It(e),a=Qs(r,It(t));return yi(r,a).join("")}function Wb(e,t){var i=Lc,r=Uc;if(he(t)){var a="separator"in t?t.separator:a;i="length"in t?Q(t.length):i,r="omission"in t?ot(t.omission):r}e=ue(e);var m=e.length;if(ln(e)){var p=It(e);m=p.length}if(i>=m)return e;var d=i-sn(r);if(d<1)return r;var b=p?yi(p,0,d).join(""):e.slice(0,d);if(a===l)return b+r;if(p&&(d+=b.length-d),Yl(a)){if(e.slice(d).search(a)){var I,w=b;for(a.global||(a=cl(a.source,ue(hs.exec(a))+"g")),a.lastIndex=0;I=a.exec(w);)var B=I.index;b=b.slice(0,B===l?d:B)}}else if(e.indexOf(ot(a),d)!=d){var D=b.lastIndexOf(a);D>-1&&(b=b.slice(0,D))}return b+r}function Vb(e){return e=ue(e),e&&Jc.test(e)?e.replace(ds,_f):e}var Gb=pn(function(e,t,i){return e+(i?" ":"")+t.toUpperCase()}),Zl=Ha("toUpperCase");function Pu(e,t,i){return e=ue(e),t=i?l:t,t===l?pf(e)?xf(e):rf(e):e.match(t)||[]}var $u=X(function(e,t){try{return nt(e,l,t)}catch(i){return zl(i)?i:new z(i)}}),kb=li(function(e,t){return ct(t,function(i){i=Nt(i),ri(e,i,kl(e[i],e))}),e});function jb(e){var t=e==null?0:e.length,i=H();return e=t?ge(e,function(r){if(typeof r[1]!="function")throw new mt(u);return[i(r[0]),r[1]]}):[],X(function(r){for(var a=-1;++a<t;){var m=e[a];if(nt(m[0],this,r))return nt(m[1],this,r)}})}function zb(e){return _p(pt(e,J))}function Xl(e){return function(){return e}}function Yb(e,t){return e==null||e!==e?t:e}var Kb=Va(),Qb=Va(!0);function Xe(e){return e}function Jl(e){return va(typeof e=="function"?e:pt(e,J))}function Zb(e){return xa(pt(e,J))}function Xb(e,t){return Ca(e,pt(t,J))}var Jb=X(function(e,t){return function(i){return Jn(i,e,t)}}),eh=X(function(e,t){return function(i){return Jn(e,i,t)}});function es(e,t,i){var r=Ne(t),a=Hr(t,r);i==null&&!(he(t)&&(a.length||!r.length))&&(i=t,t=e,e=this,a=Hr(t,Ne(t)));var m=!(he(i)&&"chain"in i)||!!i.chain,p=ai(e);return ct(a,function(d){var b=t[d];e[d]=b,p&&(e.prototype[d]=function(){var I=this.__chain__;if(m||I){var w=e(this.__wrapped__),B=w.__actions__=Ke(this.__actions__);return B.push({func:b,args:arguments,thisArg:e}),w.__chain__=I,w}return b.apply(e,hi([this.value()],arguments))})}),e}function th(){return Ue._===this&&(Ue._=wf),this}function ts(){}function ih(e){return e=Q(e),X(function(t){return Sa(t,e)})}var nh=Dl(ge),rh=Dl(Gs),oh=Dl(nl);function Hu(e){return Pl(e)?rl(Nt(e)):Up(e)}function lh(e){return function(t){return e==null?l:Vi(e,t)}}var sh=ka(),ah=ka(!0);function is(){return[]}function ns(){return!1}function uh(){return{}}function ch(){return""}function mh(){return!0}function fh(e,t){if(e=Q(e),e<1||e>gi)return[];var i=Ot,r=qe(e,Ot);t=H(t),e-=Ot;for(var a=sl(r,t);++i<e;)t(i);return a}function ph(e){return K(e)?ge(e,Nt):lt(e)?[e]:Ke(su(ue(e)))}function dh(e){var t=++Mf;return ue(e)+t}var gh=zr(function(e,t){return e+t},0),bh=Ol("ceil"),hh=zr(function(e,t){return e/t},1),_h=Ol("floor");function vh(e){return e&&e.length?$r(e,Xe,_l):l}function Th(e,t){return e&&e.length?$r(e,H(t,2),_l):l}function xh(e){return zs(e,Xe)}function Ch(e,t){return zs(e,H(t,2))}function Sh(e){return e&&e.length?$r(e,Xe,Cl):l}function yh(e,t){return e&&e.length?$r(e,H(t,2),Cl):l}var Mh=zr(function(e,t){return e*t},1),Ih=Ol("round"),wh=zr(function(e,t){return e-t},0);function Bh(e){return e&&e.length?ll(e,Xe):0}function Ah(e,t){return e&&e.length?ll(e,H(t,2)):0}return c.after=Z0,c.ary=_u,c.assign=qg,c.assignIn=Du,c.assignInWith=lo,c.assignWith=Pg,c.at=$g,c.before=vu,c.bind=kl,c.bindAll=kb,c.bindKey=Tu,c.castArray=ug,c.chain=gu,c.chunk=_d,c.compact=vd,c.concat=Td,c.cond=jb,c.conforms=zb,c.constant=Xl,c.countBy=B0,c.create=Hg,c.curry=xu,c.curryRight=Cu,c.debounce=Su,c.defaults=Wg,c.defaultsDeep=Vg,c.defer=X0,c.delay=J0,c.difference=xd,c.differenceBy=Cd,c.differenceWith=Sd,c.drop=yd,c.dropRight=Md,c.dropRightWhile=Id,c.dropWhile=wd,c.fill=Bd,c.filter=E0,c.flatMap=O0,c.flatMapDeep=L0,c.flatMapDepth=U0,c.flatten=mu,c.flattenDeep=Ad,c.flattenDepth=Ed,c.flip=eg,c.flow=Kb,c.flowRight=Qb,c.fromPairs=Rd,c.functions=Qg,c.functionsIn=Zg,c.groupBy=N0,c.initial=Od,c.intersection=Ld,c.intersectionBy=Ud,c.intersectionWith=Nd,c.invert=Jg,c.invertBy=eb,c.invokeMap=q0,c.iteratee=Jl,c.keyBy=P0,c.keys=Ne,c.keysIn=Ze,c.map=eo,c.mapKeys=ib,c.mapValues=nb,c.matches=Zb,c.matchesProperty=Xb,c.memoize=io,c.merge=rb,c.mergeWith=Ou,c.method=Jb,c.methodOf=eh,c.mixin=es,c.negate=no,c.nthArg=ih,c.omit=ob,c.omitBy=lb,c.once=tg,c.orderBy=$0,c.over=nh,c.overArgs=ig,c.overEvery=rh,c.overSome=oh,c.partial=jl,c.partialRight=yu,c.partition=H0,c.pick=sb,c.pickBy=Lu,c.property=Hu,c.propertyOf=lh,c.pull=$d,c.pullAll=pu,c.pullAllBy=Hd,c.pullAllWith=Wd,c.pullAt=Vd,c.range=sh,c.rangeRight=ah,c.rearg=ng,c.reject=G0,c.remove=Gd,c.rest=rg,c.reverse=Vl,c.sampleSize=j0,c.set=ub,c.setWith=cb,c.shuffle=z0,c.slice=kd,c.sortBy=Q0,c.sortedUniq=Xd,c.sortedUniqBy=Jd,c.split=Ob,c.spread=og,c.tail=e0,c.take=t0,c.takeRight=i0,c.takeRightWhile=n0,c.takeWhile=r0,c.tap=v0,c.throttle=lg,c.thru=Jr,c.toArray=Au,c.toPairs=Uu,c.toPairsIn=Nu,c.toPath=ph,c.toPlainObject=Ru,c.transform=mb,c.unary=sg,c.union=o0,c.unionBy=l0,c.unionWith=s0,c.uniq=a0,c.uniqBy=u0,c.uniqWith=c0,c.unset=fb,c.unzip=Gl,c.unzipWith=du,c.update=pb,c.updateWith=db,c.values=bn,c.valuesIn=gb,c.without=m0,c.words=Pu,c.wrap=ag,c.xor=f0,c.xorBy=p0,c.xorWith=d0,c.zip=g0,c.zipObject=b0,c.zipObjectDeep=h0,c.zipWith=_0,c.entries=Uu,c.entriesIn=Nu,c.extend=Du,c.extendWith=lo,es(c,c),c.add=gh,c.attempt=$u,c.camelCase=vb,c.capitalize=Fu,c.ceil=bh,c.clamp=bb,c.clone=cg,c.cloneDeep=fg,c.cloneDeepWith=pg,c.cloneWith=mg,c.conformsTo=dg,c.deburr=qu,c.defaultTo=Yb,c.divide=hh,c.endsWith=Tb,c.eq=Bt,c.escape=xb,c.escapeRegExp=Cb,c.every=A0,c.find=R0,c.findIndex=uu,c.findKey=Gg,c.findLast=D0,c.findLastIndex=cu,c.findLastKey=kg,c.floor=_h,c.forEach=bu,c.forEachRight=hu,c.forIn=jg,c.forInRight=zg,c.forOwn=Yg,c.forOwnRight=Kg,c.get=Kl,c.gt=gg,c.gte=bg,c.has=Xg,c.hasIn=Ql,c.head=fu,c.identity=Xe,c.includes=F0,c.indexOf=Dd,c.inRange=hb,c.invoke=tb,c.isArguments=ji,c.isArray=K,c.isArrayBuffer=hg,c.isArrayLike=Qe,c.isArrayLikeObject=ye,c.isBoolean=_g,c.isBuffer=Mi,c.isDate=vg,c.isElement=Tg,c.isEmpty=xg,c.isEqual=Cg,c.isEqualWith=Sg,c.isError=zl,c.isFinite=yg,c.isFunction=ai,c.isInteger=Mu,c.isLength=ro,c.isMap=Iu,c.isMatch=Mg,c.isMatchWith=Ig,c.isNaN=wg,c.isNative=Bg,c.isNil=Eg,c.isNull=Ag,c.isNumber=wu,c.isObject=he,c.isObjectLike=ve,c.isPlainObject=or,c.isRegExp=Yl,c.isSafeInteger=Rg,c.isSet=Bu,c.isString=oo,c.isSymbol=lt,c.isTypedArray=gn,c.isUndefined=Dg,c.isWeakMap=Og,c.isWeakSet=Lg,c.join=Fd,c.kebabCase=Sb,c.last=gt,c.lastIndexOf=qd,c.lowerCase=yb,c.lowerFirst=Mb,c.lt=Ug,c.lte=Ng,c.max=vh,c.maxBy=Th,c.mean=xh,c.meanBy=Ch,c.min=Sh,c.minBy=yh,c.stubArray=is,c.stubFalse=ns,c.stubObject=uh,c.stubString=ch,c.stubTrue=mh,c.multiply=Mh,c.nth=Pd,c.noConflict=th,c.noop=ts,c.now=to,c.pad=Ib,c.padEnd=wb,c.padStart=Bb,c.parseInt=Ab,c.random=_b,c.reduce=W0,c.reduceRight=V0,c.repeat=Eb,c.replace=Rb,c.result=ab,c.round=Ih,c.runInContext=g,c.sample=k0,c.size=Y0,c.snakeCase=Db,c.some=K0,c.sortedIndex=jd,c.sortedIndexBy=zd,c.sortedIndexOf=Yd,c.sortedLastIndex=Kd,c.sortedLastIndexBy=Qd,c.sortedLastIndexOf=Zd,c.startCase=Lb,c.startsWith=Ub,c.subtract=wh,c.sum=Bh,c.sumBy=Ah,c.template=Nb,c.times=fh,c.toFinite=ui,c.toInteger=Q,c.toLength=Eu,c.toLower=Fb,c.toNumber=bt,c.toSafeInteger=Fg,c.toString=ue,c.toUpper=qb,c.trim=Pb,c.trimEnd=$b,c.trimStart=Hb,c.truncate=Wb,c.unescape=Vb,c.uniqueId=dh,c.upperCase=Gb,c.upperFirst=Zl,c.each=bu,c.eachRight=hu,c.first=fu,es(c,function(){var e={};return Lt(c,function(t,i){ce.call(c.prototype,i)||(e[i]=t)}),e}(),{chain:!1}),c.VERSION=o,ct(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){c[e].placeholder=c}),ct(["drop","take"],function(e,t){te.prototype[e]=function(i){i=i===l?1:Le(Q(i),0);var r=this.__filtered__&&!t?new te(this):this.clone();return r.__filtered__?r.__takeCount__=qe(i,r.__takeCount__):r.__views__.push({size:qe(i,Ot),type:e+(r.__dir__<0?"Right":"")}),r},te.prototype[e+"Right"]=function(i){return this.reverse()[e](i).reverse()}}),ct(["filter","map","takeWhile"],function(e,t){var i=t+1,r=i==ms||i==Pc;te.prototype[e]=function(a){var m=this.clone();return m.__iteratees__.push({iteratee:H(a,3),type:i}),m.__filtered__=m.__filtered__||r,m}}),ct(["head","last"],function(e,t){var i="take"+(t?"Right":"");te.prototype[e]=function(){return this[i](1).value()[0]}}),ct(["initial","tail"],function(e,t){var i="drop"+(t?"":"Right");te.prototype[e]=function(){return this.__filtered__?new te(this):this[i](1)}}),te.prototype.compact=function(){return this.filter(Xe)},te.prototype.find=function(e){return this.filter(e).head()},te.prototype.findLast=function(e){return this.reverse().find(e)},te.prototype.invokeMap=X(function(e,t){return typeof e=="function"?new te(this):this.map(function(i){return Jn(i,e,t)})}),te.prototype.reject=function(e){return this.filter(no(H(e)))},te.prototype.slice=function(e,t){e=Q(e);var i=this;return i.__filtered__&&(e>0||t<0)?new te(i):(e<0?i=i.takeRight(-e):e&&(i=i.drop(e)),t!==l&&(t=Q(t),i=t<0?i.dropRight(-t):i.take(t-e)),i)},te.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},te.prototype.toArray=function(){return this.take(Ot)},Lt(te.prototype,function(e,t){var i=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),a=c[r?"take"+(t=="last"?"Right":""):t],m=r||/^find/.test(t);a&&(c.prototype[t]=function(){var p=this.__wrapped__,d=r?[1]:arguments,b=p instanceof te,I=d[0],w=b||K(p),B=function(ee){var ie=a.apply(c,hi([ee],d));return r&&D?ie[0]:ie};w&&i&&typeof I=="function"&&I.length!=1&&(b=w=!1);var D=this.__chain__,$=!!this.__actions__.length,V=m&&!D,Z=b&&!$;if(!m&&w){p=Z?p:new te(this);var G=e.apply(p,d);return G.__actions__.push({func:Jr,args:[B],thisArg:l}),new ft(G,D)}return V&&Z?e.apply(this,d):(G=this.thru(B),V?r?G.value()[0]:G.value():G)})}),ct(["pop","push","shift","sort","splice","unshift"],function(e){var t=Mr[e],i=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);c.prototype[e]=function(){var a=arguments;if(r&&!this.__chain__){var m=this.value();return t.apply(K(m)?m:[],a)}return this[i](function(p){return t.apply(K(p)?p:[],a)})}}),Lt(te.prototype,function(e,t){var i=c[t];if(i){var r=i.name+"";ce.call(cn,r)||(cn[r]=[]),cn[r].push({name:t,func:i})}}),cn[jr(l,Et).name]=[{name:"wrapper",func:l}],te.prototype.clone=Vf,te.prototype.reverse=Gf,te.prototype.value=kf,c.prototype.at=T0,c.prototype.chain=x0,c.prototype.commit=C0,c.prototype.next=S0,c.prototype.plant=M0,c.prototype.reverse=I0,c.prototype.toJSON=c.prototype.valueOf=c.prototype.value=w0,c.prototype.first=c.prototype.head,jn&&(c.prototype[jn]=y0),c},vi=Cf();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(Ue._=vi,define(function(){return vi})):qi?((qi.exports=vi)._=vi,Jo._=vi):Ue._=vi}).call(Un)});var Ie=class extends Ii{annees;acquis;doublon;idBloc;bloc;carnet;user;getAnnees(){return this.annees}setAnnees(o){this.annees=o}getAcquis(){return this.acquis}setAcquis(o){this.acquis=o}getDoublon(){return this.doublon}setDoublon(o){this.doublon=o}getIdBloc(){return this.idBloc}setIdBloc(o){this.idBloc=o}getCarnet(){return this.carnet}setCarnet(o){this.carnet=o}getBloc(){return this.bloc}setBloc(o){this.bloc=o}getUser(){return this.user}setUser(o){this.user=o}};ne([re("Ann\xE9e")],Ie.prototype,"annees",2),ne([re("Acquis")],Ie.prototype,"acquis",2),ne([re("Doublon")],Ie.prototype,"doublon",2),ne([re("Ident bloc")],Ie.prototype,"idBloc",2),ne([re("Bloc")],Ie.prototype,"bloc",2),ne([re("Carnet")],Ie.prototype,"carnet",2),ne([re("User")],Ie.prototype,"user",2);var Ye=class extends Ii{idUser;idTimbre;acquis;doublon;constructor(o,n,s,u){super(),this.idUser=o||null,this.idTimbre=n||null,this.acquis=s||!1,this.doublon=u||!1}getIdUser(){return this.idUser}setIdUser(o){this.idUser=o}getIdTimbre(){return this.idTimbre}setIdTimbre(o){this.idTimbre=o}isAcquis(){return this.acquis}setAcquis(o){this.acquis=o}isDoublon(){return this.doublon}setDoublon(o){this.doublon=o}};ne([re("Identifiant Utilisateur")],Ye.prototype,"idUser",2),ne([re("Identifiant timbre")],Ye.prototype,"idTimbre",2),ne([re("Acquis")],Ye.prototype,"acquis",2),ne([re("Doublon")],Ye.prototype,"doublon",2);var sr=class{key;dossier;maxWidth;maxHeight;getKey(){return this.key}setKey(o){this.key=o}getDossier(){return this.dossier}setDossier(o){this.dossier=o}getMaxWidth(){return this.maxWidth}setMaxWidth(o){this.maxWidth=o}getMaxHeight(){return this.maxHeight}setMaxHeight(o){this.maxHeight=o}};var Ui=class{dossier;nom;alignLabel;detail;file;getDossier(){return this.dossier}setDossier(o){this.dossier=o}getNom(){return this.nom}setNom(o){this.nom=o}getAlignLabel(){return this.alignLabel}setAlignLabel(o){this.alignLabel=o}getDetail(){return this.detail}setDetail(o){this.detail=o}getFile(){return this.file}setFile(o){this.file=o}};var Se=class l{constructor(o,n){this.authService=o;this.firestore=n}reinitResume$=new me(!0);timbreCritereModel=new Ie;timbreCritereBlocModel=new Ie;initUpload(){let o=new Ui;o.setDossier("table"),o.setNom(new Date().getTime()?.toString());let n=new sr;n.setMaxWidth(100),n.setMaxHeight(100),n.setDossier("autre");let s=new sr;return s.setMaxWidth(700),s.setMaxHeight(700),s.setDossier("zoom"),o.setDetail([n,s]),o}getAnneesAsync(o){return this.firestore.collection(o,n=>{let s=n;return s=s.orderBy("annee","desc"),s}).valueChanges().pipe(Ft(n=>{let s=n.map(u=>Number(u.annee)).filter(u=>S(u)&&u!=0);return Array.from(new Set(s))}))}getTimbresByCritereAsync(o){return this.getAllTimbres(o).pipe(Ft(n=>this.constructTimbres(n,null,null)))}getAllTimbres(o){return this.firestore.collection("/timbres",n=>{let s=n;return S(o)&&(S(o.getAnnees())&&o.getAnnees()?.length>0&&(s=s.where("annee","in",o.getAnnees())),S(o.getBloc())&&o.getBloc()!="TOUS"?s=s.where("idBloc",o.getBloc()!="OUI"?"==":"!=",null):S(o.getIdBloc())&&(s=s.where("idBloc","==",o.getIdBloc()))),s=s.orderBy("id","asc"),s}).valueChanges()}constructTimbres(o,n,s,u){let f=[];return o?.length>0&&o.forEach(T=>{let A=this.constructTimbre(T,n,s),E=!0;S(u)&&S(A.getTimbreAcquisModel())&&(S(u.getAcquis())&&!(u.getAcquis()=="TOUS"||u.getAcquis()=="OUI"&&A.getTimbreAcquisModel().isAcquis()||u.getAcquis()=="NON"&&!A.getTimbreAcquisModel().isAcquis())&&(E=!1),S(u.getDoublon())&&!(u.getDoublon()=="TOUS"||u.getDoublon()=="OUI"&&A.getTimbreAcquisModel().isDoublon()||u.getDoublon()=="NON"&&!A.getTimbreAcquisModel().isDoublon())&&(E=!1)),S(u?.getCarnet())&&u.getCarnet()!="TOUS"&&(et(A?.getTimbreBlocModel())||u.getCarnet()=="OUI"&&!A.getTimbreBlocModel().isCarnet()||u.getCarnet()=="NON"&&A.getTimbreBlocModel().isCarnet())&&(E=!1),E==!0&&f.push(A)}),f}constructTimbre(o,n,s){let u=wi(Zt,o);if(S(s)){let f=s.find(T=>T.getId()==u?.getIdBloc());S(f)&&u.setTimbreBlocModel(f)}if(S(n)){let f=n.find(T=>T.idTimbre==u.getId());S(f)?u.setTimbreAcquisModel(wi(Ye,f)):u.setTimbreAcquisModel(new Ye)}return u}supprimerTimbreAcquis(o){this.firestore.collection("/timbres_acquis").ref.where("idTimbre","==",o.getId()).get().then(n=>{n.forEach(s=>{s.ref.delete()})})}supprimerTimbre(o){this.firestore.collection("/timbres").ref.where("id","==",o.getId()).get().then(n=>{n.forEach(s=>{s.ref.delete()})}).catch(n=>{console.error("Erreur de suppression :",n)})}acquis(o,n,s){this.authService.userSelect$.pipe(F(u=>S(u))).subscribe(u=>{this.firestore.collection("/timbres_acquis").ref.where("idTimbre","==",o.getId()).where("idUser","==",u.getId()).get().then(f=>{f?.size==0&&this.addAcquis(u.getId(),o,n),f.forEach(T=>{let A=wi(Ye,T.data());n?(A.setAcquis(!0),A.setDoublon(s||!A.isDoublon())):(A.setAcquis(s||!A.isAcquis()),A.isAcquis()||A.setDoublon(!1)),T.ref.update(Object.assign(new Object,A)).then(E=>{o.setTimbreAcquisModel(A)}).catch(E=>{console.error("Erreur de mise \xE0 jour:",E)})})}).catch(f=>{console.error("Erreur de mise \xE0 jour id introuvable :",f)}),this.reinitResume$.next(!0)})}supprimerAcquisTimbreByUser(o,n,s,u){this.firestore.collection("/timbres_acquis").ref.where("idTimbre","==",n.getId()).where("idUser","==",o).get().then(f=>{f?.size==0&&u&&this.addAcquis(o,n,s),f.forEach(T=>{T.ref.delete().then(A=>{u&&this.supprimerTimbreAcquis(n)})})}).catch(f=>{console.error("Erreur de suppression :",f)})}addAcquis(o,n,s){let u=new Ye;u.setIdUser(o),u.setIdTimbre(n.getId()),u.setAcquis(!0),u.setDoublon(s),n.setTimbreAcquisModel(u),this.firestore.collection("/timbres_acquis").add(Object.assign(new Object,u))}static \u0275fac=function(n){return new(n||l)(be(tt),be(Bi))};static \u0275prov=qt({token:l,factory:l.\u0275fac})};var St=class extends Ii{idUser;idBloc;acquis;doublon;constructor(o,n,s,u){super(),this.idUser=o||null,this.idBloc=n||null,this.acquis=s||!1,this.doublon=u||!1}getIdUser(){return this.idUser}setIdUser(o){this.idUser=o}getIdBloc(){return this.idBloc}setIdBloc(o){this.idBloc=o}isAcquis(){return this.acquis}setAcquis(o){this.acquis=o}isDoublon(){return this.doublon}setDoublon(o){this.doublon=o}};ne([re("Identifiant Utilisateur")],St.prototype,"idUser",2),ne([re("Identifiant bloc")],St.prototype,"idBloc",2),ne([re("Acquis")],St.prototype,"acquis",2),ne([re("Doublon")],St.prototype,"doublon",2);var Fh=["canvas"];function qh(l,o){l&1&&k(0,"lib-spinner",5),l&2&&_("textSpec","Chargement en cours ...")}function Ph(l,o){if(l&1&&(k(0,"mat-error",21),U(1,"async")),l&2){let n=y(2);_("innerHTML",N(1,1,n.messageError$),hn)}}function $h(l,o){if(l&1){let n=se();v(0,"div",10)(1,"label"),k(2,"lib-libelle-model",11),x(),v(3,"input",22),Ee("ngModelChange",function(u){q(n);let f=y(2);return Ae(f.timbreBlocModel.id,u)||(f.timbreBlocModel.id=u),P(u)}),x()()}if(l&2){let n=y(2);h(2),_("object",n.timbreBlocModel)("key","id"),h(),Be("ngModel",n.timbreBlocModel.id),_("disabled",!!(n.timbreBlocModel!=null&&n.timbreBlocModel.getId()))}}function Hh(l,o){if(l&1){let n=se();v(0,"form",6,1),j("ngSubmit",function(){q(n);let u=Ce(1),f=y();return P(f.valider(u))}),v(2,"div",7),L(3,Ph,2,3,"mat-error",8),U(4,"async"),L(5,$h,4,4,"div",9),v(6,"div",10)(7,"label"),k(8,"lib-libelle-model",11),x(),v(9,"input",12),Ee("ngModelChange",function(u){q(n);let f=y();return Ae(f.timbreBlocModel.annee,u)||(f.timbreBlocModel.annee=u),P(u)}),x()(),v(10,"div",10)(11,"label"),k(12,"lib-libelle-model",11),x(),v(13,"input",13),Ee("ngModelChange",function(u){q(n);let f=y();return Ae(f.timbreBlocModel.monnaie,u)||(f.timbreBlocModel.monnaie=u),P(u)}),x()(),v(14,"div",14)(15,"div",10)(16,"label"),k(17,"lib-libelle-model",11),x(),v(18,"input",15),Ee("ngModelChange",function(u){q(n);let f=y();return Ae(f.timbreBlocModel.yt,u)||(f.timbreBlocModel.yt=u),P(u)}),x()(),k(19,"div",16),x(),v(20,"lib-upload",17),j("outPutObject",function(u){q(n);let f=y();return P(f.timbreBlocModel=u)}),x()(),v(21,"div",18)(22,"button",19),j("click",function(){q(n);let u=y();return P(u.close())}),R(23," Annuler "),x(),v(24,"button",20),R(25," Enregistrer "),x()()()}if(l&2){let n=Ce(1),s=y();_("ngClass",n!=null&&n.submitted?"red-color":"blue-color"),h(3),_("ngIf",N(4,19,s.messageError$)),h(2),_("ngIf",s.timbreBlocModel==null?null:s.timbreBlocModel.getId()),h(3),_("object",s.timbreBlocModel)("key","annee"),h(),Be("ngModel",s.timbreBlocModel.annee),_("max",s.maxAnnee)("zMax",s.maxAnnee),h(3),_("object",s.timbreBlocModel)("key","monnaie"),h(),Be("ngModel",s.timbreBlocModel.monnaie),h(4),_("object",s.timbreBlocModel)("key","yt"),h(),Be("ngModel",s.timbreBlocModel.yt),h(2),_("object",s.timbreBlocModel)("key","image")("zoom",s.timbreBlocModel.getImageZoom())("maxWidth",s.DimensionImageEnum.WIDTH_TIMBRE)("maxHeight",s.DimensionImageEnum.HEIGTH_TIMBRE)}}var On=class l{constructor(o,n,s,u,f){this.httpResponseHandlerService=o;this.dialogRef=n;this.utilsService=s;this.timbreBlocService=u;this.timbreUtilsService=f}canvas;messageError$=new me(null);load$=new me(null);id;maxAnnee=new Date().getFullYear()+1;timbreBlocModel=new Li;fileUploadModel=new Ui;DimensionImageEnum=Qi;ngOnInit(){this.fileUploadModel=this.timbreUtilsService.initUpload(),this.load$.next(!1),S(this.id)?this.timbreBlocService.getBlocByIdAsync(this.id).subscribe(o=>{this.timbreBlocModel=o,this.load$.next(!0)}):(this.timbreBlocModel.setAnnee(new Date().getFullYear()),this.timbreBlocModel.setMonnaie("E"),this.load$.next(!0))}valider(o){if(this.messageError$.next(null),o?.valid)if(S(this.timbreBlocModel.getImage()))this.saveData();else{this.messageError$.next("Veuillez s\xE9lectionner une image");return}}saveData(){this.load$.next(!1),S(this.timbreBlocModel.getId())?this.save():this.ajouter()}ajouter(){this.utilsService.getMaxIdentAsync("/timbres_bloc").pipe(F()).subscribe(o=>{this.timbreBlocModel.setId(o),this.save(!0)})}save(o){try{ze([this.timbreBlocService.upload(this.timbreBlocModel,"autre"),this.timbreBlocService.upload(this.timbreBlocModel,"table"),this.timbreBlocService.upload(this.timbreBlocModel,"zoom")]).pipe(F(([n,s,u])=>S(n)&&S(u)&&S(s))).subscribe(([n,s,u])=>{S(n)&&n!="nok"&&this.timbreBlocModel.setImage(n),S(s)&&s!="nok"&&this.timbreBlocModel.setImageTable(s),S(u)&&u!="nok"&&this.timbreBlocModel.setImageZoom(u),o?this.timbreBlocService.ajouter(this.timbreBlocModel,!0):this.timbreBlocService.modifier(this.timbreBlocModel),this.httpResponseHandlerService.showNotificationSuccess("Transaction termin\xE9e","Votre timbre a bien \xE9t\xE9 modifi\xE9e."),this.load$.next(!0),this.dialogRef.close()})}catch{this.httpResponseHandlerService.showNotificationError("Transaction non aboutie","Votre timbre n'a pas pu \xEAtre modifi\xE9."),this.load$.next(!0)}}close(){this.dialogRef.close()}static \u0275fac=function(n){return new(n||l)(W(xo),W(Yt),W(Ct),W(it),W(Se))};static \u0275cmp=we({type:l,selectors:[["app-timbre-modifier-bloc"]],viewQuery:function(n,s){if(n&1&&zi(Fh,5),n&2){let u;Yi(u=Ki())&&(s.canvas=u.first)}},decls:10,vars:6,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","space-between stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","column","fxLayoutGap","20px",1,"bloc-modal"],[3,"innerHTML",4,"ngIf"],["fxLayout","column","class","form-input",4,"ngIf"],["fxLayout","column",1,"form-input"],[3,"object","key"],["name","page","type","number","minlength","4","maxlength","4","min","1900","zMin","1900","required","","zControl","",1,"annee",2,"width","60px !important",3,"ngModelChange","ngModel","max","zMax"],["name","monnaie","type","text","trim","","minlength","1","maxlength","2","required","","zControl","",2,"width","25px !important",3,"ngModelChange","ngModel"],["fxLayout","row","fxLayout.lt-lg","column","fxLayoutGap","30px","fxLayoutGap.lt-lg","5px"],["name","yt","type","text","trim","","zControl","",3,"ngModelChange","ngModel"],["fxHide.lt-lg","","fxLayout","column",1,"form-input"],[3,"outPutObject","object","key","zoom","maxWidth","maxHeight"],["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"],[3,"innerHTML"],["name","code","type","text","trim","","upperCase","","noEspace","","required","","zControl","",3,"ngModelChange","ngModel","disabled"]],template:function(n,s){if(n&1&&(v(0,"div",2)(1,"div",3)(2,"span"),R(3),x(),v(4,"span"),R(5),x()(),L(6,qh,1,1,"ng-template",4),U(7,"async"),L(8,Hh,26,21,"ng-template",null,0,Je),x()),n&2){let u=Ce(9);h(3),Y("",s.timbreBlocModel!=null&&s.timbreBlocModel.getId()?"MODIFICATION":"AJOUT"," BLOC "),h(2),mo(s.timbreBlocModel==null?null:s.timbreBlocModel.getId()),h(),_("ngIf",N(7,4,s.load$)==!1)("ngIfElse",u)}},dependencies:[vt,In,Pt,Re,Gt,Ai,jt,kt,Ei,_n,Vt,Oi,vn,Tn,ht,Ri,Sn,yn,Mn,Cn,xn,_t,Di,Bn,xt,ec,wn,Co,An,En,Tc,So,De],encapsulation:2})};var wc=rs(ss());var it=class l{constructor(o,n,s,u,f,T){this.firestore=o;this.authService=n;this.uploadService=s;this.utilsService=u;this.timbreUtilsService=f;this.dialog=T}total$=new me(0);totalCarnet$=new me(0);timbresBlocModel$=new me(null);load$=new me(!1);upload(o,n,s){let u=100,f=100;return n=="table"?(u=u*(50/f),f=50):n=="zoom"&&(u=u*(700/f),f=700),this.uploadService.processAndUploadImage(o?.getImage(),u,f,"bloc-"+o.getId(),this.getDossier(o,n,s))}setTotal(o,n){o.isCarnet()?this.total$.pipe(F()).subscribe(s=>{this.total$.next(s+1)}):this.totalCarnet$.pipe(F()).subscribe(s=>{this.totalCarnet$.next(s+n)})}getTotal(o){this.total$.next(null),this.totalCarnet$.next(null),this.getAllBlocs(o).subscribe(n=>{this.total$.next(n?.filter(s=>!s.carnet)?.length),this.totalCarnet$.next(n?.filter(s=>s.carnet)?.length)})}getBloc(o){return this.firestore.collection("/timbres_bloc",n=>n.where("id","==",o)).valueChanges()}getBlocByIdAsync(o){return this.getBloc(o).pipe(Ft(n=>wi(Li,n[0])))}getRef(o,n){let s=o;return S(n)&&(S(n.getAnnees())&&n.getAnnees()?.length>0&&(s=s.where("annee","in",n.getAnnees())),S(n.getCarnet())&&n.getCarnet()!="TOUS"&&(s=s.where("carnet",n.getCarnet()!="OUI"?"==":"!=",!1))),s=s.orderBy("id","asc"),s}getAllBlocs(o){return this.firestore.collection("/timbres_bloc",n=>this.getRef(n,o)).valueChanges()}getTimbreBlocAcquis(){return this.authService.userSelect$.pipe(F(o=>S(o)),so(o=>S(o)?this.getTimbreBlocAcquisByUser(o.getId()).pipe(F(),Ft(n=>n)):null))}getTimbreBlocAcquisByUser(o){return this.firestore.collection("/timbres_bloc_acquis",n=>n.where("idUser","==",o)).valueChanges()}modifAll(){let o=new Ie,n=[];for(let s=2020;s<2025;s++)n.push(s);o.setAnnees(n),this.getAllBlocs(o).pipe(F(s=>s?.length>0)).subscribe(s=>{s.forEach(u=>{let f=(0,wc.cloneDeep)(u);f.imageTable=u.image,f.image=u.imageTable,this.firestore.collection("/timbres_bloc").ref.where("id","==",f.id).get().then(T=>{T.forEach(A=>{A.ref.update(f)})})})})}getBlocs(o,n){this.load$.next(!1),this.timbresBlocModel$.next(null),n&&this.getTotal(),ze([this.getAllBlocs(o),this.getTimbreBlocAcquis()]).pipe(F()).subscribe(([s,u])=>{this.timbresBlocModel$.next(this.constructBlocs(s,u,o)),this.load$.next(!0)})}getBlocsAsync(o){return this.timbresBlocModel$.next(null),this.getAllBlocs(o).pipe(F(),Ft(n=>this.constructBlocs(n,null,o)))}constructBloc(o,n){let s=wi(Li,o);if(S(n)){let u=n.find(f=>f.idBloc==s.getId());S(u)?s.setTimbreBlocAcquisModel(wi(St,u)):s.setTimbreBlocAcquisModel(new St)}return s}constructBlocs(o,n,s){let u=[];return o?.length>0&&o.forEach(f=>{let T=this.constructBloc(f,n);this.getTimbresByBlocAsync(T.getId()).subscribe(E=>{T.setNbTimbres(E?.length)});let A=!0;S(s)&&S(T.getTimbreBlocAcquisModel())&&(S(s.getAcquis())&&!(s.getAcquis()=="TOUS"||s.getAcquis()=="OUI"&&T.getTimbreBlocAcquisModel().isAcquis()||s.getAcquis()=="NON"&&!T.getTimbreBlocAcquisModel().isAcquis())&&(A=!1),S(s.getDoublon())&&!(s.getDoublon()=="TOUS"||s.getDoublon()=="OUI"&&T.getTimbreBlocAcquisModel().isDoublon()||s.getDoublon()=="NON"&&!T.getTimbreBlocAcquisModel().isDoublon())&&(A=!1)),A==!0&&u.push(T)}),u}acquis(o,n){return this.authService.userSelect$.pipe(F(s=>S(s))).subscribe(s=>{S(o?.getTimbreBlocAcquisModel()?.getIdUser())?this.firestore.collection("/timbres_bloc_acquis").ref.where("idBloc","==",o.getId()).where("idUser","==",s.getId()).get().then(u=>{u.forEach(f=>{let T=o.getTimbreBlocAcquisModel();n?(T.setAcquis(!0),T.setDoublon(!T.isDoublon())):(T.setAcquis(!T.isAcquis()),T.isAcquis()||T.setDoublon(!1)),f.ref.update(Object.assign(new Object,T)).then(A=>{o.setTimbreBlocAcquisModel(T)}).catch(A=>{console.error("Erreur de mise \xE0 jour:",A)})})}).catch(u=>{console.error("Erreur de mise \xE0 jour:",u)}):this.addAcquis(s?.getId(),o,n),this.timbreUtilsService.reinitResume$.next(!0)})}addAcquis(o,n,s){let u=new St;u.setIdUser(o),u.setIdBloc(n.getId()),u.setAcquis(!0),u.setDoublon(s),n.setTimbreBlocAcquisModel(u),this.firestore.collection("/timbres_bloc_acquis").add(Object.assign(new Object,u))}ajouterSansId(o){this.utilsService.getMaxIdentAsync("/timbres_bloc").pipe(F()).subscribe(n=>{o.setId(n),this.ajouter(o,!0)})}ajouter(o,n){this.getBloc(o.getId()).pipe(F()).subscribe(s=>{et(s)||et(s[0])||S(s[0])&&s[0]?.length==0?(o.setTimbreBlocAcquisModel(null),o.setIdOrigine(null),this.firestore.collection("/timbres_bloc").add(Object.assign(new Object,o)).then(u=>{this.timbresBlocModel$.pipe(F()).subscribe(f=>{f.push(o),this.setTotal(o,1)}),this.timbreUtilsService.reinitResume$.next(!0)}).catch(u=>{console.error("Erreur d'ajout :",u)})):console.error("bloc "+o.getId()+" d\xE9j\xE0 existant")})}isCarnet(o){this.authService.user$.pipe(F(n=>S(n))).subscribe(n=>{n?.getDroit()>=9?(o.setCarnet(!o.isCarnet()),this.modifier(o)):this.utilsService.droitInsuffisant()})}modifier(o){o.setTimbreBlocAcquisModel(null),this.firestore.collection("/timbres_bloc").ref.where("id","==",o.getId()).get().then(n=>{n.forEach(s=>{s.ref.update(Object.assign(new Object,o)).then(u=>{this.timbresBlocModel$.pipe(F(f=>S(f)&&f?.length>0)).subscribe(f=>{let T=f.find(A=>A.getId()==o.getId());S(T)&&Object.assign(T,o)})}).catch(u=>{console.error("Erreur de mise \xE0 jour :",u)})})}).catch(n=>{console.error("Erreur de mise \xE0 jour id introuvable :",n)})}getTimbresByBlocAsync(o){let n=new Ie;return n.setIdBloc(o),this.timbreUtilsService.getTimbresByCritereAsync(n)}supprimer(o){this.getTimbresByBlocAsync(o.getId()).pipe(F()).subscribe(n=>{n.forEach(s=>{this.timbreUtilsService.supprimerTimbreAcquis(s),this.timbreUtilsService.supprimerTimbre(s)})}),this.firestore.collection("/timbres_bloc_acquis").ref.where("idBloc","==",o.getId()).get().then(n=>{n.forEach(s=>{s.ref.delete()})}),this.firestore.collection("/timbres_bloc").ref.where("id","==",o.getId()).get().then(n=>{n.forEach(s=>{s.ref.delete().then(u=>{this.timbresBlocModel$.pipe(F()).subscribe(f=>{let T=f.findIndex(A=>A.getId()==o.getId());T>=0&&(f.splice(T,1),this.setTotal(o,-1))})}).catch(u=>{console.error("Erreur de suppression :",u)})})}).catch(n=>{console.error("Erreur de suppression id introuvable :",n)}),this.timbreUtilsService.reinitResume$.next(!0)}getDossier(o,n,s){let u="timbre//"+o.getAnnee();return S(n)&&(u=u+"/"+n),u=u+"/bloc/"+(S(s)?s:o.getId()),u}getBouchon(){let o=new Li;return o.setAnnee(new Date().getFullYear()),o.setMonnaie("E"),o}acquisDoublon(o,n){this.authService.user$.pipe(F(s=>S(s))).subscribe(s=>{s?.getDroit()>=9?o?.isCarnet()?this.acquisCarnetDialog(o,n):this.acquis(o,n):this.utilsService.droitInsuffisant()})}acquisCarnetDialog(o,n){let s="";o?.getTimbreBlocAcquisModel()?.isDoublon()&&n?s="enlever les doublons":o?.getTimbreBlocAcquisModel()?.isAcquis()?s="enlever les acquis":s="mettre en "+(n?"doublon":"acquis")+" tous";let u=this.dialog.open(Zi,{maxHeight:"95vh",data:{titre:"Confirmation",message:"Souhaitez-vous <b>"+s+"</b> les timbres du carnet ?",btnDroite:"Oui",btnGauche:"Non"}});u.afterClosed().subscribe(()=>{u.componentInstance.data.resultat==="valider"&&this.authService.userSelect$.pipe(F(f=>S(f))).subscribe(f=>{this.getTimbresByBlocAsync(o.getId()).pipe(F()).subscribe(T=>{T.forEach(A=>{this.timbreUtilsService.acquis(A,n,!o?.getTimbreBlocAcquisModel()?.isAcquis())})}),this.acquis(o,n)})})}modifierDialog(o){let n=this.dialog.open(On,{height:"75vh",maxHeight:"750px",width:"30%"});n.componentInstance.id=o.getId(),n.afterClosed().subscribe(()=>{n.close()})}supprimerDialog(o){this.getTimbresByBlocAsync(o.getId()).pipe(F()).subscribe(n=>{let s="";S(n)&&n?.length>0&&(s="<span class='warn'>Attention <b>"+n.length+"</b> timbre",n?.length>1?s+="s sont reli\xE9s":s+=" est reli\xE9",s+=" \xE0 ce bloc.</span></br></br>"),s+="Souhaitez-vous supprimer le bloc <b>n\xB0 "+o?.getId()+"</b> ?";let u=this.dialog.open(Zi,{maxHeight:"95vh",data:{titre:"Confirmation",message:s,btnDroite:"Oui",btnGauche:"Non"}});u.afterClosed().subscribe(()=>{u.componentInstance.data.resultat==="valider"&&this.supprimer(o)})})}static \u0275fac=function(n){return new(n||l)(be(Bi),be(tt),be(Rn),be(Ct),be(Se),be(Tt))};static \u0275prov=qt({token:l,factory:l.\u0275fac})};var Wh=["canvas"];function Vh(l,o){if(l&1&&(v(0,"span",6)(1,"b"),R(2),x()()),l&2){let n=y();h(2),Y("N\xB0",n.timbreModel==null?null:n.timbreModel.getId(),"")}}function Gh(l,o){l&1&&k(0,"lib-spinner",7),l&2&&_("textSpec","Chargement en cours ...")}function kh(l,o){if(l&1&&(k(0,"mat-error",29),U(1,"async")),l&2){let n=y(2);_("innerHTML",N(1,1,n.messageError$),hn)}}function jh(l,o){if(l&1&&(v(0,"mat-option",18),R(1),x()),l&2){let n=o.$implicit;_("value",n),h(),Gu(" ",n.getAnnee()," - ",n.getId()," ",n.isCarnet()?" (carnet)":""," ")}}function zh(l,o){if(l&1){let n=se();v(0,"img",30),j("click",function(){let u;q(n);let f=y(2);return P(f.utilsService.zoom(f.timbreModel==null||(u=f.timbreModel.getTimbreBlocModel())==null?null:u.getImageZoom()))}),x()}if(l&2){let n,s=y(2);_("src",s.timbreModel==null||(n=s.timbreModel.getTimbreBlocModel())==null?null:n.getImage(),co)}}function Yh(l,o){if(l&1){let n=se();v(0,"form",8,1),j("ngSubmit",function(){q(n);let u=Ce(1),f=y();return P(f.valider(u))}),v(2,"div",9),L(3,kh,2,3,"mat-error",10),U(4,"async"),v(5,"div",11)(6,"div",12)(7,"label"),k(8,"lib-libelle-model",13),x(),v(9,"input",14),Ee("ngModelChange",function(u){q(n);let f=y();return Ae(f.timbreModel.annee,u)||(f.timbreModel.annee=u),P(u)}),j("ngModelChange",function(u){q(n);let f=y();return P(f.changeAnnee(u))}),x()(),v(10,"div",15)(11,"label"),k(12,"lib-libelle-model",13),x(),v(13,"div",16)(14,"mat-select",17),U(15,"async"),j("ngModelChange",function(u){q(n);let f=y();return P(f.changeBloc(u))}),k(16,"mat-option",18),L(17,jh,2,4,"mat-option",19),U(18,"async"),x(),L(19,zh,1,1,"img",20),x()()(),v(20,"div",11)(21,"div",12)(22,"label"),k(23,"lib-libelle-model",13),x(),v(24,"input",21),Ee("ngModelChange",function(u){q(n);let f=y();return Ae(f.timbreModel.type,u)||(f.timbreModel.type=u),P(u)}),x()(),v(25,"div",12)(26,"label"),k(27,"lib-libelle-model",13),x(),v(28,"input",22),Ee("ngModelChange",function(u){q(n);let f=y();return Ae(f.timbreModel.monnaie,u)||(f.timbreModel.monnaie=u),P(u)}),x()()(),v(29,"div",11)(30,"div",12)(31,"label"),k(32,"lib-libelle-model",13),x(),v(33,"input",23),Ee("ngModelChange",function(u){q(n);let f=y();return Ae(f.timbreModel.yt,u)||(f.timbreModel.yt=u),P(u)}),x()(),k(34,"div",24),x(),v(35,"lib-upload",25),j("outPutObject",function(u){q(n);let f=y();return P(f.timbreModel=u)}),x()(),v(36,"div",26)(37,"button",27),j("click",function(){q(n);let u=y();return P(u.close())}),R(38," Annuler "),x(),v(39,"button",28),R(40," Enregistrer "),x()()()}if(l&2){let n,s,u=Ce(1),f=y();_("ngClass",u!=null&&u.submitted?"red-color":"blue-color"),h(3),_("ngIf",N(4,31,f.messageError$)),h(5),_("object",f.timbreModel)("key","annee"),h(),Be("ngModel",f.timbreModel.annee),_("max",f.maxAnnee)("zMax",f.maxAnnee)("disabled",!!(f.timbreModel!=null&&f.timbreModel.getId())),h(3),_("object",f.timbreModel)("key","timbreBlocModel"),h(2),_("ngModel",f.timbreModel.getTimbreBlocModel())("placeholder","Choix bloc")("disabled",!!(f.timbreModel!=null&&f.timbreModel.getId())||((n=N(15,33,f.timbreBlocService.timbresBlocModel$))==null?null:n.length)<=0),h(2),_("value",null),h(),_("ngForOf",N(18,35,f.timbreBlocService.timbresBlocModel$)),h(2),_("ngIf",f.timbreModel==null||(s=f.timbreModel.getTimbreBlocModel())==null?null:s.getImage()),h(4),_("object",f.timbreModel)("key","type"),h(),Be("ngModel",f.timbreModel.type),h(3),_("object",f.timbreModel)("key","monnaie"),h(),Be("ngModel",f.timbreModel.monnaie),_("disabled",!!f.timbreModel.getTimbreBlocModel()),h(4),_("object",f.timbreModel)("key","yt"),h(),Be("ngModel",f.timbreModel.yt),h(2),_("object",f.timbreModel)("key","image")("zoom",f.timbreModel.getImageZoom())("maxWidth",f.DimensionImageEnum.WIDTH_TIMBRE)("maxHeight",f.DimensionImageEnum.HEIGTH_TIMBRE)}}var Nn=class l{constructor(o,n,s,u,f,T){this.httpResponseHandlerService=o;this.dialogRef=n;this.timbreService=s;this.timbreBlocService=u;this.timbreUtilsService=f;this.utilsService=T}canvas;messageError$=new me(null);load$=new me(null);id;maxAnnee=new Date().getFullYear();timbreModel=new Zt;fileUploadModel=new Ui;DimensionImageEnum=Qi;ngOnInit(){this.fileUploadModel=this.timbreUtilsService.initUpload(),this.load$.next(!1),S(this.id)?this.timbreService.getTimbreByIdAsync(this.id).subscribe(o=>{this.timbreModel=o,S(o.getTimbreBlocModel())&&(this.timbreModel.setAnnee(o.getTimbreBlocModel().getAnnee()),this.timbreModel.setMonnaie(o.getTimbreBlocModel().getMonnaie())),this.load$.next(!0)}):(this.timbreModel.setAnnee(new Date().getFullYear()),this.timbreModel.setMonnaie("E"),this.load$.next(!0)),this.changeAnnee(this.timbreModel.getAnnee())}valider(o){if(this.messageError$.next(null),o?.valid)if(S(this.timbreModel.getImage()))this.saveData();else{this.messageError$.next("Veuillez s\xE9lectionner une image");return}}saveData(){this.load$.next(!1),S(this.timbreModel.getId())?this.save():this.ajouter()}ajouter(){this.utilsService.getMaxIdentAsync("/timbres").pipe(F()).subscribe(o=>{this.timbreModel.setId(o),this.save(!0)})}save(o){try{ze([this.timbreService.upload(this.timbreModel,"autre"),this.timbreService.upload(this.timbreModel,"table"),this.timbreService.upload(this.timbreModel,"zoom")]).pipe(F(([n,s,u])=>S(n)&&S(u)&&S(s))).subscribe(([n,s,u])=>{S(n)&&n!="nok"&&this.timbreModel.setImage(n),S(s)&&s!="nok"&&this.timbreModel.setImageTable(s),S(u)&&u!="nok"&&this.timbreModel.setImageZoom(u),console.log(o),o?this.timbreService.ajouter(this.timbreModel,!0):this.timbreService.modifier(this.timbreModel),this.httpResponseHandlerService.showNotificationSuccess("Transaction termin\xE9e","Votre timbre a bien \xE9t\xE9 modifi\xE9e."),this.load$.next(!0),this.dialogRef.close()})}catch{this.httpResponseHandlerService.showNotificationError("Transaction non aboutie","Votre timbre n'a pas pu \xEAtre modifi\xE9."),this.load$.next(!0)}}close(){this.dialogRef.close()}changeAnnee(o){if(this.timbreModel.setTimbreBlocModel(null),S(o)){let n=new Ie;n.setAnnees([o]),this.timbreBlocService.getBlocs(n,!1)}}changeBloc(o){S(o)?(this.timbreModel.setIdBloc(o.getId()),this.timbreModel.setTimbreBlocModel(o),this.timbreModel.setMonnaie(o.getMonnaie()),this.timbreModel.setAnnee(o.getAnnee())):(this.timbreModel.setIdBloc(null),this.timbreModel.setTimbreBlocModel(null),this.timbreModel.setMonnaie("E"))}static \u0275fac=function(n){return new(n||l)(W(xo),W(Yt),W(He),W(it),W(Se),W(Ct))};static \u0275cmp=we({type:l,selectors:[["app-timbre-modifier"]],viewQuery:function(n,s){if(n&1&&zi(Wh,5),n&2){let u;Yi(u=Ki())&&(s.canvas=u.first)}},decls:9,vars:6,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],["class","accent",4,"ngIf"],[3,"ngIf","ngIfElse"],[1,"accent"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","space-between stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","column","fxLayoutGap","20px",1,"bloc-modal"],[3,"innerHTML",4,"ngIf"],["fxLayout","row","fxLayout.lt-lg","column","fxLayoutGap","30px","fxLayoutGap.lt-lg","5px"],["fxLayout","column",1,"form-input"],[3,"object","key"],["name","page","type","number","minlength","4","maxlength","4","min","1900","zMin","1900","required","","zControl","",1,"annee",2,"width","60px !important",3,"ngModelChange","ngModel","max","zMax","disabled"],["fxLayout","column",1,"form-input","select"],["fxLayout","row","fxLayoutGap","15px"],["name","bloc",2,"width","180px !important",3,"ngModelChange","ngModel","placeholder","disabled"],[1,"selectMin",3,"value"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],["style","max-height: 40px","class","click",3,"src","click",4,"ngIf"],["name","type","type","text","trim","","zControl","",3,"ngModelChange","ngModel"],["name","monnaie","type","text","trim","","minlength","1","maxlength","2","required","","zControl","",2,"width","25px !important",3,"ngModelChange","ngModel","disabled"],["name","yt","type","text","trim","","zControl","",3,"ngModelChange","ngModel"],["fxHide.lt-lg","","fxLayout","column",1,"form-input"],[3,"outPutObject","object","key","zoom","maxWidth","maxHeight"],["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"],[3,"innerHTML"],[1,"click",2,"max-height","40px",3,"click","src"]],template:function(n,s){if(n&1&&(v(0,"div",2)(1,"div",3)(2,"span"),R(3),x(),L(4,Vh,3,1,"span",4),x(),L(5,Gh,1,1,"ng-template",5),U(6,"async"),L(7,Yh,41,37,"ng-template",null,0,Je),x()),n&2){let u=Ce(8);h(3),Y("",s.timbreModel!=null&&s.timbreModel.getId()?"MODIFICATION":"AJOUT"," "),h(),_("ngIf",s.timbreModel==null?null:s.timbreModel.getId()),h(),_("ngIf",N(6,4,s.load$)==!1)("ngIfElse",u)}},dependencies:[vt,In,Kt,zt,Pt,$t,Re,Gt,Ai,jt,kt,Ei,_n,Vt,Oi,vn,Tn,ht,Ri,Sn,yn,Mn,Cn,xn,_t,Di,xt,Bn,wn,Co,An,En,So,De],encapsulation:2})};var Bc=rs(ss());var He=class l{constructor(o,n,s,u,f,T,A){this.firestore=o;this.authService=n;this.timbreBlocService=s;this.uploadService=u;this.utilsService=f;this.timbreUtilsService=T;this.dialog=A}total$=new me(0);timbres$=new me(null);load$=new me(!1);modifAll(){let o=new Ie,n=[];for(let s=1849;s<1850;s++)n.push(s);o.setAnnees(n),this.timbreUtilsService.getAllTimbres(o).pipe(F(s=>s?.length>0)).subscribe(s=>{s.forEach(u=>{let f=(0,Bc.cloneDeep)(u);f.imageTable=u.image,f.image=u.imageTable,this.firestore.collection("/timbres").ref.where("id","==",f.id).get().then(T=>{T.forEach(A=>{A.ref.update(f)})})})})}getTimbre(o){return this.firestore.collection("/timbres",n=>n.where("id","==",o)).valueChanges()}getTimbreByIdAsync(o){return ze([this.getTimbre(o),this.timbreBlocService.getBlocsAsync()]).pipe(Ft(([n,s])=>this.timbreUtilsService.constructTimbre(n[0],null,s)))}setTotal(o){this.total$.pipe(F()).subscribe(n=>{this.total$.next(n+o)})}getTotal(o){this.total$.next(null),this.timbreUtilsService.getAllTimbres(o).subscribe(n=>{this.total$.next(n?.length)})}getTimbres(o,n){n&&this.getTotal(),this.timbres$.next(null),this.load$.next(!1),ze([this.timbreUtilsService.getAllTimbres(o),this.getTimbreAcquis(),this.timbreBlocService.getBlocsAsync(o)]).pipe(F()).subscribe(([s,u,f])=>{let T=this.timbreUtilsService.constructTimbres(s,u,f,o);T?.length>0&&(T=T.sort((A,E)=>A.getIdBloc()-E.getIdBloc()).sort((A,E)=>A?.getTimbreBlocModel()?.getNbTimbres()-E?.getTimbreBlocModel()?.getNbTimbres())),this.timbres$.next(T),this.load$.next(!0)})}getTimbreAcquis(){return this.authService.userSelect$.pipe(F(o=>S(o)),so(o=>S(o)?this.getTimbreAcquisByUser(o.getId()).pipe(F(),Ft(n=>n)):null))}getTimbreAcquisByUser(o){return this.firestore.collection("/timbres_acquis",n=>n.where("idUser","==",o)).valueChanges()}ajouterSansId(o){this.utilsService.getMaxIdentAsync("/timbres").pipe(F()).subscribe(n=>{o.setId(n),S(o.getIdBloc())&&o.setMonnaie(null),this.ajouter(o,!0)})}ajouter(o,n){this.getTimbre(o.getId()).pipe(F()).subscribe(s=>{et(s)||et(s[0])||S(s[0])&&s[0]?.length==0?(o.setTimbreAcquisModel(null),o.setTimbreBlocModel(null),this.firestore.collection("/timbres").add(Object.assign(new Object,o)).then(u=>{n&&(this.timbres$.pipe(F()).subscribe(f=>{f.push(o),this.setTotal(1)}),this.timbreUtilsService.reinitResume$.next(!0))}).catch(u=>{console.error("Erreur d'ajout :",u)})):console.error("timbre "+o.getId()+" d\xE9j\xE0 existant")})}modifier(o){o.setTimbreBlocModel(null),o.setTimbreAcquisModel(null),this.firestore.collection("/timbres").ref.where("id","==",o.getId()).get().then(n=>{n.forEach(s=>{s.ref.update(Object.assign(new Object,o)).then(u=>{this.timbres$.pipe(F(f=>S(f)&&f?.length>0)).subscribe(f=>{let T=f.find(A=>A.getId()==o.getId());S(T)&&Object.assign(T,o)})}).catch(u=>{console.error("Erreur de mise \xE0 jour :",u)})})}).catch(n=>{console.error("Erreur de mise \xE0 jour id introuvable :",n)})}supprimerTimbre(o){this.firestore.collection("/timbres").ref.where("id","==",o.getId()).get().then(n=>{n.forEach(s=>{s.ref.delete().then(u=>{this.timbres$.pipe(F()).subscribe(f=>{let T=f.findIndex(A=>A.getId()==o.getId());T>=0&&(f.splice(T,1),this.setTotal(-1))})}).catch(u=>{console.error("Erreur de suppression :",u)})})}).catch(n=>{console.error("Erreur de suppression id introuvable :",n)})}supprimer(o){this.timbreUtilsService.supprimerTimbreAcquis(o),this.supprimerTimbre(o),this.timbreUtilsService.reinitResume$.next(!0)}getBouchon(){let o=new Zt;return o.setAnnee(new Date().getFullYear()),o.setMonnaie("E"),o.setType(""),o.setYt(""),o}upload(o,n,s){let u=100,f=100;return n=="table"?(u=u*(50/f),f=50):n=="zoom"&&(u=u*(700/f),f=700),this.uploadService.processAndUploadImage(o?.getImage(),u,f,S(s)?s:o?.getId(),this.getDossier(o,n))}getDossier(o,n){let s="timbre//";return S(o.getIdBloc())?s=s+o.getTimbreBlocModel().getAnnee():s=s+o.getAnnee(),S(n)&&(s=s+"/"+n),S(o.getIdBloc())&&(s=s+"/bloc/"+o.getIdBloc()),s}acquisDoublon(o,n){this.authService.user$.pipe(F(s=>S(s))).subscribe(s=>{s?.getDroit()>=9?this.timbreUtilsService.acquis(o,n):this.utilsService.droitInsuffisant()})}modifierDialog(o){let n=this.dialog.open(Nn,{height:"75vh",maxHeight:"750px",width:"30%"});n.componentInstance.id=o.getId(),n.afterClosed().subscribe(()=>{n.close()})}supprimerDialog(o){let n=this.dialog.open(Zi,{maxHeight:"95vh",data:{titre:"Confirmation",message:"Souhaitez-vous supprimer le timbre <b>n\xB0 "+o?.getId()+"</b> ?",btnDroite:"Oui",btnGauche:"Non"}});n.afterClosed().subscribe(()=>{n.componentInstance.data.resultat==="valider"&&this.supprimer(o)})}static \u0275fac=function(n){return new(n||l)(be(Bi),be(tt),be(it),be(Rn),be(Ct),be(Se),be(Tt))};static \u0275prov=qt({token:l,factory:l.\u0275fac})};var _e=class extends Ii{annee;total;nombre;acquis;doublon;nombreCarnet;nombreTimbresCarnet;acquisTimbresCarnet;doublonTimbresCarnet;nombreBloc;acquisBloc;doublonBloc;nombreTimbresBloc;acquisTimbresBloc;doublonTimbresBloc;constructor(o,n,s,u,f,T,A,E,J,oe,ae,We,Jt,Ve,Et){super(),this.annee=o||null,this.total=n||0,this.nombre=s||0,this.acquis=u||0,this.doublon=f||0,this.nombreCarnet=T||0,this.nombreTimbresCarnet=A||0,this.acquisTimbresCarnet=E||0,this.doublonTimbresCarnet=J||0,this.nombreBloc=oe||0,this.acquisBloc=ae||0,this.doublonBloc=We||0,this.nombreTimbresBloc=Jt||0,this.acquisTimbresBloc=Ve||0,this.doublonTimbresBloc=Et||0}getAnnee(){return this.annee}setAnnee(o){this.annee=o}getTotal(){return this.total}setTotal(o){this.total=o}getNombre(){return this.nombre}setNombre(o){this.nombre=o}getAcquis(){return this.acquis}setAcquis(o){this.acquis=o}getDoublon(){return this.doublon}setDoublon(o){this.doublon=o}getNombreCarnet(){return this.nombreCarnet}setNombreCarnet(o){this.nombreCarnet=o}getNombreTimbresCarnet(){return this.nombreTimbresCarnet}setNombreTimbresCarnet(o){this.nombreTimbresCarnet=o}getAcquisTimbresCarnet(){return this.acquisTimbresCarnet}setAcquisTimbresCarnet(o){this.acquisTimbresCarnet=o}getDoublonTimbresCarnet(){return this.doublonTimbresCarnet}setDoublonTimbresCarnet(o){this.doublonTimbresCarnet=o}getNombreBloc(){return this.nombreBloc}setNombreBloc(o){this.nombreBloc=o}getAcquisBloc(){return this.acquisBloc}setAcquisBloc(o){this.acquisBloc=o}getDoublonBloc(){return this.doublonBloc}setDoublonBloc(o){this.doublonBloc=o}getNombreTimbresBloc(){return this.nombreTimbresBloc}setNombreTimbresBloc(o){this.nombreTimbresBloc=o}getAcquisTimbresBloc(){return this.acquisTimbresBloc}setAcquisTimbresBloc(o){this.acquisTimbresBloc=o}getDoublonTimbresBloc(){return this.doublonTimbresBloc}setDoublonTimbresBloc(o){this.doublonTimbresBloc=o}};ne([re("Ann\xE9e")],_e.prototype,"annee",2),ne([re("Total")],_e.prototype,"total",2),ne([re("Nombre timbres")],_e.prototype,"nombre",2),ne([re("Total de timbres acquis")],_e.prototype,"acquis",2),ne([re("Total de timbres en doublon")],_e.prototype,"doublon",2),ne([re("Carnet")],_e.prototype,"nombreCarnet",2),ne([re("Timbres carnet")],_e.prototype,"nombreTimbresCarnet",2),ne([re("Total timbres carnet acquis")],_e.prototype,"acquisTimbresCarnet",2),ne([re("Total timbres carnet en doublon")],_e.prototype,"doublonTimbresCarnet",2),ne([re("Bloc")],_e.prototype,"nombreBloc",2),ne([re("Total bloc acquis")],_e.prototype,"acquisBloc",2),ne([re("Total bloc en doublon")],_e.prototype,"doublonBloc",2),ne([re("Timbres bloc")],_e.prototype,"nombreTimbresBloc",2),ne([re("Total timbres bloc acquis")],_e.prototype,"acquisTimbresBloc",2),ne([re("Total timbres bloc en doublon")],_e.prototype,"doublonTimbresBloc",2);var Io=class l{constructor(o,n,s){this.timbreService=o;this.timbreBlocService=n;this.timbreUtilsService=s}load$=new me(!1);timbresResume$=new me(null);totalTimbreResume$=new me(null);getResume(o){this.load$.next(!1),this.timbresResume$.next(null),this.totalTimbreResume$.next(null),ze([this.timbreUtilsService.getAllTimbres(o),this.timbreService.getTimbreAcquis(),this.timbreBlocService.getAllBlocs(o),this.timbreBlocService.getTimbreBlocAcquis()]).pipe(F()).subscribe(([n,s,u,f])=>{this.timbresResume$.next(this.construct(n,s,u,f)),this.timbreUtilsService.reinitResume$.next(!1)})}construct(o,n,s,u){let f=[];if(o?.length>0&&(o.forEach(T=>{let A=T.annee;if(S(s)&&et(T.annee)&&S(T.idBloc)){let oe=s.find(ae=>ae.id==T.idBloc);S(oe)&&(A=oe.annee)}let E=f.find(oe=>oe.getAnnee()==A);et(E)&&(E=new _e,E.setAnnee(A),f.push(E)),E.setTotal(E.getTotal()+1);let J=S(T.idBloc)?s.find(oe=>oe.id==T.idBloc):null;if(S(T.idBloc)?S(J)&&J.carnet?E.setNombreTimbresCarnet(E.getNombreTimbresCarnet()+1):E.setNombreTimbresBloc(E.getNombreTimbresBloc()+1):E.setNombre(E.getNombre()+1),S(n)){let oe=n.find(ae=>ae.idTimbre==T.id);S(oe)&&(oe.acquis==!0&&(S(T.idBloc)?S(J)&&J.carnet?E.setAcquisTimbresCarnet(E.getAcquisTimbresCarnet()+1):E.setAcquisTimbresBloc(E.getAcquisTimbresBloc()+1):E.setAcquis(E.getAcquis()+1)),oe.doublon==!0&&(S(T.idBloc)?S(J)&&J.carnet?E.setDoublonTimbresCarnet(E.getDoublonTimbresCarnet()+1):E.setDoublonTimbresBloc(E.getDoublonTimbresBloc()+1):E.setDoublon(E.getDoublon()+1)))}}),s.forEach(T=>{let A=f.find(E=>E.getAnnee()==T.annee);if(et(A)&&(A=new _e,A.setAnnee(T.annee),f.push(A)),T.carnet?A.setNombreCarnet(A.getNombreCarnet()+1):A.setNombreBloc(A.getNombreBloc()+1),S(u)){let E=u.find(J=>J.idBloc==T.id);S(E)&&(E.acquis==!0&&(T.carnet||A.setAcquisBloc(A.getAcquisBloc()+1)),E.doublon==!0&&(T.carnet||A.setDoublonBloc(A.getDoublonBloc()+1)))}})),S(f)&&f?.length>0){let T=new _e;f.forEach(A=>{T.setTotal(T.getTotal()+A.getTotal()),T.setNombre(T.getNombre()+A.getNombre()),T.setAcquis(T.getAcquis()+A.getAcquis()),T.setDoublon(T.getDoublon()+A.getDoublon()),T.setNombreCarnet(T.getNombreCarnet()+A.getNombreCarnet()),T.setNombreTimbresCarnet(T.getNombreTimbresCarnet()+A.getNombreTimbresCarnet()),T.setAcquisTimbresCarnet(T.getAcquisTimbresCarnet()+A.getAcquisTimbresCarnet()),T.setDoublonTimbresCarnet(T.getDoublonTimbresCarnet()+A.getDoublonTimbresCarnet()),T.setNombreBloc(T.getNombreBloc()+A.getNombreBloc()),T.setAcquisBloc(T.getAcquisBloc()+A.getAcquisBloc()),T.setDoublonBloc(T.getDoublonBloc()+A.getDoublonBloc()),T.setNombreTimbresBloc(T.getNombreTimbresBloc()+A.getNombreTimbresBloc()),T.setAcquisTimbresBloc(T.getAcquisTimbresBloc()+A.getAcquisTimbresBloc()),T.setDoublonTimbresBloc(T.getDoublonTimbresBloc()+A.getDoublonTimbresBloc())}),this.totalTimbreResume$.next(T)}return this.load$.next(!0),f}static \u0275fac=function(n){return new(n||l)(be(He),be(it),be(Se))};static \u0275prov=qt({token:l,factory:l.\u0275fac})};var Ni=class l{constructor(o){this.firestore=o}loadGlob$=new me(!0);load$=new me(!0);supprimer(o,n){return this.load$.next(!1),this.firestore.collection(o).valueChanges().pipe(F()).subscribe(s=>{S(s)&&s?.length>0?s.forEach((u,f)=>{this.firestore.collection(o).ref.where(n,"==",u[n]).get().then(T=>{T.forEach(A=>{A.ref.delete(),f==s.length-1&&this.load$.next(!0)})}).catch(T=>{console.error("Erreur de suppression :",T)})}):this.load$.next(!0)})}supprimerTimbres(o){this.load$.next(!1),this.firestore.collection("/timbres",n=>{let s=n;return s=s.where("annee","==",o),s}).valueChanges().pipe(F()).subscribe(n=>{S(n)&&n?.length>0?n.forEach((s,u)=>{this.firestore.collection("/timbres").ref.where("id","==",s.id).get().then(f=>{f.forEach(T=>{this.supprimerAcquis(s.id),T.ref.delete(),u==n.length-1&&this.load$.next(!0)})}).catch(f=>{console.error("Erreur de suppression :",f)})}):this.load$.next(!0)})}supprimerAcquis(o){this.load$.next(!1),this.firestore.collection("/timbres_acquis",n=>{let s=n;return s=s.where("idTimbre","==",o),s}).valueChanges().pipe(F()).subscribe(n=>{S(n)&&n?.length>0?n.forEach((s,u)=>{this.firestore.collection("/timbres_acquis").ref.where("idTimbre","==",s.idTimbre).get().then(f=>{f.forEach(T=>{T.ref.delete(),u==n.length-1&&this.load$.next(!0)})}).catch(f=>{console.error("Erreur de suppression :",f)})}):this.load$.next(!0)})}supprimerBlocs(o){this.load$.next(!1),this.firestore.collection("/timbres_bloc",n=>{let s=n;return s=s.where("annee","==",o),s}).valueChanges().pipe(F()).subscribe(n=>{S(n)&&n?.length>0?n.forEach((s,u)=>{this.firestore.collection("/timbres_bloc").ref.where("id","==",s.id).get().then(f=>{f.forEach(T=>{this.supprimerBlocsAcquis(s.id),T.ref.delete(),u==n.length-1&&this.load$.next(!0)})}).catch(f=>{console.error("Erreur de suppression :",f)})}):this.load$.next(!0)})}supprimerBlocsAcquis(o){this.load$.next(!1),this.firestore.collection("/timbres_bloc_acquis",n=>{let s=n;return s=s.where("idBloc","==",o),s}).valueChanges().pipe(F()).subscribe(n=>{S(n)&&n?.length>0?n.forEach((s,u)=>{this.firestore.collection("/timbres_bloc_acquis").ref.where("id","==",s.id).get().then(f=>{f.forEach(T=>{T.ref.delete(),u==n.length-1&&this.load$.next(!0)})}).catch(f=>{console.error("Erreur de suppression :",f)})}):this.load$.next(!0)})}static \u0275fac=function(n){return new(n||l)(be(Bi))};static \u0275prov=qt({token:l,factory:l.\u0275fac})};var wo=class l{static \u0275fac=function(n){return new(n||l)};static \u0275mod=uo({type:l});static \u0275inj=ao({providers:[Ni,ku()],imports:[_c,fo,Qu,go,bo,vc,To,ho]})};var Ec=class l{static \u0275fac=function(n){return new(n||l)};static \u0275mod=uo({type:l});static \u0275inj=ao({imports:[fo,go,bo,Xu,Ju,ho,Zu,ic,tc,To,vt,wo,zt,Kt,vo]})};var Rc=l=>({accent50:l});function Qh(l,o){l&1&&k(0,"lib-spinner",2),l&2&&_("textSpec","Chargement en cours ...")}function Zh(l,o){if(l&1&&(v(0,"th",28),k(1,"lib-libelle-model",29),x()),l&2){let n=y(2);h(),_("object",n.timbreResumeModel)("key","annee")}}function Xh(l,o){if(l&1&&(v(0,"td",30),R(1),x()),l&2){let n=o.$implicit;h(),Y(" ",n==null?null:n.getAnnee()," ")}}function Jh(l,o){l&1&&k(0,"td",31)}function e_(l,o){if(l&1&&(v(0,"th",28),k(1,"lib-libelle-model",29),x()),l&2){let n=y(2);h(),_("object",n.timbreResumeModel)("key","total")}}function t_(l,o){if(l&1&&(v(0,"td",30),R(1),x()),l&2){let n=o.$implicit;h(),Y(" ",n==null?null:n.getTotal()," ")}}function i_(l,o){if(l&1&&(v(0,"td",31)(1,"b"),R(2),U(3,"async"),x()()),l&2){let n,s=y(2);h(2),Y("",(n=N(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getTotal()," ")}}function n_(l,o){if(l&1&&(v(0,"th",32),k(1,"lib-libelle-model",29),x()),l&2){let n=y(2);h(),_("object",n.timbreResumeModel)("key","nombre")}}function r_(l,o){if(l&1&&(v(0,"td",33),R(1),x()),l&2){let n=o.$implicit;h(),Y(" ",n==null?null:n.getNombre()," ")}}function o_(l,o){if(l&1&&(v(0,"td",31)(1,"b"),R(2),U(3,"async"),x()()),l&2){let n,s=y(2);h(2),Y("",(n=N(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombre()," ")}}function l_(l,o){if(l&1&&(v(0,"th",32),k(1,"lib-icon",34),x()),l&2){let n=y(2);h(),_("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK)("info",n.timbreResumeModel.getPropertyLibelle("acquis"))}}function s_(l,o){if(l&1&&(v(0,"td",35),R(1),x()),l&2){let n=o.$implicit;_("ngClass",lr(2,Rc,(n==null?null:n.getNombre())==(n==null?null:n.getAcquis()))),h(),Y(" ",n==null?null:n.getAcquis()," ")}}function a_(l,o){if(l&1&&(v(0,"td",31)(1,"b"),R(2),U(3,"async"),x()()),l&2){let n,s=y(2);h(2),Y("",(n=N(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquis()," ")}}function u_(l,o){if(l&1&&(v(0,"th",32),k(1,"lib-icon",34),x()),l&2){let n=y(2);h(),_("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK_DOUBLE)("info",n.timbreResumeModel.getPropertyLibelle("doublon"))}}function c_(l,o){if(l&1&&(v(0,"td",35),R(1),x()),l&2){let n=o.$implicit;_("ngClass",lr(2,Rc,(n==null?null:n.getNombre())==(n==null?null:n.getDoublon()))),h(),Y(" ",n==null?null:n.getDoublon()," ")}}function m_(l,o){if(l&1&&(v(0,"td",31)(1,"b"),R(2),U(3,"async"),x()()),l&2){let n,s=y(2);h(2),Y("",(n=N(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getDoublon()," ")}}function f_(l,o){if(l&1&&(v(0,"th",32),k(1,"lib-libelle-model",29),x()),l&2){let n=y(2);h(),_("object",n.timbreResumeModel)("key","nombreCarnet")}}function p_(l,o){if(l&1&&(v(0,"td",35),R(1),x()),l&2){let n=o.$implicit;_("ngClass",(n==null?null:n.getNombreCarnet())==0?"gray25":"primary25"),h(),Y(" ",(n==null?null:n.getNombreCarnet())>0?n==null?null:n.getNombreCarnet():""," ")}}function d_(l,o){if(l&1&&(v(0,"td",31)(1,"b"),R(2),U(3,"async"),x()()),l&2){let n,s=y(2);h(2),Y("",(n=N(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombreCarnet()," ")}}function g_(l,o){if(l&1&&(v(0,"th",32),k(1,"lib-libelle-model",29),x()),l&2){let n=y(2);h(),_("object",n.timbreResumeModel)("key","nombreTimbresCarnet")}}function b_(l,o){if(l&1&&(v(0,"td",35),R(1),x()),l&2){let n=o.$implicit;_("ngClass",(n==null?null:n.getNombreCarnet())==0?"gray25":"primary25"),h(),Y(" ",(n==null?null:n.getNombreCarnet())>0?n==null?null:n.getNombreTimbresCarnet():""," ")}}function h_(l,o){if(l&1&&(v(0,"td",31)(1,"b"),R(2),U(3,"async"),x()()),l&2){let n,s=y(2);h(2),Y("",(n=N(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombreTimbresCarnet()," ")}}function __(l,o){if(l&1&&(v(0,"th",32),k(1,"lib-icon",34),x()),l&2){let n=y(2);h(),_("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK)("info",n.timbreResumeModel.getPropertyLibelle("acquisTimbresCarnet"))}}function v_(l,o){if(l&1&&(v(0,"td",35),R(1),x()),l&2){let n=o.$implicit;_("ngClass",(n==null?null:n.getNombreTimbresCarnet())==0?"gray25":(n==null?null:n.getNombreTimbresCarnet())==(n==null?null:n.getAcquisTimbresCarnet())?"accent50":"primary25"),h(),Y(" ",(n==null?null:n.getNombreCarnet())>0?n==null?null:n.getAcquisTimbresCarnet():""," ")}}function T_(l,o){if(l&1&&(v(0,"td",31)(1,"b"),R(2),U(3,"async"),x()()),l&2){let n,s=y(2);h(2),Y("",(n=N(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquisTimbresCarnet()," ")}}function x_(l,o){if(l&1&&(v(0,"th",32),k(1,"lib-icon",34),x()),l&2){let n=y(2);h(),_("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK_DOUBLE)("info",n.timbreResumeModel.getPropertyLibelle("doublonTimbresCarnet"))}}function C_(l,o){if(l&1&&(v(0,"td",35),R(1),x()),l&2){let n=o.$implicit;_("ngClass",(n==null?null:n.getNombreTimbresCarnet())==0?"gray25":(n==null?null:n.getNombreTimbresCarnet())==(n==null?null:n.getDoublonTimbresCarnet())?"accent50":"primary25"),h(),Y(" ",(n==null?null:n.getNombreCarnet())>0?n==null?null:n.getDoublonTimbresCarnet():""," ")}}function S_(l,o){if(l&1&&(v(0,"td",31)(1,"b"),R(2),U(3,"async"),x()()),l&2){let n,s=y(2);h(2),Y("",(n=N(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getDoublonTimbresCarnet()," ")}}function y_(l,o){if(l&1&&(v(0,"th",32),k(1,"lib-libelle-model",29),x()),l&2){let n=y(2);h(),_("object",n.timbreResumeModel)("key","nombreBloc")}}function M_(l,o){if(l&1&&(v(0,"td",35),R(1),x()),l&2){let n=o.$implicit;_("ngClass",(n==null?null:n.getNombreBloc())==0?"gray25":""),h(),Y(" ",(n==null?null:n.getNombreBloc())>0?n==null?null:n.getNombreBloc():""," ")}}function I_(l,o){if(l&1&&(v(0,"td",31)(1,"b"),R(2),U(3,"async"),x()()),l&2){let n,s=y(2);h(2),Y("",(n=N(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombreBloc()," ")}}function w_(l,o){if(l&1&&(v(0,"th",32),k(1,"lib-icon",34),x()),l&2){let n=y(2);h(),_("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK)("info",n.timbreResumeModel.getPropertyLibelle("acquisBloc"))}}function B_(l,o){if(l&1&&(v(0,"td",35),R(1),x()),l&2){let n=o.$implicit;_("ngClass",(n==null?null:n.getNombreBloc())==0?"gray25":n.getNombreBloc()==(n==null?null:n.getAcquisBloc())?"accent50":""),h(),Y(" ",(n==null?null:n.getNombreBloc())>0?n==null?null:n.getAcquisBloc():""," ")}}function A_(l,o){if(l&1&&(v(0,"td",31)(1,"b"),R(2),U(3,"async"),x()()),l&2){let n,s=y(2);h(2),Y("",(n=N(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquisBloc()," ")}}function E_(l,o){if(l&1&&(v(0,"th",32),k(1,"lib-icon",34),x()),l&2){let n=y(2);h(),_("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK_DOUBLE)("info",n.timbreResumeModel.getPropertyLibelle("doublonBloc"))}}function R_(l,o){if(l&1&&(v(0,"td",35),R(1),x()),l&2){let n=o.$implicit;_("ngClass",(n==null?null:n.getNombreBloc())==0?"gray25":n.getNombreBloc()==(n==null?null:n.getDoublonBloc())?"accent50":""),h(),Y(" ",(n==null?null:n.getNombreBloc())>0?n==null?null:n.getDoublonBloc():""," ")}}function D_(l,o){if(l&1&&(v(0,"td",31)(1,"b"),R(2),U(3,"async"),x()()),l&2){let n,s=y(2);h(2),Y("",(n=N(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getDoublonBloc()," ")}}function O_(l,o){if(l&1&&(v(0,"th",32),k(1,"lib-libelle-model",29),x()),l&2){let n=y(2);h(),_("object",n.timbreResumeModel)("key","nombreTimbresBloc")}}function L_(l,o){if(l&1&&(v(0,"td",35),R(1),x()),l&2){let n=o.$implicit;_("ngClass",(n==null?null:n.getNombreTimbresBloc())==0?"gray25":"primary25"),h(),Y(" ",(n==null?null:n.getNombreTimbresBloc())>0?n==null?null:n.getNombreTimbresBloc():""," ")}}function U_(l,o){if(l&1&&(v(0,"td",31)(1,"b"),R(2),U(3,"async"),x()()),l&2){let n,s=y(2);h(2),Y("",(n=N(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombreTimbresBloc()," ")}}function N_(l,o){if(l&1&&(v(0,"th",32),k(1,"lib-icon",34),x()),l&2){let n=y(2);h(),_("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK)("info",n.timbreResumeModel.getPropertyLibelle("acquisTimbresBloc"))}}function F_(l,o){if(l&1&&(v(0,"td",35),R(1),x()),l&2){let n=o.$implicit;_("ngClass",(n==null?null:n.getNombreTimbresBloc())==0?"gray25":(n==null?null:n.getNombreTimbresBloc())==(n==null?null:n.getAcquisTimbresBloc())?"accent50":"primary25"),h(),Y(" ",(n==null?null:n.getNombreTimbresBloc())>0?n==null?null:n.getAcquisTimbresBloc():""," ")}}function q_(l,o){if(l&1&&(v(0,"td",31)(1,"b"),R(2),U(3,"async"),x()()),l&2){let n,s=y(2);h(2),Y("",(n=N(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquisTimbresBloc()," ")}}function P_(l,o){if(l&1&&(v(0,"th",32),k(1,"lib-icon",34),x()),l&2){let n=y(2);h(),_("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK_DOUBLE)("info",n.timbreResumeModel.getPropertyLibelle("doublonTimbresBloc"))}}function $_(l,o){if(l&1&&(v(0,"td",35),R(1),x()),l&2){let n=o.$implicit;_("ngClass",(n==null?null:n.getNombreTimbresBloc())==0?"gray25":(n==null?null:n.getNombreTimbresBloc())==(n==null?null:n.getDoublonTimbresBloc())?"accent50":"primary25"),h(),Y(" ",(n==null?null:n.getNombreTimbresBloc())>0?n==null?null:n.getDoublonTimbresBloc():""," ")}}function H_(l,o){if(l&1&&(v(0,"td",31)(1,"b"),R(2),U(3,"async"),x()()),l&2){let n,s=y(2);h(2),Y("",(n=N(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getDoublonTimbresBloc()," ")}}function W_(l,o){l&1&&k(0,"tr",36)}function V_(l,o){if(l&1){let n=se();v(0,"tr",37),j("click",function(){let u=q(n).$implicit,f=y(2);return P(f.filtreParAnnee(u))}),x()}}function G_(l,o){l&1&&k(0,"tr",38)}function k_(l,o){if(l&1){let n=se();v(0,"table",3),j("matSortChange",function(u){q(n);let f=y();return P(f.sortData(u))}),Te(1,4),L(2,Zh,2,2,"th",5)(3,Xh,2,1,"td",6)(4,Jh,1,0,"td",7),xe(),Te(5,8),L(6,e_,2,2,"th",5)(7,t_,2,1,"td",6)(8,i_,4,3,"td",7),xe(),Te(9,9),L(10,n_,2,2,"th",10)(11,r_,2,1,"td",11)(12,o_,4,3,"td",7),xe(),Te(13,12),L(14,l_,2,3,"th",10)(15,s_,2,4,"td",13)(16,a_,4,3,"td",7),xe(),Te(17,14),L(18,u_,2,3,"th",10)(19,c_,2,4,"td",13)(20,m_,4,3,"td",7),xe(),Te(21,15),L(22,f_,2,2,"th",10)(23,p_,2,2,"td",13)(24,d_,4,3,"td",7),xe(),Te(25,16),L(26,g_,2,2,"th",10)(27,b_,2,2,"td",13)(28,h_,4,3,"td",7),xe(),Te(29,17),L(30,__,2,3,"th",10)(31,v_,2,2,"td",13)(32,T_,4,3,"td",7),xe(),Te(33,18),L(34,x_,2,3,"th",10)(35,C_,2,2,"td",13)(36,S_,4,3,"td",7),xe(),Te(37,19),L(38,y_,2,2,"th",10)(39,M_,2,2,"td",13)(40,I_,4,3,"td",7),xe(),Te(41,20),L(42,w_,2,3,"th",10)(43,B_,2,2,"td",13)(44,A_,4,3,"td",7),xe(),Te(45,21),L(46,E_,2,3,"th",10)(47,R_,2,2,"td",13)(48,D_,4,3,"td",7),xe(),Te(49,22),L(50,O_,2,2,"th",10)(51,L_,2,2,"td",13)(52,U_,4,3,"td",7),xe(),Te(53,23),L(54,N_,2,3,"th",10)(55,F_,2,2,"td",13)(56,q_,4,3,"td",7),xe(),Te(57,24),L(58,P_,2,3,"th",10)(59,$_,2,2,"td",13)(60,H_,4,3,"td",7),xe(),L(61,W_,1,0,"tr",25)(62,V_,1,0,"tr",26)(63,G_,1,0,"tr",27),x()}if(l&2){let n=y();_("dataSource",n.dataSource),h(61),_("matHeaderRowDef",n.displayedColumns)("matHeaderRowDefSticky",!0),h(),_("matRowDefColumns",n.displayedColumns),h(),_("matFooterRowDef",n.displayedColumns)("matFooterRowDefSticky",!0)}}var Bo=class l{constructor(o,n,s,u){this.dialogRef=o;this.timbreResumeService=n;this.timbreService=s;this.timbreUtilsService=u;this.dataSource=new os([])}paginator;sort;dataSource=new os;displayedColumns=["annee","total","nombre","acquis","doublon","nombreCarnet","nombreTimbresCarnet","acquisTimbresCarnet","doublonTimbresCarnet","nombreBloc","acquisBloc","doublonBloc","nombreTimbresBloc","acquisTimbresBloc","doublonTimbresBloc"];timbreResumeModel=new _e;FontAwesomeEnum=Wt;FontAwesomeTypeEnum=Ht;ngOnInit(){this.timbreUtilsService.reinitResume$.pipe(F()).subscribe(o=>{o==!0&&this.timbreResumeService.getResume(),this.initData()})}initData(){this.timbreResumeService.timbresResume$.pipe(F(o=>S(o)&&o?.length>0)).subscribe(o=>{this.dataSource.data=o})}ngAfterViewInit(){this.dataSource.paginator=this.paginator}sortData(o){S(o)&&(this.dataSource.sort=this.sort)}filtreParAnnee(o){this.timbreUtilsService.timbreCritereModel=new Ie,this.timbreUtilsService.timbreCritereModel.setAnnees([o.getAnnee()]),this.timbreService.getTimbres(this.timbreUtilsService.timbreCritereModel,!1),this.dialogRef.close()}static \u0275fac=function(n){return new(n||l)(W(Yt),W(Io),W(He),W(Se))};static \u0275cmp=we({type:l,selectors:[["app-timbre-resume"]],viewQuery:function(n,s){if(n&1&&(zi(nc,5),zi(_o,5)),n&2){let u;Yi(u=Ki())&&(s.paginator=u.first),Yi(u=Ki())&&(s.sort=u.first)}},decls:4,vars:4,consts:[["load",""],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["mat-table","","matSort","",3,"matSortChange","dataSource"],["matColumnDef","annee","sticky",""],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","primary50",4,"matCellDef"],["mat-footer-cell","",4,"matFooterCellDef"],["matColumnDef","total","sticky",""],["matColumnDef","nombre"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","acquis"],["mat-cell","",3,"ngClass",4,"matCellDef"],["matColumnDef","doublon"],["matColumnDef","nombreCarnet"],["matColumnDef","nombreTimbresCarnet"],["matColumnDef","acquisTimbresCarnet"],["matColumnDef","doublonTimbresCarnet"],["matColumnDef","nombreBloc"],["matColumnDef","acquisBloc"],["matColumnDef","doublonBloc"],["matColumnDef","nombreTimbresBloc"],["matColumnDef","acquisTimbresBloc"],["matColumnDef","doublonTimbresBloc"],["mat-header-row","","class","bg-primary color-white",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","mat-row",3,"click",4,"matRowDef","matRowDefColumns"],["mat-footer-row","","class","bg-primary color-white",4,"matFooterRowDef","matFooterRowDefSticky"],["mat-header-cell","","mat-sort-header",""],[3,"object","key"],["mat-cell","",1,"primary50"],["mat-footer-cell",""],["mat-header-cell",""],["mat-cell",""],[1,"click",2,"font-size","1.2em",3,"type","icone","info"],["mat-cell","",3,"ngClass"],["mat-header-row","",1,"bg-primary","color-white"],["mat-row","",1,"mat-row",3,"click"],["mat-footer-row","",1,"bg-primary","color-white"]],template:function(n,s){if(n&1&&(L(0,Qh,1,1,"ng-template",1),U(1,"async"),L(2,k_,64,6,"ng-template",null,0,Je)),n&2){let u=Ce(3);_("ngIf",N(1,2,s.timbreResumeService.load$)==!1)("ngIfElse",u)}},dependencies:[rc,lc,fc,ac,oc,dc,sc,pc,uc,mc,cc,gc,hc,bc,_o,vo,Pt,Re,kt,Vt,xt,Qt,Bn,De],styles:["th[_ngcontent-%COMP%], tr[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{text-align:center}th[_ngcontent-%COMP%]{width:40px!important;max-width:40px!important}.mat-row[_ngcontent-%COMP%]{padding:0!important;height:30px}.mat-row[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{width:40px!important}@media screen and (max-width: 800px){th[_ngcontent-%COMP%]{width:25px!important;max-width:25px!important}.mat-row[_ngcontent-%COMP%]{padding:0!important;height:15px}.mat-row[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{width:25px!important}th[_ngcontent-%COMP%], .mat-row[_ngcontent-%COMP%]{font-size:.8em}}"]})};var Dc=rs(Rh());function j_(l,o){if(l&1&&(v(0,"mat-option",4),R(1),x()),l&2){let n=o.$implicit;_("value",n),h(),Y(" ",n," ")}}function z_(l,o){if(l&1){let n=se();v(0,"div",1)(1,"div",2)(2,"mat-select",3),Ee("ngModelChange",function(u){q(n);let f=y();return Ae(f.timbreUtilsService.timbreCritereModel.acquis,u)||(f.timbreUtilsService.timbreCritereModel.acquis=u),P(u)}),j("ngModelChange",function(){q(n);let u=y();return P(u.filtreByCritere())}),v(3,"mat-option",4),R(4," Oui"),x(),v(5,"mat-option",4),R(6," Non"),x(),v(7,"mat-option",4),R(8," Tous"),x()()(),v(9,"div",2)(10,"mat-select",5),Ee("ngModelChange",function(u){q(n);let f=y();return Ae(f.timbreUtilsService.timbreCritereModel.doublon,u)||(f.timbreUtilsService.timbreCritereModel.doublon=u),P(u)}),j("ngModelChange",function(){q(n);let u=y();return P(u.filtreByCritere())}),v(11,"mat-option",4),R(12," Oui"),x(),v(13,"mat-option",4),R(14," Non"),x(),v(15,"mat-option",4),R(16," Tous"),x()()(),v(17,"div",2)(18,"mat-select",6),Ee("ngModelChange",function(u){q(n);let f=y();return Ae(f.timbreUtilsService.timbreCritereModel.carnet,u)||(f.timbreUtilsService.timbreCritereModel.carnet=u),P(u)}),j("ngModelChange",function(){q(n);let u=y();return P(u.filtreByCritere())}),v(19,"mat-option",4),R(20," Oui"),x(),v(21,"mat-option",4),R(22," Non"),x(),v(23,"mat-option",4),R(24," Tous"),x()()(),v(25,"div",2)(26,"mat-select",7),Ee("ngModelChange",function(u){q(n);let f=y();return Ae(f.timbreUtilsService.timbreCritereModel.bloc,u)||(f.timbreUtilsService.timbreCritereModel.bloc=u),P(u)}),j("ngModelChange",function(){q(n);let u=y();return P(u.filtreByCritere())}),v(27,"mat-option",4),R(28," Oui"),x(),v(29,"mat-option",4),R(30," Non"),x(),v(31,"mat-option",4),R(32," Tous"),x()()(),v(33,"div",8)(34,"mat-select",9),Ee("ngModelChange",function(u){q(n);let f=y();return Ae(f.timbreUtilsService.timbreCritereModel.annees,u)||(f.timbreUtilsService.timbreCritereModel.annees=u),P(u)}),j("ngModelChange",function(){q(n);let u=y();return P(u.filtreByCritere())}),L(35,j_,2,2,"mat-option",10),U(36,"async"),x()()()}if(l&2){let n=y();h(2),Be("ngModel",n.timbreUtilsService.timbreCritereModel.acquis),_("placeholder","Acquis"),h(),_("value","OUI"),h(2),_("value","NON"),h(2),_("value","TOUS"),h(3),Be("ngModel",n.timbreUtilsService.timbreCritereModel.doublon),_("placeholder","Doublon"),h(),_("value","OUI"),h(2),_("value","NON"),h(2),_("value","TOUS"),h(3),Be("ngModel",n.timbreUtilsService.timbreCritereModel.carnet),_("placeholder","Carnet"),h(),_("value","OUI"),h(2),_("value","NON"),h(2),_("value","TOUS"),h(3),Be("ngModel",n.timbreUtilsService.timbreCritereModel.bloc),_("placeholder","Bloc"),h(),_("value","OUI"),h(2),_("value","NON"),h(2),_("value","TOUS"),h(3),Be("ngModel",n.timbreUtilsService.timbreCritereModel.annees),_("placeholder","Ann\xE9es"),h(),_("ngForOf",N(36,23,n.annees$))}}var Eo=class l{constructor(o,n,s){this.authService=o;this.timbreService=n;this.timbreUtilsService=s}modif=!0;annees$;ngOnInit(){this.annees$=this.timbreUtilsService.getAnneesAsync("/timbres")}filtreByCritere(){this.timbreUtilsService.timbreCritereModel.getCarnet()!="TOUS"&&this.timbreUtilsService.timbreCritereModel.setBloc("OUI"),this.timbreUtilsService.timbreCritereModel.getAcquis()=="NON"&&this.timbreUtilsService.timbreCritereModel.setDoublon("TOUS"),S(this.timbreUtilsService.timbreCritereModel.getAnnees())&&this.timbreUtilsService.timbreCritereModel.getAnnees().length>0&&this.timbreService.getTimbres(this.timbreUtilsService.timbreCritereModel,!1)}static \u0275fac=function(n){return new(n||l)(W(tt),W(He),W(Se))};static \u0275cmp=we({type:l,selectors:[["app-timbre-recherche"]],inputs:{modif:"modif"},decls:1,vars:1,consts:[["class","menuRecherche",4,"ngIf"],[1,"menuRecherche"],[1,"form-input","select",2,"width","100px"],["name","acquis",3,"ngModelChange","ngModel","placeholder"],[1,"selectMin",3,"value"],["name","doublon",1,"scrollBarAccent",3,"ngModelChange","ngModel","placeholder"],["name","carnet",1,"scrollBarAccent",3,"ngModelChange","ngModel","placeholder"],["name","bloc",1,"scrollBarAccent",3,"ngModelChange","ngModel","placeholder"],[1,"form-input","select",2,"width","150px"],["name","anneeSelect","multiple","",3,"ngModelChange","ngModel","placeholder"],["class","selectMin",3,"value",4,"ngFor","ngForOf"]],template:function(n,s){n&1&&L(0,z_,37,25,"div",0),n&2&&_("ngIf",s.modif)},dependencies:[Kt,zt,$t,Re,ht,_t,De],styles:[".menuRecherche[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:left;width:100%}.menuRecherche[_ngcontent-%COMP%] > .form-input[_ngcontent-%COMP%]{margin:0 10px;display:flex;flex-direction:column;justify-content:space-between;align-items:stretch}@media screen and (max-width: 800px){.menuRecherche[_ngcontent-%COMP%] > .form-input[_ngcontent-%COMP%]{margin:5px 10px}}"]})};function K_(l,o){if(l&1&&(v(0,"div",3)(1,"span"),R(2,"Nombre de timbres : "),x(),v(3,"span",4),R(4),U(5,"async"),x()()),l&2){let n=y();h(4),mo(N(5,1,n.total$))}}var Ro=class l{constructor(o){this.dialog=o}total$;FontAwesomeEnum=Wt;FontAwesomeTypeEnum=Ht;resume(){this.dialog.open(Bo,{height:"auto",maxHeight:"95vh",width:"1000px"})}static \u0275fac=function(n){return new(n||l)(W(Tt))};static \u0275cmp=we({type:l,selectors:[["app-timbre-total"]],inputs:{total$:"total$"},decls:4,vars:6,consts:[[1,"timbreTotal"],["class","nbTimbre",4,"ngIf"],[1,"accent","click",3,"click","icone","type","info"],[1,"nbTimbre"],[1,"bold"]],template:function(n,s){n&1&&(v(0,"div",0),L(1,K_,6,3,"div",1),U(2,"async"),v(3,"lib-icon",2),j("click",function(){return s.resume()}),x()()),n&2&&(h(),_("ngIf",N(2,4,s.total$)),h(2),_("icone",s.FontAwesomeEnum.CHART_LINE_UP)("type",s.FontAwesomeTypeEnum.TYPE_SOLID)("info","D\xE9tail par ann\xE9e"))},dependencies:[Re,Qt,De],styles:[".timbreTotal[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:start;align-content:center;gap:10px}.timbreTotal[_ngcontent-%COMP%]   .nbTimbre[_ngcontent-%COMP%]{font-size:1.2em}.timbreTotal[_ngcontent-%COMP%]   lib-icon[_ngcontent-%COMP%]{font-size:1.5em}@media screen and (max-width: 800px){.timbreTotal[_ngcontent-%COMP%]{height:25px;gap:5px}.timbreTotal[_ngcontent-%COMP%]   .nbTimbre[_ngcontent-%COMP%]{font-size:1em}.timbreTotal[_ngcontent-%COMP%]   lib-icon[_ngcontent-%COMP%]{font-size:1.2em}}"]})};function Z_(l,o){if(l&1){let n=se();v(0,"img",21),j("click",function(){q(n);let u=y().$implicit,f=y();return P(f.utilsService.zoom(u==null?null:u.getImageZoom()))}),x()}if(l&2){let n=y().$implicit;_("src",n==null?null:n.getImage(),co)}}function X_(l,o){if(l&1&&R(0),l&2){let n,s=y().$implicit;Y(" ",s==null||(n=s.getTimbreBlocModel())==null?null:n.getAnnee()," ")}}function J_(l,o){if(l&1&&R(0),l&2){let n=y().$implicit;Y(" ",n==null?null:n.getAnnee()," ")}}function e1(l,o){if(l&1){let n=se();v(0,"lib-icon",22),j("click",function(){let u;q(n);let f=y().$implicit,T=y();return P(T.utilsService.zoom(f==null||(u=f.getTimbreBlocModel())==null?null:u.getImageZoom()))}),x()}if(l&2){let n,s=y().$implicit,u=y();_("classIcone","primary")("type",u.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",u.FontAwesomeEnum.IMAGE_POLAROID)("classInfo","imageHoverBloc")("info","<img src='"+(s==null||(n=s.getTimbreBlocModel())==null?null:n.getImageZoom())+"'/>")}}function t1(l,o){if(l&1&&k(0,"lib-icon",23),l&2){let n=y().$implicit,s=y();_("classIcone","primary")("type",s.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",s.FontAwesomeEnum.CIRCLE_INFO)("info",n==null?null:n.getYt())}}function i1(l,o){if(l&1){let n=se();v(0,"div",8)(1,"div",9)(2,"div",10)(3,"lib-icon",11),j("click",function(){let u=q(n).$implicit,f=y();return P(f.timbreService.acquisDoublon(u,!1))}),x(),v(4,"lib-icon",11),j("click",function(){let u=q(n).$implicit,f=y();return P(f.timbreService.acquisDoublon(u,!0))}),x()(),v(5,"div",12)(6,"lib-icon",13),j("click",function(){let u=q(n).$implicit,f=y();return P(f.timbreService.modifierDialog(u))}),x(),v(7,"lib-icon",13),j("click",function(){let u=q(n).$implicit,f=y();return P(f.timbreService.supprimerDialog(u))}),x()()(),v(8,"div",14),L(9,Z_,1,1,"img",15),x(),v(10,"div",16),L(11,X_,1,1,"ng-template",17)(12,J_,1,1,"ng-template",null,0,Je),v(14,"div",18),L(15,e1,1,5,"lib-icon",19)(16,t1,1,4,"lib-icon",20),x()()()}if(l&2){let n,s,u,f,T,A,E=o.$implicit,J=Ce(13),oe=y();h(3),_("classIcone",!(E==null||(n=E.getTimbreAcquisModel())==null)&&n.isAcquis()?"accent":"primary")("type",oe.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",!(E==null||(s=E.getTimbreAcquisModel())==null)&&s.isAcquis()?oe.FontAwesomeEnum.CIRCLE_MINUS:oe.FontAwesomeEnum.CIRCLE_PLUS)("info",!(E==null||(u=E.getTimbreAcquisModel())==null)&&u.isAcquis()?"pas acquis":"acquis"),h(),_("classIcone",!(E==null||(f=E.getTimbreAcquisModel())==null)&&f.isDoublon()?"accent":"primary")("type",oe.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",!(E==null||(T=E.getTimbreAcquisModel())==null)&&T.isDoublon()?oe.FontAwesomeEnum.CIRCLE_MINUS:oe.FontAwesomeEnum.CIRCLE_PLUS)("info",!(E==null||(A=E.getTimbreAcquisModel())==null)&&A.isDoublon()?"pas en double":"en double"),h(2),_("type",oe.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",oe.FontAwesomeEnum.PENCIL)("info","Modifier"),h(),_("type",oe.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",oe.FontAwesomeEnum.TRASH)("info","Supprimer"),h(2),_("ngIf",E==null?null:E.getImage()),h(2),_("ngIf",E==null?null:E.getIdBloc())("ngIfElse",J),h(4),_("ngIf",E==null?null:E.getIdBloc()),h(),_("ngIf",E==null?null:E.getYt())}}var Do=class l{constructor(o,n,s,u){this.authService=o;this.timbreService=n;this.timbreUtilsService=s;this.utilsService=u}timbres$;load$;total$;modif=!0;timbre=new Zt;annees$;FontAwesomeEnum=Wt;FontAwesomeTypeEnum=Ht;ngOnInit(){this.annees$=this.timbreUtilsService.getAnneesAsync("/timbres"),this.timbre.setTimbreAcquisModel(new Ye)}static \u0275fac=function(n){return new(n||l)(W(tt),W(He),W(Se),W(Ct))};static \u0275cmp=we({type:l,selectors:[["app-timbre-resultat"]],inputs:{timbres$:"timbres$",load$:"load$",total$:"total$",modif:"modif"},decls:10,vars:12,consts:[["noBloc",""],[1,"responsiveDirection","responsiveMenu"],[3,"total$"],[3,"modif"],[1,"spinner",3,"fxHide","textSpec"],[3,"fxHide"],[1,"listeTimbre","primary"],["class","detailTimbre border-primary",4,"ngFor","ngForOf"],[1,"detailTimbre","border-primary"],[1,"headerTimbre"],[1,"actionTimbre"],[1,"click",3,"click","classIcone","type","icone","info"],[1,"actionTimbre2"],[1,"primary","click",3,"click","type","icone","info"],[1,"imgTimbre"],["class","image click",3,"src","click",4,"ngIf"],[1,"footerTimbre"],[3,"ngIf","ngIfElse"],[1,"infoTimbre"],["class","click",3,"classIcone","type","icone","classInfo","info","click",4,"ngIf"],["class","click",3,"classIcone","type","icone","info",4,"ngIf"],[1,"image","click",3,"click","src"],[1,"click",3,"click","classIcone","type","icone","classInfo","info"],[1,"click",3,"classIcone","type","icone","info"]],template:function(n,s){n&1&&(v(0,"div",1),k(1,"app-timbre-total",2)(2,"app-timbre-recherche",3),x(),k(3,"lib-spinner",4),U(4,"async"),v(5,"section",5),U(6,"async"),v(7,"div",6),L(8,i1,17,19,"div",7),U(9,"async"),x()()),n&2&&(h(),_("total$",s.total$),h(),_("modif",s.modif),h(),_("fxHide",N(4,6,s.load$)==!0)("textSpec","Chargement en cours ..."),h(2),_("fxHide",N(6,8,s.load$)==!1),h(3),_("ngForOf",N(9,10,s.timbres$)))},dependencies:[$t,Re,_n,xt,Qt,Eo,Ro,De],styles:[".spinner[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;align-items:stretch;flex:100%;height:100%}.listeTimbre[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:left;width:100%}.listeTimbre[_ngcontent-%COMP%]   lib-icon[_ngcontent-%COMP%]{font-size:1.2em}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]{margin:10px;width:115px;height:150px;border-radius:10px;border:1px solid;padding:5px 10px;display:flex;flex-direction:column;justify-content:space-between;align-items:stretch}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .headerTimbre[_ngcontent-%COMP%]{height:25px;display:flex;flex-direction:row;justify-content:space-between;align-items:end;width:100%;padding-bottom:5px}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .headerTimbre[_ngcontent-%COMP%]   .actionTimbre[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:start;gap:5px}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .headerTimbre[_ngcontent-%COMP%]   .actionTimbre2[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:end;gap:5px}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .imgTimbre[_ngcontent-%COMP%]{width:100%;display:flex;flex:auto;justify-content:center;align-items:center}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .imgTimbre[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100px;max-height:100px}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .footerTimbre[_ngcontent-%COMP%]{height:25px;display:flex;flex-direction:row;justify-content:space-between;align-items:end;width:100%}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .footerTimbre[_ngcontent-%COMP%]   .infoTimbre[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:end;align-items:end;gap:5px}@media screen and (max-width: 800px){.listeTimbre[_ngcontent-%COMP%]{justify-content:space-evenly}}"]})};function r1(l,o){if(l&1&&(k(0,"lib-spinner",5),U(1,"async")),l&2){let n=y();_("textSpec",N(1,1,n.messageLoad$))}}function o1(l,o){if(l&1&&(k(0,"mat-error",16),U(1,"async")),l&2){let n=y(2);_("innerHTML",N(1,1,n.messageError$),hn)}}function l1(l,o){if(l&1&&k(0,"app-timbre-resultat",17),l&2){let n=y(2);_("load$",n.load$)("timbres$",n.timbres$)("modif",!1)}}function s1(l,o){if(l&1&&(v(0,"mat-option",21),R(1),x()),l&2){let n=o.$implicit;_("value",n),h(),Y(" ",n," ")}}function a1(l,o){if(l&1){let n=se();v(0,"div",18)(1,"mat-select",19),Ee("ngModelChange",function(u){q(n);let f=y(2);return Ae(f.annees,u)||(f.annees=u),P(u)}),L(2,s1,2,2,"mat-option",20),x()()}if(l&2){let n=y(2);h(),Be("ngModel",n.annees),_("placeholder","Ann\xE9es"),h(),_("ngForOf",n.anneesDispo)}}function u1(l,o){l&1&&(v(0,"button",22),R(1," Enregistrer "),x())}function c1(l,o){if(l&1){let n=se();v(0,"form",6,1),j("ngSubmit",function(){q(n);let u=Ce(1),f=y();return P(f.valider(u))}),v(2,"div",7),L(3,o1,2,3,"mat-error",8),U(4,"async"),L(5,l1,1,3,"app-timbre-resultat",9),U(6,"async"),x(),v(7,"div",10),L(8,a1,3,3,"div",11),U(9,"async"),U(10,"async"),v(11,"button",12),j("click",function(){q(n);let u=y();return P(u.close())}),R(12," Annuler "),x(),v(13,"input",13),j("change",function(u){q(n);let f=y();return P(f.onFileChange(u))}),x(),v(14,"button",14),j("click",function(){q(n);let u=y();return P(u.triggerFileInput())}),R(15," Choisir un fichier "),x(),L(16,u1,2,0,"button",15),U(17,"async"),x()()}if(l&2){let n,s,u,f=Ce(1),T=y();_("ngClass",f!=null&&f.submitted?"red-color":"blue-color"),h(3),_("ngIf",N(4,6,T.messageError$)),h(2),_("ngIf",((n=N(6,8,T.timbres$))==null?null:n.length)>0),h(3),_("ngIf",!N(9,10,T.timbres$)||((s=N(10,12,T.timbres$))==null?null:s.length)==0),h(5),Vu("id",T.idFile),h(3),_("ngIf",((u=N(17,14,T.timbres$))==null?null:u.length)>0)}}var Oo=class l{constructor(o,n,s,u,f,T,A){this.authService=o;this.timbreService=n;this.timbreBlocService=s;this.timbreUtilsService=u;this.uploadService=f;this.utilsService=T;this.dialogRef=A}dossier="/assets/images/timbres/";timbres$=new me(null);messageError$=new me(null);messageLoad$=new me("Chargement en cours ...");load$=new me(null);idFile="fileImport";identTimbre=1;identBloc=1;timbresModel=[];timbresBlocsModel=[];anneesDispo=[];annees=[new Date().getFullYear()];ngOnInit(){for(let o=new Date().getFullYear();o>=1900;o--)this.anneesDispo.push(o)}triggerFileInput(){document.getElementById(this.idFile).click()}onFileChange(o){let n=o.target.files[0];n&&(this.load$.next(!1),this.messageLoad$.next("Chargement en cours ..."),this.saveCsv(n))}saveCsv(o){let n=new FileReader;n.onload=()=>{let s=n.result;this.parseCsv(s)},n.readAsText(o)}parseCsv(o){S(this.annees)&&this.annees.length>0&&ze([this.utilsService.getMaxIdentAsync("/timbres"),this.utilsService.getMaxIdentAsync("/timbres_bloc"),this.authService.userSelect$]).pipe(F(([n,s,u])=>S(u))).subscribe(([n,s,u])=>{this.identTimbre=n,this.identBloc=s,this.timbresModel=[],this.timbres$.next(null),Dc.parse(o,{header:!0,skipEmptyLines:!0,complete:f=>{S(f.data)&&f.data?.length>0&&(this.timbresBlocsModel=[],f.data.forEach((T,A)=>{let E=this.setTimbre(T,u);S(E?.getId())&&(this.timbresModel.push(E),this.identTimbre++),A==f.data.length-1&&(this.timbres$.next(this.timbresModel),this.load$.next(!0))}))},error:f=>{console.error("Erreur lors du parsing du CSV :",f)}})})}setTimbre(o,n){let s=new Zt,u=o.CODE!="NULL"&&o.CODE!=""?Number(o.CODE):null,f=o.IDENT_BLOC!="NULL"&&o.IDENT_BLOC!=""&&S(o.IDENT_BLOC)?Number(o.IDENT_BLOC):null,T=o.ANNEE!="NULL"&&o.ANNEE!=""?Number(o.ANNEE):null,A=o.MONNAIE!="NULL"&&o.MONNAIE!=""?o.MONNAIE:null;if(this.annees.includes(T)){s.setId(this.identTimbre),s.setType(o.TYPE!="NULL"&&o.TYPE!=""?o.TYPE:null),s.setYt(o.YT!="NULL"&&o.YT!=""?o.YT:null),s.setAnnee(T);let E=new Ye;E.setIdTimbre(s.getId()),E.setIdUser(n.getId()),E.setAcquis(o.ACQUIS=="1"),E.setDoublon(o.DOUBLON=="1"),s.setTimbreAcquisModel(E);let J=this.dossier+T+"/",oe="";if(S(f)){if(J+="bloc/"+f,oe=J+".png",J+="-",s.setTimbreBlocModel(this.timbresBlocsModel.find(ae=>ae.getAnnee()==T&&ae.idOrigine==f)),et(s.getTimbreBlocModel())){let ae=new Li;ae.setId(this.identBloc),ae.setAnnee(T),ae.setMonnaie(A),ae.setCarnet(o.CARNET=="1"),ae.idOrigine=f;let We=new St;We.setIdBloc(this.identBloc),We.setIdUser(n.getId()),We.setAcquis(o.ACQUIS_BLOC=="1"),We.setDoublon(o.DOUBLON_BLOC=="1"),ae.setTimbreBlocAcquisModel(We),this.uploadService.checkIfImageExists(oe).pipe(F()).subscribe(Jt=>{Jt&&(ae.setImage(oe),ae.setImageTable(oe),ae.setImageZoom(oe))}),this.timbresBlocsModel.push(ae),s.setTimbreBlocModel(ae),this.identBloc++}s.setIdBloc(s.getTimbreBlocModel()?.getId())}else s.setMonnaie(A);J+=u+".png",this.uploadService.checkIfImageExists(J).pipe(F()).subscribe(ae=>{ae&&(s.setImage(J),s.setImageTable(J),s.setImageZoom(J))})}return s}valider(o){this.messageError$.next(null),o?.valid&&(this.load$.next(!1),this.messageLoad$.next("Import en cours ..."),S(this.timbresBlocsModel)&&this.timbresBlocsModel?.length>0&&this.timbresBlocsModel.forEach((n,s)=>{this.saveBloc(n)}),this.timbres$.pipe(F()).subscribe(n=>{if(S(n)&&n?.length>0)n.forEach((s,u)=>{this.saveTimbre(s,u==n.length-1)});else{this.messageError$.next("Donn\xE9es incorrectes");return}}))}saveBloc(o){ze([this.timbreBlocService.upload(o,"autre"),this.timbreBlocService.upload(o,"table"),this.timbreBlocService.upload(o,"zoom")]).pipe(F(([n,s,u])=>S(n)&&S(u)&&S(s))).subscribe(([n,s,u])=>{S(n)&&n!="nok"&&o.setImage(n),S(s)&&s!="nok"&&o.setImageTable(s),S(u)&&u!="nok"&&o.setImageZoom(u),o?.getTimbreBlocAcquisModel()?.isAcquis()&&this.timbreBlocService.addAcquis(o?.getTimbreBlocAcquisModel()?.getIdUser(),o,o?.getTimbreBlocAcquisModel()?.isDoublon()),this.timbreBlocService.ajouter(o,!1)})}saveTimbre(o,n){ze([this.timbreService.upload(o,"autre"),this.timbreService.upload(o,"table"),this.timbreService.upload(o,"zoom")]).pipe(F(([s,u,f])=>S(s)&&S(f)&&S(u))).subscribe(([s,u,f])=>{S(s)&&s!="nok"&&o.setImage(s),S(u)&&u!="nok"&&o.setImageTable(u),S(f)&&f!="nok"&&o.setImageZoom(f),o?.getTimbreAcquisModel()?.isAcquis()&&this.timbreUtilsService.addAcquis(o?.getTimbreAcquisModel()?.getIdUser(),o,o?.getTimbreAcquisModel()?.isDoublon()),this.timbreService.ajouter(o,n),n&&(this.load$.next(!0),this.close())})}close(){this.dialogRef.close()}static \u0275fac=function(n){return new(n||l)(W(tt),W(He),W(it),W(Se),W(Rn),W(Ct),W(Yt))};static \u0275cmp=we({type:l,selectors:[["app-timbre-importer"]],decls:8,vars:4,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","start stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","column","fxLayoutGap","20px",1,"bloc-modal"],[3,"innerHTML",4,"ngIf"],[3,"load$","timbres$","modif",4,"ngIf"],["fxLayout","row","fxLayoutGap","20px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["fxLayout","row","fxLayoutAlign","end center","class","form-input select noError","style","width: 150px",4,"ngIf"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","file","accept",".xls, .xlsx, .csv","hidden","","required","",3,"change","id"],["type","button","mat-raised-button","","color","accent",1,"rounded","large","color-white",3,"click"],["type","submit","class","rounded large color-white","mat-raised-button","","color","accent",4,"ngIf"],[3,"innerHTML"],[3,"load$","timbres$","modif"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input","select","noError",2,"width","150px"],["name","anneeSelect","multiple","",3,"ngModelChange","ngModel","placeholder"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],[1,"selectMin",3,"value"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"]],template:function(n,s){if(n&1&&(v(0,"div",2)(1,"div",3)(2,"span"),R(3,"TIMBRE IMPORTER"),x()(),L(4,r1,2,3,"ng-template",4),U(5,"async"),L(6,c1,18,16,"ng-template",null,0,Je),x()),n&2){let u=Ce(7);h(4),_("ngIf",N(5,2,s.load$)==!1)("ngIfElse",u)}},dependencies:[vt,In,Kt,zt,Pt,$t,Re,Gt,Ai,jt,kt,Ei,Vt,Oi,ht,Ri,_t,Di,xt,Do,De]})};function m1(l,o){l&1&&k(0,"lib-spinner",5),l&2&&_("textSpec","Suppression en cours")}function f1(l,o){if(l&1){let n=se();v(0,"form",6,1),j("ngSubmit",function(){q(n);let u=Ce(1),f=y();return P(f.valider(u))}),v(2,"div",7)(3,"div",8)(4,"input",9),Ee("ngModelChange",function(u){q(n);let f=y();return Ae(f.annee,u)||(f.annee=u),P(u)}),x()(),v(5,"button",10),j("click",function(){q(n);let u=y();return P(u.close())}),R(6," Annuler "),x(),v(7,"button",11),R(8," Supprimer "),x()()()}if(l&2){let n=Ce(1),s=y();_("ngClass",n!=null&&n.submitted?"red-color":"blue-color"),h(4),Be("ngModel",s.annee),_("max",s.maxAnnee)("zMax",s.maxAnnee)}}var Lo=class l{constructor(o,n,s){this.dialog=o;this.dialogRef=n;this.timbreSupprimService=s}maxAnnee=new Date().getFullYear();annee=new Date().getFullYear();valider(o){if(o?.valid){let n=this.dialog.open(Zi,{maxHeight:"95vh",data:{titre:"Confirmation",message:"Souhaitez-vous supprimer les timbres ?",btnDroite:"Oui",btnGauche:"Non"}});n.afterClosed().subscribe(()=>{n.componentInstance.data.resultat==="valider"&&(this.timbreSupprimService.loadGlob$.next(!1),this.timbreSupprimService.supprimerTimbres(this.annee),this.timbreSupprimService.load$.pipe(F(s=>s==!0)).subscribe(s=>{this.timbreSupprimService.supprimerBlocs(this.annee),this.timbreSupprimService.load$.pipe(F(u=>u==!0)).subscribe(u=>{this.timbreSupprimService.loadGlob$.next(!0)})}))})}}close(){this.dialogRef.close()}static \u0275fac=function(n){return new(n||l)(W(Tt),W(Yt),W(Ni))};static \u0275cmp=we({type:l,selectors:[["app-timbre-supprim-choix-annee"]],decls:8,vars:4,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","start stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","row","fxLayoutGap","20px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["fxLayout","column","fxFlex","20","fxLayoutAlign","end end",1,"form-input","noError"],["name","annee","type","number","minlength","4","maxlength","4","min","1900","zMin","1900","required","","zControl","",2,"width","60px !important",3,"ngModelChange","ngModel","max","zMax"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"]],template:function(n,s){if(n&1&&(v(0,"div",2)(1,"div",3)(2,"span"),R(3,"TIMBRE IMPORTER"),x()(),L(4,m1,1,1,"ng-template",4),U(5,"async"),L(6,f1,9,4,"ng-template",null,0,Je),x()),n&2){let u=Ce(7);h(4),_("ngIf",N(5,2,s.timbreSupprimService.loadGlob$)==!1)("ngIfElse",u)}},dependencies:[vt,Pt,Re,Gt,Ai,jt,kt,Ei,Vt,Oi,vn,Tn,ht,Ri,Sn,yn,Mn,Cn,xn,_t,Di,xt,wn,An,En,De],encapsulation:2})};var p1=l=>[l];function d1(l,o){if(l&1){let n=se();v(0,"lib-icon",2),j("click",function(){q(n);let u=y();return P(u.supprimer())}),x()}if(l&2){let n=y();_("icone",n.FontAwesomeEnum.ROTATE)("type",n.FontAwesomeTypeEnum.TYPE_SOLID)("attribs",lr(4,p1,n.FontAwesomeAttributEnum.SPIN))("info","Supprimer en cours")}}function g1(l,o){if(l&1){let n=se();v(0,"lib-icon",3),j("click",function(){q(n);let u=y();return P(u.supprimer())}),x()}if(l&2){let n=y();_("icone",n.FontAwesomeEnum.TRASH)("type",n.FontAwesomeTypeEnum.TYPE_SOLID)("info","Supprimer les timbres")}}var Uo=class l{constructor(o,n){this.dialog=o;this.timbreSupprimService=n}FontAwesomeEnum=Wt;FontAwesomeTypeEnum=Ht;FontAwesomeAttributEnum=zu;supprimer(){this.dialog.open(Lo,{maxHeight:"50vh",width:"300px"})}static \u0275fac=function(n){return new(n||l)(W(Tt),W(Ni))};static \u0275cmp=we({type:l,selectors:[["app-timbre-supprim"]],decls:4,vars:6,consts:[["class","warn click","style","font-size: 2em",3,"icone","type","attribs","info","click",4,"ngIf"],["class","warn click","style","font-size: 2em",3,"icone","type","info","click",4,"ngIf"],[1,"warn","click",2,"font-size","2em",3,"click","icone","type","attribs","info"],[1,"warn","click",2,"font-size","2em",3,"click","icone","type","info"]],template:function(n,s){n&1&&(L(0,d1,1,6,"lib-icon",0),U(1,"async"),L(2,g1,1,3,"lib-icon",1),U(3,"async")),n&2&&(_("ngIf",N(1,2,s.timbreSupprimService.loadGlob$)==!1),h(2),_("ngIf",N(3,4,s.timbreSupprimService.loadGlob$)==!0))},dependencies:[Re,Qt,De],encapsulation:2})};function h1(l,o){if(l&1){let n=se();v(0,"button",9),j("click",function(){q(n);let u=y(2);return P(u.ajouter())}),R(1," Ajouter "),x()}}function _1(l,o){l&1&&(Te(0),R(1,"\xA0Bloc"),xe())}function v1(l,o){if(l&1){let n=se();Te(0),L(1,h1,2,0,"button",8),U(2,"async"),v(3,"button",9),j("click",function(){q(n);let u=y();return P(u.ajouterBloc())}),R(4," Ajouter "),L(5,_1,2,0,"ng-container",3),U(6,"async"),x(),xe()}if(l&2){let n=y();h(),_("ngIf",N(2,2,n.headerService.route$)==n.RouteEnum.TIMBRE),h(4),_("ngIf",N(6,4,n.headerService.route$)==n.RouteEnum.TIMBRE)}}function T1(l,o){if(l&1){let n=se();Te(0),v(1,"lib-icon",11),j("click",function(){let u=q(n).$implicit,f=y(2);return P(f.headerService.setRoute(u.getRoute()))}),x(),xe()}if(l&2){let n=o.$implicit;h(),_("icone",n==null?null:n.getIcone())("type",n==null?null:n.getType())("info",n==null?null:n.getInfo())}}function x1(l,o){if(l&1&&(Te(0),L(1,T1,2,3,"ng-container",10),U(2,"async"),xe()),l&2){let n=y();h(),_("ngForOf",N(2,1,n.headerService.choixRoutesTimbre$))}}function C1(l,o){if(l&1){let n=se();v(0,"lib-icon",13),j("click",function(){q(n);let u=y(2);return P(u.headerService.mode=u.ModeEnum.TABLE)}),x()}if(l&2){let n=y(2);_("icone",n.FontAwesomeEnum.TABLE)("type",n.FontAwesomeTypeEnum.TYPE_SOLID)("info","Mode tableau")}}function S1(l,o){if(l&1){let n=se();v(0,"lib-icon",13),j("click",function(){q(n);let u=y(2);return P(u.headerService.mode=u.ModeEnum.GRAPH)}),x()}if(l&2){let n=y(2);_("icone",n.FontAwesomeEnum.MEMO)("type",n.FontAwesomeTypeEnum.TYPE_SOLID)("info","Mode tableau")}}function y1(l,o){if(l&1&&(Te(0),L(1,C1,1,3,"ng-template",12)(2,S1,1,3,"ng-template",null,0,Je),xe()),l&2){let n=Ce(3),s=y();h(),_("ngIf",s.headerService.mode==s.ModeEnum.GRAPH)("ngIfElse",n)}}function M1(l,o){if(l&1){let n=se();v(0,"lib-icon",14),j("click",function(){q(n);let u=y();return P(u.importer())}),x()}if(l&2){let n=y();_("icone",n.FontAwesomeEnum.UPLOAD)("type",n.FontAwesomeTypeEnum.TYPE_SOLID)("info","Importer les timbres")}}function I1(l,o){l&1&&k(0,"app-timbre-supprim",15)}function w1(l,o){if(l&1&&(v(0,"mat-option",19),R(1),x()),l&2){let n=o.$implicit;_("value",n),h(),Y(" ",n==null?null:n.getPrenom()," ")}}function B1(l,o){if(l&1){let n=se();v(0,"div",16)(1,"mat-select",17),U(2,"async"),j("ngModelChange",function(u){q(n);let f=y();return P(f.setUser(u))}),L(3,w1,2,2,"mat-option",18),U(4,"async"),x()()}if(l&2){let n=y();h(),_("ngModel",N(2,3,n.authService.userSelect$))("placeholder","Utilisateur"),h(2),_("ngForOf",N(4,5,n.authService.users$))}}var Oc=class l{constructor(o,n,s,u,f,T){this.authService=o;this.headerService=n;this.timbreService=s;this.timbreBlocService=u;this.timbreUtilsService=f;this.dialog=T;this.verifRoute()}FontAwesomeEnum=Wt;RouteEnum=ju;FontAwesomeTypeEnum=Ht;DroitEnum=po;ModeEnum=Yu;ajouter(){let o=this.dialog.open(Nn,{maxHeight:"95vh",width:"30%"});o.afterClosed().subscribe(()=>{o.close()})}ajouterBloc(){let o=this.dialog.open(On,{maxHeight:"95vh",width:"30%"});o.afterClosed().subscribe(()=>{o.close()})}ajouterBouchon(){this.timbreService.ajouterSansId(this.timbreService.getBouchon())}importer(){let o=this.dialog.open(Oo,{height:"90vh",width:"70%"});o.afterClosed().subscribe(()=>{o.close()})}verifRoute(){window.location.href.indexOf("bloc")>0?S(this.timbreUtilsService.timbreCritereBlocModel.getAnnees())&&this.timbreUtilsService.timbreCritereBlocModel.getAnnees().length>0?this.timbreBlocService.getBlocs(this.timbreUtilsService.timbreCritereBlocModel,!0):this.timbreUtilsService.getAnneesAsync("/timbres_bloc").pipe(F(o=>S(o)&&o?.length>0)).subscribe(o=>{this.timbreUtilsService.timbreCritereBlocModel.setAnnees([o[0]]),this.timbreBlocService.getBlocs(this.timbreUtilsService.timbreCritereBlocModel,!0)}):S(this.timbreUtilsService.timbreCritereModel.getAnnees())&&this.timbreUtilsService.timbreCritereModel.getAnnees().length>0?this.timbreService.getTimbres(this.timbreUtilsService.timbreCritereModel,!0):this.timbreUtilsService.getAnneesAsync("/timbres").pipe(F(o=>S(o)&&o?.length>0)).subscribe(o=>{this.timbreUtilsService.timbreCritereModel.setAnnees([o[0]]),this.timbreService.getTimbres(this.timbreUtilsService.timbreCritereModel,!0)})}setUser(o){this.authService.userSelect$.next(o),this.verifRoute(),this.timbreUtilsService.reinitResume$.next(!0)}static \u0275fac=function(n){return new(n||l)(W(tt),W(Ku),W(He),W(it),W(Se),W(Tt))};static \u0275cmp=we({type:l,selectors:[["app-menu"]],decls:21,vars:30,consts:[["modeTable",""],[1,"menu"],[1,"sousMenu","sousMenuBouton"],[4,"ngIf"],[1,"sousMenu"],["class","accent click hide-on-mobile","style","font-size: 2em",3,"icone","type","info","click",4,"ngIf"],["class","hide-on-mobile",4,"ngIf"],["fxLayout","row","fxLayoutAlign","end center","class","form-input select","style","width: 120px",4,"ngIf"],["class","rounded large color-white","mat-raised-button","","color","primary",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],[4,"ngFor","ngForOf"],[1,"primary","click",2,"font-size","2em",3,"click","icone","type","info"],[3,"ngIf","ngIfElse"],[1,"primary","click","hide-on-mobile",2,"font-size","2em",3,"click","icone","type","info"],[1,"accent","click","hide-on-mobile",2,"font-size","2em",3,"click","icone","type","info"],[1,"hide-on-mobile"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input","select",2,"width","120px"],["name","user",1,"scrollBarAccent",3,"ngModelChange","ngModel","placeholder"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],[1,"selectMin",3,"value"]],template:function(n,s){if(n&1&&(v(0,"div",1)(1,"div",2),L(2,v1,7,6,"ng-container",3),U(3,"async"),x(),v(4,"div",4),L(5,x1,3,3,"ng-container",3),U(6,"async"),L(7,y1,4,2,"ng-container",3),U(8,"async"),U(9,"async"),U(10,"async"),L(11,M1,1,3,"lib-icon",5),U(12,"async"),U(13,"async"),L(14,I1,1,0,"app-timbre-supprim",6),U(15,"async"),U(16,"async"),L(17,B1,5,7,"div",7),U(18,"async"),U(19,"async"),U(20,"async"),x()()),n&2){let u,f,T,A,E,J;h(2),_("ngIf",((u=N(3,6,s.authService.user$))==null?null:u.getDroit())==s.DroitEnum.TOTAL),h(3),_("ngIf",((f=N(6,8,s.headerService.choixRoutesTimbre$))==null?null:f.length)>0),h(2),_("ngIf",((T=N(8,10,s.authService.user$))==null?null:T.getDroit())==s.DroitEnum.TOTAL&&(N(9,12,s.headerService.route$)==s.RouteEnum.TIMBRE||N(10,14,s.headerService.route$)==s.RouteEnum.BLOC)),h(4),_("ngIf",((A=N(12,16,s.authService.user$))==null?null:A.getDroit())==s.DroitEnum.TOTAL&&N(13,18,s.headerService.route$)==s.RouteEnum.TIMBRE),h(3),_("ngIf",((E=N(15,20,s.authService.user$))==null?null:E.getDroit())==s.DroitEnum.TOTAL&&N(16,22,s.headerService.route$)==s.RouteEnum.TIMBRE),h(3),_("ngIf",(((J=N(18,24,s.authService.user$))==null?null:J.getDroit())==s.DroitEnum.TOTAL||((J=N(19,26,s.authService.user$))==null?null:J.getDroit())==s.DroitEnum.CONSULT_TOTAL)&&((J=N(20,28,s.authService.users$))==null?null:J.length)>0)}},dependencies:[$t,Re,Gt,jt,ht,_t,Qt,vt,Uo,zt,Kt,De],styles:[".menu[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:10px;padding:0 5px}.menu[_ngcontent-%COMP%]   .sousMenu[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:15px}@media screen and (max-width: 800px){.menu[_ngcontent-%COMP%]{flex-direction:column}.menu[_ngcontent-%COMP%]   .sousMenuBouton[_ngcontent-%COMP%]{justify-content:space-between}.menu[_ngcontent-%COMP%]   .sousMenu[_ngcontent-%COMP%]{gap:10px}}"]})};export{St as a,Ye as b,Se as c,it as d,He as e,Eo as f,Io as g,Bo as h,Ro as i,Do as j,Oo as k,Oc as l,Ec as m};

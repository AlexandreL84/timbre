import{a as $t,b as fr,c as Xt}from"./chunk-UC6EBUZB.js";import{a as em,b as tm}from"./chunk-74ALCSYC.js";import{a as Dt,b as Ji,c as Pi,d as nt,e as yo,f as On,g as Ln,h as So,i as Nn,j as q_,k as Mo,q as Im}from"./chunk-NXIDJGTZ.js";import{e as Co,f as en}from"./chunk-BWXLVRTQ.js";import{c as Rn,d as Rt,g as Dn}from"./chunk-ZOS427ZO.js";import{l as le,m as Ri,n as Di,o as Xi,u as Cn,v as Ve}from"./chunk-MRG6BAM3.js";import{a as sm}from"./chunk-QSN6FLEW.js";import{$ as vn,Aa as B,Ab as zt,Ba as ho,Bb as Oi,Bc as vo,Ca as $,Cb as Li,Cc as xo,D as go,Da as Yc,Db as Yt,Dc as pm,Ea as Kc,Eb as Kt,Ec as fm,Fa as Fe,Fc as dm,Ga as Ue,Gb as im,Gc as gm,H as Bi,Ha as Pe,Hb as yn,Hc as bm,I as kc,Ic as _m,Jc as hm,K as Te,Kb as Et,Kc as Tm,La as pr,Lb as Ni,Lc as vm,M as Ce,Mb as Fi,Mc as xm,N as jc,Na as R,Nb as It,Nc as Cm,Oa as D,Ob as Ui,Oc as ym,P as bo,Pa as et,Pb as Sn,Pc as Sm,Qb as Mn,Qc as Mm,Rb as En,Rc as cs,S as H,Sb as In,T as W,Tb as An,Tc as Zt,Ub as wn,Uc as Em,Vb as nm,W as zc,Wb as rm,Xa as Ct,Xb as At,Ya as tt,Yb as om,Za as Se,Zb as lm,aa as xn,ab as Ae,ba as h,bb as Qc,c as be,ca as q,cb as Zc,ha as O,ia as T,jc as Bn,k as jt,kc as it,l as We,lc as am,ma as v,na as x,nc as Qt,oa as G,ob as Xc,pa as ie,pb as S,pc as wt,qa as ne,qb as Oe,sa as se,ta as j,ua as C,uc as cm,va as _o,vb as yt,vc as Bt,wa as gi,wb as St,wc as mm,x as U,xa as bi,xb as Jc,ya as _i,yb as Mt,yc as um,za as ye,zb as To}from"./chunk-BJTW7O66.js";import{d as P_,f as Gc,g as oe}from"./chunk-GOLCFQAC.js";var Um=P_((Hn,vr)=>{(function(){var o,r="4.17.21",n=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",c="Expected a function",p="Invalid `variable` option passed into `_.template`",g="__lodash_hash_undefined__",M=500,L="__lodash_placeholder__",V=1,_e=2,ce=4,rt=1,ii=2,ke=1,Ht=2,Wn=4,ot=8,ni=16,lt=32,ri=64,ft=128,Vn=256,Ho=512,Wm=30,Vm="...",Gm=800,km=16,ps=1,jm=2,zm=3,Wi=1/0,Ti=9007199254740991,Ym=17976931348623157e292,xr=NaN,Wt=4294967295,Km=Wt-1,Qm=Wt>>>1,Zm=[["ary",ft],["bind",ke],["bindKey",Ht],["curry",ot],["curryRight",ni],["flip",Ho],["partial",lt],["partialRight",ri],["rearg",Vn]],on="[object Arguments]",Cr="[object Array]",Xm="[object AsyncFunction]",Gn="[object Boolean]",kn="[object Date]",Jm="[object DOMException]",yr="[object Error]",Sr="[object Function]",fs="[object GeneratorFunction]",Lt="[object Map]",jn="[object Number]",eu="[object Null]",oi="[object Object]",ds="[object Promise]",tu="[object Proxy]",zn="[object RegExp]",Nt="[object Set]",Yn="[object String]",Mr="[object Symbol]",iu="[object Undefined]",Kn="[object WeakMap]",nu="[object WeakSet]",Qn="[object ArrayBuffer]",ln="[object DataView]",Wo="[object Float32Array]",Vo="[object Float64Array]",Go="[object Int8Array]",ko="[object Int16Array]",jo="[object Int32Array]",zo="[object Uint8Array]",Yo="[object Uint8ClampedArray]",Ko="[object Uint16Array]",Qo="[object Uint32Array]",ru=/\b__p \+= '';/g,ou=/\b(__p \+=) '' \+/g,lu=/(__e\(.*?\)|\b__t\)) \+\n'';/g,gs=/&(?:amp|lt|gt|quot|#39);/g,bs=/[&<>"']/g,su=RegExp(gs.source),au=RegExp(bs.source),cu=/<%-([\s\S]+?)%>/g,mu=/<%([\s\S]+?)%>/g,_s=/<%=([\s\S]+?)%>/g,uu=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,pu=/^\w*$/,fu=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Zo=/[\\^$.*+?()[\]{}|]/g,du=RegExp(Zo.source),Xo=/^\s+/,gu=/\s/,bu=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,_u=/\{\n\/\* \[wrapped with (.+)\] \*/,hu=/,? & /,Tu=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,vu=/[()=,{}\[\]\/\s]/,xu=/\\(\\)?/g,Cu=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,hs=/\w*$/,yu=/^[-+]0x[0-9a-f]+$/i,Su=/^0b[01]+$/i,Mu=/^\[object .+?Constructor\]$/,Eu=/^0o[0-7]+$/i,Iu=/^(?:0|[1-9]\d*)$/,Au=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Er=/($^)/,wu=/['\n\r\u2028\u2029\\]/g,Ir="\\ud800-\\udfff",Bu="\\u0300-\\u036f",Ru="\\ufe20-\\ufe2f",Du="\\u20d0-\\u20ff",Ts=Bu+Ru+Du,vs="\\u2700-\\u27bf",xs="a-z\\xdf-\\xf6\\xf8-\\xff",Ou="\\xac\\xb1\\xd7\\xf7",Lu="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Nu="\\u2000-\\u206f",Fu=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Cs="A-Z\\xc0-\\xd6\\xd8-\\xde",ys="\\ufe0e\\ufe0f",Ss=Ou+Lu+Nu+Fu,Jo="['\u2019]",Uu="["+Ir+"]",Ms="["+Ss+"]",Ar="["+Ts+"]",Es="\\d+",Pu="["+vs+"]",Is="["+xs+"]",As="[^"+Ir+Ss+Es+vs+xs+Cs+"]",el="\\ud83c[\\udffb-\\udfff]",qu="(?:"+Ar+"|"+el+")",ws="[^"+Ir+"]",tl="(?:\\ud83c[\\udde6-\\uddff]){2}",il="[\\ud800-\\udbff][\\udc00-\\udfff]",sn="["+Cs+"]",Bs="\\u200d",Rs="(?:"+Is+"|"+As+")",$u="(?:"+sn+"|"+As+")",Ds="(?:"+Jo+"(?:d|ll|m|re|s|t|ve))?",Os="(?:"+Jo+"(?:D|LL|M|RE|S|T|VE))?",Ls=qu+"?",Ns="["+ys+"]?",Hu="(?:"+Bs+"(?:"+[ws,tl,il].join("|")+")"+Ns+Ls+")*",Wu="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Vu="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Fs=Ns+Ls+Hu,Gu="(?:"+[Pu,tl,il].join("|")+")"+Fs,ku="(?:"+[ws+Ar+"?",Ar,tl,il,Uu].join("|")+")",ju=RegExp(Jo,"g"),zu=RegExp(Ar,"g"),nl=RegExp(el+"(?="+el+")|"+ku+Fs,"g"),Yu=RegExp([sn+"?"+Is+"+"+Ds+"(?="+[Ms,sn,"$"].join("|")+")",$u+"+"+Os+"(?="+[Ms,sn+Rs,"$"].join("|")+")",sn+"?"+Rs+"+"+Ds,sn+"+"+Os,Vu,Wu,Es,Gu].join("|"),"g"),Ku=RegExp("["+Bs+Ir+Ts+ys+"]"),Qu=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Zu=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Xu=-1,ge={};ge[Wo]=ge[Vo]=ge[Go]=ge[ko]=ge[jo]=ge[zo]=ge[Yo]=ge[Ko]=ge[Qo]=!0,ge[on]=ge[Cr]=ge[Qn]=ge[Gn]=ge[ln]=ge[kn]=ge[yr]=ge[Sr]=ge[Lt]=ge[jn]=ge[oi]=ge[zn]=ge[Nt]=ge[Yn]=ge[Kn]=!1;var de={};de[on]=de[Cr]=de[Qn]=de[ln]=de[Gn]=de[kn]=de[Wo]=de[Vo]=de[Go]=de[ko]=de[jo]=de[Lt]=de[jn]=de[oi]=de[zn]=de[Nt]=de[Yn]=de[Mr]=de[zo]=de[Yo]=de[Ko]=de[Qo]=!0,de[yr]=de[Sr]=de[Kn]=!1;var Ju={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},ep={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},tp={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},ip={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},np=parseFloat,rp=parseInt,Us=typeof global=="object"&&global&&global.Object===Object&&global,op=typeof self=="object"&&self&&self.Object===Object&&self,Re=Us||op||Function("return this")(),rl=typeof Hn=="object"&&Hn&&!Hn.nodeType&&Hn,Vi=rl&&typeof vr=="object"&&vr&&!vr.nodeType&&vr,Ps=Vi&&Vi.exports===rl,ol=Ps&&Us.process,dt=function(){try{var b=Vi&&Vi.require&&Vi.require("util").types;return b||ol&&ol.binding&&ol.binding("util")}catch{}}(),qs=dt&&dt.isArrayBuffer,$s=dt&&dt.isDate,Hs=dt&&dt.isMap,Ws=dt&&dt.isRegExp,Vs=dt&&dt.isSet,Gs=dt&&dt.isTypedArray;function st(b,E,y){switch(y.length){case 0:return b.call(E);case 1:return b.call(E,y[0]);case 2:return b.call(E,y[0],y[1]);case 3:return b.call(E,y[0],y[1],y[2])}return b.apply(E,y)}function lp(b,E,y,F){for(var K=-1,ae=b==null?0:b.length;++K<ae;){var we=b[K];E(F,we,y(we),b)}return F}function gt(b,E){for(var y=-1,F=b==null?0:b.length;++y<F&&E(b[y],y,b)!==!1;);return b}function sp(b,E){for(var y=b==null?0:b.length;y--&&E(b[y],y,b)!==!1;);return b}function ks(b,E){for(var y=-1,F=b==null?0:b.length;++y<F;)if(!E(b[y],y,b))return!1;return!0}function vi(b,E){for(var y=-1,F=b==null?0:b.length,K=0,ae=[];++y<F;){var we=b[y];E(we,y,b)&&(ae[K++]=we)}return ae}function wr(b,E){var y=b==null?0:b.length;return!!y&&an(b,E,0)>-1}function ll(b,E,y){for(var F=-1,K=b==null?0:b.length;++F<K;)if(y(E,b[F]))return!0;return!1}function he(b,E){for(var y=-1,F=b==null?0:b.length,K=Array(F);++y<F;)K[y]=E(b[y],y,b);return K}function xi(b,E){for(var y=-1,F=E.length,K=b.length;++y<F;)b[K+y]=E[y];return b}function sl(b,E,y,F){var K=-1,ae=b==null?0:b.length;for(F&&ae&&(y=b[++K]);++K<ae;)y=E(y,b[K],K,b);return y}function ap(b,E,y,F){var K=b==null?0:b.length;for(F&&K&&(y=b[--K]);K--;)y=E(y,b[K],K,b);return y}function al(b,E){for(var y=-1,F=b==null?0:b.length;++y<F;)if(E(b[y],y,b))return!0;return!1}var cp=cl("length");function mp(b){return b.split("")}function up(b){return b.match(Tu)||[]}function js(b,E,y){var F;return y(b,function(K,ae,we){if(E(K,ae,we))return F=ae,!1}),F}function Br(b,E,y,F){for(var K=b.length,ae=y+(F?1:-1);F?ae--:++ae<K;)if(E(b[ae],ae,b))return ae;return-1}function an(b,E,y){return E===E?yp(b,E,y):Br(b,zs,y)}function pp(b,E,y,F){for(var K=y-1,ae=b.length;++K<ae;)if(F(b[K],E))return K;return-1}function zs(b){return b!==b}function Ys(b,E){var y=b==null?0:b.length;return y?ul(b,E)/y:xr}function cl(b){return function(E){return E==null?o:E[b]}}function ml(b){return function(E){return b==null?o:b[E]}}function Ks(b,E,y,F,K){return K(b,function(ae,we,fe){y=F?(F=!1,ae):E(y,ae,we,fe)}),y}function fp(b,E){var y=b.length;for(b.sort(E);y--;)b[y]=b[y].value;return b}function ul(b,E){for(var y,F=-1,K=b.length;++F<K;){var ae=E(b[F]);ae!==o&&(y=y===o?ae:y+ae)}return y}function pl(b,E){for(var y=-1,F=Array(b);++y<b;)F[y]=E(y);return F}function dp(b,E){return he(E,function(y){return[y,b[y]]})}function Qs(b){return b&&b.slice(0,ea(b)+1).replace(Xo,"")}function at(b){return function(E){return b(E)}}function fl(b,E){return he(E,function(y){return b[y]})}function Zn(b,E){return b.has(E)}function Zs(b,E){for(var y=-1,F=b.length;++y<F&&an(E,b[y],0)>-1;);return y}function Xs(b,E){for(var y=b.length;y--&&an(E,b[y],0)>-1;);return y}function gp(b,E){for(var y=b.length,F=0;y--;)b[y]===E&&++F;return F}var bp=ml(Ju),_p=ml(ep);function hp(b){return"\\"+ip[b]}function Tp(b,E){return b==null?o:b[E]}function cn(b){return Ku.test(b)}function vp(b){return Qu.test(b)}function xp(b){for(var E,y=[];!(E=b.next()).done;)y.push(E.value);return y}function dl(b){var E=-1,y=Array(b.size);return b.forEach(function(F,K){y[++E]=[K,F]}),y}function Js(b,E){return function(y){return b(E(y))}}function Ci(b,E){for(var y=-1,F=b.length,K=0,ae=[];++y<F;){var we=b[y];(we===E||we===L)&&(b[y]=L,ae[K++]=y)}return ae}function Rr(b){var E=-1,y=Array(b.size);return b.forEach(function(F){y[++E]=F}),y}function Cp(b){var E=-1,y=Array(b.size);return b.forEach(function(F){y[++E]=[F,F]}),y}function yp(b,E,y){for(var F=y-1,K=b.length;++F<K;)if(b[F]===E)return F;return-1}function Sp(b,E,y){for(var F=y+1;F--;)if(b[F]===E)return F;return F}function mn(b){return cn(b)?Ep(b):cp(b)}function Ft(b){return cn(b)?Ip(b):mp(b)}function ea(b){for(var E=b.length;E--&&gu.test(b.charAt(E)););return E}var Mp=ml(tp);function Ep(b){for(var E=nl.lastIndex=0;nl.test(b);)++E;return E}function Ip(b){return b.match(nl)||[]}function Ap(b){return b.match(Yu)||[]}var wp=function b(E){E=E==null?Re:yi.defaults(Re.Object(),E,yi.pick(Re,Zu));var y=E.Array,F=E.Date,K=E.Error,ae=E.Function,we=E.Math,fe=E.Object,gl=E.RegExp,Bp=E.String,bt=E.TypeError,Dr=y.prototype,Rp=ae.prototype,un=fe.prototype,Or=E["__core-js_shared__"],Lr=Rp.toString,ue=un.hasOwnProperty,Dp=0,ta=function(){var e=/[^.]+$/.exec(Or&&Or.keys&&Or.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Nr=un.toString,Op=Lr.call(fe),Lp=Re._,Np=gl("^"+Lr.call(ue).replace(Zo,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Fr=Ps?E.Buffer:o,Si=E.Symbol,Ur=E.Uint8Array,ia=Fr?Fr.allocUnsafe:o,Pr=Js(fe.getPrototypeOf,fe),na=fe.create,ra=un.propertyIsEnumerable,qr=Dr.splice,oa=Si?Si.isConcatSpreadable:o,Xn=Si?Si.iterator:o,Gi=Si?Si.toStringTag:o,$r=function(){try{var e=Ki(fe,"defineProperty");return e({},"",{}),e}catch{}}(),Fp=E.clearTimeout!==Re.clearTimeout&&E.clearTimeout,Up=F&&F.now!==Re.Date.now&&F.now,Pp=E.setTimeout!==Re.setTimeout&&E.setTimeout,Hr=we.ceil,Wr=we.floor,bl=fe.getOwnPropertySymbols,qp=Fr?Fr.isBuffer:o,la=E.isFinite,$p=Dr.join,Hp=Js(fe.keys,fe),Be=we.max,$e=we.min,Wp=F.now,Vp=E.parseInt,sa=we.random,Gp=Dr.reverse,_l=Ki(E,"DataView"),Jn=Ki(E,"Map"),hl=Ki(E,"Promise"),pn=Ki(E,"Set"),er=Ki(E,"WeakMap"),tr=Ki(fe,"create"),Vr=er&&new er,fn={},kp=Qi(_l),jp=Qi(Jn),zp=Qi(hl),Yp=Qi(pn),Kp=Qi(er),Gr=Si?Si.prototype:o,ir=Gr?Gr.valueOf:o,aa=Gr?Gr.toString:o;function m(e){if(xe(e)&&!Q(e)&&!(e instanceof te)){if(e instanceof _t)return e;if(ue.call(e,"__wrapped__"))return cc(e)}return new _t(e)}var dn=function(){function e(){}return function(t){if(!ve(t))return{};if(na)return na(t);e.prototype=t;var i=new e;return e.prototype=o,i}}();function kr(){}function _t(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=o}m.templateSettings={escape:cu,evaluate:mu,interpolate:_s,variable:"",imports:{_:m}},m.prototype=kr.prototype,m.prototype.constructor=m,_t.prototype=dn(kr.prototype),_t.prototype.constructor=_t;function te(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Wt,this.__views__=[]}function Qp(){var e=new te(this.__wrapped__);return e.__actions__=Qe(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Qe(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Qe(this.__views__),e}function Zp(){if(this.__filtered__){var e=new te(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Xp(){var e=this.__wrapped__.value(),t=this.__dir__,i=Q(e),l=t<0,a=i?e.length:0,u=u0(0,a,this.__views__),f=u.start,d=u.end,_=d-f,I=l?d:f-1,A=this.__iteratees__,w=A.length,N=0,P=$e(_,this.__takeCount__);if(!i||!l&&a==_&&P==_)return Da(e,this.__actions__);var z=[];e:for(;_--&&N<P;){I+=t;for(var X=-1,Y=e[I];++X<w;){var ee=A[X],re=ee.iteratee,ut=ee.type,Ye=re(Y);if(ut==jm)Y=Ye;else if(!Ye){if(ut==ps)continue e;break e}}z[N++]=Y}return z}te.prototype=dn(kr.prototype),te.prototype.constructor=te;function ki(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var l=e[t];this.set(l[0],l[1])}}function Jp(){this.__data__=tr?tr(null):{},this.size=0}function ef(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function tf(e){var t=this.__data__;if(tr){var i=t[e];return i===g?o:i}return ue.call(t,e)?t[e]:o}function nf(e){var t=this.__data__;return tr?t[e]!==o:ue.call(t,e)}function rf(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=tr&&t===o?g:t,this}ki.prototype.clear=Jp,ki.prototype.delete=ef,ki.prototype.get=tf,ki.prototype.has=nf,ki.prototype.set=rf;function li(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var l=e[t];this.set(l[0],l[1])}}function of(){this.__data__=[],this.size=0}function lf(e){var t=this.__data__,i=jr(t,e);if(i<0)return!1;var l=t.length-1;return i==l?t.pop():qr.call(t,i,1),--this.size,!0}function sf(e){var t=this.__data__,i=jr(t,e);return i<0?o:t[i][1]}function af(e){return jr(this.__data__,e)>-1}function cf(e,t){var i=this.__data__,l=jr(i,e);return l<0?(++this.size,i.push([e,t])):i[l][1]=t,this}li.prototype.clear=of,li.prototype.delete=lf,li.prototype.get=sf,li.prototype.has=af,li.prototype.set=cf;function si(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var l=e[t];this.set(l[0],l[1])}}function mf(){this.size=0,this.__data__={hash:new ki,map:new(Jn||li),string:new ki}}function uf(e){var t=ro(this,e).delete(e);return this.size-=t?1:0,t}function pf(e){return ro(this,e).get(e)}function ff(e){return ro(this,e).has(e)}function df(e,t){var i=ro(this,e),l=i.size;return i.set(e,t),this.size+=i.size==l?0:1,this}si.prototype.clear=mf,si.prototype.delete=uf,si.prototype.get=pf,si.prototype.has=ff,si.prototype.set=df;function ji(e){var t=-1,i=e==null?0:e.length;for(this.__data__=new si;++t<i;)this.add(e[t])}function gf(e){return this.__data__.set(e,g),this}function bf(e){return this.__data__.has(e)}ji.prototype.add=ji.prototype.push=gf,ji.prototype.has=bf;function Ut(e){var t=this.__data__=new li(e);this.size=t.size}function _f(){this.__data__=new li,this.size=0}function hf(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i}function Tf(e){return this.__data__.get(e)}function vf(e){return this.__data__.has(e)}function xf(e,t){var i=this.__data__;if(i instanceof li){var l=i.__data__;if(!Jn||l.length<n-1)return l.push([e,t]),this.size=++i.size,this;i=this.__data__=new si(l)}return i.set(e,t),this.size=i.size,this}Ut.prototype.clear=_f,Ut.prototype.delete=hf,Ut.prototype.get=Tf,Ut.prototype.has=vf,Ut.prototype.set=xf;function ca(e,t){var i=Q(e),l=!i&&Zi(e),a=!i&&!l&&wi(e),u=!i&&!l&&!a&&hn(e),f=i||l||a||u,d=f?pl(e.length,Bp):[],_=d.length;for(var I in e)(t||ue.call(e,I))&&!(f&&(I=="length"||a&&(I=="offset"||I=="parent")||u&&(I=="buffer"||I=="byteLength"||I=="byteOffset")||ui(I,_)))&&d.push(I);return d}function ma(e){var t=e.length;return t?e[wl(0,t-1)]:o}function Cf(e,t){return oo(Qe(e),zi(t,0,e.length))}function yf(e){return oo(Qe(e))}function Tl(e,t,i){(i!==o&&!Pt(e[t],i)||i===o&&!(t in e))&&ai(e,t,i)}function nr(e,t,i){var l=e[t];(!(ue.call(e,t)&&Pt(l,i))||i===o&&!(t in e))&&ai(e,t,i)}function jr(e,t){for(var i=e.length;i--;)if(Pt(e[i][0],t))return i;return-1}function Sf(e,t,i,l){return Mi(e,function(a,u,f){t(l,a,i(a),f)}),l}function ua(e,t){return e&&Gt(t,De(t),e)}function Mf(e,t){return e&&Gt(t,Xe(t),e)}function ai(e,t,i){t=="__proto__"&&$r?$r(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}function vl(e,t){for(var i=-1,l=t.length,a=y(l),u=e==null;++i<l;)a[i]=u?o:es(e,t[i]);return a}function zi(e,t,i){return e===e&&(i!==o&&(e=e<=i?e:i),t!==o&&(e=e>=t?e:t)),e}function ht(e,t,i,l,a,u){var f,d=t&V,_=t&_e,I=t&ce;if(i&&(f=a?i(e,l,a,u):i(e)),f!==o)return f;if(!ve(e))return e;var A=Q(e);if(A){if(f=f0(e),!d)return Qe(e,f)}else{var w=He(e),N=w==Sr||w==fs;if(wi(e))return Na(e,d);if(w==oi||w==on||N&&!a){if(f=_||N?{}:ec(e),!d)return _?i0(e,Mf(f,e)):t0(e,ua(f,e))}else{if(!de[w])return a?e:{};f=d0(e,w,d)}}u||(u=new Ut);var P=u.get(e);if(P)return P;u.set(e,f),wc(e)?e.forEach(function(Y){f.add(ht(Y,t,i,Y,e,u))}):Ic(e)&&e.forEach(function(Y,ee){f.set(ee,ht(Y,t,i,ee,e,u))});var z=I?_?$l:ql:_?Xe:De,X=A?o:z(e);return gt(X||e,function(Y,ee){X&&(ee=Y,Y=e[ee]),nr(f,ee,ht(Y,t,i,ee,e,u))}),f}function Ef(e){var t=De(e);return function(i){return pa(i,e,t)}}function pa(e,t,i){var l=i.length;if(e==null)return!l;for(e=fe(e);l--;){var a=i[l],u=t[a],f=e[a];if(f===o&&!(a in e)||!u(f))return!1}return!0}function fa(e,t,i){if(typeof e!="function")throw new bt(c);return mr(function(){e.apply(o,i)},t)}function rr(e,t,i,l){var a=-1,u=wr,f=!0,d=e.length,_=[],I=t.length;if(!d)return _;i&&(t=he(t,at(i))),l?(u=ll,f=!1):t.length>=n&&(u=Zn,f=!1,t=new ji(t));e:for(;++a<d;){var A=e[a],w=i==null?A:i(A);if(A=l||A!==0?A:0,f&&w===w){for(var N=I;N--;)if(t[N]===w)continue e;_.push(A)}else u(t,w,l)||_.push(A)}return _}var Mi=$a(Vt),da=$a(Cl,!0);function If(e,t){var i=!0;return Mi(e,function(l,a,u){return i=!!t(l,a,u),i}),i}function zr(e,t,i){for(var l=-1,a=e.length;++l<a;){var u=e[l],f=t(u);if(f!=null&&(d===o?f===f&&!mt(f):i(f,d)))var d=f,_=u}return _}function Af(e,t,i,l){var a=e.length;for(i=Z(i),i<0&&(i=-i>a?0:a+i),l=l===o||l>a?a:Z(l),l<0&&(l+=a),l=i>l?0:Rc(l);i<l;)e[i++]=t;return e}function ga(e,t){var i=[];return Mi(e,function(l,a,u){t(l,a,u)&&i.push(l)}),i}function Ne(e,t,i,l,a){var u=-1,f=e.length;for(i||(i=b0),a||(a=[]);++u<f;){var d=e[u];t>0&&i(d)?t>1?Ne(d,t-1,i,l,a):xi(a,d):l||(a[a.length]=d)}return a}var xl=Ha(),ba=Ha(!0);function Vt(e,t){return e&&xl(e,t,De)}function Cl(e,t){return e&&ba(e,t,De)}function Yr(e,t){return vi(t,function(i){return pi(e[i])})}function Yi(e,t){t=Ii(t,e);for(var i=0,l=t.length;e!=null&&i<l;)e=e[kt(t[i++])];return i&&i==l?e:o}function _a(e,t,i){var l=t(e);return Q(e)?l:xi(l,i(e))}function je(e){return e==null?e===o?iu:eu:Gi&&Gi in fe(e)?m0(e):y0(e)}function yl(e,t){return e>t}function wf(e,t){return e!=null&&ue.call(e,t)}function Bf(e,t){return e!=null&&t in fe(e)}function Rf(e,t,i){return e>=$e(t,i)&&e<Be(t,i)}function Sl(e,t,i){for(var l=i?ll:wr,a=e[0].length,u=e.length,f=u,d=y(u),_=1/0,I=[];f--;){var A=e[f];f&&t&&(A=he(A,at(t))),_=$e(A.length,_),d[f]=!i&&(t||a>=120&&A.length>=120)?new ji(f&&A):o}A=e[0];var w=-1,N=d[0];e:for(;++w<a&&I.length<_;){var P=A[w],z=t?t(P):P;if(P=i||P!==0?P:0,!(N?Zn(N,z):l(I,z,i))){for(f=u;--f;){var X=d[f];if(!(X?Zn(X,z):l(e[f],z,i)))continue e}N&&N.push(z),I.push(P)}}return I}function Df(e,t,i,l){return Vt(e,function(a,u,f){t(l,i(a),u,f)}),l}function or(e,t,i){t=Ii(t,e),e=rc(e,t);var l=e==null?e:e[kt(vt(t))];return l==null?o:st(l,e,i)}function ha(e){return xe(e)&&je(e)==on}function Of(e){return xe(e)&&je(e)==Qn}function Lf(e){return xe(e)&&je(e)==kn}function lr(e,t,i,l,a){return e===t?!0:e==null||t==null||!xe(e)&&!xe(t)?e!==e&&t!==t:Nf(e,t,i,l,lr,a)}function Nf(e,t,i,l,a,u){var f=Q(e),d=Q(t),_=f?Cr:He(e),I=d?Cr:He(t);_=_==on?oi:_,I=I==on?oi:I;var A=_==oi,w=I==oi,N=_==I;if(N&&wi(e)){if(!wi(t))return!1;f=!0,A=!1}if(N&&!A)return u||(u=new Ut),f||hn(e)?Za(e,t,i,l,a,u):a0(e,t,_,i,l,a,u);if(!(i&rt)){var P=A&&ue.call(e,"__wrapped__"),z=w&&ue.call(t,"__wrapped__");if(P||z){var X=P?e.value():e,Y=z?t.value():t;return u||(u=new Ut),a(X,Y,i,l,u)}}return N?(u||(u=new Ut),c0(e,t,i,l,a,u)):!1}function Ff(e){return xe(e)&&He(e)==Lt}function Ml(e,t,i,l){var a=i.length,u=a,f=!l;if(e==null)return!u;for(e=fe(e);a--;){var d=i[a];if(f&&d[2]?d[1]!==e[d[0]]:!(d[0]in e))return!1}for(;++a<u;){d=i[a];var _=d[0],I=e[_],A=d[1];if(f&&d[2]){if(I===o&&!(_ in e))return!1}else{var w=new Ut;if(l)var N=l(I,A,_,e,t,w);if(!(N===o?lr(A,I,rt|ii,l,w):N))return!1}}return!0}function Ta(e){if(!ve(e)||h0(e))return!1;var t=pi(e)?Np:Mu;return t.test(Qi(e))}function Uf(e){return xe(e)&&je(e)==zn}function Pf(e){return xe(e)&&He(e)==Nt}function qf(e){return xe(e)&&uo(e.length)&&!!ge[je(e)]}function va(e){return typeof e=="function"?e:e==null?Je:typeof e=="object"?Q(e)?ya(e[0],e[1]):Ca(e):Wc(e)}function El(e){if(!cr(e))return Hp(e);var t=[];for(var i in fe(e))ue.call(e,i)&&i!="constructor"&&t.push(i);return t}function $f(e){if(!ve(e))return C0(e);var t=cr(e),i=[];for(var l in e)l=="constructor"&&(t||!ue.call(e,l))||i.push(l);return i}function Il(e,t){return e<t}function xa(e,t){var i=-1,l=Ze(e)?y(e.length):[];return Mi(e,function(a,u,f){l[++i]=t(a,u,f)}),l}function Ca(e){var t=Wl(e);return t.length==1&&t[0][2]?ic(t[0][0],t[0][1]):function(i){return i===e||Ml(i,e,t)}}function ya(e,t){return Gl(e)&&tc(t)?ic(kt(e),t):function(i){var l=es(i,e);return l===o&&l===t?ts(i,e):lr(t,l,rt|ii)}}function Kr(e,t,i,l,a){e!==t&&xl(t,function(u,f){if(a||(a=new Ut),ve(u))Hf(e,t,f,i,Kr,l,a);else{var d=l?l(jl(e,f),u,f+"",e,t,a):o;d===o&&(d=u),Tl(e,f,d)}},Xe)}function Hf(e,t,i,l,a,u,f){var d=jl(e,i),_=jl(t,i),I=f.get(_);if(I){Tl(e,i,I);return}var A=u?u(d,_,i+"",e,t,f):o,w=A===o;if(w){var N=Q(_),P=!N&&wi(_),z=!N&&!P&&hn(_);A=_,N||P||z?Q(d)?A=d:Ee(d)?A=Qe(d):P?(w=!1,A=Na(_,!0)):z?(w=!1,A=Fa(_,!0)):A=[]:ur(_)||Zi(_)?(A=d,Zi(d)?A=Dc(d):(!ve(d)||pi(d))&&(A=ec(_))):w=!1}w&&(f.set(_,A),a(A,_,l,u,f),f.delete(_)),Tl(e,i,A)}function Sa(e,t){var i=e.length;if(i)return t+=t<0?i:0,ui(t,i)?e[t]:o}function Ma(e,t,i){t.length?t=he(t,function(u){return Q(u)?function(f){return Yi(f,u.length===1?u[0]:u)}:u}):t=[Je];var l=-1;t=he(t,at(k()));var a=xa(e,function(u,f,d){var _=he(t,function(I){return I(u)});return{criteria:_,index:++l,value:u}});return fp(a,function(u,f){return e0(u,f,i)})}function Wf(e,t){return Ea(e,t,function(i,l){return ts(e,l)})}function Ea(e,t,i){for(var l=-1,a=t.length,u={};++l<a;){var f=t[l],d=Yi(e,f);i(d,f)&&sr(u,Ii(f,e),d)}return u}function Vf(e){return function(t){return Yi(t,e)}}function Al(e,t,i,l){var a=l?pp:an,u=-1,f=t.length,d=e;for(e===t&&(t=Qe(t)),i&&(d=he(e,at(i)));++u<f;)for(var _=0,I=t[u],A=i?i(I):I;(_=a(d,A,_,l))>-1;)d!==e&&qr.call(d,_,1),qr.call(e,_,1);return e}function Ia(e,t){for(var i=e?t.length:0,l=i-1;i--;){var a=t[i];if(i==l||a!==u){var u=a;ui(a)?qr.call(e,a,1):Dl(e,a)}}return e}function wl(e,t){return e+Wr(sa()*(t-e+1))}function Gf(e,t,i,l){for(var a=-1,u=Be(Hr((t-e)/(i||1)),0),f=y(u);u--;)f[l?u:++a]=e,e+=i;return f}function Bl(e,t){var i="";if(!e||t<1||t>Ti)return i;do t%2&&(i+=e),t=Wr(t/2),t&&(e+=e);while(t);return i}function J(e,t){return zl(nc(e,t,Je),e+"")}function kf(e){return ma(Tn(e))}function jf(e,t){var i=Tn(e);return oo(i,zi(t,0,i.length))}function sr(e,t,i,l){if(!ve(e))return e;t=Ii(t,e);for(var a=-1,u=t.length,f=u-1,d=e;d!=null&&++a<u;){var _=kt(t[a]),I=i;if(_==="__proto__"||_==="constructor"||_==="prototype")return e;if(a!=f){var A=d[_];I=l?l(A,_,d):o,I===o&&(I=ve(A)?A:ui(t[a+1])?[]:{})}nr(d,_,I),d=d[_]}return e}var Aa=Vr?function(e,t){return Vr.set(e,t),e}:Je,zf=$r?function(e,t){return $r(e,"toString",{configurable:!0,enumerable:!1,value:ns(t),writable:!0})}:Je;function Yf(e){return oo(Tn(e))}function Tt(e,t,i){var l=-1,a=e.length;t<0&&(t=-t>a?0:a+t),i=i>a?a:i,i<0&&(i+=a),a=t>i?0:i-t>>>0,t>>>=0;for(var u=y(a);++l<a;)u[l]=e[l+t];return u}function Kf(e,t){var i;return Mi(e,function(l,a,u){return i=t(l,a,u),!i}),!!i}function Qr(e,t,i){var l=0,a=e==null?l:e.length;if(typeof t=="number"&&t===t&&a<=Qm){for(;l<a;){var u=l+a>>>1,f=e[u];f!==null&&!mt(f)&&(i?f<=t:f<t)?l=u+1:a=u}return a}return Rl(e,t,Je,i)}function Rl(e,t,i,l){var a=0,u=e==null?0:e.length;if(u===0)return 0;t=i(t);for(var f=t!==t,d=t===null,_=mt(t),I=t===o;a<u;){var A=Wr((a+u)/2),w=i(e[A]),N=w!==o,P=w===null,z=w===w,X=mt(w);if(f)var Y=l||z;else I?Y=z&&(l||N):d?Y=z&&N&&(l||!P):_?Y=z&&N&&!P&&(l||!X):P||X?Y=!1:Y=l?w<=t:w<t;Y?a=A+1:u=A}return $e(u,Km)}function wa(e,t){for(var i=-1,l=e.length,a=0,u=[];++i<l;){var f=e[i],d=t?t(f):f;if(!i||!Pt(d,_)){var _=d;u[a++]=f===0?0:f}}return u}function Ba(e){return typeof e=="number"?e:mt(e)?xr:+e}function ct(e){if(typeof e=="string")return e;if(Q(e))return he(e,ct)+"";if(mt(e))return aa?aa.call(e):"";var t=e+"";return t=="0"&&1/e==-Wi?"-0":t}function Ei(e,t,i){var l=-1,a=wr,u=e.length,f=!0,d=[],_=d;if(i)f=!1,a=ll;else if(u>=n){var I=t?null:l0(e);if(I)return Rr(I);f=!1,a=Zn,_=new ji}else _=t?[]:d;e:for(;++l<u;){var A=e[l],w=t?t(A):A;if(A=i||A!==0?A:0,f&&w===w){for(var N=_.length;N--;)if(_[N]===w)continue e;t&&_.push(w),d.push(A)}else a(_,w,i)||(_!==d&&_.push(w),d.push(A))}return d}function Dl(e,t){return t=Ii(t,e),e=rc(e,t),e==null||delete e[kt(vt(t))]}function Ra(e,t,i,l){return sr(e,t,i(Yi(e,t)),l)}function Zr(e,t,i,l){for(var a=e.length,u=l?a:-1;(l?u--:++u<a)&&t(e[u],u,e););return i?Tt(e,l?0:u,l?u+1:a):Tt(e,l?u+1:0,l?a:u)}function Da(e,t){var i=e;return i instanceof te&&(i=i.value()),sl(t,function(l,a){return a.func.apply(a.thisArg,xi([l],a.args))},i)}function Ol(e,t,i){var l=e.length;if(l<2)return l?Ei(e[0]):[];for(var a=-1,u=y(l);++a<l;)for(var f=e[a],d=-1;++d<l;)d!=a&&(u[a]=rr(u[a]||f,e[d],t,i));return Ei(Ne(u,1),t,i)}function Oa(e,t,i){for(var l=-1,a=e.length,u=t.length,f={};++l<a;){var d=l<u?t[l]:o;i(f,e[l],d)}return f}function Ll(e){return Ee(e)?e:[]}function Nl(e){return typeof e=="function"?e:Je}function Ii(e,t){return Q(e)?e:Gl(e,t)?[e]:ac(me(e))}var Qf=J;function Ai(e,t,i){var l=e.length;return i=i===o?l:i,!t&&i>=l?e:Tt(e,t,i)}var La=Fp||function(e){return Re.clearTimeout(e)};function Na(e,t){if(t)return e.slice();var i=e.length,l=ia?ia(i):new e.constructor(i);return e.copy(l),l}function Fl(e){var t=new e.constructor(e.byteLength);return new Ur(t).set(new Ur(e)),t}function Zf(e,t){var i=t?Fl(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}function Xf(e){var t=new e.constructor(e.source,hs.exec(e));return t.lastIndex=e.lastIndex,t}function Jf(e){return ir?fe(ir.call(e)):{}}function Fa(e,t){var i=t?Fl(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}function Ua(e,t){if(e!==t){var i=e!==o,l=e===null,a=e===e,u=mt(e),f=t!==o,d=t===null,_=t===t,I=mt(t);if(!d&&!I&&!u&&e>t||u&&f&&_&&!d&&!I||l&&f&&_||!i&&_||!a)return 1;if(!l&&!u&&!I&&e<t||I&&i&&a&&!l&&!u||d&&i&&a||!f&&a||!_)return-1}return 0}function e0(e,t,i){for(var l=-1,a=e.criteria,u=t.criteria,f=a.length,d=i.length;++l<f;){var _=Ua(a[l],u[l]);if(_){if(l>=d)return _;var I=i[l];return _*(I=="desc"?-1:1)}}return e.index-t.index}function Pa(e,t,i,l){for(var a=-1,u=e.length,f=i.length,d=-1,_=t.length,I=Be(u-f,0),A=y(_+I),w=!l;++d<_;)A[d]=t[d];for(;++a<f;)(w||a<u)&&(A[i[a]]=e[a]);for(;I--;)A[d++]=e[a++];return A}function qa(e,t,i,l){for(var a=-1,u=e.length,f=-1,d=i.length,_=-1,I=t.length,A=Be(u-d,0),w=y(A+I),N=!l;++a<A;)w[a]=e[a];for(var P=a;++_<I;)w[P+_]=t[_];for(;++f<d;)(N||a<u)&&(w[P+i[f]]=e[a++]);return w}function Qe(e,t){var i=-1,l=e.length;for(t||(t=y(l));++i<l;)t[i]=e[i];return t}function Gt(e,t,i,l){var a=!i;i||(i={});for(var u=-1,f=t.length;++u<f;){var d=t[u],_=l?l(i[d],e[d],d,i,e):o;_===o&&(_=e[d]),a?ai(i,d,_):nr(i,d,_)}return i}function t0(e,t){return Gt(e,Vl(e),t)}function i0(e,t){return Gt(e,Xa(e),t)}function Xr(e,t){return function(i,l){var a=Q(i)?lp:Sf,u=t?t():{};return a(i,e,k(l,2),u)}}function gn(e){return J(function(t,i){var l=-1,a=i.length,u=a>1?i[a-1]:o,f=a>2?i[2]:o;for(u=e.length>3&&typeof u=="function"?(a--,u):o,f&&ze(i[0],i[1],f)&&(u=a<3?o:u,a=1),t=fe(t);++l<a;){var d=i[l];d&&e(t,d,l,u)}return t})}function $a(e,t){return function(i,l){if(i==null)return i;if(!Ze(i))return e(i,l);for(var a=i.length,u=t?a:-1,f=fe(i);(t?u--:++u<a)&&l(f[u],u,f)!==!1;);return i}}function Ha(e){return function(t,i,l){for(var a=-1,u=fe(t),f=l(t),d=f.length;d--;){var _=f[e?d:++a];if(i(u[_],_,u)===!1)break}return t}}function n0(e,t,i){var l=t&ke,a=ar(e);function u(){var f=this&&this!==Re&&this instanceof u?a:e;return f.apply(l?i:this,arguments)}return u}function Wa(e){return function(t){t=me(t);var i=cn(t)?Ft(t):o,l=i?i[0]:t.charAt(0),a=i?Ai(i,1).join(""):t.slice(1);return l[e]()+a}}function bn(e){return function(t){return sl($c(qc(t).replace(ju,"")),e,"")}}function ar(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var i=dn(e.prototype),l=e.apply(i,t);return ve(l)?l:i}}function r0(e,t,i){var l=ar(e);function a(){for(var u=arguments.length,f=y(u),d=u,_=_n(a);d--;)f[d]=arguments[d];var I=u<3&&f[0]!==_&&f[u-1]!==_?[]:Ci(f,_);if(u-=I.length,u<i)return za(e,t,Jr,a.placeholder,o,f,I,o,o,i-u);var A=this&&this!==Re&&this instanceof a?l:e;return st(A,this,f)}return a}function Va(e){return function(t,i,l){var a=fe(t);if(!Ze(t)){var u=k(i,3);t=De(t),i=function(d){return u(a[d],d,a)}}var f=e(t,i,l);return f>-1?a[u?t[f]:f]:o}}function Ga(e){return mi(function(t){var i=t.length,l=i,a=_t.prototype.thru;for(e&&t.reverse();l--;){var u=t[l];if(typeof u!="function")throw new bt(c);if(a&&!f&&no(u)=="wrapper")var f=new _t([],!0)}for(l=f?l:i;++l<i;){u=t[l];var d=no(u),_=d=="wrapper"?Hl(u):o;_&&kl(_[0])&&_[1]==(ft|ot|lt|Vn)&&!_[4].length&&_[9]==1?f=f[no(_[0])].apply(f,_[3]):f=u.length==1&&kl(u)?f[d]():f.thru(u)}return function(){var I=arguments,A=I[0];if(f&&I.length==1&&Q(A))return f.plant(A).value();for(var w=0,N=i?t[w].apply(this,I):A;++w<i;)N=t[w].call(this,N);return N}})}function Jr(e,t,i,l,a,u,f,d,_,I){var A=t&ft,w=t&ke,N=t&Ht,P=t&(ot|ni),z=t&Ho,X=N?o:ar(e);function Y(){for(var ee=arguments.length,re=y(ee),ut=ee;ut--;)re[ut]=arguments[ut];if(P)var Ye=_n(Y),pt=gp(re,Ye);if(l&&(re=Pa(re,l,a,P)),u&&(re=qa(re,u,f,P)),ee-=pt,P&&ee<I){var Ie=Ci(re,Ye);return za(e,t,Jr,Y.placeholder,i,re,Ie,d,_,I-ee)}var qt=w?i:this,di=N?qt[e]:e;return ee=re.length,d?re=S0(re,d):z&&ee>1&&re.reverse(),A&&_<ee&&(re.length=_),this&&this!==Re&&this instanceof Y&&(di=X||ar(di)),di.apply(qt,re)}return Y}function ka(e,t){return function(i,l){return Df(i,e,t(l),{})}}function eo(e,t){return function(i,l){var a;if(i===o&&l===o)return t;if(i!==o&&(a=i),l!==o){if(a===o)return l;typeof i=="string"||typeof l=="string"?(i=ct(i),l=ct(l)):(i=Ba(i),l=Ba(l)),a=e(i,l)}return a}}function Ul(e){return mi(function(t){return t=he(t,at(k())),J(function(i){var l=this;return e(t,function(a){return st(a,l,i)})})})}function to(e,t){t=t===o?" ":ct(t);var i=t.length;if(i<2)return i?Bl(t,e):t;var l=Bl(t,Hr(e/mn(t)));return cn(t)?Ai(Ft(l),0,e).join(""):l.slice(0,e)}function o0(e,t,i,l){var a=t&ke,u=ar(e);function f(){for(var d=-1,_=arguments.length,I=-1,A=l.length,w=y(A+_),N=this&&this!==Re&&this instanceof f?u:e;++I<A;)w[I]=l[I];for(;_--;)w[I++]=arguments[++d];return st(N,a?i:this,w)}return f}function ja(e){return function(t,i,l){return l&&typeof l!="number"&&ze(t,i,l)&&(i=l=o),t=fi(t),i===o?(i=t,t=0):i=fi(i),l=l===o?t<i?1:-1:fi(l),Gf(t,i,l,e)}}function io(e){return function(t,i){return typeof t=="string"&&typeof i=="string"||(t=xt(t),i=xt(i)),e(t,i)}}function za(e,t,i,l,a,u,f,d,_,I){var A=t&ot,w=A?f:o,N=A?o:f,P=A?u:o,z=A?o:u;t|=A?lt:ri,t&=~(A?ri:lt),t&Wn||(t&=~(ke|Ht));var X=[e,t,a,P,w,z,N,d,_,I],Y=i.apply(o,X);return kl(e)&&oc(Y,X),Y.placeholder=l,lc(Y,e,t)}function Pl(e){var t=we[e];return function(i,l){if(i=xt(i),l=l==null?0:$e(Z(l),292),l&&la(i)){var a=(me(i)+"e").split("e"),u=t(a[0]+"e"+(+a[1]+l));return a=(me(u)+"e").split("e"),+(a[0]+"e"+(+a[1]-l))}return t(i)}}var l0=pn&&1/Rr(new pn([,-0]))[1]==Wi?function(e){return new pn(e)}:ls;function Ya(e){return function(t){var i=He(t);return i==Lt?dl(t):i==Nt?Cp(t):dp(t,e(t))}}function ci(e,t,i,l,a,u,f,d){var _=t&Ht;if(!_&&typeof e!="function")throw new bt(c);var I=l?l.length:0;if(I||(t&=~(lt|ri),l=a=o),f=f===o?f:Be(Z(f),0),d=d===o?d:Z(d),I-=a?a.length:0,t&ri){var A=l,w=a;l=a=o}var N=_?o:Hl(e),P=[e,t,i,l,a,A,w,u,f,d];if(N&&x0(P,N),e=P[0],t=P[1],i=P[2],l=P[3],a=P[4],d=P[9]=P[9]===o?_?0:e.length:Be(P[9]-I,0),!d&&t&(ot|ni)&&(t&=~(ot|ni)),!t||t==ke)var z=n0(e,t,i);else t==ot||t==ni?z=r0(e,t,d):(t==lt||t==(ke|lt))&&!a.length?z=o0(e,t,i,l):z=Jr.apply(o,P);var X=N?Aa:oc;return lc(X(z,P),e,t)}function Ka(e,t,i,l){return e===o||Pt(e,un[i])&&!ue.call(l,i)?t:e}function Qa(e,t,i,l,a,u){return ve(e)&&ve(t)&&(u.set(t,e),Kr(e,t,o,Qa,u),u.delete(t)),e}function s0(e){return ur(e)?o:e}function Za(e,t,i,l,a,u){var f=i&rt,d=e.length,_=t.length;if(d!=_&&!(f&&_>d))return!1;var I=u.get(e),A=u.get(t);if(I&&A)return I==t&&A==e;var w=-1,N=!0,P=i&ii?new ji:o;for(u.set(e,t),u.set(t,e);++w<d;){var z=e[w],X=t[w];if(l)var Y=f?l(X,z,w,t,e,u):l(z,X,w,e,t,u);if(Y!==o){if(Y)continue;N=!1;break}if(P){if(!al(t,function(ee,re){if(!Zn(P,re)&&(z===ee||a(z,ee,i,l,u)))return P.push(re)})){N=!1;break}}else if(!(z===X||a(z,X,i,l,u))){N=!1;break}}return u.delete(e),u.delete(t),N}function a0(e,t,i,l,a,u,f){switch(i){case ln:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Qn:return!(e.byteLength!=t.byteLength||!u(new Ur(e),new Ur(t)));case Gn:case kn:case jn:return Pt(+e,+t);case yr:return e.name==t.name&&e.message==t.message;case zn:case Yn:return e==t+"";case Lt:var d=dl;case Nt:var _=l&rt;if(d||(d=Rr),e.size!=t.size&&!_)return!1;var I=f.get(e);if(I)return I==t;l|=ii,f.set(e,t);var A=Za(d(e),d(t),l,a,u,f);return f.delete(e),A;case Mr:if(ir)return ir.call(e)==ir.call(t)}return!1}function c0(e,t,i,l,a,u){var f=i&rt,d=ql(e),_=d.length,I=ql(t),A=I.length;if(_!=A&&!f)return!1;for(var w=_;w--;){var N=d[w];if(!(f?N in t:ue.call(t,N)))return!1}var P=u.get(e),z=u.get(t);if(P&&z)return P==t&&z==e;var X=!0;u.set(e,t),u.set(t,e);for(var Y=f;++w<_;){N=d[w];var ee=e[N],re=t[N];if(l)var ut=f?l(re,ee,N,t,e,u):l(ee,re,N,e,t,u);if(!(ut===o?ee===re||a(ee,re,i,l,u):ut)){X=!1;break}Y||(Y=N=="constructor")}if(X&&!Y){var Ye=e.constructor,pt=t.constructor;Ye!=pt&&"constructor"in e&&"constructor"in t&&!(typeof Ye=="function"&&Ye instanceof Ye&&typeof pt=="function"&&pt instanceof pt)&&(X=!1)}return u.delete(e),u.delete(t),X}function mi(e){return zl(nc(e,o,pc),e+"")}function ql(e){return _a(e,De,Vl)}function $l(e){return _a(e,Xe,Xa)}var Hl=Vr?function(e){return Vr.get(e)}:ls;function no(e){for(var t=e.name+"",i=fn[t],l=ue.call(fn,t)?i.length:0;l--;){var a=i[l],u=a.func;if(u==null||u==e)return a.name}return t}function _n(e){var t=ue.call(m,"placeholder")?m:e;return t.placeholder}function k(){var e=m.iteratee||rs;return e=e===rs?va:e,arguments.length?e(arguments[0],arguments[1]):e}function ro(e,t){var i=e.__data__;return _0(t)?i[typeof t=="string"?"string":"hash"]:i.map}function Wl(e){for(var t=De(e),i=t.length;i--;){var l=t[i],a=e[l];t[i]=[l,a,tc(a)]}return t}function Ki(e,t){var i=Tp(e,t);return Ta(i)?i:o}function m0(e){var t=ue.call(e,Gi),i=e[Gi];try{e[Gi]=o;var l=!0}catch{}var a=Nr.call(e);return l&&(t?e[Gi]=i:delete e[Gi]),a}var Vl=bl?function(e){return e==null?[]:(e=fe(e),vi(bl(e),function(t){return ra.call(e,t)}))}:ss,Xa=bl?function(e){for(var t=[];e;)xi(t,Vl(e)),e=Pr(e);return t}:ss,He=je;(_l&&He(new _l(new ArrayBuffer(1)))!=ln||Jn&&He(new Jn)!=Lt||hl&&He(hl.resolve())!=ds||pn&&He(new pn)!=Nt||er&&He(new er)!=Kn)&&(He=function(e){var t=je(e),i=t==oi?e.constructor:o,l=i?Qi(i):"";if(l)switch(l){case kp:return ln;case jp:return Lt;case zp:return ds;case Yp:return Nt;case Kp:return Kn}return t});function u0(e,t,i){for(var l=-1,a=i.length;++l<a;){var u=i[l],f=u.size;switch(u.type){case"drop":e+=f;break;case"dropRight":t-=f;break;case"take":t=$e(t,e+f);break;case"takeRight":e=Be(e,t-f);break}}return{start:e,end:t}}function p0(e){var t=e.match(_u);return t?t[1].split(hu):[]}function Ja(e,t,i){t=Ii(t,e);for(var l=-1,a=t.length,u=!1;++l<a;){var f=kt(t[l]);if(!(u=e!=null&&i(e,f)))break;e=e[f]}return u||++l!=a?u:(a=e==null?0:e.length,!!a&&uo(a)&&ui(f,a)&&(Q(e)||Zi(e)))}function f0(e){var t=e.length,i=new e.constructor(t);return t&&typeof e[0]=="string"&&ue.call(e,"index")&&(i.index=e.index,i.input=e.input),i}function ec(e){return typeof e.constructor=="function"&&!cr(e)?dn(Pr(e)):{}}function d0(e,t,i){var l=e.constructor;switch(t){case Qn:return Fl(e);case Gn:case kn:return new l(+e);case ln:return Zf(e,i);case Wo:case Vo:case Go:case ko:case jo:case zo:case Yo:case Ko:case Qo:return Fa(e,i);case Lt:return new l;case jn:case Yn:return new l(e);case zn:return Xf(e);case Nt:return new l;case Mr:return Jf(e)}}function g0(e,t){var i=t.length;if(!i)return e;var l=i-1;return t[l]=(i>1?"& ":"")+t[l],t=t.join(i>2?", ":" "),e.replace(bu,`{
/* [wrapped with `+t+`] */
`)}function b0(e){return Q(e)||Zi(e)||!!(oa&&e&&e[oa])}function ui(e,t){var i=typeof e;return t=t??Ti,!!t&&(i=="number"||i!="symbol"&&Iu.test(e))&&e>-1&&e%1==0&&e<t}function ze(e,t,i){if(!ve(i))return!1;var l=typeof t;return(l=="number"?Ze(i)&&ui(t,i.length):l=="string"&&t in i)?Pt(i[t],e):!1}function Gl(e,t){if(Q(e))return!1;var i=typeof e;return i=="number"||i=="symbol"||i=="boolean"||e==null||mt(e)?!0:pu.test(e)||!uu.test(e)||t!=null&&e in fe(t)}function _0(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function kl(e){var t=no(e),i=m[t];if(typeof i!="function"||!(t in te.prototype))return!1;if(e===i)return!0;var l=Hl(i);return!!l&&e===l[0]}function h0(e){return!!ta&&ta in e}var T0=Or?pi:as;function cr(e){var t=e&&e.constructor,i=typeof t=="function"&&t.prototype||un;return e===i}function tc(e){return e===e&&!ve(e)}function ic(e,t){return function(i){return i==null?!1:i[e]===t&&(t!==o||e in fe(i))}}function v0(e){var t=co(e,function(l){return i.size===M&&i.clear(),l}),i=t.cache;return t}function x0(e,t){var i=e[1],l=t[1],a=i|l,u=a<(ke|Ht|ft),f=l==ft&&i==ot||l==ft&&i==Vn&&e[7].length<=t[8]||l==(ft|Vn)&&t[7].length<=t[8]&&i==ot;if(!(u||f))return e;l&ke&&(e[2]=t[2],a|=i&ke?0:Wn);var d=t[3];if(d){var _=e[3];e[3]=_?Pa(_,d,t[4]):d,e[4]=_?Ci(e[3],L):t[4]}return d=t[5],d&&(_=e[5],e[5]=_?qa(_,d,t[6]):d,e[6]=_?Ci(e[5],L):t[6]),d=t[7],d&&(e[7]=d),l&ft&&(e[8]=e[8]==null?t[8]:$e(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=a,e}function C0(e){var t=[];if(e!=null)for(var i in fe(e))t.push(i);return t}function y0(e){return Nr.call(e)}function nc(e,t,i){return t=Be(t===o?e.length-1:t,0),function(){for(var l=arguments,a=-1,u=Be(l.length-t,0),f=y(u);++a<u;)f[a]=l[t+a];a=-1;for(var d=y(t+1);++a<t;)d[a]=l[a];return d[t]=i(f),st(e,this,d)}}function rc(e,t){return t.length<2?e:Yi(e,Tt(t,0,-1))}function S0(e,t){for(var i=e.length,l=$e(t.length,i),a=Qe(e);l--;){var u=t[l];e[l]=ui(u,i)?a[u]:o}return e}function jl(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var oc=sc(Aa),mr=Pp||function(e,t){return Re.setTimeout(e,t)},zl=sc(zf);function lc(e,t,i){var l=t+"";return zl(e,g0(l,M0(p0(l),i)))}function sc(e){var t=0,i=0;return function(){var l=Wp(),a=km-(l-i);if(i=l,a>0){if(++t>=Gm)return arguments[0]}else t=0;return e.apply(o,arguments)}}function oo(e,t){var i=-1,l=e.length,a=l-1;for(t=t===o?l:t;++i<t;){var u=wl(i,a),f=e[u];e[u]=e[i],e[i]=f}return e.length=t,e}var ac=v0(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(fu,function(i,l,a,u){t.push(a?u.replace(xu,"$1"):l||i)}),t});function kt(e){if(typeof e=="string"||mt(e))return e;var t=e+"";return t=="0"&&1/e==-Wi?"-0":t}function Qi(e){if(e!=null){try{return Lr.call(e)}catch{}try{return e+""}catch{}}return""}function M0(e,t){return gt(Zm,function(i){var l="_."+i[0];t&i[1]&&!wr(e,l)&&e.push(l)}),e.sort()}function cc(e){if(e instanceof te)return e.clone();var t=new _t(e.__wrapped__,e.__chain__);return t.__actions__=Qe(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function E0(e,t,i){(i?ze(e,t,i):t===o)?t=1:t=Be(Z(t),0);var l=e==null?0:e.length;if(!l||t<1)return[];for(var a=0,u=0,f=y(Hr(l/t));a<l;)f[u++]=Tt(e,a,a+=t);return f}function I0(e){for(var t=-1,i=e==null?0:e.length,l=0,a=[];++t<i;){var u=e[t];u&&(a[l++]=u)}return a}function A0(){var e=arguments.length;if(!e)return[];for(var t=y(e-1),i=arguments[0],l=e;l--;)t[l-1]=arguments[l];return xi(Q(i)?Qe(i):[i],Ne(t,1))}var w0=J(function(e,t){return Ee(e)?rr(e,Ne(t,1,Ee,!0)):[]}),B0=J(function(e,t){var i=vt(t);return Ee(i)&&(i=o),Ee(e)?rr(e,Ne(t,1,Ee,!0),k(i,2)):[]}),R0=J(function(e,t){var i=vt(t);return Ee(i)&&(i=o),Ee(e)?rr(e,Ne(t,1,Ee,!0),o,i):[]});function D0(e,t,i){var l=e==null?0:e.length;return l?(t=i||t===o?1:Z(t),Tt(e,t<0?0:t,l)):[]}function O0(e,t,i){var l=e==null?0:e.length;return l?(t=i||t===o?1:Z(t),t=l-t,Tt(e,0,t<0?0:t)):[]}function L0(e,t){return e&&e.length?Zr(e,k(t,3),!0,!0):[]}function N0(e,t){return e&&e.length?Zr(e,k(t,3),!0):[]}function F0(e,t,i,l){var a=e==null?0:e.length;return a?(i&&typeof i!="number"&&ze(e,t,i)&&(i=0,l=a),Af(e,t,i,l)):[]}function mc(e,t,i){var l=e==null?0:e.length;if(!l)return-1;var a=i==null?0:Z(i);return a<0&&(a=Be(l+a,0)),Br(e,k(t,3),a)}function uc(e,t,i){var l=e==null?0:e.length;if(!l)return-1;var a=l-1;return i!==o&&(a=Z(i),a=i<0?Be(l+a,0):$e(a,l-1)),Br(e,k(t,3),a,!0)}function pc(e){var t=e==null?0:e.length;return t?Ne(e,1):[]}function U0(e){var t=e==null?0:e.length;return t?Ne(e,Wi):[]}function P0(e,t){var i=e==null?0:e.length;return i?(t=t===o?1:Z(t),Ne(e,t)):[]}function q0(e){for(var t=-1,i=e==null?0:e.length,l={};++t<i;){var a=e[t];l[a[0]]=a[1]}return l}function fc(e){return e&&e.length?e[0]:o}function $0(e,t,i){var l=e==null?0:e.length;if(!l)return-1;var a=i==null?0:Z(i);return a<0&&(a=Be(l+a,0)),an(e,t,a)}function H0(e){var t=e==null?0:e.length;return t?Tt(e,0,-1):[]}var W0=J(function(e){var t=he(e,Ll);return t.length&&t[0]===e[0]?Sl(t):[]}),V0=J(function(e){var t=vt(e),i=he(e,Ll);return t===vt(i)?t=o:i.pop(),i.length&&i[0]===e[0]?Sl(i,k(t,2)):[]}),G0=J(function(e){var t=vt(e),i=he(e,Ll);return t=typeof t=="function"?t:o,t&&i.pop(),i.length&&i[0]===e[0]?Sl(i,o,t):[]});function k0(e,t){return e==null?"":$p.call(e,t)}function vt(e){var t=e==null?0:e.length;return t?e[t-1]:o}function j0(e,t,i){var l=e==null?0:e.length;if(!l)return-1;var a=l;return i!==o&&(a=Z(i),a=a<0?Be(l+a,0):$e(a,l-1)),t===t?Sp(e,t,a):Br(e,zs,a,!0)}function z0(e,t){return e&&e.length?Sa(e,Z(t)):o}var Y0=J(dc);function dc(e,t){return e&&e.length&&t&&t.length?Al(e,t):e}function K0(e,t,i){return e&&e.length&&t&&t.length?Al(e,t,k(i,2)):e}function Q0(e,t,i){return e&&e.length&&t&&t.length?Al(e,t,o,i):e}var Z0=mi(function(e,t){var i=e==null?0:e.length,l=vl(e,t);return Ia(e,he(t,function(a){return ui(a,i)?+a:a}).sort(Ua)),l});function X0(e,t){var i=[];if(!(e&&e.length))return i;var l=-1,a=[],u=e.length;for(t=k(t,3);++l<u;){var f=e[l];t(f,l,e)&&(i.push(f),a.push(l))}return Ia(e,a),i}function Yl(e){return e==null?e:Gp.call(e)}function J0(e,t,i){var l=e==null?0:e.length;return l?(i&&typeof i!="number"&&ze(e,t,i)?(t=0,i=l):(t=t==null?0:Z(t),i=i===o?l:Z(i)),Tt(e,t,i)):[]}function ed(e,t){return Qr(e,t)}function td(e,t,i){return Rl(e,t,k(i,2))}function id(e,t){var i=e==null?0:e.length;if(i){var l=Qr(e,t);if(l<i&&Pt(e[l],t))return l}return-1}function nd(e,t){return Qr(e,t,!0)}function rd(e,t,i){return Rl(e,t,k(i,2),!0)}function od(e,t){var i=e==null?0:e.length;if(i){var l=Qr(e,t,!0)-1;if(Pt(e[l],t))return l}return-1}function ld(e){return e&&e.length?wa(e):[]}function sd(e,t){return e&&e.length?wa(e,k(t,2)):[]}function ad(e){var t=e==null?0:e.length;return t?Tt(e,1,t):[]}function cd(e,t,i){return e&&e.length?(t=i||t===o?1:Z(t),Tt(e,0,t<0?0:t)):[]}function md(e,t,i){var l=e==null?0:e.length;return l?(t=i||t===o?1:Z(t),t=l-t,Tt(e,t<0?0:t,l)):[]}function ud(e,t){return e&&e.length?Zr(e,k(t,3),!1,!0):[]}function pd(e,t){return e&&e.length?Zr(e,k(t,3)):[]}var fd=J(function(e){return Ei(Ne(e,1,Ee,!0))}),dd=J(function(e){var t=vt(e);return Ee(t)&&(t=o),Ei(Ne(e,1,Ee,!0),k(t,2))}),gd=J(function(e){var t=vt(e);return t=typeof t=="function"?t:o,Ei(Ne(e,1,Ee,!0),o,t)});function bd(e){return e&&e.length?Ei(e):[]}function _d(e,t){return e&&e.length?Ei(e,k(t,2)):[]}function hd(e,t){return t=typeof t=="function"?t:o,e&&e.length?Ei(e,o,t):[]}function Kl(e){if(!(e&&e.length))return[];var t=0;return e=vi(e,function(i){if(Ee(i))return t=Be(i.length,t),!0}),pl(t,function(i){return he(e,cl(i))})}function gc(e,t){if(!(e&&e.length))return[];var i=Kl(e);return t==null?i:he(i,function(l){return st(t,o,l)})}var Td=J(function(e,t){return Ee(e)?rr(e,t):[]}),vd=J(function(e){return Ol(vi(e,Ee))}),xd=J(function(e){var t=vt(e);return Ee(t)&&(t=o),Ol(vi(e,Ee),k(t,2))}),Cd=J(function(e){var t=vt(e);return t=typeof t=="function"?t:o,Ol(vi(e,Ee),o,t)}),yd=J(Kl);function Sd(e,t){return Oa(e||[],t||[],nr)}function Md(e,t){return Oa(e||[],t||[],sr)}var Ed=J(function(e){var t=e.length,i=t>1?e[t-1]:o;return i=typeof i=="function"?(e.pop(),i):o,gc(e,i)});function bc(e){var t=m(e);return t.__chain__=!0,t}function Id(e,t){return t(e),e}function lo(e,t){return t(e)}var Ad=mi(function(e){var t=e.length,i=t?e[0]:0,l=this.__wrapped__,a=function(u){return vl(u,e)};return t>1||this.__actions__.length||!(l instanceof te)||!ui(i)?this.thru(a):(l=l.slice(i,+i+(t?1:0)),l.__actions__.push({func:lo,args:[a],thisArg:o}),new _t(l,this.__chain__).thru(function(u){return t&&!u.length&&u.push(o),u}))});function wd(){return bc(this)}function Bd(){return new _t(this.value(),this.__chain__)}function Rd(){this.__values__===o&&(this.__values__=Bc(this.value()));var e=this.__index__>=this.__values__.length,t=e?o:this.__values__[this.__index__++];return{done:e,value:t}}function Dd(){return this}function Od(e){for(var t,i=this;i instanceof kr;){var l=cc(i);l.__index__=0,l.__values__=o,t?a.__wrapped__=l:t=l;var a=l;i=i.__wrapped__}return a.__wrapped__=e,t}function Ld(){var e=this.__wrapped__;if(e instanceof te){var t=e;return this.__actions__.length&&(t=new te(this)),t=t.reverse(),t.__actions__.push({func:lo,args:[Yl],thisArg:o}),new _t(t,this.__chain__)}return this.thru(Yl)}function Nd(){return Da(this.__wrapped__,this.__actions__)}var Fd=Xr(function(e,t,i){ue.call(e,i)?++e[i]:ai(e,i,1)});function Ud(e,t,i){var l=Q(e)?ks:If;return i&&ze(e,t,i)&&(t=o),l(e,k(t,3))}function Pd(e,t){var i=Q(e)?vi:ga;return i(e,k(t,3))}var qd=Va(mc),$d=Va(uc);function Hd(e,t){return Ne(so(e,t),1)}function Wd(e,t){return Ne(so(e,t),Wi)}function Vd(e,t,i){return i=i===o?1:Z(i),Ne(so(e,t),i)}function _c(e,t){var i=Q(e)?gt:Mi;return i(e,k(t,3))}function hc(e,t){var i=Q(e)?sp:da;return i(e,k(t,3))}var Gd=Xr(function(e,t,i){ue.call(e,i)?e[i].push(t):ai(e,i,[t])});function kd(e,t,i,l){e=Ze(e)?e:Tn(e),i=i&&!l?Z(i):0;var a=e.length;return i<0&&(i=Be(a+i,0)),po(e)?i<=a&&e.indexOf(t,i)>-1:!!a&&an(e,t,i)>-1}var jd=J(function(e,t,i){var l=-1,a=typeof t=="function",u=Ze(e)?y(e.length):[];return Mi(e,function(f){u[++l]=a?st(t,f,i):or(f,t,i)}),u}),zd=Xr(function(e,t,i){ai(e,i,t)});function so(e,t){var i=Q(e)?he:xa;return i(e,k(t,3))}function Yd(e,t,i,l){return e==null?[]:(Q(t)||(t=t==null?[]:[t]),i=l?o:i,Q(i)||(i=i==null?[]:[i]),Ma(e,t,i))}var Kd=Xr(function(e,t,i){e[i?0:1].push(t)},function(){return[[],[]]});function Qd(e,t,i){var l=Q(e)?sl:Ks,a=arguments.length<3;return l(e,k(t,4),i,a,Mi)}function Zd(e,t,i){var l=Q(e)?ap:Ks,a=arguments.length<3;return l(e,k(t,4),i,a,da)}function Xd(e,t){var i=Q(e)?vi:ga;return i(e,mo(k(t,3)))}function Jd(e){var t=Q(e)?ma:kf;return t(e)}function eg(e,t,i){(i?ze(e,t,i):t===o)?t=1:t=Z(t);var l=Q(e)?Cf:jf;return l(e,t)}function tg(e){var t=Q(e)?yf:Yf;return t(e)}function ig(e){if(e==null)return 0;if(Ze(e))return po(e)?mn(e):e.length;var t=He(e);return t==Lt||t==Nt?e.size:El(e).length}function ng(e,t,i){var l=Q(e)?al:Kf;return i&&ze(e,t,i)&&(t=o),l(e,k(t,3))}var rg=J(function(e,t){if(e==null)return[];var i=t.length;return i>1&&ze(e,t[0],t[1])?t=[]:i>2&&ze(t[0],t[1],t[2])&&(t=[t[0]]),Ma(e,Ne(t,1),[])}),ao=Up||function(){return Re.Date.now()};function og(e,t){if(typeof t!="function")throw new bt(c);return e=Z(e),function(){if(--e<1)return t.apply(this,arguments)}}function Tc(e,t,i){return t=i?o:t,t=e&&t==null?e.length:t,ci(e,ft,o,o,o,o,t)}function vc(e,t){var i;if(typeof t!="function")throw new bt(c);return e=Z(e),function(){return--e>0&&(i=t.apply(this,arguments)),e<=1&&(t=o),i}}var Ql=J(function(e,t,i){var l=ke;if(i.length){var a=Ci(i,_n(Ql));l|=lt}return ci(e,l,t,i,a)}),xc=J(function(e,t,i){var l=ke|Ht;if(i.length){var a=Ci(i,_n(xc));l|=lt}return ci(t,l,e,i,a)});function Cc(e,t,i){t=i?o:t;var l=ci(e,ot,o,o,o,o,o,t);return l.placeholder=Cc.placeholder,l}function yc(e,t,i){t=i?o:t;var l=ci(e,ni,o,o,o,o,o,t);return l.placeholder=yc.placeholder,l}function Sc(e,t,i){var l,a,u,f,d,_,I=0,A=!1,w=!1,N=!0;if(typeof e!="function")throw new bt(c);t=xt(t)||0,ve(i)&&(A=!!i.leading,w="maxWait"in i,u=w?Be(xt(i.maxWait)||0,t):u,N="trailing"in i?!!i.trailing:N);function P(Ie){var qt=l,di=a;return l=a=o,I=Ie,f=e.apply(di,qt),f}function z(Ie){return I=Ie,d=mr(ee,t),A?P(Ie):f}function X(Ie){var qt=Ie-_,di=Ie-I,Vc=t-qt;return w?$e(Vc,u-di):Vc}function Y(Ie){var qt=Ie-_,di=Ie-I;return _===o||qt>=t||qt<0||w&&di>=u}function ee(){var Ie=ao();if(Y(Ie))return re(Ie);d=mr(ee,X(Ie))}function re(Ie){return d=o,N&&l?P(Ie):(l=a=o,f)}function ut(){d!==o&&La(d),I=0,l=_=a=d=o}function Ye(){return d===o?f:re(ao())}function pt(){var Ie=ao(),qt=Y(Ie);if(l=arguments,a=this,_=Ie,qt){if(d===o)return z(_);if(w)return La(d),d=mr(ee,t),P(_)}return d===o&&(d=mr(ee,t)),f}return pt.cancel=ut,pt.flush=Ye,pt}var lg=J(function(e,t){return fa(e,1,t)}),sg=J(function(e,t,i){return fa(e,xt(t)||0,i)});function ag(e){return ci(e,Ho)}function co(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new bt(c);var i=function(){var l=arguments,a=t?t.apply(this,l):l[0],u=i.cache;if(u.has(a))return u.get(a);var f=e.apply(this,l);return i.cache=u.set(a,f)||u,f};return i.cache=new(co.Cache||si),i}co.Cache=si;function mo(e){if(typeof e!="function")throw new bt(c);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function cg(e){return vc(2,e)}var mg=Qf(function(e,t){t=t.length==1&&Q(t[0])?he(t[0],at(k())):he(Ne(t,1),at(k()));var i=t.length;return J(function(l){for(var a=-1,u=$e(l.length,i);++a<u;)l[a]=t[a].call(this,l[a]);return st(e,this,l)})}),Zl=J(function(e,t){var i=Ci(t,_n(Zl));return ci(e,lt,o,t,i)}),Mc=J(function(e,t){var i=Ci(t,_n(Mc));return ci(e,ri,o,t,i)}),ug=mi(function(e,t){return ci(e,Vn,o,o,o,t)});function pg(e,t){if(typeof e!="function")throw new bt(c);return t=t===o?t:Z(t),J(e,t)}function fg(e,t){if(typeof e!="function")throw new bt(c);return t=t==null?0:Be(Z(t),0),J(function(i){var l=i[t],a=Ai(i,0,t);return l&&xi(a,l),st(e,this,a)})}function dg(e,t,i){var l=!0,a=!0;if(typeof e!="function")throw new bt(c);return ve(i)&&(l="leading"in i?!!i.leading:l,a="trailing"in i?!!i.trailing:a),Sc(e,t,{leading:l,maxWait:t,trailing:a})}function gg(e){return Tc(e,1)}function bg(e,t){return Zl(Nl(t),e)}function _g(){if(!arguments.length)return[];var e=arguments[0];return Q(e)?e:[e]}function hg(e){return ht(e,ce)}function Tg(e,t){return t=typeof t=="function"?t:o,ht(e,ce,t)}function vg(e){return ht(e,V|ce)}function xg(e,t){return t=typeof t=="function"?t:o,ht(e,V|ce,t)}function Cg(e,t){return t==null||pa(e,t,De(t))}function Pt(e,t){return e===t||e!==e&&t!==t}var yg=io(yl),Sg=io(function(e,t){return e>=t}),Zi=ha(function(){return arguments}())?ha:function(e){return xe(e)&&ue.call(e,"callee")&&!ra.call(e,"callee")},Q=y.isArray,Mg=qs?at(qs):Of;function Ze(e){return e!=null&&uo(e.length)&&!pi(e)}function Ee(e){return xe(e)&&Ze(e)}function Eg(e){return e===!0||e===!1||xe(e)&&je(e)==Gn}var wi=qp||as,Ig=$s?at($s):Lf;function Ag(e){return xe(e)&&e.nodeType===1&&!ur(e)}function wg(e){if(e==null)return!0;if(Ze(e)&&(Q(e)||typeof e=="string"||typeof e.splice=="function"||wi(e)||hn(e)||Zi(e)))return!e.length;var t=He(e);if(t==Lt||t==Nt)return!e.size;if(cr(e))return!El(e).length;for(var i in e)if(ue.call(e,i))return!1;return!0}function Bg(e,t){return lr(e,t)}function Rg(e,t,i){i=typeof i=="function"?i:o;var l=i?i(e,t):o;return l===o?lr(e,t,o,i):!!l}function Xl(e){if(!xe(e))return!1;var t=je(e);return t==yr||t==Jm||typeof e.message=="string"&&typeof e.name=="string"&&!ur(e)}function Dg(e){return typeof e=="number"&&la(e)}function pi(e){if(!ve(e))return!1;var t=je(e);return t==Sr||t==fs||t==Xm||t==tu}function Ec(e){return typeof e=="number"&&e==Z(e)}function uo(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Ti}function ve(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function xe(e){return e!=null&&typeof e=="object"}var Ic=Hs?at(Hs):Ff;function Og(e,t){return e===t||Ml(e,t,Wl(t))}function Lg(e,t,i){return i=typeof i=="function"?i:o,Ml(e,t,Wl(t),i)}function Ng(e){return Ac(e)&&e!=+e}function Fg(e){if(T0(e))throw new K(s);return Ta(e)}function Ug(e){return e===null}function Pg(e){return e==null}function Ac(e){return typeof e=="number"||xe(e)&&je(e)==jn}function ur(e){if(!xe(e)||je(e)!=oi)return!1;var t=Pr(e);if(t===null)return!0;var i=ue.call(t,"constructor")&&t.constructor;return typeof i=="function"&&i instanceof i&&Lr.call(i)==Op}var Jl=Ws?at(Ws):Uf;function qg(e){return Ec(e)&&e>=-Ti&&e<=Ti}var wc=Vs?at(Vs):Pf;function po(e){return typeof e=="string"||!Q(e)&&xe(e)&&je(e)==Yn}function mt(e){return typeof e=="symbol"||xe(e)&&je(e)==Mr}var hn=Gs?at(Gs):qf;function $g(e){return e===o}function Hg(e){return xe(e)&&He(e)==Kn}function Wg(e){return xe(e)&&je(e)==nu}var Vg=io(Il),Gg=io(function(e,t){return e<=t});function Bc(e){if(!e)return[];if(Ze(e))return po(e)?Ft(e):Qe(e);if(Xn&&e[Xn])return xp(e[Xn]());var t=He(e),i=t==Lt?dl:t==Nt?Rr:Tn;return i(e)}function fi(e){if(!e)return e===0?e:0;if(e=xt(e),e===Wi||e===-Wi){var t=e<0?-1:1;return t*Ym}return e===e?e:0}function Z(e){var t=fi(e),i=t%1;return t===t?i?t-i:t:0}function Rc(e){return e?zi(Z(e),0,Wt):0}function xt(e){if(typeof e=="number")return e;if(mt(e))return xr;if(ve(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ve(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Qs(e);var i=Su.test(e);return i||Eu.test(e)?rp(e.slice(2),i?2:8):yu.test(e)?xr:+e}function Dc(e){return Gt(e,Xe(e))}function kg(e){return e?zi(Z(e),-Ti,Ti):e===0?e:0}function me(e){return e==null?"":ct(e)}var jg=gn(function(e,t){if(cr(t)||Ze(t)){Gt(t,De(t),e);return}for(var i in t)ue.call(t,i)&&nr(e,i,t[i])}),Oc=gn(function(e,t){Gt(t,Xe(t),e)}),fo=gn(function(e,t,i,l){Gt(t,Xe(t),e,l)}),zg=gn(function(e,t,i,l){Gt(t,De(t),e,l)}),Yg=mi(vl);function Kg(e,t){var i=dn(e);return t==null?i:ua(i,t)}var Qg=J(function(e,t){e=fe(e);var i=-1,l=t.length,a=l>2?t[2]:o;for(a&&ze(t[0],t[1],a)&&(l=1);++i<l;)for(var u=t[i],f=Xe(u),d=-1,_=f.length;++d<_;){var I=f[d],A=e[I];(A===o||Pt(A,un[I])&&!ue.call(e,I))&&(e[I]=u[I])}return e}),Zg=J(function(e){return e.push(o,Qa),st(Lc,o,e)});function Xg(e,t){return js(e,k(t,3),Vt)}function Jg(e,t){return js(e,k(t,3),Cl)}function eb(e,t){return e==null?e:xl(e,k(t,3),Xe)}function tb(e,t){return e==null?e:ba(e,k(t,3),Xe)}function ib(e,t){return e&&Vt(e,k(t,3))}function nb(e,t){return e&&Cl(e,k(t,3))}function rb(e){return e==null?[]:Yr(e,De(e))}function ob(e){return e==null?[]:Yr(e,Xe(e))}function es(e,t,i){var l=e==null?o:Yi(e,t);return l===o?i:l}function lb(e,t){return e!=null&&Ja(e,t,wf)}function ts(e,t){return e!=null&&Ja(e,t,Bf)}var sb=ka(function(e,t,i){t!=null&&typeof t.toString!="function"&&(t=Nr.call(t)),e[t]=i},ns(Je)),ab=ka(function(e,t,i){t!=null&&typeof t.toString!="function"&&(t=Nr.call(t)),ue.call(e,t)?e[t].push(i):e[t]=[i]},k),cb=J(or);function De(e){return Ze(e)?ca(e):El(e)}function Xe(e){return Ze(e)?ca(e,!0):$f(e)}function mb(e,t){var i={};return t=k(t,3),Vt(e,function(l,a,u){ai(i,t(l,a,u),l)}),i}function ub(e,t){var i={};return t=k(t,3),Vt(e,function(l,a,u){ai(i,a,t(l,a,u))}),i}var pb=gn(function(e,t,i){Kr(e,t,i)}),Lc=gn(function(e,t,i,l){Kr(e,t,i,l)}),fb=mi(function(e,t){var i={};if(e==null)return i;var l=!1;t=he(t,function(u){return u=Ii(u,e),l||(l=u.length>1),u}),Gt(e,$l(e),i),l&&(i=ht(i,V|_e|ce,s0));for(var a=t.length;a--;)Dl(i,t[a]);return i});function db(e,t){return Nc(e,mo(k(t)))}var gb=mi(function(e,t){return e==null?{}:Wf(e,t)});function Nc(e,t){if(e==null)return{};var i=he($l(e),function(l){return[l]});return t=k(t),Ea(e,i,function(l,a){return t(l,a[0])})}function bb(e,t,i){t=Ii(t,e);var l=-1,a=t.length;for(a||(a=1,e=o);++l<a;){var u=e==null?o:e[kt(t[l])];u===o&&(l=a,u=i),e=pi(u)?u.call(e):u}return e}function _b(e,t,i){return e==null?e:sr(e,t,i)}function hb(e,t,i,l){return l=typeof l=="function"?l:o,e==null?e:sr(e,t,i,l)}var Fc=Ya(De),Uc=Ya(Xe);function Tb(e,t,i){var l=Q(e),a=l||wi(e)||hn(e);if(t=k(t,4),i==null){var u=e&&e.constructor;a?i=l?new u:[]:ve(e)?i=pi(u)?dn(Pr(e)):{}:i={}}return(a?gt:Vt)(e,function(f,d,_){return t(i,f,d,_)}),i}function vb(e,t){return e==null?!0:Dl(e,t)}function xb(e,t,i){return e==null?e:Ra(e,t,Nl(i))}function Cb(e,t,i,l){return l=typeof l=="function"?l:o,e==null?e:Ra(e,t,Nl(i),l)}function Tn(e){return e==null?[]:fl(e,De(e))}function yb(e){return e==null?[]:fl(e,Xe(e))}function Sb(e,t,i){return i===o&&(i=t,t=o),i!==o&&(i=xt(i),i=i===i?i:0),t!==o&&(t=xt(t),t=t===t?t:0),zi(xt(e),t,i)}function Mb(e,t,i){return t=fi(t),i===o?(i=t,t=0):i=fi(i),e=xt(e),Rf(e,t,i)}function Eb(e,t,i){if(i&&typeof i!="boolean"&&ze(e,t,i)&&(t=i=o),i===o&&(typeof t=="boolean"?(i=t,t=o):typeof e=="boolean"&&(i=e,e=o)),e===o&&t===o?(e=0,t=1):(e=fi(e),t===o?(t=e,e=0):t=fi(t)),e>t){var l=e;e=t,t=l}if(i||e%1||t%1){var a=sa();return $e(e+a*(t-e+np("1e-"+((a+"").length-1))),t)}return wl(e,t)}var Ib=bn(function(e,t,i){return t=t.toLowerCase(),e+(i?Pc(t):t)});function Pc(e){return is(me(e).toLowerCase())}function qc(e){return e=me(e),e&&e.replace(Au,bp).replace(zu,"")}function Ab(e,t,i){e=me(e),t=ct(t);var l=e.length;i=i===o?l:zi(Z(i),0,l);var a=i;return i-=t.length,i>=0&&e.slice(i,a)==t}function wb(e){return e=me(e),e&&au.test(e)?e.replace(bs,_p):e}function Bb(e){return e=me(e),e&&du.test(e)?e.replace(Zo,"\\$&"):e}var Rb=bn(function(e,t,i){return e+(i?"-":"")+t.toLowerCase()}),Db=bn(function(e,t,i){return e+(i?" ":"")+t.toLowerCase()}),Ob=Wa("toLowerCase");function Lb(e,t,i){e=me(e),t=Z(t);var l=t?mn(e):0;if(!t||l>=t)return e;var a=(t-l)/2;return to(Wr(a),i)+e+to(Hr(a),i)}function Nb(e,t,i){e=me(e),t=Z(t);var l=t?mn(e):0;return t&&l<t?e+to(t-l,i):e}function Fb(e,t,i){e=me(e),t=Z(t);var l=t?mn(e):0;return t&&l<t?to(t-l,i)+e:e}function Ub(e,t,i){return i||t==null?t=0:t&&(t=+t),Vp(me(e).replace(Xo,""),t||0)}function Pb(e,t,i){return(i?ze(e,t,i):t===o)?t=1:t=Z(t),Bl(me(e),t)}function qb(){var e=arguments,t=me(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var $b=bn(function(e,t,i){return e+(i?"_":"")+t.toLowerCase()});function Hb(e,t,i){return i&&typeof i!="number"&&ze(e,t,i)&&(t=i=o),i=i===o?Wt:i>>>0,i?(e=me(e),e&&(typeof t=="string"||t!=null&&!Jl(t))&&(t=ct(t),!t&&cn(e))?Ai(Ft(e),0,i):e.split(t,i)):[]}var Wb=bn(function(e,t,i){return e+(i?" ":"")+is(t)});function Vb(e,t,i){return e=me(e),i=i==null?0:zi(Z(i),0,e.length),t=ct(t),e.slice(i,i+t.length)==t}function Gb(e,t,i){var l=m.templateSettings;i&&ze(e,t,i)&&(t=o),e=me(e),t=fo({},t,l,Ka);var a=fo({},t.imports,l.imports,Ka),u=De(a),f=fl(a,u),d,_,I=0,A=t.interpolate||Er,w="__p += '",N=gl((t.escape||Er).source+"|"+A.source+"|"+(A===_s?Cu:Er).source+"|"+(t.evaluate||Er).source+"|$","g"),P="//# sourceURL="+(ue.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Xu+"]")+`
`;e.replace(N,function(Y,ee,re,ut,Ye,pt){return re||(re=ut),w+=e.slice(I,pt).replace(wu,hp),ee&&(d=!0,w+=`' +
__e(`+ee+`) +
'`),Ye&&(_=!0,w+=`';
`+Ye+`;
__p += '`),re&&(w+=`' +
((__t = (`+re+`)) == null ? '' : __t) +
'`),I=pt+Y.length,Y}),w+=`';
`;var z=ue.call(t,"variable")&&t.variable;if(!z)w=`with (obj) {
`+w+`
}
`;else if(vu.test(z))throw new K(p);w=(_?w.replace(ru,""):w).replace(ou,"$1").replace(lu,"$1;"),w="function("+(z||"obj")+`) {
`+(z?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(d?", __e = _.escape":"")+(_?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+w+`return __p
}`;var X=Hc(function(){return ae(u,P+"return "+w).apply(o,f)});if(X.source=w,Xl(X))throw X;return X}function kb(e){return me(e).toLowerCase()}function jb(e){return me(e).toUpperCase()}function zb(e,t,i){if(e=me(e),e&&(i||t===o))return Qs(e);if(!e||!(t=ct(t)))return e;var l=Ft(e),a=Ft(t),u=Zs(l,a),f=Xs(l,a)+1;return Ai(l,u,f).join("")}function Yb(e,t,i){if(e=me(e),e&&(i||t===o))return e.slice(0,ea(e)+1);if(!e||!(t=ct(t)))return e;var l=Ft(e),a=Xs(l,Ft(t))+1;return Ai(l,0,a).join("")}function Kb(e,t,i){if(e=me(e),e&&(i||t===o))return e.replace(Xo,"");if(!e||!(t=ct(t)))return e;var l=Ft(e),a=Zs(l,Ft(t));return Ai(l,a).join("")}function Qb(e,t){var i=Wm,l=Vm;if(ve(t)){var a="separator"in t?t.separator:a;i="length"in t?Z(t.length):i,l="omission"in t?ct(t.omission):l}e=me(e);var u=e.length;if(cn(e)){var f=Ft(e);u=f.length}if(i>=u)return e;var d=i-mn(l);if(d<1)return l;var _=f?Ai(f,0,d).join(""):e.slice(0,d);if(a===o)return _+l;if(f&&(d+=_.length-d),Jl(a)){if(e.slice(d).search(a)){var I,A=_;for(a.global||(a=gl(a.source,me(hs.exec(a))+"g")),a.lastIndex=0;I=a.exec(A);)var w=I.index;_=_.slice(0,w===o?d:w)}}else if(e.indexOf(ct(a),d)!=d){var N=_.lastIndexOf(a);N>-1&&(_=_.slice(0,N))}return _+l}function Zb(e){return e=me(e),e&&su.test(e)?e.replace(gs,Mp):e}var Xb=bn(function(e,t,i){return e+(i?" ":"")+t.toUpperCase()}),is=Wa("toUpperCase");function $c(e,t,i){return e=me(e),t=i?o:t,t===o?vp(e)?Ap(e):up(e):e.match(t)||[]}var Hc=J(function(e,t){try{return st(e,o,t)}catch(i){return Xl(i)?i:new K(i)}}),Jb=mi(function(e,t){return gt(t,function(i){i=kt(i),ai(e,i,Ql(e[i],e))}),e});function e_(e){var t=e==null?0:e.length,i=k();return e=t?he(e,function(l){if(typeof l[1]!="function")throw new bt(c);return[i(l[0]),l[1]]}):[],J(function(l){for(var a=-1;++a<t;){var u=e[a];if(st(u[0],this,l))return st(u[1],this,l)}})}function t_(e){return Ef(ht(e,V))}function ns(e){return function(){return e}}function i_(e,t){return e==null||e!==e?t:e}var n_=Ga(),r_=Ga(!0);function Je(e){return e}function rs(e){return va(typeof e=="function"?e:ht(e,V))}function o_(e){return Ca(ht(e,V))}function l_(e,t){return ya(e,ht(t,V))}var s_=J(function(e,t){return function(i){return or(i,e,t)}}),a_=J(function(e,t){return function(i){return or(e,i,t)}});function os(e,t,i){var l=De(t),a=Yr(t,l);i==null&&!(ve(t)&&(a.length||!l.length))&&(i=t,t=e,e=this,a=Yr(t,De(t)));var u=!(ve(i)&&"chain"in i)||!!i.chain,f=pi(e);return gt(a,function(d){var _=t[d];e[d]=_,f&&(e.prototype[d]=function(){var I=this.__chain__;if(u||I){var A=e(this.__wrapped__),w=A.__actions__=Qe(this.__actions__);return w.push({func:_,args:arguments,thisArg:e}),A.__chain__=I,A}return _.apply(e,xi([this.value()],arguments))})}),e}function c_(){return Re._===this&&(Re._=Lp),this}function ls(){}function m_(e){return e=Z(e),J(function(t){return Sa(t,e)})}var u_=Ul(he),p_=Ul(ks),f_=Ul(al);function Wc(e){return Gl(e)?cl(kt(e)):Vf(e)}function d_(e){return function(t){return e==null?o:Yi(e,t)}}var g_=ja(),b_=ja(!0);function ss(){return[]}function as(){return!1}function __(){return{}}function h_(){return""}function T_(){return!0}function v_(e,t){if(e=Z(e),e<1||e>Ti)return[];var i=Wt,l=$e(e,Wt);t=k(t),e-=Wt;for(var a=pl(l,t);++i<e;)t(i);return a}function x_(e){return Q(e)?he(e,kt):mt(e)?[e]:Qe(ac(me(e)))}function C_(e){var t=++Dp;return me(e)+t}var y_=eo(function(e,t){return e+t},0),S_=Pl("ceil"),M_=eo(function(e,t){return e/t},1),E_=Pl("floor");function I_(e){return e&&e.length?zr(e,Je,yl):o}function A_(e,t){return e&&e.length?zr(e,k(t,2),yl):o}function w_(e){return Ys(e,Je)}function B_(e,t){return Ys(e,k(t,2))}function R_(e){return e&&e.length?zr(e,Je,Il):o}function D_(e,t){return e&&e.length?zr(e,k(t,2),Il):o}var O_=eo(function(e,t){return e*t},1),L_=Pl("round"),N_=eo(function(e,t){return e-t},0);function F_(e){return e&&e.length?ul(e,Je):0}function U_(e,t){return e&&e.length?ul(e,k(t,2)):0}return m.after=og,m.ary=Tc,m.assign=jg,m.assignIn=Oc,m.assignInWith=fo,m.assignWith=zg,m.at=Yg,m.before=vc,m.bind=Ql,m.bindAll=Jb,m.bindKey=xc,m.castArray=_g,m.chain=bc,m.chunk=E0,m.compact=I0,m.concat=A0,m.cond=e_,m.conforms=t_,m.constant=ns,m.countBy=Fd,m.create=Kg,m.curry=Cc,m.curryRight=yc,m.debounce=Sc,m.defaults=Qg,m.defaultsDeep=Zg,m.defer=lg,m.delay=sg,m.difference=w0,m.differenceBy=B0,m.differenceWith=R0,m.drop=D0,m.dropRight=O0,m.dropRightWhile=L0,m.dropWhile=N0,m.fill=F0,m.filter=Pd,m.flatMap=Hd,m.flatMapDeep=Wd,m.flatMapDepth=Vd,m.flatten=pc,m.flattenDeep=U0,m.flattenDepth=P0,m.flip=ag,m.flow=n_,m.flowRight=r_,m.fromPairs=q0,m.functions=rb,m.functionsIn=ob,m.groupBy=Gd,m.initial=H0,m.intersection=W0,m.intersectionBy=V0,m.intersectionWith=G0,m.invert=sb,m.invertBy=ab,m.invokeMap=jd,m.iteratee=rs,m.keyBy=zd,m.keys=De,m.keysIn=Xe,m.map=so,m.mapKeys=mb,m.mapValues=ub,m.matches=o_,m.matchesProperty=l_,m.memoize=co,m.merge=pb,m.mergeWith=Lc,m.method=s_,m.methodOf=a_,m.mixin=os,m.negate=mo,m.nthArg=m_,m.omit=fb,m.omitBy=db,m.once=cg,m.orderBy=Yd,m.over=u_,m.overArgs=mg,m.overEvery=p_,m.overSome=f_,m.partial=Zl,m.partialRight=Mc,m.partition=Kd,m.pick=gb,m.pickBy=Nc,m.property=Wc,m.propertyOf=d_,m.pull=Y0,m.pullAll=dc,m.pullAllBy=K0,m.pullAllWith=Q0,m.pullAt=Z0,m.range=g_,m.rangeRight=b_,m.rearg=ug,m.reject=Xd,m.remove=X0,m.rest=pg,m.reverse=Yl,m.sampleSize=eg,m.set=_b,m.setWith=hb,m.shuffle=tg,m.slice=J0,m.sortBy=rg,m.sortedUniq=ld,m.sortedUniqBy=sd,m.split=Hb,m.spread=fg,m.tail=ad,m.take=cd,m.takeRight=md,m.takeRightWhile=ud,m.takeWhile=pd,m.tap=Id,m.throttle=dg,m.thru=lo,m.toArray=Bc,m.toPairs=Fc,m.toPairsIn=Uc,m.toPath=x_,m.toPlainObject=Dc,m.transform=Tb,m.unary=gg,m.union=fd,m.unionBy=dd,m.unionWith=gd,m.uniq=bd,m.uniqBy=_d,m.uniqWith=hd,m.unset=vb,m.unzip=Kl,m.unzipWith=gc,m.update=xb,m.updateWith=Cb,m.values=Tn,m.valuesIn=yb,m.without=Td,m.words=$c,m.wrap=bg,m.xor=vd,m.xorBy=xd,m.xorWith=Cd,m.zip=yd,m.zipObject=Sd,m.zipObjectDeep=Md,m.zipWith=Ed,m.entries=Fc,m.entriesIn=Uc,m.extend=Oc,m.extendWith=fo,os(m,m),m.add=y_,m.attempt=Hc,m.camelCase=Ib,m.capitalize=Pc,m.ceil=S_,m.clamp=Sb,m.clone=hg,m.cloneDeep=vg,m.cloneDeepWith=xg,m.cloneWith=Tg,m.conformsTo=Cg,m.deburr=qc,m.defaultTo=i_,m.divide=M_,m.endsWith=Ab,m.eq=Pt,m.escape=wb,m.escapeRegExp=Bb,m.every=Ud,m.find=qd,m.findIndex=mc,m.findKey=Xg,m.findLast=$d,m.findLastIndex=uc,m.findLastKey=Jg,m.floor=E_,m.forEach=_c,m.forEachRight=hc,m.forIn=eb,m.forInRight=tb,m.forOwn=ib,m.forOwnRight=nb,m.get=es,m.gt=yg,m.gte=Sg,m.has=lb,m.hasIn=ts,m.head=fc,m.identity=Je,m.includes=kd,m.indexOf=$0,m.inRange=Mb,m.invoke=cb,m.isArguments=Zi,m.isArray=Q,m.isArrayBuffer=Mg,m.isArrayLike=Ze,m.isArrayLikeObject=Ee,m.isBoolean=Eg,m.isBuffer=wi,m.isDate=Ig,m.isElement=Ag,m.isEmpty=wg,m.isEqual=Bg,m.isEqualWith=Rg,m.isError=Xl,m.isFinite=Dg,m.isFunction=pi,m.isInteger=Ec,m.isLength=uo,m.isMap=Ic,m.isMatch=Og,m.isMatchWith=Lg,m.isNaN=Ng,m.isNative=Fg,m.isNil=Pg,m.isNull=Ug,m.isNumber=Ac,m.isObject=ve,m.isObjectLike=xe,m.isPlainObject=ur,m.isRegExp=Jl,m.isSafeInteger=qg,m.isSet=wc,m.isString=po,m.isSymbol=mt,m.isTypedArray=hn,m.isUndefined=$g,m.isWeakMap=Hg,m.isWeakSet=Wg,m.join=k0,m.kebabCase=Rb,m.last=vt,m.lastIndexOf=j0,m.lowerCase=Db,m.lowerFirst=Ob,m.lt=Vg,m.lte=Gg,m.max=I_,m.maxBy=A_,m.mean=w_,m.meanBy=B_,m.min=R_,m.minBy=D_,m.stubArray=ss,m.stubFalse=as,m.stubObject=__,m.stubString=h_,m.stubTrue=T_,m.multiply=O_,m.nth=z0,m.noConflict=c_,m.noop=ls,m.now=ao,m.pad=Lb,m.padEnd=Nb,m.padStart=Fb,m.parseInt=Ub,m.random=Eb,m.reduce=Qd,m.reduceRight=Zd,m.repeat=Pb,m.replace=qb,m.result=bb,m.round=L_,m.runInContext=b,m.sample=Jd,m.size=ig,m.snakeCase=$b,m.some=ng,m.sortedIndex=ed,m.sortedIndexBy=td,m.sortedIndexOf=id,m.sortedLastIndex=nd,m.sortedLastIndexBy=rd,m.sortedLastIndexOf=od,m.startCase=Wb,m.startsWith=Vb,m.subtract=N_,m.sum=F_,m.sumBy=U_,m.template=Gb,m.times=v_,m.toFinite=fi,m.toInteger=Z,m.toLength=Rc,m.toLower=kb,m.toNumber=xt,m.toSafeInteger=kg,m.toString=me,m.toUpper=jb,m.trim=zb,m.trimEnd=Yb,m.trimStart=Kb,m.truncate=Qb,m.unescape=Zb,m.uniqueId=C_,m.upperCase=Xb,m.upperFirst=is,m.each=_c,m.eachRight=hc,m.first=fc,os(m,function(){var e={};return Vt(m,function(t,i){ue.call(m.prototype,i)||(e[i]=t)}),e}(),{chain:!1}),m.VERSION=r,gt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){m[e].placeholder=m}),gt(["drop","take"],function(e,t){te.prototype[e]=function(i){i=i===o?1:Be(Z(i),0);var l=this.__filtered__&&!t?new te(this):this.clone();return l.__filtered__?l.__takeCount__=$e(i,l.__takeCount__):l.__views__.push({size:$e(i,Wt),type:e+(l.__dir__<0?"Right":"")}),l},te.prototype[e+"Right"]=function(i){return this.reverse()[e](i).reverse()}}),gt(["filter","map","takeWhile"],function(e,t){var i=t+1,l=i==ps||i==zm;te.prototype[e]=function(a){var u=this.clone();return u.__iteratees__.push({iteratee:k(a,3),type:i}),u.__filtered__=u.__filtered__||l,u}}),gt(["head","last"],function(e,t){var i="take"+(t?"Right":"");te.prototype[e]=function(){return this[i](1).value()[0]}}),gt(["initial","tail"],function(e,t){var i="drop"+(t?"":"Right");te.prototype[e]=function(){return this.__filtered__?new te(this):this[i](1)}}),te.prototype.compact=function(){return this.filter(Je)},te.prototype.find=function(e){return this.filter(e).head()},te.prototype.findLast=function(e){return this.reverse().find(e)},te.prototype.invokeMap=J(function(e,t){return typeof e=="function"?new te(this):this.map(function(i){return or(i,e,t)})}),te.prototype.reject=function(e){return this.filter(mo(k(e)))},te.prototype.slice=function(e,t){e=Z(e);var i=this;return i.__filtered__&&(e>0||t<0)?new te(i):(e<0?i=i.takeRight(-e):e&&(i=i.drop(e)),t!==o&&(t=Z(t),i=t<0?i.dropRight(-t):i.take(t-e)),i)},te.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},te.prototype.toArray=function(){return this.take(Wt)},Vt(te.prototype,function(e,t){var i=/^(?:filter|find|map|reject)|While$/.test(t),l=/^(?:head|last)$/.test(t),a=m[l?"take"+(t=="last"?"Right":""):t],u=l||/^find/.test(t);a&&(m.prototype[t]=function(){var f=this.__wrapped__,d=l?[1]:arguments,_=f instanceof te,I=d[0],A=_||Q(f),w=function(ee){var re=a.apply(m,xi([ee],d));return l&&N?re[0]:re};A&&i&&typeof I=="function"&&I.length!=1&&(_=A=!1);var N=this.__chain__,P=!!this.__actions__.length,z=u&&!N,X=_&&!P;if(!u&&A){f=X?f:new te(this);var Y=e.apply(f,d);return Y.__actions__.push({func:lo,args:[w],thisArg:o}),new _t(Y,N)}return z&&X?e.apply(this,d):(Y=this.thru(w),z?l?Y.value()[0]:Y.value():Y)})}),gt(["pop","push","shift","sort","splice","unshift"],function(e){var t=Dr[e],i=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",l=/^(?:pop|shift)$/.test(e);m.prototype[e]=function(){var a=arguments;if(l&&!this.__chain__){var u=this.value();return t.apply(Q(u)?u:[],a)}return this[i](function(f){return t.apply(Q(f)?f:[],a)})}}),Vt(te.prototype,function(e,t){var i=m[t];if(i){var l=i.name+"";ue.call(fn,l)||(fn[l]=[]),fn[l].push({name:t,func:i})}}),fn[Jr(o,Ht).name]=[{name:"wrapper",func:o}],te.prototype.clone=Qp,te.prototype.reverse=Zp,te.prototype.value=Xp,m.prototype.at=Ad,m.prototype.chain=wd,m.prototype.commit=Bd,m.prototype.next=Rd,m.prototype.plant=Od,m.prototype.reverse=Ld,m.prototype.toJSON=m.prototype.valueOf=m.prototype.value=Nd,m.prototype.first=m.prototype.head,Xn&&(m.prototype[Xn]=Dd),m},yi=wp();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(Re._=yi,define(function(){return yi})):Vi?((Vi.exports=yi)._=yi,rl._=yi):Re._=yi}).call(Hn)});var Ke=class extends Ri{idUser;idTimbre;acquis;doublon;constructor(r,n,s,c){super(),this.idUser=r||null,this.idTimbre=n||null,this.acquis=s||!1,this.doublon=c||!1}getIdUser(){return this.idUser}setIdUser(r){this.idUser=r}getIdTimbre(){return this.idTimbre}setIdTimbre(r){this.idTimbre=r}isAcquis(){return this.acquis}setAcquis(r){this.acquis=r}isDoublon(){return this.doublon}setDoublon(r){this.doublon=r}};oe([le("Identifiant Utilisateur")],Ke.prototype,"idUser",2),oe([le("Identifiant timbre")],Ke.prototype,"idTimbre",2),oe([le("Acquis")],Ke.prototype,"acquis",2),oe([le("Doublon")],Ke.prototype,"doublon",2);var dr=class{key;dossier;maxWidth;maxHeight;getKey(){return this.key}setKey(r){this.key=r}getDossier(){return this.dossier}setDossier(r){this.dossier=r}getMaxWidth(){return this.maxWidth}setMaxWidth(r){this.maxWidth=r}getMaxHeight(){return this.maxHeight}setMaxHeight(r){this.maxHeight=r}};var qi=class{dossier;nom;alignLabel;detail;file;getDossier(){return this.dossier}setDossier(r){this.dossier=r}getNom(){return this.nom}setNom(r){this.nom=r}getAlignLabel(){return this.alignLabel}setAlignLabel(r){this.alignLabel=r}getDetail(){return this.detail}setDetail(r){this.detail=r}getFile(){return this.file}setFile(r){this.file=r}};var Me=class o{constructor(r,n){this.authService=r;this.firestore=n}reinitResume$=new be(!0);initUpload(){let r=new qi;r.setDossier("table"),r.setNom(new Date().getTime()?.toString());let n=new dr;n.setMaxWidth(100),n.setMaxHeight(100),n.setDossier("autre");let s=new dr;return s.setMaxWidth(700),s.setMaxHeight(700),s.setDossier("zoom"),r.setDetail([n,s]),r}getAnneesAsync(r){return this.firestore.collection(r,n=>{let s=n;return s=s.orderBy("annee","desc"),s}).valueChanges().pipe(jt(n=>{let s=n.map(c=>Number(c.annee)).filter(c=>S(c)&&c!=0);return Array.from(new Set(s))}))}getTimbresByCritereAsync(r){return this.getAllTimbres(r).pipe(jt(n=>this.constructTimbres(n,null,null)))}getAllTimbres(r){return this.firestore.collection("/timbres",n=>{let s=n;return S(r)&&(S(r.getAnnees())&&r.getAnnees()?.length>0&&(s=s.where("annee","in",r.getAnnees())),r?.getType()?.length==0||r?.getType()?.length==1&&r?.getType()?.find(c=>c=="TIMBRE")?s=s.where("idBloc","==",null):r?.getType()?.length>0&&!r?.getType()?.find(c=>c=="TIMBRE")?s=s.where("idBloc","!=",null):S(r.getIdBloc())&&(s=s.where("idBloc","==",r.getIdBloc()))),s=s.orderBy("id","asc"),s}).valueChanges()}constructTimbres(r,n,s,c){let p=[];return r?.length>0&&r.forEach(g=>{let M=this.constructTimbre(g,n,s),L=!1;S(c)?((c?.getType()?.find(V=>V=="TIMBRE")&&Oe(M?.getTimbreBlocModel())||c?.getType()?.find(V=>V=="BLOC")&&S(M?.getTimbreBlocModel())&&M?.getTimbreBlocModel()?.getType()=="BLOC"||c?.getType()?.find(V=>V=="CARNET")&&S(M?.getTimbreBlocModel())&&M?.getTimbreBlocModel()?.getType()=="CARNET")&&(L=!0),S(M.getTimbreAcquisModel())&&(S(c.getAcquis())&&!(c.getAcquis()=="TOUS"||c.getAcquis()=="OUI"&&M.getTimbreAcquisModel().isAcquis()||c.getAcquis()=="NON"&&!M.getTimbreAcquisModel().isAcquis())&&(L=!1),S(c.getDoublon())&&!(c.getDoublon()=="TOUS"||c.getDoublon()=="OUI"&&M.getTimbreAcquisModel().isDoublon()||c.getDoublon()=="NON"&&!M.getTimbreAcquisModel().isDoublon())&&(L=!1))):L=!0,L==!0&&p.push(M)}),p}constructTimbre(r,n,s){let c=Di(Dt,r);if(S(s)){let p=s.find(g=>g.getId()==c?.getIdBloc());S(p)&&c.setTimbreBlocModel(p)}if(S(n)){let p=n.find(g=>g.idTimbre==c.getId());S(p)?c.setTimbreAcquisModel(Di(Ke,p)):c.setTimbreAcquisModel(new Ke)}return c}supprimerTimbreAcquis(r){this.firestore.collection("/timbres_acquis").ref.where("idTimbre","==",r.getId()).get().then(n=>{n.forEach(s=>{s.ref.delete()})})}supprimerTimbre(r){this.firestore.collection("/timbres").ref.where("id","==",r.getId()).get().then(n=>{n.forEach(s=>{s.ref.delete()})}).catch(n=>{console.error("Erreur de suppression :",n)})}acquis(r,n,s){this.authService.userSelect$.pipe(U(c=>S(c))).subscribe(c=>{this.firestore.collection("/timbres_acquis").ref.where("idTimbre","==",r.getId()).where("idUser","==",c.getId()).get().then(p=>{p?.size==0&&this.addAcquis(c.getId(),r,n),p.forEach(g=>{let M=Di(Ke,g.data());n?(M.setAcquis(!0),M.setDoublon(s||!M.isDoublon())):(M.setAcquis(s||!M.isAcquis()),M.isAcquis()||M.setDoublon(!1)),g.ref.update(Object.assign(new Object,M)).then(L=>{r.setTimbreAcquisModel(M)}).catch(L=>{console.error("Erreur de mise \xE0 jour:",L)})})}).catch(p=>{console.error("Erreur de mise \xE0 jour id introuvable :",p)}),this.reinitResume$.next(!0)})}supprimerAcquisTimbreByUser(r,n,s,c){this.firestore.collection("/timbres_acquis").ref.where("idTimbre","==",n.getId()).where("idUser","==",r).get().then(p=>{p?.size==0&&c&&this.addAcquis(r,n,s),p.forEach(g=>{g.ref.delete().then(M=>{c&&this.supprimerTimbreAcquis(n)})})}).catch(p=>{console.error("Erreur de suppression :",p)})}addAcquis(r,n,s){let c=new Ke;c.setIdUser(r),c.setIdTimbre(n.getId()),c.setAcquis(!0),c.setDoublon(s),n.setTimbreAcquisModel(c),this.firestore.collection("/timbres_acquis").add(Object.assign(new Object,c))}static \u0275fac=function(n){return new(n||o)(Te(Ve),Te(Cn))};static \u0275prov=Bi({token:o,factory:o.\u0275fac})};var Ot=class extends Ri{idUser;idBloc;acquis;doublon;constructor(r,n,s,c){super(),this.idUser=r||null,this.idBloc=n||null,this.acquis=s||!1,this.doublon=c||!1}getIdUser(){return this.idUser}setIdUser(r){this.idUser=r}getIdBloc(){return this.idBloc}setIdBloc(r){this.idBloc=r}isAcquis(){return this.acquis}setAcquis(r){this.acquis=r}isDoublon(){return this.doublon}setDoublon(r){this.doublon=r}};oe([le("Identifiant Utilisateur")],Ot.prototype,"idUser",2),oe([le("Identifiant bloc")],Ot.prototype,"idBloc",2),oe([le("Acquis")],Ot.prototype,"acquis",2),oe([le("Doublon")],Ot.prototype,"doublon",2);var k_=["canvas"];function j_(o,r){if(o&1&&(v(0,"span",6)(1,"b"),B(2),x()()),o&2){let n=C();h(2),$("N\xB0",n.timbreModel==null?null:n.timbreModel.getId(),"")}}function z_(o,r){o&1&&G(0,"lib-spinner",7),o&2&&T("textSpec","Chargement en cours ...")}function Y_(o,r){if(o&1&&(G(0,"mat-error",27),R(1,"async")),o&2){let n=C(2);T("innerHTML",D(1,1,n.messageError$),vn)}}function K_(o,r){if(o&1&&(v(0,"mat-option",18),B(1),x()),o&2){let n=r.$implicit,s=C(2);T("value",n),h(),Kc(" ",n.getAnnee()," - ",n.getId()," ",(n==null?null:n.getType())==s.TypeTimbreEnum.CARNET?" (carnet)":""," ")}}function Q_(o,r){if(o&1){let n=se();v(0,"img",28),j("click",function(){let c;H(n);let p=C(2);return W(p.utilsService.zoom(p.timbreModel==null||(c=p.timbreModel.getTimbreBlocModel())==null?null:c.getImageZoom()))}),x()}if(o&2){let n,s=C(2);T("src",s.timbreModel==null||(n=s.timbreModel.getTimbreBlocModel())==null?null:n.getImage(),xn)}}function Z_(o,r){if(o&1){let n=se();v(0,"form",8,1),j("ngSubmit",function(){H(n);let c=ye(1),p=C();return W(p.valider(c))}),v(2,"div",9),O(3,Y_,2,3,"mat-error",10),R(4,"async"),v(5,"div",11)(6,"div",12)(7,"label"),G(8,"lib-libelle-model",13),x(),v(9,"input",14),Pe("ngModelChange",function(c){H(n);let p=C();return Ue(p.timbreModel.annee,c)||(p.timbreModel.annee=c),W(c)}),j("ngModelChange",function(c){H(n);let p=C();return W(p.changeAnnee(c))}),x()(),v(10,"div",15)(11,"label"),G(12,"lib-libelle-model",13),x(),v(13,"div",16)(14,"mat-select",17),R(15,"async"),j("ngModelChange",function(c){H(n);let p=C();return W(p.changeBloc(c))}),G(16,"mat-option",18),O(17,K_,2,4,"mat-option",19),R(18,"async"),x(),O(19,Q_,1,1,"img",20),x()()(),v(20,"div",11)(21,"div",12)(22,"label"),G(23,"lib-libelle-model",13),x(),v(24,"input",21),Pe("ngModelChange",function(c){H(n);let p=C();return Ue(p.timbreModel.yt,c)||(p.timbreModel.yt=c),W(c)}),x()(),v(25,"div",12)(26,"label"),G(27,"lib-libelle-model",13),x(),v(28,"input",22),Pe("ngModelChange",function(c){H(n);let p=C();return Ue(p.timbreModel.type,c)||(p.timbreModel.type=c),W(c)}),x()()(),v(29,"lib-upload",23),j("outPutObject",function(c){H(n);let p=C();return W(p.timbreModel=c)}),x()(),v(30,"div",24)(31,"button",25),j("click",function(){H(n);let c=C();return W(c.close())}),B(32," Annuler "),x(),v(33,"button",26),B(34," Enregistrer "),x()()()}if(o&2){let n,s,c=ye(1),p=C();T("ngClass",c!=null&&c.submitted?"red-color":"blue-color"),h(3),T("ngIf",D(4,27,p.messageError$)),h(5),T("object",p.timbreModel)("key","annee"),h(),Fe("ngModel",p.timbreModel.annee),T("max",p.maxAnnee)("zMax",p.maxAnnee)("disabled",!!(p.timbreModel!=null&&p.timbreModel.getId())),h(3),T("object",p.timbreModel)("key","timbreBlocModel"),h(2),T("ngModel",p.timbreModel.getTimbreBlocModel())("placeholder","Choix bloc")("disabled",!!(p.timbreModel!=null&&p.timbreModel.getId())||((n=D(15,29,p.timbreBlocService.timbresBlocModel$))==null?null:n.length)<=0),h(2),T("value",null),h(),T("ngForOf",D(18,31,p.timbreBlocService.timbresBlocModel$)),h(2),T("ngIf",p.timbreModel==null||(s=p.timbreModel.getTimbreBlocModel())==null?null:s.getImage()),h(4),T("object",p.timbreModel)("key","yt"),h(),Fe("ngModel",p.timbreModel.yt),h(3),T("object",p.timbreModel)("key","type"),h(),Fe("ngModel",p.timbreModel.type),h(),T("object",p.timbreModel)("key","image")("zoom",p.timbreModel.getImageZoom())("maxWidth",p.DimensionImageEnum.WIDTH_TIMBRE)("maxHeight",p.DimensionImageEnum.HEIGTH_TIMBRE)}}var Fn=class o{constructor(r,n,s,c,p,g){this.httpResponseHandlerService=r;this.dialogRef=n;this.timbreService=s;this.timbreBlocService=c;this.timbreUtilsService=p;this.utilsService=g}canvas;messageError$=new be(null);load$=new be(null);id;maxAnnee=new Date().getFullYear();timbreModel=new Dt;fileUploadModel=new qi;TypeTimbreEnum=$t;DimensionImageEnum=Ji;ngOnInit(){this.fileUploadModel=this.timbreUtilsService.initUpload(),this.load$.next(!1),S(this.id)?this.timbreService.getTimbreByIdAsync(this.id).subscribe(r=>{this.timbreModel=r,S(r.getTimbreBlocModel())&&(this.timbreModel.setAnnee(r.getTimbreBlocModel().getAnnee()),this.timbreModel.setMonnaie(r.getTimbreBlocModel().getMonnaie())),this.load$.next(!0)}):(this.timbreModel.setAnnee(new Date().getFullYear()),this.timbreModel.setMonnaie("E"),this.load$.next(!0)),this.changeAnnee(this.timbreModel.getAnnee())}valider(r){if(this.messageError$.next(null),r?.valid)if(S(this.timbreModel.getImage()))this.saveData();else{this.messageError$.next("Veuillez s\xE9lectionner une image");return}}saveData(){this.load$.next(!1),S(this.timbreModel.getId())?this.save():this.ajouter()}ajouter(){this.utilsService.getMaxIdentAsync("/timbres").pipe(U()).subscribe(r=>{this.timbreModel.setId(r),this.save(!0)})}save(r){this.timbreModel.getAnnee()>=2002?this.timbreModel.setMonnaie("E"):this.timbreModel.getAnnee()>=1999?this.timbreModel.setMonnaie("FE"):this.timbreModel.setMonnaie("F");try{We([this.timbreService.upload(this.timbreModel,"autre"),this.timbreService.upload(this.timbreModel,"table"),this.timbreService.upload(this.timbreModel,"zoom")]).pipe(U(([n,s,c])=>S(n)&&S(c)&&S(s))).subscribe(([n,s,c])=>{S(n)&&n!="nok"&&this.timbreModel.setImage(n),S(s)&&s!="nok"&&this.timbreModel.setImageTable(s),S(c)&&c!="nok"&&this.timbreModel.setImageZoom(c),r?this.timbreService.ajouter(this.timbreModel,!0):this.timbreService.modifier(this.timbreModel),this.httpResponseHandlerService.showNotificationSuccess("Transaction termin\xE9e","Votre timbre a bien \xE9t\xE9 modifi\xE9e."),this.load$.next(!0),this.dialogRef.close()})}catch{this.httpResponseHandlerService.showNotificationError("Transaction non aboutie","Votre timbre n'a pas pu \xEAtre modifi\xE9."),this.load$.next(!0)}}close(){this.dialogRef.close()}changeAnnee(r){if(this.timbreModel.setTimbreBlocModel(null),S(r)){let n=new fr;n.initCritereBloc(),n.setAnnees([r]),n.setSort("desc"),this.timbreBlocService.getBlocs(n,!1)}}changeBloc(r){S(r)?(this.timbreModel.setIdBloc(r.getId()),this.timbreModel.setTimbreBlocModel(r),this.timbreModel.setMonnaie(r.getMonnaie()),this.timbreModel.setAnnee(r.getAnnee())):(this.timbreModel.setIdBloc(null),this.timbreModel.setTimbreBlocModel(null),this.timbreModel.setMonnaie("E"))}static \u0275fac=function(n){return new(n||o)(q(Co),q(Qt),q(Le),q(Ge),q(Me),q(nt))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-modifier"]],viewQuery:function(n,s){if(n&1&&gi(k_,5),n&2){let c;bi(c=_i())&&(s.canvas=c.first)}},decls:9,vars:6,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],["class","accent",4,"ngIf"],[3,"ngIf","ngIfElse"],[1,"accent"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","space-between stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","column","fxLayoutGap","20px",1,"bloc-modal"],[3,"innerHTML",4,"ngIf"],["fxLayout","row","fxLayout.lt-lg","column","fxLayoutGap","30px","fxLayoutGap.lt-lg","5px"],["fxLayout","column",1,"form-input"],[3,"object","key"],["name","page","type","number","minlength","4","maxlength","4","min","1900","zMin","1900","required","","zControl","",1,"annee",2,"width","60px !important",3,"ngModelChange","ngModel","max","zMax","disabled"],["fxLayout","column",1,"form-input","select"],["fxLayout","row","fxLayoutGap","15px"],["name","bloc",2,"width","180px !important",3,"ngModelChange","ngModel","placeholder","disabled"],[1,"selectMin",3,"value"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],["style","max-height: 40px","class","click",3,"src","click",4,"ngIf"],["name","yt","type","text","trim","","zControl","",3,"ngModelChange","ngModel"],["name","type","type","text","trim","","zControl","",3,"ngModelChange","ngModel"],[3,"outPutObject","object","key","zoom","maxWidth","maxHeight"],["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"],[3,"innerHTML"],[1,"click",2,"max-height","40px",3,"click","src"]],template:function(n,s){if(n&1&&(v(0,"div",2)(1,"div",3)(2,"span"),B(3),x(),O(4,j_,3,1,"span",4),x(),O(5,z_,1,1,"ng-template",5),R(6,"async"),O(7,Z_,35,33,"ng-template",null,0,et),x()),n&2){let c=ye(8);h(3),$("",s.timbreModel!=null&&s.timbreModel.getId()?"MODIFICATION":"AJOUT"," "),h(),T("ngIf",s.timbreModel==null?null:s.timbreModel.getId()),h(),T("ngIf",D(6,4,s.load$)==!1)("ngIfElse",c)}},dependencies:[it,Bn,Bt,At,Ct,tt,Se,zt,Oi,Kt,Yt,Li,Mt,Ui,yn,Sn,Et,Ni,In,An,wn,En,Mn,It,Fi,Rt,Dn,Rn,yo,On,Ln,So,Ae],encapsulation:2})};var Le=class o{constructor(r,n,s,c,p,g,M,L){this.firestore=r;this.authService=n;this.timbreBlocService=s;this.uploadService=c;this.utilsService=p;this.timbreUtilsService=g;this.dialog=M;this.preferenceService=L}total$=new be(0);timbres$=new be(null);load$=new be(!1);getTimbre(r){return this.firestore.collection("/timbres",n=>n.where("id","==",r)).valueChanges()}getTimbreByIdAsync(r){return We([this.getTimbre(r),this.timbreBlocService.getBlocsAsync()]).pipe(jt(([n,s])=>this.timbreUtilsService.constructTimbre(n[0],null,s)))}setTotal(r){this.total$.pipe(U()).subscribe(n=>{this.total$.next(n+r)})}getTotal(r){this.total$.next(null),this.timbreUtilsService.getAllTimbres(r).subscribe(n=>{this.total$.next(n?.length)})}getTimbres(r,n){n&&this.getTotal(),this.timbres$.next(null),this.load$.next(!1),We([this.timbreUtilsService.getAllTimbres(r),this.getTimbreAcquis(),this.timbreBlocService.getBlocsAsync(r)]).pipe(U()).subscribe(([s,c,p])=>{let g=this.timbreUtilsService.constructTimbres(s,c,p,r);g?.length>0&&(g=g.sort((M,L)=>M.getIdBloc()-L.getIdBloc()).sort((M,L)=>M?.getTimbreBlocModel()?.getNbTimbres()-L?.getTimbreBlocModel()?.getNbTimbres())),this.timbres$.next(g),this.load$.next(!0)})}getTimbreAcquis(){return this.authService.userSelect$.pipe(U(r=>S(r)),go(r=>S(r)?this.getTimbreAcquisByUser(r.getId()).pipe(U(),jt(n=>n)):null))}getTimbreAcquisByUser(r){return this.firestore.collection("/timbres_acquis",n=>n.where("idUser","==",r)).valueChanges()}ajouterSansId(r){this.utilsService.getMaxIdentAsync("/timbres").pipe(U()).subscribe(n=>{r.setId(n),S(r.getIdBloc())&&r.setMonnaie(null),this.ajouter(r,!0)})}ajouter(r,n){this.getTimbre(r.getId()).pipe(U()).subscribe(s=>{Oe(s)||Oe(s[0])||S(s[0])&&s[0]?.length==0?(r.setTimbreAcquisModel(null),r.setTimbreBlocModel(null),this.firestore.collection("/timbres").add(Object.assign(new Object,r)).then(c=>{n&&(this.preferenceService.getTimbreCritere("timbreCritere").pipe(U()).subscribe(p=>{S(p.getAnnees().find(g=>g==r.getAnnee()))&&this.timbres$.pipe(U()).subscribe(g=>{Oe(g)&&(g=[]),g.push(r),this.setTotal(1)})}),this.timbreUtilsService.reinitResume$.next(!0))}).catch(c=>{console.error("Erreur d'ajout :",c)})):console.error("timbre "+r.getId()+" d\xE9j\xE0 existant")})}modifier(r){r.setTimbreBlocModel(null),r.setTimbreAcquisModel(null),this.firestore.collection("/timbres").ref.where("id","==",r.getId()).get().then(n=>{n.forEach(s=>{s.ref.update(Object.assign(new Object,r)).then(c=>{this.timbres$.pipe(U(p=>S(p)&&p?.length>0)).subscribe(p=>{let g=p.find(M=>M.getId()==r.getId());S(g)&&Object.assign(g,r)})}).catch(c=>{console.error("Erreur de mise \xE0 jour :",c)})})}).catch(n=>{console.error("Erreur de mise \xE0 jour id introuvable :",n)})}supprimerTimbre(r){this.firestore.collection("/timbres").ref.where("id","==",r.getId()).get().then(n=>{n.forEach(s=>{s.ref.delete().then(c=>{this.timbres$.pipe(U()).subscribe(p=>{let g=p.findIndex(M=>M.getId()==r.getId());g>=0&&(p.splice(g,1),this.setTotal(-1))})}).catch(c=>{console.error("Erreur de suppression :",c)})})}).catch(n=>{console.error("Erreur de suppression id introuvable :",n)})}supprimer(r){this.timbreUtilsService.supprimerTimbreAcquis(r),this.supprimerTimbre(r),this.timbreUtilsService.reinitResume$.next(!0)}getBouchon(){let r=new Dt;return r.setAnnee(new Date().getFullYear()),r.setMonnaie("E"),r.setType(""),r.setYt(""),r}upload(r,n,s){let c=100,p=100;return n=="table"?(c=c*(50/p),p=50):n=="zoom"&&(c=c*(700/p),p=700),this.uploadService.processAndUploadImage(r?.getImage(),c,p,S(s)?s:r?.getId(),this.getDossier(r,n))}getDossier(r,n){let s="timbre//";return S(r.getIdBloc())?s=s+r.getTimbreBlocModel().getAnnee():s=s+r.getAnnee(),S(n)&&(s=s+"/"+n),S(r.getIdBloc())&&(s=s+"/bloc/"+r.getIdBloc()),s}acquisDoublon(r,n){this.authService.user$.pipe(U(s=>S(s))).subscribe(s=>{s?.getDroit()>=9?this.timbreUtilsService.acquis(r,n):this.utilsService.droitInsuffisant()})}modifierDialog(r){let n=this.dialog.open(Fn,{height:"75vh",maxHeight:"750px",width:"30%"});n.componentInstance.id=r.getId(),n.afterClosed().subscribe(()=>{n.close()})}supprimerDialog(r){let n=this.dialog.open(en,{maxHeight:"95vh",data:{titre:"Confirmation",message:"Souhaitez-vous supprimer le timbre <b>n\xB0 "+r?.getId()+"</b> ?",btnDroite:"Oui",btnGauche:"Non"}});n.afterClosed().subscribe(()=>{n.componentInstance.data.resultat==="valider"&&this.supprimer(r)})}static \u0275fac=function(n){return new(n||o)(Te(Cn),Te(Ve),Te(Ge),Te(Nn),Te(nt),Te(Me),Te(wt),Te(Xt))};static \u0275prov=Bi({token:o,factory:o.\u0275fac})};var X_=["canvas"];function J_(o,r){if(o&1&&(ie(0),G(1,"img",6),ne()),o&2){let n=r.$implicit;h(),T("src",n,xn)}}function eh(o,r){if(o&1&&(v(0,"div",4),O(1,J_,2,1,"ng-container",5),x()),o&2){let n=C();h(),T("ngForOf",n.selectedImages)}}var Ro=class o{constructor(r){this.utilsService=r}canvas;label="Choisir les images";maxWidth=100;maxHeight=200;alignLabel;outPutFiles=new zc;selectedImages=[];id="file"+Math.floor(Math.random()*Math.floor(1e3));FontAwesomeEnum=St;FontAwesomeTypeEnum=yt;triggerFileInput(){document.getElementById(this.id).click()}onFileSelected(r){let n=r.target.files;this.selectedImages=[];let s=[];n&&n?.length>0&&(Array.from(n).forEach(c=>{let p=new FileReader;p.onload=g=>{g.target?.result&&this.selectedImages.push(g.target.result)},p.readAsDataURL(c),s.push(c)}),this.outPutFiles.emit(s))}static \u0275fac=function(n){return new(n||o)(q(nt))};static \u0275cmp=Ce({type:o,selectors:[["lib-upload-multiple"]],viewQuery:function(n,s){if(n&1&&gi(X_,5),n&2){let c;bi(c=_i())&&(s.canvas=c.first)}},inputs:{label:"label",maxWidth:"maxWidth",maxHeight:"maxHeight",alignLabel:"alignLabel"},outputs:{outPutFiles:"outPutFiles"},decls:5,vars:3,consts:[[1,"form-input","uploadMultiple"],["type","file","accept","image/*","multiple","","hidden","",3,"change","id"],["type","button","mat-raised-button","","color","accent",1,"rounded","large","color-white",3,"click"],["class","listeImage",4,"ngIf"],[1,"listeImage"],[4,"ngFor","ngForOf"],["alt","Image preview",1,"imgSelect",3,"src"]],template:function(n,s){n&1&&(v(0,"div",0)(1,"input",1),j("change",function(p){return s.onFileSelected(p)}),x(),v(2,"button",2),j("click",function(){return s.triggerFileInput()}),B(3),x(),O(4,eh,2,1,"div",3),x()),n&2&&(h(),_o("id",s.id),h(2),$(" ",s.label," "),h(),T("ngIf",s.selectedImages.length))},dependencies:[tt,Se,it],styles:[".uploadMultiple[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:start;align-items:stretch;gap:10px;width:100%}.uploadMultiple[_ngcontent-%COMP%]   .listeImage[_ngcontent-%COMP%]{flex-direction:row;flex-wrap:wrap;justify-content:left;width:100%}.uploadMultiple[_ngcontent-%COMP%]   .listeImage[_ngcontent-%COMP%]   .imgSelect[_ngcontent-%COMP%]{margin:5px;max-width:100px;max-height:150px}"]})};var Pn=class o{transform(r,n){let s=[],c=Object.keys(r),p=Object.values(r);for(let g=0;g<c.length;g++)s.push({key:c[g],value:p[g]});return n=="sort"?s?.sort(function(g,M){return g.key<M.key?-1:g.key>M.key?1:0}):s}static \u0275fac=function(n){return new(n||o)};static \u0275pipe=bo({name:"enumToArray",type:o,pure:!0})};var qn=class o{transform(r,n){return S(r)&&typeof r=="string"?(r=r.toLowerCase(),r.charAt(0).toUpperCase()+r.slice(1)):r}static \u0275fac=function(n){return new(n||o)};static \u0275pipe=bo({name:"capitalize",type:o,pure:!0})};var ih=["canvas"];function nh(o,r){o&1&&G(0,"lib-spinner",5),o&2&&T("textSpec","Chargement en cours ...")}function rh(o,r){if(o&1&&(G(0,"mat-error",23),R(1,"async")),o&2){let n=C(2);T("innerHTML",D(1,1,n.messageError$),vn)}}function oh(o,r){if(o&1&&(v(0,"mat-option",25),B(1),R(2,"capitalize"),x()),o&2){let n=C().$implicit;T("value",n.value),h(),$(" ",D(2,2,n.value)," ")}}function lh(o,r){if(o&1&&(ie(0),O(1,oh,3,4,"mat-option",24),ne()),o&2){let n=r.$implicit,s=C(2);h(),T("ngIf",n.value!=s.TypeTimbreEnum.TIMBRE)}}function sh(o,r){if(o&1){let n=se();v(0,"form",6,1),j("ngSubmit",function(){H(n);let c=ye(1),p=C();return W(p.valider(c))}),v(2,"div",7),O(3,rh,2,3,"mat-error",8),R(4,"async"),v(5,"div",9)(6,"div",10)(7,"label"),G(8,"lib-libelle-model",11),x(),v(9,"input",12),Pe("ngModelChange",function(c){H(n);let p=C();return Ue(p.timbreBlocModel.annee,c)||(p.timbreBlocModel.annee=c),W(c)}),x()(),v(10,"div",13)(11,"label"),G(12,"lib-libelle-model",11),x(),v(13,"mat-select",14),Pe("ngModelChange",function(c){H(n);let p=C();return Ue(p.timbreBlocModel.type,c)||(p.timbreBlocModel.type=c),W(c)}),O(14,lh,2,1,"ng-container",15),R(15,"enumToArray"),x()()(),v(16,"div",9)(17,"div",10)(18,"label"),G(19,"lib-libelle-model",11),x(),v(20,"input",16),Pe("ngModelChange",function(c){H(n);let p=C();return Ue(p.timbreBlocModel.yt,c)||(p.timbreBlocModel.yt=c),W(c)}),x()(),G(21,"div",17),x(),v(22,"lib-upload",18),j("outPutObject",function(c){H(n);let p=C();return W(p.timbreBlocModel=c)}),x(),v(23,"lib-upload-multiple",19),j("outPutFiles",function(c){H(n);let p=C();return W(p.selectTimbres(c))}),x()(),v(24,"div",20)(25,"button",21),j("click",function(){H(n);let c=C();return W(c.close())}),B(26," Annuler "),x(),v(27,"button",22),B(28," Enregistrer "),x()()()}if(o&2){let n=ye(1),s=C();T("ngClass",n!=null&&n.submitted?"red-color":"blue-color"),h(3),T("ngIf",D(4,23,s.messageError$)),h(5),T("object",s.timbreBlocModel)("key","annee"),h(),Fe("ngModel",s.timbreBlocModel.annee),T("max",s.maxAnnee)("zMax",s.maxAnnee),h(3),T("object",s.timbreBlocModel)("key","type"),h(),Fe("ngModel",s.timbreBlocModel.type),T("placeholder","Type"),h(),T("ngForOf",D(15,25,s.TypeTimbreEnum)),h(5),T("object",s.timbreBlocModel)("key","yt"),h(),Fe("ngModel",s.timbreBlocModel.yt),h(2),T("object",s.timbreBlocModel)("key","image")("zoom",s.timbreBlocModel.getImageZoom())("maxWidth",s.DimensionImageEnum.WIDTH_TIMBRE)("maxHeight",s.DimensionImageEnum.HEIGTH_TIMBRE),h(),T("label","Timbres")("maxWidth",s.DimensionImageEnum.WIDTH_TIMBRE)("maxHeight",s.DimensionImageEnum.HEIGTH_TIMBRE)}}var $n=class o{constructor(r,n,s,c,p,g){this.httpResponseHandlerService=r;this.dialogRef=n;this.utilsService=s;this.timbreBlocService=c;this.timbreService=p;this.timbreUtilsService=g}canvas;messageError$=new be(null);load$=new be(null);id;maxAnnee=new Date().getFullYear()+1;timbreBlocModel=new Pi;fileUploadModel=new qi;DimensionImageEnum=Ji;TypeTimbreEnum=$t;ngOnInit(){this.fileUploadModel=this.timbreUtilsService.initUpload(),this.load$.next(!1),S(this.id)?this.timbreBlocService.getBlocByIdAsync(this.id).subscribe(r=>{this.timbreBlocModel=r,this.load$.next(!0)}):(this.timbreBlocModel.setAnnee(new Date().getFullYear()),this.timbreBlocModel.setMonnaie("E"),this.load$.next(!0))}valider(r){if(this.messageError$.next(null),r?.valid)if(S(this.timbreBlocModel.getImage()))this.saveData();else{this.messageError$.next("Veuillez s\xE9lectionner une image");return}}saveData(){this.load$.next(!1),S(this.timbreBlocModel.getId())?this.save():this.ajouter()}ajouter(){this.utilsService.getMaxIdentAsync("/timbres_bloc").pipe(U()).subscribe(r=>{this.timbreBlocModel.setId(r),this.save(!0)})}save(r){this.timbreBlocModel.getAnnee()>=2002?this.timbreBlocModel.setMonnaie("E"):this.timbreBlocModel.getAnnee()>=1999?this.timbreBlocModel.setMonnaie("FE"):this.timbreBlocModel.setMonnaie("F");try{We([this.timbreBlocService.upload(this.timbreBlocModel,"autre"),this.timbreBlocService.upload(this.timbreBlocModel,"table"),this.timbreBlocService.upload(this.timbreBlocModel,"zoom")]).pipe(U(([n,s,c])=>S(n)&&S(c)&&S(s))).subscribe(([n,s,c])=>{S(n)&&n!="nok"&&this.timbreBlocModel.setImage(n),S(s)&&s!="nok"&&this.timbreBlocModel.setImageTable(s),S(c)&&c!="nok"&&this.timbreBlocModel.setImageZoom(c),r?this.timbreBlocService.ajouter(this.timbreBlocModel,!0):this.timbreBlocService.modifier(this.timbreBlocModel),this.timbreBlocModel?.getTimbres()?.length>0?this.saveTimbres():this.validSuccess()})}catch{this.httpResponseHandlerService.showNotificationError("Transaction non aboutie","Votre timbre n'a pas pu \xEAtre modifi\xE9."),this.load$.next(!0)}}validSuccess(){this.httpResponseHandlerService.showNotificationSuccess("Transaction termin\xE9e","Votre timbre a bien \xE9t\xE9 modifi\xE9e."),this.load$.next(!0),this.dialogRef.close()}saveTimbres(){this.timbreBlocModel?.getTimbres()?.length>0&&this.utilsService.getMaxIdentAsync("/timbres").pipe(U()).subscribe(r=>{this.timbreBlocModel?.getTimbres().forEach((n,s)=>{n.setIdBloc(this.timbreBlocModel.getId()),n.setTimbreBlocModel(this.timbreBlocModel),n.setMonnaie(this.timbreBlocModel.getMonnaie()),n.setAnnee(this.timbreBlocModel.getAnnee()),n.setId(r),r++,We([this.timbreService.upload(n,"autre"),this.timbreService.upload(n,"table"),this.timbreService.upload(n,"zoom")]).pipe(U(([c,p,g])=>S(c)&&S(g)&&S(p))).subscribe(([c,p,g])=>{S(c)&&c!="nok"&&n.setImage(c),S(p)&&p!="nok"&&n.setImageTable(p),S(g)&&g!="nok"&&n.setImageZoom(g),this.timbreService.ajouter(n,!0),this.httpResponseHandlerService.showNotificationSuccess("Transaction termin\xE9e","Votre timbre a bien \xE9t\xE9 modifi\xE9e."),s==this.timbreBlocModel.getTimbres().length-1&&this.validSuccess()})})})}close(){this.dialogRef.close()}selectTimbres(r){this.timbreBlocModel.setTimbres(null),S(r)&&r?.length>0&&r.forEach(n=>{let s=new Dt;s.setImage(n),s.setYt(n?.name?.replace(/\.([a-z]+)$/,"")),this.timbreBlocModel.addTimbre(s)})}static \u0275fac=function(n){return new(n||o)(q(Co),q(Qt),q(nt),q(Ge),q(Le),q(Me))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-modifier-bloc"]],viewQuery:function(n,s){if(n&1&&gi(ih,5),n&2){let c;bi(c=_i())&&(s.canvas=c.first)}},decls:10,vars:6,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","space-between stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","column","fxLayoutGap","20px",1,"bloc-modal"],[3,"innerHTML",4,"ngIf"],["fxLayout","row","fxLayout.lt-lg","column","fxLayoutGap","30px","fxLayoutGap.lt-lg","5px"],["fxLayout","column",1,"form-input"],[3,"object","key"],["name","page","type","number","minlength","4","maxlength","4","min","1900","zMin","1900","required","","zControl","",1,"annee",2,"width","60px !important",3,"ngModelChange","ngModel","max","zMax"],[1,"form-input","select"],["name","type","required","",1,"scrollBarAccent",2,"width","100px",3,"ngModelChange","ngModel","placeholder"],[4,"ngFor","ngForOf"],["name","yt","type","text","trim","","zControl","",3,"ngModelChange","ngModel"],["fxHide.lt-lg","","fxLayout","column",1,"form-input"],[3,"outPutObject","object","key","zoom","maxWidth","maxHeight"],[3,"outPutFiles","label","maxWidth","maxHeight"],["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"],[3,"innerHTML"],["class","selectMin",3,"value",4,"ngIf"],[1,"selectMin",3,"value"]],template:function(n,s){if(n&1&&(v(0,"div",2)(1,"div",3)(2,"span"),B(3),x(),v(4,"span"),B(5),x()(),O(6,nh,1,1,"ng-template",4),R(7,"async"),O(8,sh,29,27,"ng-template",null,0,et),x()),n&2){let c=ye(9);h(3),$("",s.timbreBlocModel!=null&&s.timbreBlocModel.getId()?"MODIFICATION":"AJOUT"," BLOC "),h(2),ho(s.timbreBlocModel==null?null:s.timbreBlocModel.getId()),h(),T("ngIf",D(7,4,s.load$)==!1)("ngIfElse",c)}},dependencies:[it,Bn,Bt,At,Ct,tt,Se,zt,Oi,Kt,Yt,Li,To,Mt,Ui,yn,Sn,Et,Ni,In,An,wn,En,Mn,It,Fi,Dn,Rt,Rn,yo,On,Ln,So,Ro,Ae,Pn,qn],encapsulation:2})};var rn=class extends Ri{type;total;constructor(r,n){super(),this.type=r||null,this.total=n||null}getType(){return this.type}setType(r){this.type=r}getTotal(){return this.total}setTotal(r){this.total=r}};oe([le("Type")],rn.prototype,"type",2),oe([le("Total")],rn.prototype,"total",2);var us=Gc(Um());var Ge=class o{constructor(r,n,s,c,p,g,M){this.firestore=r;this.authService=n;this.uploadService=s;this.utilsService=c;this.timbreUtilsService=p;this.dialog=g;this.preferenceService=M}total$=new be([]);timbresBlocModel$=new be(null);load$=new be(!1);upload(r,n,s){let c=100,p=100;return n=="table"?(c=c*(50/p),p=50):n=="zoom"&&(c=c*(700/p),p=700),this.uploadService.processAndUploadImage(r?.getImage(),c,p,"bloc-"+r.getId(),this.getDossier(r,n,s))}setTotal(r,n){this.total$.pipe(U()).subscribe(s=>{let c=s.find(p=>p.getType()==r?.getType());S(c)?c.setTotal(c.getTotal()+1):s.push(new rn(r?.getType(),1)),this.total$.next(s)})}getTotal(r){this.total$.next(null),this.getAllBlocs(r).subscribe(n=>{let s=[];Object.keys($t).forEach(c=>{c!="TIMBRE"&&s.push(new rn(c,n?.filter(p=>p.type==c)?.length))}),this.total$.next(s)})}getBloc(r){return this.firestore.collection("/timbres_bloc",n=>n.where("id","==",r)).valueChanges()}getBlocByIdAsync(r){return this.getBloc(r).pipe(jt(n=>Di(Pi,n[0])))}getRef(r,n){let s=r;return S(n)&&(S(n.getAnnees())&&n.getAnnees()?.length>0&&(s=s.where("annee","in",n.getAnnees())),S(n.getType())&&n.getType()?.length>0&&(s=s.where("type","in",n.getType()))),s=s.orderBy("id",n?.getSort()=="desc"?"desc":"asc"),s}getAllBlocs(r){return this.firestore.collection("/timbres_bloc",n=>this.getRef(n,r)).valueChanges()}getTimbreBlocAcquis(){return this.authService.userSelect$.pipe(U(r=>S(r)),go(r=>S(r)?this.getTimbreBlocAcquisByUser(r.getId()).pipe(U(),jt(n=>n)):null))}getTimbreBlocAcquisByUser(r){return this.firestore.collection("/timbres_bloc_acquis",n=>n.where("idUser","==",r)).valueChanges()}getBlocs(r,n){this.load$.next(!1),this.timbresBlocModel$.next(null),n&&this.getTotal(),We([this.getAllBlocs(r),this.getTimbreBlocAcquis()]).pipe(U()).subscribe(([s,c])=>{this.timbresBlocModel$.next(this.constructBlocs(s,c,r)),this.load$.next(!0)})}getBlocsAsync(r){return this.timbresBlocModel$.next(null),this.getAllBlocs(r).pipe(U(),jt(n=>this.constructBlocs(n,null,r)))}constructBloc(r,n){let s=Di(Pi,r);if(S(n)){let c=n.find(p=>p.idBloc==s.getId());S(c)?s.setTimbreBlocAcquisModel(Di(Ot,c)):s.setTimbreBlocAcquisModel(new Ot)}return s}constructBlocs(r,n,s){let c=[];return r?.length>0&&r.forEach(p=>{let g=this.constructBloc(p,n);this.getTimbresByBlocAsync(g.getId()).subscribe(L=>{g.setNbTimbres(L?.length)});let M=!0;S(s)?S(g.getTimbreBlocAcquisModel())&&(S(s.getAcquis())&&!(s.getAcquis()=="TOUS"||s.getAcquis()=="OUI"&&g.getTimbreBlocAcquisModel().isAcquis()||s.getAcquis()=="NON"&&!g.getTimbreBlocAcquisModel().isAcquis())&&(M=!1),S(s.getDoublon())&&!(s.getDoublon()=="TOUS"||s.getDoublon()=="OUI"&&g.getTimbreBlocAcquisModel().isDoublon()||s.getDoublon()=="NON"&&!g.getTimbreBlocAcquisModel().isDoublon())&&(M=!1)):M=!0,M==!0&&c.push(g)}),c}acquis(r,n){return this.authService.userSelect$.pipe(U(s=>S(s))).subscribe(s=>{S(r?.getTimbreBlocAcquisModel()?.getIdUser())?this.firestore.collection("/timbres_bloc_acquis").ref.where("idBloc","==",r.getId()).where("idUser","==",s.getId()).get().then(c=>{c.forEach(p=>{let g=r.getTimbreBlocAcquisModel();n?(g.setAcquis(!0),g.setDoublon(!g.isDoublon())):(g.setAcquis(!g.isAcquis()),g.isAcquis()||g.setDoublon(!1)),p.ref.update(Object.assign(new Object,g)).then(M=>{r.setTimbreBlocAcquisModel(g)}).catch(M=>{console.error("Erreur de mise \xE0 jour:",M)})})}).catch(c=>{console.error("Erreur de mise \xE0 jour:",c)}):this.addAcquis(s?.getId(),r,n),this.timbreUtilsService.reinitResume$.next(!0)})}addAcquis(r,n,s){let c=new Ot;c.setIdUser(r),c.setIdBloc(n.getId()),c.setAcquis(!0),c.setDoublon(s),n.setTimbreBlocAcquisModel(c),this.firestore.collection("/timbres_bloc_acquis").add(Object.assign(new Object,c))}ajouterSansId(r){this.utilsService.getMaxIdentAsync("/timbres_bloc").pipe(U()).subscribe(n=>{r.setId(n),this.ajouter(r,!0)})}ajouter(r,n){let s=(0,us.cloneDeep)(r);this.getBloc(s.getId()).pipe(U()).subscribe(c=>{Oe(c)||Oe(c[0])||S(c[0])&&c[0]?.length==0?(s.setTimbreBlocAcquisModel(null),s.setTimbres(null),s.setIdOrigine(null),this.firestore.collection("/timbres_bloc").add(Object.assign(new Object,s)).then(p=>{this.preferenceService.getTimbreCritere("timbreCritere").pipe(U()).subscribe(g=>{S(g.getAnnees().find(M=>M==s.getAnnee()))&&this.timbresBlocModel$.pipe(U()).subscribe(M=>{Oe(M)&&(M=[]),M.push(s),this.setTotal(s,1)})}),this.timbreUtilsService.reinitResume$.next(!0)}).catch(p=>{console.error("Erreur d'ajout :",p)})):console.error("bloc "+s.getId()+" d\xE9j\xE0 existant")})}isCarnet(r){this.authService.user$.pipe(U(n=>S(n))).subscribe(n=>{n?.getDroit()>=9?(r.getType()=="BLOC"?r.setType("CARNET"):r.getType()=="CARNET"?r.setType("COLLECTOR"):r.setType("BLOC"),this.modifier(r)):this.utilsService.droitInsuffisant()})}modifier(r){let n=(0,us.cloneDeep)(r);n.setTimbreBlocAcquisModel(null),n.setTimbres(null),this.firestore.collection("/timbres_bloc").ref.where("id","==",n.getId()).get().then(s=>{s.forEach(c=>{c.ref.update(Object.assign(new Object,n)).then(p=>{this.timbresBlocModel$.pipe(U(g=>S(g)&&g?.length>0)).subscribe(g=>{let M=g.find(L=>L.getId()==n.getId());S(M)&&Object.assign(M,n)})}).catch(p=>{console.error("Erreur de mise \xE0 jour :",p)})})}).catch(s=>{console.error("Erreur de mise \xE0 jour id introuvable :",s)})}getTimbresByBlocAsync(r){let n=new fr;return n.setIdBloc(r),this.timbreUtilsService.getTimbresByCritereAsync(n)}supprimer(r){this.getTimbresByBlocAsync(r.getId()).pipe(U()).subscribe(n=>{n.forEach(s=>{this.timbreUtilsService.supprimerTimbreAcquis(s),this.timbreUtilsService.supprimerTimbre(s)})}),this.firestore.collection("/timbres_bloc_acquis").ref.where("idBloc","==",r.getId()).get().then(n=>{n.forEach(s=>{s.ref.delete()})}),this.firestore.collection("/timbres_bloc").ref.where("id","==",r.getId()).get().then(n=>{n.forEach(s=>{s.ref.delete().then(c=>{this.timbresBlocModel$.pipe(U()).subscribe(p=>{let g=p.findIndex(M=>M.getId()==r.getId());g>=0&&(p.splice(g,1),this.setTotal(r,-1))})}).catch(c=>{console.error("Erreur de suppression :",c)})})}).catch(n=>{console.error("Erreur de suppression id introuvable :",n)}),this.timbreUtilsService.reinitResume$.next(!0)}getDossier(r,n,s){let c="timbre//"+r.getAnnee();return S(n)&&(c=c+"/"+n),c=c+"/bloc/"+(S(s)?s:r.getId()),c}getBouchon(){let r=new Pi;return r.setAnnee(new Date().getFullYear()),r.setMonnaie("E"),r}acquisDoublon(r,n){this.authService.user$.pipe(U(s=>S(s))).subscribe(s=>{s?.getDroit()>=9?r?.getType()=="CARNET"?this.acquisCarnetDialog(r,n):this.acquis(r,n):this.utilsService.droitInsuffisant()})}acquisCarnetDialog(r,n){let s="";r?.getTimbreBlocAcquisModel()?.isDoublon()&&n?s="enlever les doublons":r?.getTimbreBlocAcquisModel()?.isAcquis()?s="enlever les acquis":s="mettre en "+(n?"doublon":"acquis")+" tous";let c=this.dialog.open(en,{maxHeight:"95vh",data:{titre:"Confirmation",message:"Souhaitez-vous <b>"+s+"</b> les timbres du "+r?.getType()?.toLowerCase()+" ?",btnDroite:"Oui",btnGauche:"Non"}});c.afterClosed().subscribe(()=>{c.componentInstance.data.resultat==="valider"&&this.authService.userSelect$.pipe(U(p=>S(p))).subscribe(p=>{this.getTimbresByBlocAsync(r.getId()).pipe(U()).subscribe(g=>{g.forEach(M=>{this.timbreUtilsService.acquis(M,n,!r?.getTimbreBlocAcquisModel()?.isAcquis())})}),this.acquis(r,n)})})}modifierDialog(r){let n=this.dialog.open($n,{height:"75vh",maxHeight:"750px",width:"30%"});n.componentInstance.id=r.getId(),n.afterClosed().subscribe(()=>{n.close()})}supprimerDialog(r){this.getTimbresByBlocAsync(r.getId()).pipe(U()).subscribe(n=>{let s="";S(n)&&n?.length>0&&(s="<span class='warn'>Attention <b>"+n.length+"</b> timbre",n?.length>1?s+="s sont reli\xE9s":s+=" est reli\xE9",s+=" \xE0 ce bloc.</span></br></br>"),s+="Souhaitez-vous supprimer le bloc <b>n\xB0 "+r?.getId()+"</b> ?";let c=this.dialog.open(en,{maxHeight:"95vh",data:{titre:"Confirmation",message:s,btnDroite:"Oui",btnGauche:"Non"}});c.afterClosed().subscribe(()=>{c.componentInstance.data.resultat==="valider"&&this.supprimer(r)})})}modifAll(){let r=new fr;this.getAllBlocs(r).pipe(U(n=>n?.length>0)).subscribe(n=>{n.forEach(s=>{s.carnet==!0?s.type="CARNET":s.type="BLOC",this.firestore.collection("/timbres_bloc").ref.where("id","==",s.id).get().then(c=>{c.forEach(p=>{p.ref.update(s)})})})})}static \u0275fac=function(n){return new(n||o)(Te(Cn),Te(Ve),Te(Nn),Te(nt),Te(Me),Te(wt),Te(Xt))};static \u0275prov=Bi({token:o,factory:o.\u0275fac})};var pe=class extends Ri{annee;total;nombre;acquis;doublon;nombreCarnet;nombreTimbresCarnet;acquisTimbresCarnet;doublonTimbresCarnet;nombreCollector;acquisCollector;doublonCollector;nombreTimbresCollector;acquisTimbresCollector;doublonTimbresCollector;nombreBloc;acquisBloc;doublonBloc;nombreTimbresBloc;acquisTimbresBloc;doublonTimbresBloc;constructor(r,n,s,c,p,g,M,L,V,_e,ce,rt,ii,ke,Ht,Wn,ot,ni,lt,ri,ft){super(),this.annee=r||null,this.total=n||0,this.nombre=s||0,this.acquis=c||0,this.doublon=p||0,this.nombreCarnet=g||0,this.nombreTimbresCarnet=M||0,this.acquisTimbresCarnet=L||0,this.doublonTimbresCarnet=V||0,this.nombreCollector=_e||0,this.nombreCollector=_e||0,this.acquisCollector=ce||0,this.nombreTimbresCollector=ii||0,this.acquisTimbresCollector=ke||0,this.doublonTimbresCollector=Ht||0,this.nombreBloc=Wn||0,this.acquisBloc=ot||0,this.doublonBloc=ni||0,this.nombreTimbresBloc=lt||0,this.acquisTimbresBloc=ri||0,this.doublonTimbresBloc=ft||0}getAnnee(){return this.annee}setAnnee(r){this.annee=r}getTotal(){return this.total}setTotal(r){this.total=r}getNombre(){return this.nombre}setNombre(r){this.nombre=r}getAcquis(){return this.acquis}setAcquis(r){this.acquis=r}getDoublon(){return this.doublon}setDoublon(r){this.doublon=r}getNombreCarnet(){return this.nombreCarnet}setNombreCarnet(r){this.nombreCarnet=r}getNombreTimbresCarnet(){return this.nombreTimbresCarnet}setNombreTimbresCarnet(r){this.nombreTimbresCarnet=r}getAcquisTimbresCarnet(){return this.acquisTimbresCarnet}setAcquisTimbresCarnet(r){this.acquisTimbresCarnet=r}getDoublonTimbresCarnet(){return this.doublonTimbresCarnet}setDoublonTimbresCarnet(r){this.doublonTimbresCarnet=r}getNombreCollector(){return this.nombreCollector}setNombreCollector(r){this.nombreCollector=r}getAcquisCollector(){return this.acquisCollector}setAcquisCollector(r){this.acquisCollector=r}getDoublonCollector(){return this.doublonCollector}setDoublonCollector(r){this.doublonCollector=r}getNombreTimbresCollector(){return this.nombreTimbresCollector}setNombreTimbresCollector(r){this.nombreTimbresCollector=r}getAcquisTimbresCollector(){return this.acquisTimbresCollector}setAcquisTimbresCollector(r){this.acquisTimbresCollector=r}getDoublonTimbresCollector(){return this.doublonTimbresCollector}setDoublonTimbresCollector(r){this.doublonTimbresCollector=r}getNombreBloc(){return this.nombreBloc}setNombreBloc(r){this.nombreBloc=r}getAcquisBloc(){return this.acquisBloc}setAcquisBloc(r){this.acquisBloc=r}getDoublonBloc(){return this.doublonBloc}setDoublonBloc(r){this.doublonBloc=r}getNombreTimbresBloc(){return this.nombreTimbresBloc}setNombreTimbresBloc(r){this.nombreTimbresBloc=r}getAcquisTimbresBloc(){return this.acquisTimbresBloc}setAcquisTimbresBloc(r){this.acquisTimbresBloc=r}getDoublonTimbresBloc(){return this.doublonTimbresBloc}setDoublonTimbresBloc(r){this.doublonTimbresBloc=r}};oe([le("Ann\xE9e")],pe.prototype,"annee",2),oe([le("Total")],pe.prototype,"total",2),oe([le("Nombre timbres")],pe.prototype,"nombre",2),oe([le("Total de timbres acquis")],pe.prototype,"acquis",2),oe([le("Total de timbres en doublon")],pe.prototype,"doublon",2),oe([le("Carnet")],pe.prototype,"nombreCarnet",2),oe([le("Timbres carnet")],pe.prototype,"nombreTimbresCarnet",2),oe([le("Total timbres carnet acquis")],pe.prototype,"acquisTimbresCarnet",2),oe([le("Total timbres carnet en doublon")],pe.prototype,"doublonTimbresCarnet",2),oe([le("Collector")],pe.prototype,"nombreCollector",2),oe([le("Total bloc collector")],pe.prototype,"acquisCollector",2),oe([le("Total bloc en collector")],pe.prototype,"doublonCollector",2),oe([le("Timbres collector")],pe.prototype,"nombreTimbresCollector",2),oe([le("Total timbres collector acquis")],pe.prototype,"acquisTimbresCollector",2),oe([le("Total timbres collector en doublon")],pe.prototype,"doublonTimbresCollector",2),oe([le("Nombre bloc")],pe.prototype,"nombreBloc",2),oe([le("Total bloc acquis")],pe.prototype,"acquisBloc",2),oe([le("Total bloc en doublon")],pe.prototype,"doublonBloc",2),oe([le("Timbres bloc")],pe.prototype,"nombreTimbresBloc",2),oe([le("Total timbres bloc acquis")],pe.prototype,"acquisTimbresBloc",2),oe([le("Total timbres bloc en doublon")],pe.prototype,"doublonTimbresBloc",2);var Do=class o{constructor(r,n,s){this.timbreService=r;this.timbreBlocService=n;this.timbreUtilsService=s}load$=new be(!1);timbresResume$=new be(null);totalTimbreResume$=new be(null);getResume(r){this.load$.next(!1),this.timbresResume$.next(null),this.totalTimbreResume$.next(null),We([this.timbreUtilsService.getAllTimbres(r),this.timbreService.getTimbreAcquis(),this.timbreBlocService.getAllBlocs(r),this.timbreBlocService.getTimbreBlocAcquis()]).pipe(U()).subscribe(([n,s,c,p])=>{this.timbresResume$.next(this.construct(n,s,c,p)),this.timbreUtilsService.reinitResume$.next(!1)})}construct(r,n,s,c){let p=[];if(r?.length>0&&(r.forEach(g=>{let M=g.annee;if(S(s)&&Oe(g.annee)&&S(g.idBloc)){let _e=s.find(ce=>ce.id==g.idBloc);S(_e)&&(M=_e.annee)}let L=p.find(_e=>_e.getAnnee()==M);Oe(L)&&(L=new pe,L.setAnnee(M),p.push(L)),L.setTotal(L.getTotal()+1);let V=S(g.idBloc)?s.find(_e=>_e.id==g.idBloc):null;if(S(g.idBloc)?S(V)&&V.type=="CARNET"?L.setNombreTimbresCarnet(L.getNombreTimbresCarnet()+1):S(V)&&V.type=="COLLECTOR"?L.setNombreTimbresCollector(L.getNombreTimbresCollector()+1):L.setNombreTimbresBloc(L.getNombreTimbresBloc()+1):L.setNombre(L.getNombre()+1),S(n)){let _e=n.find(ce=>ce.idTimbre==g.id);S(_e)&&(_e.acquis==!0&&(S(g.idBloc)?S(V)&&V.type=="CARNET"?L.setAcquisTimbresCarnet(L.getAcquisTimbresCarnet()+1):S(V)&&V.type=="COLLECTOR"?L.setAcquisTimbresCollector(L.getAcquisTimbresCollector()+1):L.setAcquisTimbresBloc(L.getAcquisTimbresBloc()+1):L.setAcquis(L.getAcquis()+1)),_e.doublon==!0&&(S(g.idBloc)?S(V)&&V.type=="CARNET"?L.setDoublonTimbresCarnet(L.getDoublonTimbresCarnet()+1):S(V)&&V.type=="COLLECTOR"?L.setDoublonTimbresCollector(L.getDoublonTimbresCollector()+1):L.setDoublonTimbresBloc(L.getDoublonTimbresBloc()+1):L.setDoublon(L.getDoublon()+1)))}}),s.forEach(g=>{let M=p.find(L=>L.getAnnee()==g.annee);if(Oe(M)&&(M=new pe,M.setAnnee(g.annee),p.push(M)),g.type=="CARNET"?M.setNombreCarnet(M.getNombreCarnet()+1):g.type=="COLLECTOR"?M.setNombreCollector(M.getNombreCollector()+1):M.setNombreBloc(M.getNombreBloc()+1),S(c)){let L=c.find(V=>V.idBloc==g.id);S(L)&&(L.acquis==!0&&(Oe(g.type)||g.type=="BLOC"?M.setAcquisBloc(M.getAcquisBloc()+1):g.type=="COLLECTOR"&&M.setAcquisCollector(M.getAcquisCollector()+1)),L.doublon==!0&&(Oe(g.type)||g.type=="BLOC"?M.setDoublonBloc(M.getDoublonBloc()+1):g.type=="COLLECTOR"&&M.setDoublonCollector(M.getDoublonCollector()+1)))}})),S(p)&&p?.length>0){let g=new pe;p.forEach(M=>{g.setTotal(g.getTotal()+M.getTotal()),g.setNombre(g.getNombre()+M.getNombre()),g.setAcquis(g.getAcquis()+M.getAcquis()),g.setDoublon(g.getDoublon()+M.getDoublon()),g.setNombreCarnet(g.getNombreCarnet()+M.getNombreCarnet()),g.setNombreTimbresCarnet(g.getNombreTimbresCarnet()+M.getNombreTimbresCarnet()),g.setAcquisTimbresCarnet(g.getAcquisTimbresCarnet()+M.getAcquisTimbresCarnet()),g.setDoublonTimbresCarnet(g.getDoublonTimbresCarnet()+M.getDoublonTimbresCarnet()),g.setNombreBloc(g.getNombreBloc()+M.getNombreBloc()),g.setAcquisBloc(g.getAcquisBloc()+M.getAcquisBloc()),g.setDoublonBloc(g.getDoublonBloc()+M.getDoublonBloc()),g.setNombreTimbresBloc(g.getNombreTimbresBloc()+M.getNombreTimbresBloc()),g.setAcquisTimbresBloc(g.getAcquisTimbresBloc()+M.getAcquisTimbresBloc()),g.setDoublonTimbresBloc(g.getDoublonTimbresBloc()+M.getDoublonTimbresBloc()),g.setNombreCollector(g.getNombreCollector()+M.getNombreCollector()),g.setAcquisCollector(g.getAcquisCollector()+M.getAcquisCollector()),g.setDoublonCollector(g.getDoublonCollector()+M.getDoublonCollector()),g.setNombreTimbresCollector(g.getNombreTimbresCollector()+M.getNombreTimbresCollector()),g.setAcquisTimbresCollector(g.getAcquisTimbresCollector()+M.getAcquisTimbresCollector()),g.setDoublonTimbresCollector(g.getDoublonTimbresCollector()+M.getDoublonTimbresCollector())}),this.totalTimbreResume$.next(g)}return this.load$.next(!0),p}static \u0275fac=function(n){return new(n||o)(Te(Le),Te(Ge),Te(Me))};static \u0275prov=Bi({token:o,factory:o.\u0275fac})};var Pm=class o{static \u0275fac=function(n){return new(n||o)};static \u0275mod=jc({type:o});static \u0275inj=kc({imports:[Zc,im,nm,om,lm,sm,rm,cm,am,Em,it,Im,At,Bt,xo]})};var qm=o=>({accent50:o});function ch(o,r){o&1&&G(0,"lib-spinner",2),o&2&&T("textSpec","Chargement en cours ...")}function mh(o,r){if(o&1&&(v(0,"th",35),G(1,"lib-libelle-model",36),x()),o&2){let n=C(2);h(),T("object",n.timbreResumeModel)("key","annee")}}function uh(o,r){if(o&1&&(v(0,"td",37),B(1),x()),o&2){let n=r.$implicit;h(),$(" ",n==null?null:n.getAnnee()," ")}}function ph(o,r){o&1&&G(0,"td",38)}function fh(o,r){if(o&1&&(v(0,"th",35),G(1,"lib-libelle-model",36),x()),o&2){let n=C(2);h(),T("object",n.timbreResumeModel)("key","total")}}function dh(o,r){if(o&1&&(v(0,"td",37),B(1),x()),o&2){let n=r.$implicit;h(),$(" ",n==null?null:n.getTotal()," ")}}function gh(o,r){if(o&1&&(v(0,"td",38)(1,"b"),B(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),$("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getTotal()," ")}}function bh(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-libelle-model",36),x()),o&2){let n=C(2);h(),T("object",n.timbreResumeModel)("key","nombre")}}function _h(o,r){if(o&1&&(v(0,"td",40),B(1),x()),o&2){let n=r.$implicit;h(),$(" ",n==null?null:n.getNombre()," ")}}function hh(o,r){if(o&1&&(v(0,"td",38)(1,"b"),B(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),$("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombre()," ")}}function Th(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK)("info",n.timbreResumeModel.getPropertyLibelle("acquis"))}}function vh(o,r){if(o&1&&(ie(0),B(1),ne()),o&2){let n=C().$implicit;h(),$(" ",n==null?null:n.getAcquis()," ")}}function xh(o,r){if(o&1&&(v(0,"td",42),R(1,"percent"),O(2,vh,2,1,"ng-container",43),x()),o&2){let n=r.$implicit;T("ngClass",pr(5,qm,(n==null?null:n.getNombre())==(n==null?null:n.getAcquis())))("matTooltip",(n==null?null:n.getAcquis())>0?D(1,3,(n==null?null:n.getAcquis())/(n==null?null:n.getNombre())):""),h(2),T("ngIf",(n==null?null:n.getAcquis())>0)}}function Ch(o,r){if(o&1&&(ie(0),v(1,"b"),B(2),R(3,"async"),R(4,"async"),R(5,"async"),R(6,"percent"),x(),ne()),o&2){let n,s=C(3);h(2),Yc("",(n=D(3,2,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquis()," (",D(6,8,((n=D(4,4,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquis())/((n=D(5,6,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombre())),")")}}function yh(o,r){if(o&1&&(v(0,"td",38),O(1,Ch,7,10,"ng-container",43),R(2,"async"),x()),o&2){let n,s=C(2);h(),T("ngIf",((n=D(2,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquis())>0)}}function Sh(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK_DOUBLE)("info",n.timbreResumeModel.getPropertyLibelle("doublon"))}}function Mh(o,r){if(o&1&&(v(0,"td",44),B(1),x()),o&2){let n=r.$implicit;T("ngClass",pr(2,qm,(n==null?null:n.getNombre())==(n==null?null:n.getDoublon()))),h(),$(" ",n==null?null:n.getDoublon()," ")}}function Eh(o,r){if(o&1&&(v(0,"td",38)(1,"b"),B(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),$("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getDoublon()," ")}}function Ih(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-libelle-model",36),x()),o&2){let n=C(2);h(),T("object",n.timbreResumeModel)("key","nombreCarnet")}}function Ah(o,r){if(o&1&&(v(0,"td",44),B(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreCarnet())==0?"gray25":"primary25"),h(),$(" ",(n==null?null:n.getNombreCarnet())>0?n==null?null:n.getNombreCarnet():""," ")}}function wh(o,r){if(o&1&&(v(0,"td",38)(1,"b"),B(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),$("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombreCarnet()," ")}}function Bh(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-libelle-model",36),x()),o&2){let n=C(2);h(),T("object",n.timbreResumeModel)("key","nombreTimbresCarnet")}}function Rh(o,r){if(o&1&&(v(0,"td",44),B(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreCarnet())==0?"gray25":"primary25"),h(),$(" ",(n==null?null:n.getNombreCarnet())>0?n==null?null:n.getNombreTimbresCarnet():""," ")}}function Dh(o,r){if(o&1&&(v(0,"td",38)(1,"b"),B(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),$("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombreTimbresCarnet()," ")}}function Oh(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK)("info",n.timbreResumeModel.getPropertyLibelle("acquisTimbresCarnet"))}}function Lh(o,r){if(o&1&&(v(0,"td",44),B(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreTimbresCarnet())==0?"gray25":(n==null?null:n.getNombreTimbresCarnet())==(n==null?null:n.getAcquisTimbresCarnet())?"accent50":"primary25"),h(),$(" ",(n==null?null:n.getNombreCarnet())>0?n==null?null:n.getAcquisTimbresCarnet():""," ")}}function Nh(o,r){if(o&1&&(v(0,"td",38)(1,"b"),B(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),$("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquisTimbresCarnet()," ")}}function Fh(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK_DOUBLE)("info",n.timbreResumeModel.getPropertyLibelle("doublonTimbresCarnet"))}}function Uh(o,r){if(o&1&&(v(0,"td",44),B(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreTimbresCarnet())==0?"gray25":(n==null?null:n.getNombreTimbresCarnet())==(n==null?null:n.getDoublonTimbresCarnet())?"accent50":"primary25"),h(),$(" ",(n==null?null:n.getNombreCarnet())>0?n==null?null:n.getDoublonTimbresCarnet():""," ")}}function Ph(o,r){if(o&1&&(v(0,"td",38)(1,"b"),B(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),$("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getDoublonTimbresCarnet()," ")}}function qh(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-libelle-model",36),x()),o&2){let n=C(2);h(),T("object",n.timbreResumeModel)("key","nombreBloc")}}function $h(o,r){if(o&1&&(v(0,"td",44),B(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreBloc())==0?"gray25":""),h(),$(" ",(n==null?null:n.getNombreBloc())>0?n==null?null:n.getNombreBloc():""," ")}}function Hh(o,r){if(o&1&&(v(0,"td",38)(1,"b"),B(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),$("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombreBloc()," ")}}function Wh(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK)("info",n.timbreResumeModel.getPropertyLibelle("acquisBloc"))}}function Vh(o,r){if(o&1&&(v(0,"td",44),B(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreBloc())==0?"gray25":n.getNombreBloc()==(n==null?null:n.getAcquisBloc())?"accent50":""),h(),$(" ",(n==null?null:n.getNombreBloc())>0?n==null?null:n.getAcquisBloc():""," ")}}function Gh(o,r){if(o&1&&(v(0,"td",38)(1,"b"),B(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),$("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquisBloc()," ")}}function kh(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK_DOUBLE)("info",n.timbreResumeModel.getPropertyLibelle("doublonBloc"))}}function jh(o,r){if(o&1&&(v(0,"td",44),B(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreBloc())==0?"gray25":n.getNombreBloc()==(n==null?null:n.getDoublonBloc())?"accent50":""),h(),$(" ",(n==null?null:n.getNombreBloc())>0?n==null?null:n.getDoublonBloc():""," ")}}function zh(o,r){if(o&1&&(v(0,"td",38)(1,"b"),B(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),$("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getDoublonBloc()," ")}}function Yh(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-libelle-model",36),x()),o&2){let n=C(2);h(),T("object",n.timbreResumeModel)("key","nombreTimbresBloc")}}function Kh(o,r){if(o&1&&(v(0,"td",44),B(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreTimbresBloc())==0?"gray25":"primary25"),h(),$(" ",(n==null?null:n.getNombreTimbresBloc())>0?n==null?null:n.getNombreTimbresBloc():""," ")}}function Qh(o,r){if(o&1&&(v(0,"td",38)(1,"b"),B(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),$("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombreTimbresBloc()," ")}}function Zh(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK)("info",n.timbreResumeModel.getPropertyLibelle("acquisTimbresBloc"))}}function Xh(o,r){if(o&1&&(v(0,"td",44),B(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreTimbresBloc())==0?"gray25":(n==null?null:n.getNombreTimbresBloc())==(n==null?null:n.getAcquisTimbresBloc())?"accent50":"primary25"),h(),$(" ",(n==null?null:n.getNombreTimbresBloc())>0?n==null?null:n.getAcquisTimbresBloc():""," ")}}function Jh(o,r){if(o&1&&(v(0,"td",38)(1,"b"),B(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),$("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquisTimbresBloc()," ")}}function e1(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK_DOUBLE)("info",n.timbreResumeModel.getPropertyLibelle("doublonTimbresBloc"))}}function t1(o,r){if(o&1&&(v(0,"td",44),B(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreTimbresBloc())==0?"gray25":(n==null?null:n.getNombreTimbresBloc())==(n==null?null:n.getDoublonTimbresBloc())?"accent50":"primary25"),h(),$(" ",(n==null?null:n.getNombreTimbresBloc())>0?n==null?null:n.getDoublonTimbresBloc():""," ")}}function i1(o,r){if(o&1&&(v(0,"td",38)(1,"b"),B(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),$("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getDoublonTimbresBloc()," ")}}function n1(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-libelle-model",36),x()),o&2){let n=C(2);h(),T("object",n.timbreResumeModel)("key","nombreCollector")}}function r1(o,r){if(o&1&&(v(0,"td",44),B(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreCollector())==0?"gray25":"primary25"),h(),$(" ",(n==null?null:n.getNombreCollector())>0?n==null?null:n.getNombreCollector():""," ")}}function o1(o,r){if(o&1&&(v(0,"td",38)(1,"b"),B(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),$("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombreCollector()," ")}}function l1(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK)("info",n.timbreResumeModel.getPropertyLibelle("acquisCollector"))}}function s1(o,r){if(o&1&&(v(0,"td",44),B(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreCollector())==0?"gray25":n.getNombreCollector()==(n==null?null:n.getAcquisCollector())?"accent50":""),h(),$(" ",(n==null?null:n.getNombreCollector())>0?n==null?null:n.getAcquisCollector():""," ")}}function a1(o,r){if(o&1&&(v(0,"td",38)(1,"b"),B(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),$("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquisCollector()," ")}}function c1(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK_DOUBLE)("info",n.timbreResumeModel.getPropertyLibelle("doublonCollector"))}}function m1(o,r){if(o&1&&(v(0,"td",44),B(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreCollector())==0?"gray25":n.getNombreCollector()==(n==null?null:n.getDoublonCollector())?"accent50":""),h(),$(" ",(n==null?null:n.getNombreCollector())>0?n==null?null:n.getDoublonCollector():""," ")}}function u1(o,r){if(o&1&&(v(0,"td",38)(1,"b"),B(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),$("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getDoublonCollector()," ")}}function p1(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-libelle-model",36),x()),o&2){let n=C(2);h(),T("object",n.timbreResumeModel)("key","nombreTimbresCollector")}}function f1(o,r){if(o&1&&(v(0,"td",44),B(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreCollector())==0?"gray25":"primary25"),h(),$(" ",(n==null?null:n.getNombreCollector())>0?n==null?null:n.getNombreTimbresCollector():""," ")}}function d1(o,r){if(o&1&&(v(0,"td",38)(1,"b"),B(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),$("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombreTimbresCollector()," ")}}function g1(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK)("info",n.timbreResumeModel.getPropertyLibelle("acquisTimbresCollector"))}}function b1(o,r){if(o&1&&(v(0,"td",44),B(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreTimbresCollector())==0?"gray25":(n==null?null:n.getNombreTimbresCollector())==(n==null?null:n.getAcquisTimbresCollector())?"accent50":"primary25"),h(),$(" ",(n==null?null:n.getNombreCollector())>0?n==null?null:n.getAcquisTimbresCollector():""," ")}}function _1(o,r){if(o&1&&(v(0,"td",38)(1,"b"),B(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),$("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquisTimbresCollector()," ")}}function h1(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK_DOUBLE)("info",n.timbreResumeModel.getPropertyLibelle("doublonTimbresCollector"))}}function T1(o,r){if(o&1&&(v(0,"td",44),B(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreTimbresCollector())==0?"gray25":(n==null?null:n.getNombreTimbresCollector())==(n==null?null:n.getDoublonTimbresCollector())?"accent50":"primary25"),h(),$(" ",(n==null?null:n.getNombreCollector())>0?n==null?null:n.getDoublonTimbresCollector():""," ")}}function v1(o,r){if(o&1&&(v(0,"td",38)(1,"b"),B(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),$("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getDoublonTimbresCollector()," ")}}function x1(o,r){o&1&&G(0,"tr",45)}function C1(o,r){if(o&1){let n=se();v(0,"tr",46),j("click",function(){let c=H(n).$implicit,p=C(2);return W(p.filtreParAnnee(c))}),x()}}function y1(o,r){o&1&&G(0,"tr",47)}function S1(o,r){if(o&1){let n=se();v(0,"table",3),j("matSortChange",function(c){H(n);let p=C();return W(p.sortData(c))}),ie(1,4),O(2,mh,2,2,"th",5)(3,uh,2,1,"td",6)(4,ph,1,0,"td",7),ne(),ie(5,8),O(6,fh,2,2,"th",5)(7,dh,2,1,"td",6)(8,gh,4,3,"td",7),ne(),ie(9,9),O(10,bh,2,2,"th",10)(11,_h,2,1,"td",11)(12,hh,4,3,"td",7),ne(),ie(13,12),O(14,Th,2,3,"th",10)(15,xh,3,7,"td",13)(16,yh,3,3,"td",7),ne(),ie(17,14),O(18,Sh,2,3,"th",10)(19,Mh,2,4,"td",15)(20,Eh,4,3,"td",7),ne(),ie(21,16),O(22,Ih,2,2,"th",10)(23,Ah,2,2,"td",15)(24,wh,4,3,"td",7),ne(),ie(25,17),O(26,Bh,2,2,"th",10)(27,Rh,2,2,"td",15)(28,Dh,4,3,"td",7),ne(),ie(29,18),O(30,Oh,2,3,"th",10)(31,Lh,2,2,"td",15)(32,Nh,4,3,"td",7),ne(),ie(33,19),O(34,Fh,2,3,"th",10)(35,Uh,2,2,"td",15)(36,Ph,4,3,"td",7),ne(),ie(37,20),O(38,qh,2,2,"th",10)(39,$h,2,2,"td",15)(40,Hh,4,3,"td",7),ne(),ie(41,21),O(42,Wh,2,3,"th",10)(43,Vh,2,2,"td",15)(44,Gh,4,3,"td",7),ne(),ie(45,22),O(46,kh,2,3,"th",10)(47,jh,2,2,"td",15)(48,zh,4,3,"td",7),ne(),ie(49,23),O(50,Yh,2,2,"th",10)(51,Kh,2,2,"td",15)(52,Qh,4,3,"td",7),ne(),ie(53,24),O(54,Zh,2,3,"th",10)(55,Xh,2,2,"td",15)(56,Jh,4,3,"td",7),ne(),ie(57,25),O(58,e1,2,3,"th",10)(59,t1,2,2,"td",15)(60,i1,4,3,"td",7),ne(),ie(61,26),O(62,n1,2,2,"th",10)(63,r1,2,2,"td",15)(64,o1,4,3,"td",7),ne(),B(65,"> "),ie(66,27),O(67,l1,2,3,"th",10)(68,s1,2,2,"td",15)(69,a1,4,3,"td",7),ne(),ie(70,28),O(71,c1,2,3,"th",10)(72,m1,2,2,"td",15)(73,u1,4,3,"td",7),ne(),ie(74,29),O(75,p1,2,2,"th",10)(76,f1,2,2,"td",15)(77,d1,4,3,"td",7),ne(),ie(78,30),O(79,g1,2,3,"th",10)(80,b1,2,2,"td",15)(81,_1,4,3,"td",7),ne(),ie(82,31),O(83,h1,2,3,"th",10)(84,T1,2,2,"td",15)(85,v1,4,3,"td",7),ne(),O(86,x1,1,0,"tr",32)(87,C1,1,0,"tr",33)(88,y1,1,0,"tr",34),x()}if(o&2){let n=C();T("dataSource",n.dataSource),h(86),T("matHeaderRowDef",n.displayedColumns)("matHeaderRowDefSticky",!0),h(),T("matRowDefColumns",n.displayedColumns),h(),T("matFooterRowDef",n.displayedColumns)("matFooterRowDefSticky",!0)}}var Oo=class o{constructor(r,n,s,c,p,g,M){this.authService=r;this.dialogRef=n;this.timbreResumeService=s;this.timbreService=c;this.timbreBlocService=p;this.timbreUtilsService=g;this.preferenceService=M;this.dataSource=new cs([])}paginator;sort;dataSource=new cs;displayedColumns=[];timbreResumeModel=new pe;FontAwesomeEnum=St;FontAwesomeTypeEnum=yt;ngOnInit(){this.initColumns(),this.timbreUtilsService.reinitResume$.pipe(U()).subscribe(r=>{r==!0&&this.timbreResumeService.getResume(),this.initData()})}initColumns(){this.authService.user$.pipe(U(r=>S(r))).subscribe(r=>{let n=[];n.push("annee","total","nombre","acquis"),r?.getDroit()==10&&n.push("doublon"),n.push("nombreCarnet","nombreTimbresCarnet","acquisTimbresCarnet"),r?.getDroit()==10&&n.push("doublonTimbresCarnet"),n.push("nombreBloc","acquisBloc"),r?.getDroit()==10&&n.push("doublonBloc"),n.push("nombreTimbresBloc","acquisTimbresBloc"),r?.getDroit()==10&&n.push("doublonTimbresBloc"),n.push(),(r?.getDroit()==2||r?.getDroit()==10)&&n.push("nombreCollector","acquisCollector"),this.displayedColumns=n})}initData(){this.timbreResumeService.timbresResume$.pipe(U(r=>S(r)&&r?.length>0)).subscribe(r=>{this.dataSource.data=r})}ngAfterViewInit(){this.dataSource.paginator=this.paginator}sortData(r){S(r)&&(this.dataSource.sort=this.sort)}filtreParAnnee(r){window.location.href.indexOf("bloc")>0?this.preferenceService.getTimbreCritere("blocCritere").pipe(U()).subscribe(n=>{n.initCritereBloc(),n.setAnnees([r.getAnnee()]),this.preferenceService.modifier("blocCritere",n),this.timbreBlocService.getBlocs(n,!1)}):this.preferenceService.getTimbreCritere("timbreCritere").pipe(U()).subscribe(n=>{n.initCritere(),n.setAnnees([r.getAnnee()]),this.preferenceService.modifier("timbreCritere",n),this.timbreService.getTimbres(n,!1)}),this.dialogRef.close()}static \u0275fac=function(n){return new(n||o)(q(Ve),q(Qt),q(Do),q(Le),q(Ge),q(Me),q(Xt))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-resume"]],viewQuery:function(n,s){if(n&1&&(gi(um,5),gi(vo,5)),n&2){let c;bi(c=_i())&&(s.paginator=c.first),bi(c=_i())&&(s.sort=c.first)}},decls:4,vars:4,consts:[["load",""],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["mat-table","","matSort","",3,"matSortChange","dataSource"],["matColumnDef","annee","sticky",""],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","primary50",4,"matCellDef"],["mat-footer-cell","",4,"matFooterCellDef"],["matColumnDef","total","sticky",""],["matColumnDef","nombre"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","acquis"],["mat-cell","",3,"ngClass","matTooltip",4,"matCellDef"],["matColumnDef","doublon"],["mat-cell","",3,"ngClass",4,"matCellDef"],["matColumnDef","nombreCarnet"],["matColumnDef","nombreTimbresCarnet"],["matColumnDef","acquisTimbresCarnet"],["matColumnDef","doublonTimbresCarnet"],["matColumnDef","nombreBloc"],["matColumnDef","acquisBloc"],["matColumnDef","doublonBloc"],["matColumnDef","nombreTimbresBloc"],["matColumnDef","acquisTimbresBloc"],["matColumnDef","doublonTimbresBloc"],["matColumnDef","nombreCollector"],["matColumnDef","acquisCollector"],["matColumnDef","doublonCollector"],["matColumnDef","nombreTimbresCollector"],["matColumnDef","acquisTimbresCollector"],["matColumnDef","doublonTimbresCollector"],["mat-header-row","","class","bg-primary color-white",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","mat-row",3,"click",4,"matRowDef","matRowDefColumns"],["mat-footer-row","","class","bg-primary color-white",4,"matFooterRowDef","matFooterRowDefSticky"],["mat-header-cell","","mat-sort-header",""],[3,"object","key"],["mat-cell","",1,"primary50"],["mat-footer-cell",""],["mat-header-cell",""],["mat-cell",""],[1,"click",2,"font-size","1.2em",3,"type","icone","info"],["mat-cell","",3,"ngClass","matTooltip"],[4,"ngIf"],["mat-cell","",3,"ngClass"],["mat-header-row","",1,"bg-primary","color-white"],["mat-row","",1,"mat-row",3,"click"],["mat-footer-row","",1,"bg-primary","color-white"]],template:function(n,s){if(n&1&&(O(0,ch,1,1,"ng-template",1),R(1,"async"),O(2,S1,89,6,"ng-template",null,0,et)),n&2){let c=ye(3);T("ngIf",D(1,2,s.timbreResumeService.load$)==!1)("ngIfElse",c)}},dependencies:[mm,pm,dm,vm,bm,fm,Cm,gm,xm,_m,Tm,hm,ym,Mm,Sm,vo,xo,Ct,Se,Yt,Mt,Rt,Zt,Dn,Ae,Qc],styles:["th[_ngcontent-%COMP%], tr[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{text-align:center}th[_ngcontent-%COMP%]{width:40px!important;max-width:40px!important}.mat-row[_ngcontent-%COMP%]{padding:0!important;height:30px}.mat-row[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{width:40px!important}@media screen and (max-width: 800px){th[_ngcontent-%COMP%]{width:25px!important;max-width:25px!important}.mat-row[_ngcontent-%COMP%]{padding:0!important;height:15px}.mat-row[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{width:25px!important}th[_ngcontent-%COMP%], .mat-row[_ngcontent-%COMP%]{font-size:.8em}}"]})};var $m=Gc(q_());function M1(o,r){if(o&1&&(v(0,"mat-option",7),B(1),R(2,"capitalize"),x()),o&2){let n=C().$implicit;T("value",n.value),h(),$(" ",D(2,2,n.value)," ")}}function E1(o,r){if(o&1&&(ie(0),O(1,M1,3,4,"mat-option",11),ne()),o&2){let n=r.$implicit,s=C(2);h(),T("ngIf",n.value!=s.TypeTimbreEnum.COLLECTOR)}}function I1(o,r){if(o&1&&(v(0,"mat-option",7),B(1),x()),o&2){let n=r.$implicit;T("value",n),h(),$(" ",n," ")}}function A1(o,r){if(o&1){let n=se();v(0,"div",1)(1,"div",2)(2,"mat-select",3),Pe("ngModelChange",function(c){H(n);let p=C();return Ue(p.preferenceService.timbreCritereModel.type,c)||(p.preferenceService.timbreCritereModel.type=c),W(c)}),j("ngModelChange",function(){H(n);let c=C();return W(c.filtreByCritere())}),O(3,E1,2,1,"ng-container",4),R(4,"enumToArray"),x()(),v(5,"div",5)(6,"mat-select",6),Pe("ngModelChange",function(c){H(n);let p=C();return Ue(p.preferenceService.timbreCritereModel.acquis,c)||(p.preferenceService.timbreCritereModel.acquis=c),W(c)}),j("ngModelChange",function(){H(n);let c=C();return W(c.filtreByCritere())}),v(7,"mat-option",7),B(8," Oui"),x(),v(9,"mat-option",7),B(10," Non"),x(),v(11,"mat-option",7),B(12," Tous"),x()()(),v(13,"div",5)(14,"mat-select",8),Pe("ngModelChange",function(c){H(n);let p=C();return Ue(p.preferenceService.timbreCritereModel.doublon,c)||(p.preferenceService.timbreCritereModel.doublon=c),W(c)}),j("ngModelChange",function(){H(n);let c=C();return W(c.filtreByCritere())}),v(15,"mat-option",7),B(16," Oui"),x(),v(17,"mat-option",7),B(18," Non"),x(),v(19,"mat-option",7),B(20," Tous"),x()()(),v(21,"div",5)(22,"mat-select",9),Pe("ngModelChange",function(c){H(n);let p=C();return Ue(p.preferenceService.timbreCritereModel.annees,c)||(p.preferenceService.timbreCritereModel.annees=c),W(c)}),j("ngModelChange",function(){H(n);let c=C();return W(c.filtreByCritere())}),O(23,I1,2,2,"mat-option",10),R(24,"async"),x()()()}if(o&2){let n=C();h(2),Fe("ngModel",n.preferenceService.timbreCritereModel.type),T("placeholder","Type"),h(),T("ngForOf",D(4,16,n.TypeTimbreEnum)),h(3),Fe("ngModel",n.preferenceService.timbreCritereModel.acquis),T("placeholder","Acquis"),h(),T("value","OUI"),h(2),T("value","NON"),h(2),T("value","TOUS"),h(3),Fe("ngModel",n.preferenceService.timbreCritereModel.doublon),T("placeholder","Doublon"),h(),T("value","OUI"),h(2),T("value","NON"),h(2),T("value","TOUS"),h(3),Fe("ngModel",n.preferenceService.timbreCritereModel.annees),T("placeholder","Ann\xE9es"),h(),T("ngForOf",D(24,18,n.annees$))}}var No=class o{constructor(r,n,s,c){this.authService=r;this.timbreService=n;this.timbreUtilsService=s;this.preferenceService=c}modif=!0;annees$;TypeTimbreEnum=$t;ngOnInit(){this.annees$=this.timbreUtilsService.getAnneesAsync("/timbres")}filtreByCritere(){this.preferenceService.timbreCritereModel.getAcquis()=="NON"&&this.preferenceService.timbreCritereModel.setDoublon("TOUS"),this.preferenceService.modifier("timbreCritere",this.preferenceService.timbreCritereModel),this.recherche()}recherche(){S(this.preferenceService.timbreCritereModel.getAnnees())&&this.preferenceService.timbreCritereModel.getAnnees().length>0&&this.timbreService.getTimbres(this.preferenceService.timbreCritereModel,!1)}static \u0275fac=function(n){return new(n||o)(q(Ve),q(Le),q(Me),q(Xt))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-recherche"]],inputs:{modif:"modif"},decls:1,vars:1,consts:[["class","menuRecherche",4,"ngIf"],[1,"menuRecherche"],[1,"form-input","select",2,"width","120px"],["name","type","multiple","",1,"scrollBarAccent",3,"ngModelChange","ngModel","placeholder"],[4,"ngFor","ngForOf"],[1,"form-input","select",2,"width","100px"],["name","acquis",3,"ngModelChange","ngModel","placeholder"],[1,"selectMin",3,"value"],["name","doublon",1,"scrollBarAccent",3,"ngModelChange","ngModel","placeholder"],["name","anneeSelect","multiple","",3,"ngModelChange","ngModel","placeholder"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],["class","selectMin",3,"value",4,"ngIf"]],template:function(n,s){n&1&&O(0,A1,25,20,"div",0),n&2&&T("ngIf",s.modif)},dependencies:[Bt,At,tt,Se,Et,It,Ae,Pn,qn],styles:[".menuRecherche[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:left;width:100%}.menuRecherche[_ngcontent-%COMP%] > .form-input[_ngcontent-%COMP%]{margin:0 10px;display:flex;flex-direction:column;justify-content:space-between;align-items:stretch}@media screen and (max-width: 800px){.menuRecherche[_ngcontent-%COMP%] > .form-input[_ngcontent-%COMP%]{margin:5px 10px}}"]})};function B1(o,r){if(o&1&&(v(0,"div",3)(1,"span"),B(2,"Nombre de timbres : "),x(),v(3,"span",4),B(4),R(5,"async"),x()()),o&2){let n=C();h(4),ho(D(5,1,n.total$))}}var Fo=class o{constructor(r){this.dialog=r}total$;FontAwesomeEnum=St;FontAwesomeTypeEnum=yt;resume(){this.dialog.open(Oo,{height:"auto",maxHeight:"95vh",width:"1200px"})}static \u0275fac=function(n){return new(n||o)(q(wt))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-total"]],inputs:{total$:"total$"},decls:4,vars:6,consts:[[1,"timbreTotal"],["class","nbTimbre",4,"ngIf"],[1,"accent","click",3,"click","icone","type","info"],[1,"nbTimbre"],[1,"bold"]],template:function(n,s){n&1&&(v(0,"div",0),O(1,B1,6,3,"div",1),R(2,"async"),v(3,"lib-icon",2),j("click",function(){return s.resume()}),x()()),n&2&&(h(),T("ngIf",D(2,4,s.total$)),h(2),T("icone",s.FontAwesomeEnum.CHART_LINE_UP)("type",s.FontAwesomeTypeEnum.TYPE_SOLID)("info","D\xE9tail par ann\xE9e"))},dependencies:[Se,Zt,Ae],styles:[".timbreTotal[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:start;align-content:center;gap:10px}.timbreTotal[_ngcontent-%COMP%]   .nbTimbre[_ngcontent-%COMP%]{font-size:1.2em;justify-content:start;align-content:center}.timbreTotal[_ngcontent-%COMP%]   lib-icon[_ngcontent-%COMP%]{font-size:1.5em}@media screen and (max-width: 800px){.timbreTotal[_ngcontent-%COMP%]{height:25px;gap:5px}.timbreTotal[_ngcontent-%COMP%]   .nbTimbre[_ngcontent-%COMP%]{font-size:1em}.timbreTotal[_ngcontent-%COMP%]   lib-icon[_ngcontent-%COMP%]{font-size:1.2em}}"]})};function D1(o,r){if(o&1){let n=se();v(0,"lib-icon",21),j("click",function(){H(n);let c=C().$implicit,p=C();return W(p.timbreService.acquisDoublon(c,!1))}),x()}if(o&2){let n,s,c,p=C().$implicit,g=C();T("classIcone",!(p==null||(n=p.getTimbreAcquisModel())==null)&&n.isAcquis()?"accent":"primary")("type",g.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",!(p==null||(s=p.getTimbreAcquisModel())==null)&&s.isAcquis()?g.FontAwesomeEnum.CIRCLE_MINUS:g.FontAwesomeEnum.CIRCLE_PLUS)("info",!(p==null||(c=p.getTimbreAcquisModel())==null)&&c.isAcquis()?"pas acquis":"acquis")}}function O1(o,r){if(o&1){let n=se();v(0,"lib-icon",21),j("click",function(){H(n);let c=C().$implicit,p=C();return W(p.timbreService.acquisDoublon(c,!0))}),x()}if(o&2){let n,s,c,p=C().$implicit,g=C();T("classIcone",!(p==null||(n=p.getTimbreAcquisModel())==null)&&n.isDoublon()?"accent":"primary")("type",g.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",!(p==null||(s=p.getTimbreAcquisModel())==null)&&s.isDoublon()?g.FontAwesomeEnum.CIRCLE_MINUS:g.FontAwesomeEnum.CIRCLE_PLUS)("info",!(p==null||(c=p.getTimbreAcquisModel())==null)&&c.isDoublon()?"pas en double":"en double")}}function L1(o,r){if(o&1){let n=se();v(0,"lib-icon",22),j("click",function(){H(n);let c=C().$implicit,p=C();return W(p.timbreService.modifierDialog(c))}),x()}if(o&2){let n=C(2);T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.PENCIL)("info","Modifier")}}function N1(o,r){if(o&1){let n=se();v(0,"lib-icon",22),j("click",function(){H(n);let c=C().$implicit,p=C();return W(p.timbreService.supprimerDialog(c))}),x()}if(o&2){let n=C(2);T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.TRASH)("info","Supprimer")}}function F1(o,r){if(o&1){let n=se();v(0,"img",23),j("click",function(){H(n);let c=C().$implicit,p=C();return W(p.utilsService.zoom(c==null?null:c.getImageZoom()))}),x()}if(o&2){let n=C().$implicit;T("src",n==null?null:n.getImage(),xn)}}function U1(o,r){if(o&1&&B(0),o&2){let n,s=C().$implicit;$(" ",s==null||(n=s.getTimbreBlocModel())==null?null:n.getAnnee()," ")}}function P1(o,r){if(o&1&&B(0),o&2){let n=C().$implicit;$(" ",n==null?null:n.getAnnee()," ")}}function q1(o,r){if(o&1){let n=se();v(0,"lib-icon",24),j("click",function(){let c;H(n);let p=C().$implicit,g=C();return W(g.utilsService.zoom(p==null||(c=p.getTimbreBlocModel())==null?null:c.getImageZoom()))}),x()}if(o&2){let n,s=C().$implicit,c=C();T("classIcone","primary")("type",c.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",c.FontAwesomeEnum.IMAGE_POLAROID)("classInfo","imageHoverBloc")("info","<img src='"+(s==null||(n=s.getTimbreBlocModel())==null?null:n.getImageZoom())+"'/>")}}function $1(o,r){if(o&1&&G(0,"lib-icon",25),o&2){let n=C().$implicit,s=C();T("classIcone","primary")("type",s.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",s.FontAwesomeEnum.CIRCLE_INFO)("info",n==null?null:n.getYt())}}function H1(o,r){if(o&1&&(v(0,"div",8)(1,"div",9)(2,"div",10),O(3,D1,1,4,"lib-icon",11),R(4,"async"),O(5,O1,1,4,"lib-icon",11),R(6,"async"),x(),v(7,"div",12),O(8,L1,1,3,"lib-icon",13),R(9,"async"),O(10,N1,1,3,"lib-icon",13),R(11,"async"),x()(),v(12,"div",14),O(13,F1,1,1,"img",15),x(),v(14,"div",16),O(15,U1,1,1,"ng-template",17)(16,P1,1,1,"ng-template",null,0,et),v(18,"div",18),O(19,q1,1,5,"lib-icon",19)(20,$1,1,4,"lib-icon",20),x()()()),o&2){let n,s,c,p,g,M=r.$implicit,L=ye(17),V=C();T("ngClass",!(M==null||(n=M.getTimbreAcquisModel())==null)&&n.isAcquis()?"border-accent bg-accentA200":"border-primary"),h(3),T("ngIf",((s=D(4,10,V.authService.user$))==null?null:s.getDroit())>=V.DroitEnum.PARTIEL),h(2),T("ngIf",((c=D(6,12,V.authService.user$))==null?null:c.getDroit())==V.DroitEnum.TOTAL),h(3),T("ngIf",((p=D(9,14,V.authService.user$))==null?null:p.getDroit())==V.DroitEnum.TOTAL),h(2),T("ngIf",((g=D(11,16,V.authService.user$))==null?null:g.getDroit())==V.DroitEnum.TOTAL),h(3),T("ngIf",M==null?null:M.getImage()),h(2),T("ngIf",M==null?null:M.getIdBloc())("ngIfElse",L),h(4),T("ngIf",M==null?null:M.getIdBloc()),h(),T("ngIf",M==null?null:M.getYt())}}var Uo=class o{constructor(r,n,s,c){this.authService=r;this.timbreService=n;this.timbreUtilsService=s;this.utilsService=c}timbres$;load$;total$;modif=!0;timbre=new Dt;annees$;DroitEnum=Xi;FontAwesomeEnum=St;FontAwesomeTypeEnum=yt;ngOnInit(){this.annees$=this.timbreUtilsService.getAnneesAsync("/timbres"),this.timbre.setTimbreAcquisModel(new Ke)}static \u0275fac=function(n){return new(n||o)(q(Ve),q(Le),q(Me),q(nt))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-resultat"]],inputs:{timbres$:"timbres$",load$:"load$",total$:"total$",modif:"modif"},decls:10,vars:12,consts:[["noBloc",""],[1,"responsiveDirection","responsiveMenu"],[3,"total$"],[3,"modif"],[1,"spinner",3,"fxHide","textSpec"],[3,"fxHide"],[1,"listeTimbre","primary"],["class","detailTimbre",3,"ngClass",4,"ngFor","ngForOf"],[1,"detailTimbre",3,"ngClass"],[1,"headerTimbre"],[1,"actionTimbre"],["class","click",3,"classIcone","type","icone","info","click",4,"ngIf"],[1,"actionTimbre2"],["class","primary click",3,"type","icone","info","click",4,"ngIf"],[1,"imgTimbre"],["class","image zoomIn",3,"src","click",4,"ngIf"],[1,"footerTimbre"],[3,"ngIf","ngIfElse"],[1,"infoTimbre"],["class","click",3,"classIcone","type","icone","classInfo","info","click",4,"ngIf"],["class","click",3,"classIcone","type","icone","info",4,"ngIf"],[1,"click",3,"click","classIcone","type","icone","info"],[1,"primary","click",3,"click","type","icone","info"],[1,"image","zoomIn",3,"click","src"],[1,"click",3,"click","classIcone","type","icone","classInfo","info"],[1,"click",3,"classIcone","type","icone","info"]],template:function(n,s){n&1&&(v(0,"div",1),G(1,"app-timbre-total",2)(2,"app-timbre-recherche",3),x(),G(3,"lib-spinner",4),R(4,"async"),v(5,"section",5),R(6,"async"),v(7,"div",6),O(8,H1,21,18,"div",7),R(9,"async"),x()()),n&2&&(h(),T("total$",s.total$),h(),T("modif",s.modif),h(),T("fxHide",D(4,6,s.load$)==!0)("textSpec","Chargement en cours ..."),h(2),T("fxHide",D(6,8,s.load$)==!1),h(3),T("ngForOf",D(9,10,s.timbres$)))},dependencies:[Ct,tt,Se,To,Mt,Rt,Zt,No,Fo,Ae],styles:[".spinner[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;align-items:stretch;flex:100%;height:100%}.listeTimbre[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:left;width:100%}.listeTimbre[_ngcontent-%COMP%]   lib-icon[_ngcontent-%COMP%]{font-size:1.2em}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]{margin:10px;width:115px;height:150px;border-radius:10px;border:1px solid;padding:5px 10px;display:flex;flex-direction:column;justify-content:space-between;align-items:stretch}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .headerTimbre[_ngcontent-%COMP%]{height:25px;display:flex;flex-direction:row;justify-content:space-between;align-items:end;width:100%;padding-bottom:5px}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .headerTimbre[_ngcontent-%COMP%]   .actionTimbre[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:start;gap:5px}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .headerTimbre[_ngcontent-%COMP%]   .actionTimbre2[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:end;gap:5px}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .imgTimbre[_ngcontent-%COMP%]{width:100%;display:flex;flex:auto;justify-content:center;align-items:center}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .imgTimbre[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100px;max-height:100px}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .footerTimbre[_ngcontent-%COMP%]{height:25px;display:flex;flex-direction:row;justify-content:space-between;align-items:end;width:100%}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .footerTimbre[_ngcontent-%COMP%]   .infoTimbre[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:end;align-items:end;gap:5px}@media screen and (max-width: 800px){.listeTimbre[_ngcontent-%COMP%]{justify-content:space-evenly}}"]})};function V1(o,r){if(o&1&&(G(0,"lib-spinner",5),R(1,"async")),o&2){let n=C();T("textSpec",D(1,1,n.messageLoad$))}}function G1(o,r){if(o&1&&(G(0,"mat-error",16),R(1,"async")),o&2){let n=C(2);T("innerHTML",D(1,1,n.messageError$),vn)}}function k1(o,r){if(o&1&&G(0,"app-timbre-resultat",17),o&2){let n=C(2);T("load$",n.load$)("timbres$",n.timbres$)("modif",!1)}}function j1(o,r){if(o&1&&(v(0,"mat-option",21),B(1),x()),o&2){let n=r.$implicit;T("value",n),h(),$(" ",n," ")}}function z1(o,r){if(o&1){let n=se();v(0,"div",18)(1,"mat-select",19),Pe("ngModelChange",function(c){H(n);let p=C(2);return Ue(p.annees,c)||(p.annees=c),W(c)}),O(2,j1,2,2,"mat-option",20),x()()}if(o&2){let n=C(2);h(),Fe("ngModel",n.annees),T("placeholder","Ann\xE9es"),h(),T("ngForOf",n.anneesDispo)}}function Y1(o,r){o&1&&(v(0,"button",22),B(1," Enregistrer "),x())}function K1(o,r){if(o&1){let n=se();v(0,"form",6,1),j("ngSubmit",function(){H(n);let c=ye(1),p=C();return W(p.valider(c))}),v(2,"div",7),O(3,G1,2,3,"mat-error",8),R(4,"async"),O(5,k1,1,3,"app-timbre-resultat",9),R(6,"async"),x(),v(7,"div",10),O(8,z1,3,3,"div",11),R(9,"async"),R(10,"async"),v(11,"button",12),j("click",function(){H(n);let c=C();return W(c.close())}),B(12," Annuler "),x(),v(13,"input",13),j("change",function(c){H(n);let p=C();return W(p.onFileChange(c))}),x(),v(14,"button",14),j("click",function(){H(n);let c=C();return W(c.triggerFileInput())}),B(15," Choisir un fichier "),x(),O(16,Y1,2,0,"button",15),R(17,"async"),x()()}if(o&2){let n,s,c,p=ye(1),g=C();T("ngClass",p!=null&&p.submitted?"red-color":"blue-color"),h(3),T("ngIf",D(4,6,g.messageError$)),h(2),T("ngIf",((n=D(6,8,g.timbres$))==null?null:n.length)>0),h(3),T("ngIf",!D(9,10,g.timbres$)||((s=D(10,12,g.timbres$))==null?null:s.length)==0),h(5),_o("id",g.idFile),h(3),T("ngIf",((c=D(17,14,g.timbres$))==null?null:c.length)>0)}}var Po=class o{constructor(r,n,s,c,p,g,M){this.authService=r;this.timbreService=n;this.timbreBlocService=s;this.timbreUtilsService=c;this.uploadService=p;this.utilsService=g;this.dialogRef=M}dossier="/assets/images/timbres/";timbres$=new be(null);messageError$=new be(null);messageLoad$=new be("Chargement en cours ...");load$=new be(null);idFile="fileImport";identTimbre=1;identBloc=1;timbresModel=[];timbresBlocsModel=[];anneesDispo=[];annees=[new Date().getFullYear()];ngOnInit(){for(let r=new Date().getFullYear();r>=1900;r--)this.anneesDispo.push(r)}triggerFileInput(){document.getElementById(this.idFile).click()}onFileChange(r){let n=r.target.files[0];n&&(this.load$.next(!1),this.messageLoad$.next("Chargement en cours ..."),this.saveCsv(n))}saveCsv(r){let n=new FileReader;n.onload=()=>{let s=n.result;this.parseCsv(s)},n.readAsText(r)}parseCsv(r){S(this.annees)&&this.annees.length>0&&We([this.utilsService.getMaxIdentAsync("/timbres"),this.utilsService.getMaxIdentAsync("/timbres_bloc"),this.authService.userSelect$]).pipe(U(([n,s,c])=>S(c))).subscribe(([n,s,c])=>{this.identTimbre=n,this.identBloc=s,this.timbresModel=[],this.timbres$.next(null),$m.parse(r,{header:!0,skipEmptyLines:!0,complete:p=>{S(p.data)&&p.data?.length>0&&(this.timbresBlocsModel=[],p.data.forEach((g,M)=>{let L=this.setTimbre(g,c);S(L?.getId())&&(this.timbresModel.push(L),this.identTimbre++),M==p.data.length-1&&(this.timbres$.next(this.timbresModel),this.load$.next(!0))}))},error:p=>{console.error("Erreur lors du parsing du CSV :",p)}})})}setTimbre(r,n){let s=new Dt,c=r.CODE!="NULL"&&r.CODE!=""?Number(r.CODE):null,p=r.IDENT_BLOC!="NULL"&&r.IDENT_BLOC!=""&&S(r.IDENT_BLOC)?Number(r.IDENT_BLOC):null,g=r.ANNEE!="NULL"&&r.ANNEE!=""?Number(r.ANNEE):null,M=r.MONNAIE!="NULL"&&r.MONNAIE!=""?r.MONNAIE:null;if(this.annees.includes(g)){s.setId(this.identTimbre),s.setType(r.TYPE!="NULL"&&r.TYPE!=""?r.TYPE:null),s.setYt(r.YT!="NULL"&&r.YT!=""?r.YT:null),s.setAnnee(g);let L=new Ke;L.setIdTimbre(s.getId()),L.setIdUser(n.getId()),L.setAcquis(r.ACQUIS=="1"),L.setDoublon(r.DOUBLON=="1"),s.setTimbreAcquisModel(L);let V=this.dossier+g+"/",_e="";if(S(p)){if(V+="bloc/"+p,_e=V+".png",V+="-",s.setTimbreBlocModel(this.timbresBlocsModel.find(ce=>ce.getAnnee()==g&&ce.idOrigine==p)),Oe(s.getTimbreBlocModel())){let ce=new Pi;ce.setId(this.identBloc),ce.setAnnee(g),ce.setMonnaie(M),ce.setType(r.CARNET=="1"?"CARNET":"BLOC"),ce.idOrigine=p;let rt=new Ot;rt.setIdBloc(this.identBloc),rt.setIdUser(n.getId()),rt.setAcquis(r.ACQUIS_BLOC=="1"),rt.setDoublon(r.DOUBLON_BLOC=="1"),ce.setTimbreBlocAcquisModel(rt),this.uploadService.checkIfImageExists(_e).pipe(U()).subscribe(ii=>{ii&&(ce.setImage(_e),ce.setImageTable(_e),ce.setImageZoom(_e))}),this.timbresBlocsModel.push(ce),s.setTimbreBlocModel(ce),this.identBloc++}s.setIdBloc(s.getTimbreBlocModel()?.getId())}else s.setMonnaie(M);V+=c+".png",this.uploadService.checkIfImageExists(V).pipe(U()).subscribe(ce=>{ce&&(s.setImage(V),s.setImageTable(V),s.setImageZoom(V))})}return s}valider(r){this.messageError$.next(null),r?.valid&&(this.load$.next(!1),this.messageLoad$.next("Import en cours ..."),S(this.timbresBlocsModel)&&this.timbresBlocsModel?.length>0&&this.timbresBlocsModel.forEach((n,s)=>{this.saveBloc(n)}),this.timbres$.pipe(U()).subscribe(n=>{if(S(n)&&n?.length>0)n.forEach((s,c)=>{this.saveTimbre(s,c==n.length-1)});else{this.messageError$.next("Donn\xE9es incorrectes");return}}))}saveBloc(r){We([this.timbreBlocService.upload(r,"autre"),this.timbreBlocService.upload(r,"table"),this.timbreBlocService.upload(r,"zoom")]).pipe(U(([n,s,c])=>S(n)&&S(c)&&S(s))).subscribe(([n,s,c])=>{S(n)&&n!="nok"&&r.setImage(n),S(s)&&s!="nok"&&r.setImageTable(s),S(c)&&c!="nok"&&r.setImageZoom(c),r?.getTimbreBlocAcquisModel()?.isAcquis()&&this.timbreBlocService.addAcquis(r?.getTimbreBlocAcquisModel()?.getIdUser(),r,r?.getTimbreBlocAcquisModel()?.isDoublon()),this.timbreBlocService.ajouter(r,!1)})}saveTimbre(r,n){We([this.timbreService.upload(r,"autre"),this.timbreService.upload(r,"table"),this.timbreService.upload(r,"zoom")]).pipe(U(([s,c,p])=>S(s)&&S(p)&&S(c))).subscribe(([s,c,p])=>{S(s)&&s!="nok"&&r.setImage(s),S(c)&&c!="nok"&&r.setImageTable(c),S(p)&&p!="nok"&&r.setImageZoom(p),r?.getTimbreAcquisModel()?.isAcquis()&&this.timbreUtilsService.addAcquis(r?.getTimbreAcquisModel()?.getIdUser(),r,r?.getTimbreAcquisModel()?.isDoublon()),this.timbreService.ajouter(r,n),n&&(this.load$.next(!0),this.close())})}close(){this.dialogRef.close()}static \u0275fac=function(n){return new(n||o)(q(Ve),q(Le),q(Ge),q(Me),q(Nn),q(nt),q(Qt))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-importer"]],decls:8,vars:4,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","start stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","column","fxLayoutGap","20px",1,"bloc-modal"],[3,"innerHTML",4,"ngIf"],[3,"load$","timbres$","modif",4,"ngIf"],["fxLayout","row","fxLayoutGap","20px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["fxLayout","row","fxLayoutAlign","end center","class","form-input select noError","style","width: 100px",4,"ngIf"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","file","accept",".xls, .xlsx, .csv","hidden","","required","",3,"change","id"],["type","button","mat-raised-button","","color","accent",1,"rounded","large","color-white",3,"click"],["type","submit","class","rounded large color-white","mat-raised-button","","color","accent",4,"ngIf"],[3,"innerHTML"],[3,"load$","timbres$","modif"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input","select","noError",2,"width","100px"],["name","anneeSelect","multiple","",3,"ngModelChange","ngModel","placeholder"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],[1,"selectMin",3,"value"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"]],template:function(n,s){if(n&1&&(v(0,"div",2)(1,"div",3)(2,"span"),B(3,"TIMBRE IMPORTER"),x()(),O(4,V1,2,3,"ng-template",4),R(5,"async"),O(6,K1,18,16,"ng-template",null,0,et),x()),n&2){let c=ye(7);h(4),T("ngIf",D(5,2,s.load$)==!1)("ngIfElse",c)}},dependencies:[it,Bn,Bt,At,Ct,tt,Se,zt,Oi,Kt,Yt,Li,Mt,Ui,Et,Ni,It,Fi,Rt,Uo,Ae]})};function Z1(o,r){o&1&&G(0,"lib-spinner",5),o&2&&T("textSpec","Suppression en cours")}function X1(o,r){if(o&1){let n=se();v(0,"form",6,1),j("ngSubmit",function(){H(n);let c=ye(1),p=C();return W(p.valider(c))}),v(2,"div",7)(3,"div",8)(4,"input",9),Pe("ngModelChange",function(c){H(n);let p=C();return Ue(p.annee,c)||(p.annee=c),W(c)}),x()(),v(5,"button",10),j("click",function(){H(n);let c=C();return W(c.close())}),B(6," Annuler "),x(),v(7,"button",11),B(8," Supprimer "),x()()()}if(o&2){let n=ye(1),s=C();T("ngClass",n!=null&&n.submitted?"red-color":"blue-color"),h(4),Fe("ngModel",s.annee),T("max",s.maxAnnee)("zMax",s.maxAnnee)}}var qo=class o{constructor(r,n,s){this.dialog=r;this.dialogRef=n;this.timbreSupprimService=s}maxAnnee=new Date().getFullYear();annee=new Date().getFullYear();valider(r){if(r?.valid){let n=this.dialog.open(en,{maxHeight:"95vh",data:{titre:"Confirmation",message:"Souhaitez-vous supprimer les timbres ?",btnDroite:"Oui",btnGauche:"Non"}});n.afterClosed().subscribe(()=>{n.componentInstance.data.resultat==="valider"&&(this.timbreSupprimService.loadGlob$.next(!1),this.timbreSupprimService.supprimerTimbres(this.annee),this.timbreSupprimService.load$.pipe(U(s=>s==!0)).subscribe(s=>{this.timbreSupprimService.supprimerBlocs(this.annee),this.timbreSupprimService.load$.pipe(U(c=>c==!0)).subscribe(c=>{this.timbreSupprimService.loadGlob$.next(!0)})}))})}}close(){this.dialogRef.close()}static \u0275fac=function(n){return new(n||o)(q(wt),q(Qt),q(Mo))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-supprim-choix-annee"]],decls:8,vars:4,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","start stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","row","fxLayoutGap","20px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["fxLayout","column","fxFlex","20","fxLayoutAlign","end end",1,"form-input","noError"],["name","annee","type","number","minlength","4","maxlength","4","min","1900","zMin","1900","required","","zControl","",2,"width","60px !important",3,"ngModelChange","ngModel","max","zMax"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"]],template:function(n,s){if(n&1&&(v(0,"div",2)(1,"div",3)(2,"span"),B(3,"TIMBRE IMPORTER"),x()(),O(4,Z1,1,1,"ng-template",4),R(5,"async"),O(6,X1,9,4,"ng-template",null,0,et),x()),n&2){let c=ye(7);h(4),T("ngIf",D(5,2,s.timbreSupprimService.loadGlob$)==!1)("ngIfElse",c)}},dependencies:[it,Ct,Se,zt,Oi,Kt,Yt,Li,Mt,Ui,yn,Sn,Et,Ni,In,An,wn,En,Mn,It,Fi,Rt,Rn,On,Ln,Ae],encapsulation:2})};var J1=o=>[o];function eT(o,r){if(o&1){let n=se();v(0,"lib-icon",2),j("click",function(){H(n);let c=C();return W(c.supprimer())}),x()}if(o&2){let n=C();T("icone",n.FontAwesomeEnum.ROTATE)("type",n.FontAwesomeTypeEnum.TYPE_SOLID)("attribs",pr(4,J1,n.FontAwesomeAttributEnum.SPIN))("info","Supprimer en cours")}}function tT(o,r){if(o&1){let n=se();v(0,"lib-icon",3),j("click",function(){H(n);let c=C();return W(c.supprimer())}),x()}if(o&2){let n=C();T("icone",n.FontAwesomeEnum.TRASH)("type",n.FontAwesomeTypeEnum.TYPE_SOLID)("info","Supprimer les timbres")}}var $o=class o{constructor(r,n){this.dialog=r;this.timbreSupprimService=n}FontAwesomeEnum=St;FontAwesomeTypeEnum=yt;FontAwesomeAttributEnum=Jc;supprimer(){this.dialog.open(qo,{maxHeight:"50vh",width:"300px"})}static \u0275fac=function(n){return new(n||o)(q(wt),q(Mo))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-supprim"]],decls:4,vars:6,consts:[["class","warn click","style","font-size: 2em",3,"icone","type","attribs","info","click",4,"ngIf"],["class","warn click","style","font-size: 2em",3,"icone","type","info","click",4,"ngIf"],[1,"warn","click",2,"font-size","2em",3,"click","icone","type","attribs","info"],[1,"warn","click",2,"font-size","2em",3,"click","icone","type","info"]],template:function(n,s){n&1&&(O(0,eT,1,6,"lib-icon",0),R(1,"async"),O(2,tT,1,3,"lib-icon",1),R(3,"async")),n&2&&(T("ngIf",D(1,2,s.timbreSupprimService.loadGlob$)==!1),h(2),T("ngIf",D(3,4,s.timbreSupprimService.loadGlob$)==!0))},dependencies:[Se,Zt,Ae],encapsulation:2})};function nT(o,r){if(o&1){let n=se();v(0,"button",9),j("click",function(){H(n);let c=C(2);return W(c.ajouter())}),B(1," Ajouter "),x()}}function rT(o,r){o&1&&(ie(0),B(1,"\xA0Bloc"),ne())}function oT(o,r){if(o&1){let n=se();ie(0),O(1,nT,2,0,"button",8),R(2,"async"),v(3,"button",9),j("click",function(){H(n);let c=C();return W(c.ajouterBloc())}),B(4," Ajouter "),O(5,rT,2,0,"ng-container",3),R(6,"async"),x(),ne()}if(o&2){let n=C();h(),T("ngIf",D(2,2,n.headerService.route$)==n.RouteEnum.TIMBRE),h(4),T("ngIf",D(6,4,n.headerService.route$)==n.RouteEnum.TIMBRE)}}function lT(o,r){if(o&1){let n=se();ie(0),v(1,"lib-icon",11),j("click",function(){let c=H(n).$implicit,p=C(2);return W(p.headerService.setRoute(c.getRoute()))}),x(),ne()}if(o&2){let n=r.$implicit;h(),T("icone",n==null?null:n.getIcone())("type",n==null?null:n.getType())("info",n==null?null:n.getInfo())}}function sT(o,r){if(o&1&&(ie(0),O(1,lT,2,3,"ng-container",10),R(2,"async"),ne()),o&2){let n=C();h(),T("ngForOf",D(2,1,n.headerService.choixRoutesTimbre$))}}function aT(o,r){if(o&1){let n=se();v(0,"lib-icon",13),j("click",function(){H(n);let c=C(2);return W(c.headerService.mode=c.ModeEnum.TABLE)}),x()}if(o&2){let n=C(2);T("icone",n.FontAwesomeEnum.TABLE)("type",n.FontAwesomeTypeEnum.TYPE_SOLID)("info","Mode tableau")}}function cT(o,r){if(o&1){let n=se();v(0,"lib-icon",13),j("click",function(){H(n);let c=C(2);return W(c.headerService.mode=c.ModeEnum.GRAPH)}),x()}if(o&2){let n=C(2);T("icone",n.FontAwesomeEnum.MEMO)("type",n.FontAwesomeTypeEnum.TYPE_SOLID)("info","Mode tableau")}}function mT(o,r){if(o&1&&(ie(0),O(1,aT,1,3,"ng-template",12)(2,cT,1,3,"ng-template",null,0,et),ne()),o&2){let n=ye(3),s=C();h(),T("ngIf",s.headerService.mode==s.ModeEnum.GRAPH)("ngIfElse",n)}}function uT(o,r){if(o&1){let n=se();v(0,"lib-icon",14),j("click",function(){H(n);let c=C();return W(c.importer())}),x()}if(o&2){let n=C();T("icone",n.FontAwesomeEnum.UPLOAD)("type",n.FontAwesomeTypeEnum.TYPE_SOLID)("info","Importer les timbres")}}function pT(o,r){o&1&&G(0,"app-timbre-supprim",15)}function fT(o,r){if(o&1&&(v(0,"mat-option",19),B(1),x()),o&2){let n=r.$implicit;T("value",n),h(),$(" ",n==null?null:n.getPrenom()," ")}}function dT(o,r){if(o&1){let n=se();v(0,"div",16)(1,"mat-select",17),R(2,"async"),j("ngModelChange",function(c){H(n);let p=C();return W(p.setUser(c))}),O(3,fT,2,2,"mat-option",18),R(4,"async"),x()()}if(o&2){let n=C();h(),T("ngModel",D(2,3,n.authService.userSelect$))("placeholder","Utilisateur"),h(2),T("ngForOf",D(4,5,n.authService.users$))}}var Hm=class o{constructor(r,n,s,c,p,g,M){this.preferenceService=r;this.authService=n;this.headerService=s;this.timbreService=c;this.timbreBlocService=p;this.timbreUtilsService=g;this.dialog=M;this.verifRoute()}FontAwesomeEnum=St;RouteEnum=Xc;FontAwesomeTypeEnum=yt;DroitEnum=Xi;ModeEnum=em;ajouter(){let r=this.dialog.open(Fn,{maxHeight:"95vh",width:"30%",minWidth:"300px"});r.afterClosed().subscribe(()=>{r.close()})}ajouterBloc(){let r=this.dialog.open($n,{maxHeight:"95vh",width:"30%",minWidth:"300px"});r.afterClosed().subscribe(()=>{r.close()})}ajouterBouchon(){this.timbreService.ajouterSansId(this.timbreService.getBouchon())}importer(){let r=this.dialog.open(Po,{height:"90vh",width:"70%",minWidth:"300px"});r.afterClosed().subscribe(()=>{r.close()})}verifRoute(){window.location.href.indexOf("bloc")>0?this.preferenceService.getTimbreCritere("blocCritere").pipe(U()).subscribe(r=>{S(r.getAnnees())&&r.getAnnees().length>0?this.timbreBlocService.getBlocs(r,!0):this.timbreUtilsService.getAnneesAsync("/timbres_bloc").pipe(U(n=>S(n)&&n?.length>0)).subscribe(n=>{r.initCritere(),r.setAcquis("NON"),r.setAnnees([n[0]]),this.preferenceService.timbreCritereBlocModel=r,this.preferenceService.modifier("blocCritere",r),this.timbreBlocService.getBlocs(r,!0)})}):this.preferenceService.getTimbreCritere("timbreCritere").pipe(U()).subscribe(r=>{S(r.getAnnees())&&r.getAnnees().length>0?this.timbreService.getTimbres(r,!0):this.timbreUtilsService.getAnneesAsync("/timbres").pipe(U(n=>S(n)&&n?.length>0)).subscribe(n=>{r.initCritere(),r.setAcquis("NON"),r.setAnnees([n[0]]),this.preferenceService.timbreCritereModel=r,this.preferenceService.modifier("timbreCritere",r),this.timbreService.getTimbres(r,!0)})})}setUser(r){this.authService.userSelect$.next(r),this.verifRoute(),this.timbreUtilsService.reinitResume$.next(!0)}static \u0275fac=function(n){return new(n||o)(q(Xt),q(Ve),q(tm),q(Le),q(Ge),q(Me),q(wt))};static \u0275cmp=Ce({type:o,selectors:[["app-menu"]],decls:22,vars:32,consts:[["modeTable",""],[1,"menu"],[1,"sousMenu","sousMenuBouton"],[4,"ngIf"],[1,"sousMenu"],["class","accent click hide-on-mobile","style","font-size: 2em",3,"icone","type","info","click",4,"ngIf"],["class","hide-on-mobile",4,"ngIf"],["fxLayout","row","fxLayoutAlign","end center","class","form-input select","style","width: 120px",4,"ngIf"],["class","rounded large color-white","mat-raised-button","","color","primary",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],[4,"ngFor","ngForOf"],[1,"primary","click",2,"font-size","2em",3,"click","icone","type","info"],[3,"ngIf","ngIfElse"],[1,"primary","click","hide-on-mobile",2,"font-size","2em",3,"click","icone","type","info"],[1,"accent","click","hide-on-mobile",2,"font-size","2em",3,"click","icone","type","info"],[1,"hide-on-mobile"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input","select",2,"width","120px"],["name","user",1,"scrollBarAccent",3,"ngModelChange","ngModel","placeholder"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],[1,"selectMin",3,"value"]],template:function(n,s){if(n&1&&(v(0,"div",1)(1,"div",2),O(2,oT,7,6,"ng-container",3),R(3,"async"),x(),v(4,"div",4),O(5,sT,3,3,"ng-container",3),R(6,"async"),O(7,mT,4,2,"ng-container",3),R(8,"async"),R(9,"async"),R(10,"async"),R(11,"async"),O(12,uT,1,3,"lib-icon",5),R(13,"async"),R(14,"async"),O(15,pT,1,0,"app-timbre-supprim",6),R(16,"async"),R(17,"async"),O(18,dT,5,7,"div",7),R(19,"async"),R(20,"async"),R(21,"async"),x()()),n&2){let c,p,g,M,L,V;h(2),T("ngIf",((c=D(3,6,s.authService.user$))==null?null:c.getDroit())==s.DroitEnum.TOTAL),h(3),T("ngIf",((p=D(6,8,s.headerService.choixRoutesTimbre$))==null?null:p.length)>0),h(2),T("ngIf",(((g=D(8,10,s.authService.user$))==null?null:g.getDroit())==s.DroitEnum.TOTAL||((g=D(9,12,s.authService.user$))==null?null:g.getDroit())==s.DroitEnum.CONSULT_TOTAL)&&(D(10,14,s.headerService.route$)==s.RouteEnum.TIMBRE||D(11,16,s.headerService.route$)==s.RouteEnum.BLOC)),h(5),T("ngIf",((M=D(13,18,s.authService.user$))==null?null:M.getDroit())==s.DroitEnum.TOTAL&&D(14,20,s.headerService.route$)==s.RouteEnum.TIMBRE),h(3),T("ngIf",((L=D(16,22,s.authService.user$))==null?null:L.getDroit())==s.DroitEnum.TOTAL&&D(17,24,s.headerService.route$)==s.RouteEnum.TIMBRE),h(3),T("ngIf",(((V=D(19,26,s.authService.user$))==null?null:V.getDroit())==s.DroitEnum.TOTAL||((V=D(20,28,s.authService.user$))==null?null:V.getDroit())==s.DroitEnum.CONSULT_TOTAL)&&((V=D(21,30,s.authService.users$))==null?null:V.length)>0)}},dependencies:[tt,Se,zt,Kt,Et,It,Zt,it,$o,At,Bt,Ae],styles:[".menu[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:10px;padding:0 5px}.menu[_ngcontent-%COMP%]   .sousMenu[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:15px}@media screen and (max-width: 800px){.menu[_ngcontent-%COMP%]{flex-direction:column}.menu[_ngcontent-%COMP%]   .sousMenuBouton[_ngcontent-%COMP%]{justify-content:space-between}.menu[_ngcontent-%COMP%]   .sousMenu[_ngcontent-%COMP%]{gap:10px}}"]})};export{Ot as a,Ke as b,Me as c,Pn as d,qn as e,Ge as f,Le as g,No as h,Do as i,Oo as j,Fo as k,Uo as l,Po as m,Hm as n,Pm as o};

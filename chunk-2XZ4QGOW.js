import{a as We,b as Je,c as Ke}from"./chunk-YPPT4V6O.js";import{a as Pe,b as ke,c as Fe,e as M,f as je,g as w,h as He,j as Ve,k as qe,l as Ne,m as Xe,n as ze,o as Ge,p as Ye,q as tt}from"./chunk-O7OONOOP.js";import{a as Oe,c as Be,d as B,k as Ue,l as Qe,m as j,n as rt,o as et}from"./chunk-MMZJ7P3Q.js";import{A as Ze}from"./chunk-XCAZ4NYN.js";import{b as Ee,e as Ie,f as De,g as Le,h as $e}from"./chunk-2RQPKCKX.js";import{b as $}from"./chunk-YJBF73UA.js";import{A as x,Ab as me,Ac as _e,Bb as le,Bc as Te,Cb as ae,Cc as Ce,Da as L,Db as ce,Ec as xe,Fc as ge,Ga as K,Ha as ee,Hc as he,Ic as Se,J as q,Ja as te,K as m,Kc as ye,L as d,Lc as ve,Nc as Me,Oc as W,Pc as we,Q as u,Qa as Q,Qc as Re,R as o,Rc as Ae,Sb as pe,Tb as se,W as a,X as c,Xb as ue,Y as s,Z as b,_ as f,aa as h,ba as T,bb as y,ca as r,ea as N,fa as X,ga as z,ha as D,ia as g,ka as S,l as v,mc as de,q as E,qb as P,rb as k,sa as J,tb as ie,u as I,v as R,va as G,vb as ne,vc as O,wa as Y,wb as oe,xa as A,xb as re,xc as be,yc as F,z as C,zc as fe}from"./chunk-KH6MZ2DN.js";import"./chunk-65CH3ZW6.js";import{g as ot}from"./chunk-GV7GV3NK.js";var it=ot(rt());var ut=()=>[10,20,50,100];function dt(t,i){if(t&1){let e=h();a(0,"div",3),s(1,"app-timbre-recherche",29),a(2,"div",30)(3,"input",31),T("input",function(l){C(e);let p=r();return x(p.applyFilter(l))}),c()(),a(4,"lib-icon",32),T("click",function(){C(e);let l=r();return x(l.exportTable())}),c()()}if(t&2){let e=r();m(),o("modif",e.modif),m(3),o("type",e.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",e.FontAwesomeEnum.FILE_EXEL)("info","Exporter tableau")}}function bt(t,i){if(t&1&&(a(0,"th",33),s(1,"lib-libelle-model",34),c()),t&2){let e=r();m(),o("object",e.timbre)("key","image")}}function ft(t,i){if(t&1){let e=h();a(0,"img",37),T("click",function(){C(e);let l=r().$implicit,p=r();return x(p.utilsService.zoom(l==null?null:l.getImageZoom()))}),c()}if(t&2){let e=r().$implicit;o("src",e==null?null:e.getImageTable(),q)}}function _t(t,i){if(t&1&&(a(0,"td",35),u(1,ft,1,1,"img",36),c()),t&2){let e=i.$implicit;m(),o("ngIf",e==null?null:e.getImageTable())}}function Tt(t,i){if(t&1&&(a(0,"th",38),s(1,"lib-libelle-model",39),c()),t&2){let e=r();m(),o("object",e.timbre)("key","id")}}function Ct(t,i){if(t&1&&(a(0,"td",40),g(1),c()),t&2){let e=i.$implicit;m(),S(" ",e==null?null:e.getId()," ")}}function xt(t,i){if(t&1&&(a(0,"th",38),s(1,"lib-libelle-model",39),c()),t&2){let e=r();m(),o("object",e.timbre)("key","annee")}}function gt(t,i){if(t&1&&g(0),t&2){let e,n=r().$implicit;S(" ",n==null||(e=n.getTimbreBlocModel())==null?null:e.getAnnee()," ")}}function ht(t,i){if(t&1&&g(0),t&2){let e=r().$implicit;S(" ",e==null?null:e.getAnnee()," ")}}function St(t,i){if(t&1&&(a(0,"td",40),u(1,gt,1,1,"ng-template",41)(2,ht,1,1,"ng-template",null,0,A),c()),t&2){let e=i.$implicit,n=D(3);m(),o("ngIf",e==null?null:e.getIdBloc())("ngIfElse",n)}}function yt(t,i){if(t&1&&(a(0,"th",42),s(1,"lib-libelle-model",39),c()),t&2){let e=r();m(),o("object",e.timbre)("key","idBloc")}}function vt(t,i){if(t&1){let e=h();a(0,"img",37),T("click",function(){let l;C(e);let p=r(2).$implicit,_=r();return x(_.utilsService.zoom(p==null||(l=p.getTimbreBlocModel())==null?null:l.getImageZoom()))}),c()}if(t&2){let e,n=r(2).$implicit;o("src",n==null||(e=n.getTimbreBlocModel())==null?null:e.getImageTable(),q)}}function Mt(t,i){if(t&1&&u(0,vt,1,1,"img",36),t&2){let e,n=r().$implicit;o("ngIf",n==null||(e=n.getTimbreBlocModel())==null?null:e.getImage())}}function wt(t,i){t&1&&g(0," Non ")}function Et(t,i){if(t&1&&(a(0,"td",40),u(1,Mt,1,1,"ng-template",41)(2,wt,1,0,"ng-template",null,0,A),c()),t&2){let e=i.$implicit,n=D(3);m(),o("ngIf",e==null?null:e.getIdBloc())("ngIfElse",n)}}function It(t,i){if(t&1&&(a(0,"th",43),s(1,"lib-libelle-model",39),c()),t&2){let e=r();m(),o("object",e.timbre)("key","monnaie")}}function Rt(t,i){if(t&1&&g(0),t&2){let e,n=r().$implicit;S(" ",(n==null||(e=n.getTimbreBlocModel())==null?null:e.getMonnaie())=="E"?"\u20AC":"Francs"," ")}}function Dt(t,i){if(t&1&&g(0),t&2){let e=r().$implicit;S(" ",(e==null?null:e.getMonnaie())=="E"?"\u20AC":"Francs"," ")}}function At(t,i){if(t&1&&(a(0,"td",44),u(1,Rt,1,1,"ng-template",41)(2,Dt,1,1,"ng-template",null,0,A),c()),t&2){let e=i.$implicit,n=D(3);m(),o("ngIf",e==null?null:e.getIdBloc())("ngIfElse",n)}}function Lt(t,i){if(t&1&&(a(0,"th",43),s(1,"lib-libelle-model",39),c()),t&2){let e=r();m(),o("object",e.timbre)("key","type")}}function $t(t,i){if(t&1&&(a(0,"td",44),g(1),c()),t&2){let e=i.$implicit;m(),S(" ",e==null?null:e.getType()," ")}}function Pt(t,i){if(t&1&&(a(0,"th",43),s(1,"lib-libelle-model",39),c()),t&2){let e=r();m(),o("object",e.timbre)("key","yt")}}function kt(t,i){if(t&1&&(a(0,"td",44),g(1),c()),t&2){let e=i.$implicit;m(),S(" ",e==null?null:e.getYt()," ")}}function Ot(t,i){if(t&1&&(a(0,"th",42),s(1,"lib-libelle-model",45),c()),t&2){let e=r();m(),o("object",e.timbre==null?null:e.timbre.getTimbreAcquisModel())("key","acquis")("align","center center")}}function Ft(t,i){if(t&1){let e=h();a(0,"td",35)(1,"lib-icon",46),T("click",function(){let l=C(e).$implicit,p=r();return x(p.acquisDoublon(l,!1))}),c()()}if(t&2){let e,n,l,p=i.$implicit,_=r();m(),o("classIcone",!(p==null||(e=p.getTimbreAcquisModel())==null)&&e.isAcquis()?"accent":"primary")("type",_.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",!(p==null||(n=p.getTimbreAcquisModel())==null)&&n.isAcquis()?_.FontAwesomeEnum.CIRCLE_MINUS:_.FontAwesomeEnum.CIRCLE_PLUS)("info",!(p==null||(l=p.getTimbreAcquisModel())==null)&&l.isAcquis()?"pas acquis":"acquis")}}function Bt(t,i){if(t&1&&(a(0,"th",42),s(1,"lib-libelle-model",45),c()),t&2){let e=r();m(),o("object",e.timbre==null?null:e.timbre.getTimbreAcquisModel())("key","doublon")("align","center center")}}function jt(t,i){if(t&1){let e=h();a(0,"td",35)(1,"lib-icon",46),T("click",function(){let l=C(e).$implicit,p=r();return x(p.acquisDoublon(l,!0))}),c()()}if(t&2){let e,n,l,p=i.$implicit,_=r();m(),o("classIcone",!(p==null||(e=p.getTimbreAcquisModel())==null)&&e.isDoublon()?"accent":"primary")("type",_.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",!(p==null||(n=p.getTimbreAcquisModel())==null)&&n.isDoublon()?_.FontAwesomeEnum.CIRCLE_MINUS:_.FontAwesomeEnum.CIRCLE_PLUS)("info",!(p==null||(l=p.getTimbreAcquisModel())==null)&&l.isDoublon()?"pas en double":"en double")}}function Ht(t,i){if(t&1&&(a(0,"th",47),s(1,"lib-icon",48),c()),t&2){let e=r();m(),o("type",e.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",e.FontAwesomeEnum.PENCIL)("info","Modifier")}}function Ut(t,i){if(t&1){let e=h();a(0,"td",35)(1,"lib-icon",49),T("click",function(){let l=C(e).$implicit,p=r();return x(p.modifier(l))}),c()()}if(t&2){let e=r();m(),o("type",e.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",e.FontAwesomeEnum.PENCIL)("info","Modifier")}}function Vt(t,i){if(t&1&&(a(0,"th",47),s(1,"lib-icon",48),c()),t&2){let e=r();m(),o("type",e.FontAwesomeTypeEnum.TYPE_SOLID)("icone",e.FontAwesomeEnum.TRASH)("info","Supprimer")}}function qt(t,i){if(t&1){let e=h();a(0,"td",35)(1,"lib-icon",49),T("click",function(){let l=C(e).$implicit,p=r();return x(p.supprimer(l))}),c()()}if(t&2){let e=r();m(),o("type",e.FontAwesomeTypeEnum.TYPE_SOLID)("icone",e.FontAwesomeEnum.TRASH)("info","Supprimer")}}function Nt(t,i){t&1&&s(0,"tr",50)}function Xt(t,i){t&1&&s(0,"tr",51)}var H=class t{constructor(i,e,n,l,p,_){this.snackBar=i;this.authService=e;this.timbreService=n;this.timbreUtilsService=l;this.dialog=p;this.utilsService=_;this.dataSource=new W([])}paginator;sort;timbres$;load$;total$;modif=!0;dataSource=new W;displayedColumns;timbre=new Oe;annees$;FontAwesomeEnum=k;FontAwesomeTypeEnum=P;ngOnInit(){this.annees$=this.timbreUtilsService.getAnneesAsync("/timbres"),this.timbre.setTimbreAcquisModel(new Fe),this.displayedColumns=["image","id","annee","idBloc","monnaie","type","yt","acquis","doublon"],this.modif&&this.authService.user$.pipe(v(i=>y(i)&&i?.getDroit()==10)).subscribe(i=>{this.displayedColumns.push("modifier","supprimer")}),this.timbres$.subscribe(i=>{this.dataSource.data=i})}ngAfterViewInit(){this.dataSource.paginator=this.paginator}sortData(i){y(i)&&(this.dataSource.sort=this.sort)}applyFilter(i){let e=i.target.value;this.dataSource.filter=e.trim().toLowerCase()}droitInsuffisant(){this.snackBar.open("Droit insuffisant",null,{duration:6e3})}acquisDoublon(i,e){this.authService.user$.pipe(v(n=>y(n))).subscribe(n=>{n?.getDroit()>=9?this.timbreService.acquis(i,e):this.droitInsuffisant()})}modifier(i){let e=this.dialog.open(He,{height:"75vh",maxHeight:"750px",width:"30%"});e.componentInstance.id=i.getId(),e.afterClosed().subscribe(()=>{e.close()})}supprimer(i){let e=this.dialog.open(Ue,{maxHeight:"95vh",data:{titre:"Confirmation",message:"Souhaitez-vous supprimer le timbre <b>n\xB0 "+i?.getId()+"</b> ?",btnDroite:"Oui",btnGauche:"Non"}});e.afterClosed().subscribe(()=>{e.componentInstance.data.resultat==="valider"&&this.timbreService.supprimer(i)})}exportTable(){let i=j.json_to_sheet(this.dataSource.data),e=j.book_new();j.book_append_sheet(e,i,"Donn\xE9es");let n=Qe(e,{bookType:"xlsx",type:"array"}),l=new Blob([n],{type:"application/octet-stream"});(0,it.saveAs)(l,"export_timbres.xlsx")}generatePDFByImage(){let i="https://firebasestorage.googleapis.com/v0/b/book-f941b.appspot.com/o/AF.png?alt=media&token=a1039f78-3cff-41ab-8569-ea1b2cefe2c1";this.generatePDF(null)}generatePDF(i){}static \u0275fac=function(e){return new(e||t)(d(be),d($),d(w),d(M),d(de),d(B))};static \u0275cmp=I({type:t,selectors:[["app-timbre-resultat-table"]],viewQuery:function(e,n){if(e&1&&(N(O,5),N(F,5)),e&2){let l;X(l=z())&&(n.paginator=l.first),X(l=z())&&(n.sort=l.first)}},inputs:{timbres$:"timbres$",load$:"load$",total$:"total$",modif:"modif"},decls:44,vars:15,consts:[["noBloc",""],["fxFlexFill","",3,"fxHide","textSpec"],[3,"fxHide"],["fxLayout","row","fxLayoutAlign","space-between center","fxLayoutGap","15px",2,"height","50px"],[3,"total$"],["fxLayout","row","fxLayoutAlign","space-between center","fxLayoutGap","15px","style","height: 50px",4,"ngIf"],["id","pdf-content","mat-table","","matSort","",3,"matSortChange","dataSource"],["matColumnDef","image"],["mat-header-cell","","class","image",4,"matHeaderCellDef"],["mat-cell","","class","alignCenter",4,"matCellDef"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","annee"],["matColumnDef","idBloc"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","monnaie"],["mat-header-cell","","mat-sort-header","","class","hide-on-mobile",4,"matHeaderCellDef"],["mat-cell","","class","hide-on-mobile",4,"matCellDef"],["matColumnDef","type"],["matColumnDef","yt"],["matColumnDef","acquis"],["matColumnDef","doublon"],["matColumnDef","modifier"],["mat-header-cell","","class","alignCenter",4,"matHeaderCellDef"],["matColumnDef","supprimer"],["mat-header-row","","class","bg-primary color-white",4,"matHeaderRowDef"],["mat-row","","class","mat-row",4,"matRowDef","matRowDefColumns"],[3,"pageSize","pageSizeOptions"],[3,"modif"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input",2,"width","200px","min-height","55px","height","55px"],["placeholder","Filtrer les donn\xE9es","type","text",3,"input"],[1,"primary","click",2,"font-size","1.7em",3,"click","type","icone","info"],["mat-header-cell","",1,"image"],[1,"hide-on-mobile",3,"object","key"],["mat-cell","",1,"alignCenter"],["class","image click",3,"src","click",4,"ngIf"],[1,"image","click",3,"click","src"],["mat-header-cell","","mat-sort-header",""],[3,"object","key"],["mat-cell",""],[3,"ngIf","ngIfElse"],["mat-header-cell",""],["mat-header-cell","","mat-sort-header","",1,"hide-on-mobile"],["mat-cell","",1,"hide-on-mobile"],[3,"object","key","align"],[1,"click",2,"font-size","1.2em",3,"click","classIcone","type","icone","info"],["mat-header-cell","",1,"alignCenter"],[2,"font-size","1.2em",3,"type","icone","info"],[1,"primary","click",2,"font-size","1.2em",3,"click","type","icone","info"],["mat-header-row","",1,"bg-primary","color-white"],["mat-row","",1,"mat-row"]],template:function(e,n){e&1&&(s(0,"lib-spinner",1),G(1,"async"),a(2,"section",2),G(3,"async"),a(4,"div",3),s(5,"app-timbre-total",4),u(6,dt,5,4,"div",5),c(),a(7,"table",6),T("matSortChange",function(p){return n.sortData(p)}),b(8,7),u(9,bt,2,2,"th",8)(10,_t,2,1,"td",9),f(),b(11,10),u(12,Tt,2,2,"th",11)(13,Ct,2,1,"td",12),f(),b(14,13),u(15,xt,2,2,"th",11)(16,St,4,2,"td",12),f(),b(17,14),u(18,yt,2,2,"th",15)(19,Et,4,2,"td",12),f(),b(20,16),u(21,It,2,2,"th",17)(22,At,4,2,"td",18),f(),b(23,19),u(24,Lt,2,2,"th",17)(25,$t,2,1,"td",18),f(),b(26,20),u(27,Pt,2,2,"th",17)(28,kt,2,1,"td",18),f(),b(29,21),u(30,Ot,2,3,"th",15)(31,Ft,2,4,"td",9),f(),b(32,22),u(33,Bt,2,3,"th",15)(34,jt,2,4,"td",9),f(),b(35,23),u(36,Ht,2,3,"th",24)(37,Ut,2,3,"td",9),f(),b(38,25),u(39,Vt,2,3,"th",24)(40,qt,2,3,"td",9),f(),u(41,Nt,1,0,"tr",26)(42,Xt,1,0,"tr",27),c(),s(43,"mat-paginator",28),c()),e&2&&(o("fxHide",Y(1,10,n.load$)==!0)("textSpec","Chargement en cours ..."),m(2),o("fxHide",Y(3,12,n.load$)==!1),m(3),o("total$",n.total$),m(),o("ngIf",n.modif),m(),o("dataSource",n.dataSource),m(34),o("matHeaderRowDef",n.displayedColumns),m(),o("matRowDefColumns",n.displayedColumns),m(),o("pageSize",15)("pageSizeOptions",J(14,ut)))},dependencies:[_e,Ce,Se,xe,Te,ye,ge,he,ve,Me,O,F,fe,L,oe,re,le,me,ne,Ie,Re,$e,Ve,Xe,K],styles:[".mat-row[_ngcontent-%COMP%]{height:35px}.image[_ngcontent-%COMP%]{max-height:30px!important}.mat-column-acquis[_ngcontent-%COMP%], .mat-column-doublon[_ngcontent-%COMP%]{width:60px!important;max-width:60px!important;padding:0!important}.mat-column-ajouter[_ngcontent-%COMP%], .mat-column-modifier[_ngcontent-%COMP%], .mat-column-supprimer[_ngcontent-%COMP%]{width:35px!important;max-width:35px!important;padding:0!important}@media screen and (max-width: 800px){.mat-row[_ngcontent-%COMP%]{height:25px}.image[_ngcontent-%COMP%]{max-height:20px!important}.mat-column-acquis[_ngcontent-%COMP%], .mat-column-doublon[_ngcontent-%COMP%]{width:50px!important;max-width:50px!important;padding:0!important}.mat-column-ajouter[_ngcontent-%COMP%], .mat-column-modifier[_ngcontent-%COMP%], .mat-column-supprimer[_ngcontent-%COMP%]{width:20px!important;max-width:20px!important;padding:0!important}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:0 5px!important}th[_ngcontent-%COMP%], .mat-row[_ngcontent-%COMP%]{font-size:.8em}.mat-column-libelle[_ngcontent-%COMP%],   .mat-column-libelle .mat-sort-header-container{width:40px!important;max-width:40px!important}.mat-column-drapeau[_ngcontent-%COMP%],   .mat-column-drapeau span{width:15px!important;max-width:15px!important}.mat-column-classeur[_ngcontent-%COMP%],   .mat-column-classeur .mat-sort-header-container, .mat-column-page[_ngcontent-%COMP%],   .mat-column-page .mat-sort-header-container{width:15px!important;max-width:15px!important}.mat-column-total[_ngcontent-%COMP%],   .mat-column-total .mat-sort-header-container{width:25px!important;max-width:25px!important}}"]})};function Gt(t,i){if(t&1&&s(0,"app-timbre-resultat",3),t&2){let e=r();o("load$",e.timbreService.load$)("timbres$",e.timbreService.timbres$)("total$",e.timbreService.total$)}}function Yt(t,i){if(t&1&&s(0,"app-timbre-resultat-table",3),t&2){let e=r();o("load$",e.timbreService.load$)("timbres$",e.timbreService.timbres$)("total$",e.timbreService.total$)}}var U=class t{constructor(i,e,n,l){this.authService=i;this.headerService=e;this.timbreService=n;this.timbreUtilsService=l}FontAwesomeTypeEnum=P;FontAwesomeEnum=k;ngOnInit(){this.timbreService.timbres$.next(null),this.headerService.titre$.next("TIMBRES"),this.timbreUtilsService.timbreCritereModel=new Pe,this.authService.userSelect$.pipe(v(i=>y(i))).subscribe(i=>{this.timbreUtilsService.getAnneesAsync("/timbres").pipe(v(e=>y(e)&&e?.length>0)).subscribe(e=>{this.timbreUtilsService.timbreCritereModel.setAnnees([e[0]]),this.timbreService.getTimbres(this.timbreUtilsService.timbreCritereModel)})})}ModeEnum=ke;static \u0275fac=function(e){return new(e||t)(d($),d(ie),d(w),d(M))};static \u0275cmp=I({type:t,selectors:[["app-timbre-layout"]],decls:5,vars:2,consts:[[1,"timbreLayout"],[1,"timbreBody"],[3,"load$","timbres$","total$",4,"ngIf"],[3,"load$","timbres$","total$"]],template:function(e,n){e&1&&(a(0,"div",0)(1,"div",1),s(2,"app-menu"),u(3,Gt,1,3,"app-timbre-resultat",2)(4,Yt,1,3,"app-timbre-resultat-table",2),c()()),e&2&&(m(3),o("ngIf",n.timbreService.mode==n.ModeEnum.GRAPH),m(),o("ngIf",n.timbreService.mode==n.ModeEnum.TABLE))},dependencies:[L,Ye,H,ze],styles:[".timbreLayout[_ngcontent-%COMP%]{display:flex;flex:100;flex-direction:row;justify-content:space-between;align-content:stretch;padding:0 15px}.timbreLayout[_ngcontent-%COMP%]   .timbreBody[_ngcontent-%COMP%]{display:flex;flex:100;flex-direction:column;gap:20px}@media screen and (max-width: 800px){.timbreLayout[_ngcontent-%COMP%]{padding:0 5px}.timbreLayout[_ngcontent-%COMP%]   .timbreBody[_ngcontent-%COMP%]{gap:10px}}"]})};var Qt=[{path:"",component:U},{path:"importer",component:Ge},{path:"resume",component:Ne}],V=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=R({type:t});static \u0275inj=E({imports:[Q.forChild(Qt),Q]})};var nt=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=R({type:t});static \u0275inj=E({providers:[B,M,w,je,qe,Be,te()],imports:[we,V,ee,ae,ce,pe,De,Ae,Je,Le,ue,Ee,We,Ke,et,Ze,tt,se]})};export{nt as TimbreModule};

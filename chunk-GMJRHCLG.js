import{a as $t,b as _r,c as Jt}from"./chunk-JSFO2W3L.js";import{a as rm,b as om}from"./chunk-QXYOZCS4.js";import{a as Ot,b as nn,c as Hi,d as rt,e as Eo,f as Nn,g as Fn,h as Ao,i as Un,j as V_,k as Bo,q as Rm}from"./chunk-4QECCGEG.js";import{e as Io,f as Ti}from"./chunk-BFCS4JX5.js";import{c as On,d as Dt,g as Ln}from"./chunk-6HHNYKAJ.js";import{l as le,m as Li,n as Ni,o as tn,u as Sn,v as Ve}from"./chunk-6QQKUJTI.js";import{a as um}from"./chunk-55NJJND4.js";import{Aa as ye,Ab as yo,Ba as w,Bb as zt,Ca as Co,Cb as Fi,Cc as So,Da as H,Db as Ui,Dc as Mo,E as To,Ea as Jc,Eb as Yt,Ec as bm,Fa as Xc,Fb as Kt,Fc as _m,Ga as Ue,Gc as hm,Ha as qe,Hb as lm,Hc as Tm,I as Oi,Ia as Pe,Ib as Mn,Ic as vm,J as Kc,Jc as xm,Kc as Cm,L as he,Lb as At,Lc as ym,Ma as br,Mb as qi,Mc as Sm,N as Ce,Nb as Pi,Nc as Mm,O as Zc,Oa as R,Ob as Bt,Oc as Im,Pa as D,Pb as $i,Pc as Em,Q as vo,Qa as et,Qb as In,Qc as Am,Rb as En,Rc as Bm,Sb as An,Sc as fs,T as W,Tb as Bn,U as V,Ub as wn,Uc as Qt,Vb as Rn,Vc as wm,Wb as sm,X as Qc,Xb as am,Ya as St,Yb as wt,Za as tt,Zb as cm,_a as Se,_b as mm,aa as Cn,ba as yn,bb as Ae,c as _e,ca as h,cb as em,da as $,db as tm,f as dr,ia as O,ja as T,kc as Dn,l as jt,lc as it,m as Re,mc as pm,na as v,oa as x,oc as Zt,pa as G,pb as im,qa as ie,qb as I,qc as nt,ra as ne,rb as Le,s as Ri,t as gr,ta as se,ua as j,v as Di,va as C,vc as fm,wa as xo,wb as Mt,wc as Rt,xa as bi,xb as It,xc as dm,y as q,ya as _i,yb as nm,za as hi,zb as Et,zc as gm}from"./chunk-QXCOODFE.js";import{d as W_,f as Yc,g as oe}from"./chunk-GOLCFQAC.js";var Hm=W_((Vn,Sr)=>{(function(){var o,r="4.17.21",n=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",c="Expected a function",p="Invalid `variable` option passed into `_.template`",b="__lodash_hash_undefined__",y=500,L="__lodash_placeholder__",U=1,de=2,ce=4,ot=1,ni=2,ke=1,Ht=2,Gn=4,lt=8,ri=16,st=32,oi=64,gt=128,kn=256,ko=512,jm=30,zm="...",Ym=800,Km=16,bs=1,Zm=2,Qm=3,ki=1/0,vi=9007199254740991,Jm=17976931348623157e292,Mr=NaN,Wt=4294967295,Xm=Wt-1,eu=Wt>>>1,tu=[["ary",gt],["bind",ke],["bindKey",Ht],["curry",lt],["curryRight",ri],["flip",ko],["partial",st],["partialRight",oi],["rearg",kn]],sn="[object Arguments]",Ir="[object Array]",iu="[object AsyncFunction]",jn="[object Boolean]",zn="[object Date]",nu="[object DOMException]",Er="[object Error]",Ar="[object Function]",_s="[object GeneratorFunction]",Lt="[object Map]",Yn="[object Number]",ru="[object Null]",li="[object Object]",hs="[object Promise]",ou="[object Proxy]",Kn="[object RegExp]",Nt="[object Set]",Zn="[object String]",Br="[object Symbol]",lu="[object Undefined]",Qn="[object WeakMap]",su="[object WeakSet]",Jn="[object ArrayBuffer]",an="[object DataView]",jo="[object Float32Array]",zo="[object Float64Array]",Yo="[object Int8Array]",Ko="[object Int16Array]",Zo="[object Int32Array]",Qo="[object Uint8Array]",Jo="[object Uint8ClampedArray]",Xo="[object Uint16Array]",el="[object Uint32Array]",au=/\b__p \+= '';/g,cu=/\b(__p \+=) '' \+/g,mu=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ts=/&(?:amp|lt|gt|quot|#39);/g,vs=/[&<>"']/g,uu=RegExp(Ts.source),pu=RegExp(vs.source),fu=/<%-([\s\S]+?)%>/g,du=/<%([\s\S]+?)%>/g,xs=/<%=([\s\S]+?)%>/g,gu=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,bu=/^\w*$/,_u=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,tl=/[\\^$.*+?()[\]{}|]/g,hu=RegExp(tl.source),il=/^\s+/,Tu=/\s/,vu=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,xu=/\{\n\/\* \[wrapped with (.+)\] \*/,Cu=/,? & /,yu=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Su=/[()=,{}\[\]\/\s]/,Mu=/\\(\\)?/g,Iu=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Cs=/\w*$/,Eu=/^[-+]0x[0-9a-f]+$/i,Au=/^0b[01]+$/i,Bu=/^\[object .+?Constructor\]$/,wu=/^0o[0-7]+$/i,Ru=/^(?:0|[1-9]\d*)$/,Du=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,wr=/($^)/,Ou=/['\n\r\u2028\u2029\\]/g,Rr="\\ud800-\\udfff",Lu="\\u0300-\\u036f",Nu="\\ufe20-\\ufe2f",Fu="\\u20d0-\\u20ff",ys=Lu+Nu+Fu,Ss="\\u2700-\\u27bf",Ms="a-z\\xdf-\\xf6\\xf8-\\xff",Uu="\\xac\\xb1\\xd7\\xf7",qu="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Pu="\\u2000-\\u206f",$u=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Is="A-Z\\xc0-\\xd6\\xd8-\\xde",Es="\\ufe0e\\ufe0f",As=Uu+qu+Pu+$u,nl="['\u2019]",Hu="["+Rr+"]",Bs="["+As+"]",Dr="["+ys+"]",ws="\\d+",Wu="["+Ss+"]",Rs="["+Ms+"]",Ds="[^"+Rr+As+ws+Ss+Ms+Is+"]",rl="\\ud83c[\\udffb-\\udfff]",Vu="(?:"+Dr+"|"+rl+")",Os="[^"+Rr+"]",ol="(?:\\ud83c[\\udde6-\\uddff]){2}",ll="[\\ud800-\\udbff][\\udc00-\\udfff]",cn="["+Is+"]",Ls="\\u200d",Ns="(?:"+Rs+"|"+Ds+")",Gu="(?:"+cn+"|"+Ds+")",Fs="(?:"+nl+"(?:d|ll|m|re|s|t|ve))?",Us="(?:"+nl+"(?:D|LL|M|RE|S|T|VE))?",qs=Vu+"?",Ps="["+Es+"]?",ku="(?:"+Ls+"(?:"+[Os,ol,ll].join("|")+")"+Ps+qs+")*",ju="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",zu="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",$s=Ps+qs+ku,Yu="(?:"+[Wu,ol,ll].join("|")+")"+$s,Ku="(?:"+[Os+Dr+"?",Dr,ol,ll,Hu].join("|")+")",Zu=RegExp(nl,"g"),Qu=RegExp(Dr,"g"),sl=RegExp(rl+"(?="+rl+")|"+Ku+$s,"g"),Ju=RegExp([cn+"?"+Rs+"+"+Fs+"(?="+[Bs,cn,"$"].join("|")+")",Gu+"+"+Us+"(?="+[Bs,cn+Ns,"$"].join("|")+")",cn+"?"+Ns+"+"+Fs,cn+"+"+Us,zu,ju,ws,Yu].join("|"),"g"),Xu=RegExp("["+Ls+Rr+ys+Es+"]"),ep=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,tp=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ip=-1,be={};be[jo]=be[zo]=be[Yo]=be[Ko]=be[Zo]=be[Qo]=be[Jo]=be[Xo]=be[el]=!0,be[sn]=be[Ir]=be[Jn]=be[jn]=be[an]=be[zn]=be[Er]=be[Ar]=be[Lt]=be[Yn]=be[li]=be[Kn]=be[Nt]=be[Zn]=be[Qn]=!1;var ge={};ge[sn]=ge[Ir]=ge[Jn]=ge[an]=ge[jn]=ge[zn]=ge[jo]=ge[zo]=ge[Yo]=ge[Ko]=ge[Zo]=ge[Lt]=ge[Yn]=ge[li]=ge[Kn]=ge[Nt]=ge[Zn]=ge[Br]=ge[Qo]=ge[Jo]=ge[Xo]=ge[el]=!0,ge[Er]=ge[Ar]=ge[Qn]=!1;var np={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},rp={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},op={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},lp={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},sp=parseFloat,ap=parseInt,Hs=typeof global=="object"&&global&&global.Object===Object&&global,cp=typeof self=="object"&&self&&self.Object===Object&&self,De=Hs||cp||Function("return this")(),al=typeof Vn=="object"&&Vn&&!Vn.nodeType&&Vn,ji=al&&typeof Sr=="object"&&Sr&&!Sr.nodeType&&Sr,Ws=ji&&ji.exports===al,cl=Ws&&Hs.process,bt=function(){try{var g=ji&&ji.require&&ji.require("util").types;return g||cl&&cl.binding&&cl.binding("util")}catch{}}(),Vs=bt&&bt.isArrayBuffer,Gs=bt&&bt.isDate,ks=bt&&bt.isMap,js=bt&&bt.isRegExp,zs=bt&&bt.isSet,Ys=bt&&bt.isTypedArray;function at(g,M,S){switch(S.length){case 0:return g.call(M);case 1:return g.call(M,S[0]);case 2:return g.call(M,S[0],S[1]);case 3:return g.call(M,S[0],S[1],S[2])}return g.apply(M,S)}function mp(g,M,S,F){for(var K=-1,ae=g==null?0:g.length;++K<ae;){var Be=g[K];M(F,Be,S(Be),g)}return F}function _t(g,M){for(var S=-1,F=g==null?0:g.length;++S<F&&M(g[S],S,g)!==!1;);return g}function up(g,M){for(var S=g==null?0:g.length;S--&&M(g[S],S,g)!==!1;);return g}function Ks(g,M){for(var S=-1,F=g==null?0:g.length;++S<F;)if(!M(g[S],S,g))return!1;return!0}function xi(g,M){for(var S=-1,F=g==null?0:g.length,K=0,ae=[];++S<F;){var Be=g[S];M(Be,S,g)&&(ae[K++]=Be)}return ae}function Or(g,M){var S=g==null?0:g.length;return!!S&&mn(g,M,0)>-1}function ml(g,M,S){for(var F=-1,K=g==null?0:g.length;++F<K;)if(S(M,g[F]))return!0;return!1}function Te(g,M){for(var S=-1,F=g==null?0:g.length,K=Array(F);++S<F;)K[S]=M(g[S],S,g);return K}function Ci(g,M){for(var S=-1,F=M.length,K=g.length;++S<F;)g[K+S]=M[S];return g}function ul(g,M,S,F){var K=-1,ae=g==null?0:g.length;for(F&&ae&&(S=g[++K]);++K<ae;)S=M(S,g[K],K,g);return S}function pp(g,M,S,F){var K=g==null?0:g.length;for(F&&K&&(S=g[--K]);K--;)S=M(S,g[K],K,g);return S}function pl(g,M){for(var S=-1,F=g==null?0:g.length;++S<F;)if(M(g[S],S,g))return!0;return!1}var fp=fl("length");function dp(g){return g.split("")}function gp(g){return g.match(yu)||[]}function Zs(g,M,S){var F;return S(g,function(K,ae,Be){if(M(K,ae,Be))return F=ae,!1}),F}function Lr(g,M,S,F){for(var K=g.length,ae=S+(F?1:-1);F?ae--:++ae<K;)if(M(g[ae],ae,g))return ae;return-1}function mn(g,M,S){return M===M?Ep(g,M,S):Lr(g,Qs,S)}function bp(g,M,S,F){for(var K=S-1,ae=g.length;++K<ae;)if(F(g[K],M))return K;return-1}function Qs(g){return g!==g}function Js(g,M){var S=g==null?0:g.length;return S?gl(g,M)/S:Mr}function fl(g){return function(M){return M==null?o:M[g]}}function dl(g){return function(M){return g==null?o:g[M]}}function Xs(g,M,S,F,K){return K(g,function(ae,Be,fe){S=F?(F=!1,ae):M(S,ae,Be,fe)}),S}function _p(g,M){var S=g.length;for(g.sort(M);S--;)g[S]=g[S].value;return g}function gl(g,M){for(var S,F=-1,K=g.length;++F<K;){var ae=M(g[F]);ae!==o&&(S=S===o?ae:S+ae)}return S}function bl(g,M){for(var S=-1,F=Array(g);++S<g;)F[S]=M(S);return F}function hp(g,M){return Te(M,function(S){return[S,g[S]]})}function ea(g){return g&&g.slice(0,ra(g)+1).replace(il,"")}function ct(g){return function(M){return g(M)}}function _l(g,M){return Te(M,function(S){return g[S]})}function Xn(g,M){return g.has(M)}function ta(g,M){for(var S=-1,F=g.length;++S<F&&mn(M,g[S],0)>-1;);return S}function ia(g,M){for(var S=g.length;S--&&mn(M,g[S],0)>-1;);return S}function Tp(g,M){for(var S=g.length,F=0;S--;)g[S]===M&&++F;return F}var vp=dl(np),xp=dl(rp);function Cp(g){return"\\"+lp[g]}function yp(g,M){return g==null?o:g[M]}function un(g){return Xu.test(g)}function Sp(g){return ep.test(g)}function Mp(g){for(var M,S=[];!(M=g.next()).done;)S.push(M.value);return S}function hl(g){var M=-1,S=Array(g.size);return g.forEach(function(F,K){S[++M]=[K,F]}),S}function na(g,M){return function(S){return g(M(S))}}function yi(g,M){for(var S=-1,F=g.length,K=0,ae=[];++S<F;){var Be=g[S];(Be===M||Be===L)&&(g[S]=L,ae[K++]=S)}return ae}function Nr(g){var M=-1,S=Array(g.size);return g.forEach(function(F){S[++M]=F}),S}function Ip(g){var M=-1,S=Array(g.size);return g.forEach(function(F){S[++M]=[F,F]}),S}function Ep(g,M,S){for(var F=S-1,K=g.length;++F<K;)if(g[F]===M)return F;return-1}function Ap(g,M,S){for(var F=S+1;F--;)if(g[F]===M)return F;return F}function pn(g){return un(g)?wp(g):fp(g)}function Ft(g){return un(g)?Rp(g):dp(g)}function ra(g){for(var M=g.length;M--&&Tu.test(g.charAt(M)););return M}var Bp=dl(op);function wp(g){for(var M=sl.lastIndex=0;sl.test(g);)++M;return M}function Rp(g){return g.match(sl)||[]}function Dp(g){return g.match(Ju)||[]}var Op=function g(M){M=M==null?De:Si.defaults(De.Object(),M,Si.pick(De,tp));var S=M.Array,F=M.Date,K=M.Error,ae=M.Function,Be=M.Math,fe=M.Object,Tl=M.RegExp,Lp=M.String,ht=M.TypeError,Fr=S.prototype,Np=ae.prototype,fn=fe.prototype,Ur=M["__core-js_shared__"],qr=Np.toString,ue=fn.hasOwnProperty,Fp=0,oa=function(){var e=/[^.]+$/.exec(Ur&&Ur.keys&&Ur.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Pr=fn.toString,Up=qr.call(fe),qp=De._,Pp=Tl("^"+qr.call(ue).replace(tl,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),$r=Ws?M.Buffer:o,Mi=M.Symbol,Hr=M.Uint8Array,la=$r?$r.allocUnsafe:o,Wr=na(fe.getPrototypeOf,fe),sa=fe.create,aa=fn.propertyIsEnumerable,Vr=Fr.splice,ca=Mi?Mi.isConcatSpreadable:o,er=Mi?Mi.iterator:o,zi=Mi?Mi.toStringTag:o,Gr=function(){try{var e=Ji(fe,"defineProperty");return e({},"",{}),e}catch{}}(),$p=M.clearTimeout!==De.clearTimeout&&M.clearTimeout,Hp=F&&F.now!==De.Date.now&&F.now,Wp=M.setTimeout!==De.setTimeout&&M.setTimeout,kr=Be.ceil,jr=Be.floor,vl=fe.getOwnPropertySymbols,Vp=$r?$r.isBuffer:o,ma=M.isFinite,Gp=Fr.join,kp=na(fe.keys,fe),we=Be.max,He=Be.min,jp=F.now,zp=M.parseInt,ua=Be.random,Yp=Fr.reverse,xl=Ji(M,"DataView"),tr=Ji(M,"Map"),Cl=Ji(M,"Promise"),dn=Ji(M,"Set"),ir=Ji(M,"WeakMap"),nr=Ji(fe,"create"),zr=ir&&new ir,gn={},Kp=Xi(xl),Zp=Xi(tr),Qp=Xi(Cl),Jp=Xi(dn),Xp=Xi(ir),Yr=Mi?Mi.prototype:o,rr=Yr?Yr.valueOf:o,pa=Yr?Yr.toString:o;function m(e){if(xe(e)&&!Z(e)&&!(e instanceof te)){if(e instanceof Tt)return e;if(ue.call(e,"__wrapped__"))return fc(e)}return new Tt(e)}var bn=function(){function e(){}return function(t){if(!ve(t))return{};if(sa)return sa(t);e.prototype=t;var i=new e;return e.prototype=o,i}}();function Kr(){}function Tt(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=o}m.templateSettings={escape:fu,evaluate:du,interpolate:xs,variable:"",imports:{_:m}},m.prototype=Kr.prototype,m.prototype.constructor=m,Tt.prototype=bn(Kr.prototype),Tt.prototype.constructor=Tt;function te(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Wt,this.__views__=[]}function ef(){var e=new te(this.__wrapped__);return e.__actions__=Ze(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Ze(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Ze(this.__views__),e}function tf(){if(this.__filtered__){var e=new te(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function nf(){var e=this.__wrapped__.value(),t=this.__dir__,i=Z(e),l=t<0,a=i?e.length:0,u=g0(0,a,this.__views__),f=u.start,d=u.end,_=d-f,E=l?d:f-1,A=this.__iteratees__,B=A.length,N=0,P=He(_,this.__takeCount__);if(!i||!l&&a==_&&P==_)return Fa(e,this.__actions__);var z=[];e:for(;_--&&N<P;){E+=t;for(var J=-1,Y=e[E];++J<B;){var ee=A[J],re=ee.iteratee,pt=ee.type,Ye=re(Y);if(pt==Zm)Y=Ye;else if(!Ye){if(pt==bs)continue e;break e}}z[N++]=Y}return z}te.prototype=bn(Kr.prototype),te.prototype.constructor=te;function Yi(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var l=e[t];this.set(l[0],l[1])}}function rf(){this.__data__=nr?nr(null):{},this.size=0}function of(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function lf(e){var t=this.__data__;if(nr){var i=t[e];return i===b?o:i}return ue.call(t,e)?t[e]:o}function sf(e){var t=this.__data__;return nr?t[e]!==o:ue.call(t,e)}function af(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=nr&&t===o?b:t,this}Yi.prototype.clear=rf,Yi.prototype.delete=of,Yi.prototype.get=lf,Yi.prototype.has=sf,Yi.prototype.set=af;function si(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var l=e[t];this.set(l[0],l[1])}}function cf(){this.__data__=[],this.size=0}function mf(e){var t=this.__data__,i=Zr(t,e);if(i<0)return!1;var l=t.length-1;return i==l?t.pop():Vr.call(t,i,1),--this.size,!0}function uf(e){var t=this.__data__,i=Zr(t,e);return i<0?o:t[i][1]}function pf(e){return Zr(this.__data__,e)>-1}function ff(e,t){var i=this.__data__,l=Zr(i,e);return l<0?(++this.size,i.push([e,t])):i[l][1]=t,this}si.prototype.clear=cf,si.prototype.delete=mf,si.prototype.get=uf,si.prototype.has=pf,si.prototype.set=ff;function ai(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var l=e[t];this.set(l[0],l[1])}}function df(){this.size=0,this.__data__={hash:new Yi,map:new(tr||si),string:new Yi}}function gf(e){var t=ao(this,e).delete(e);return this.size-=t?1:0,t}function bf(e){return ao(this,e).get(e)}function _f(e){return ao(this,e).has(e)}function hf(e,t){var i=ao(this,e),l=i.size;return i.set(e,t),this.size+=i.size==l?0:1,this}ai.prototype.clear=df,ai.prototype.delete=gf,ai.prototype.get=bf,ai.prototype.has=_f,ai.prototype.set=hf;function Ki(e){var t=-1,i=e==null?0:e.length;for(this.__data__=new ai;++t<i;)this.add(e[t])}function Tf(e){return this.__data__.set(e,b),this}function vf(e){return this.__data__.has(e)}Ki.prototype.add=Ki.prototype.push=Tf,Ki.prototype.has=vf;function Ut(e){var t=this.__data__=new si(e);this.size=t.size}function xf(){this.__data__=new si,this.size=0}function Cf(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i}function yf(e){return this.__data__.get(e)}function Sf(e){return this.__data__.has(e)}function Mf(e,t){var i=this.__data__;if(i instanceof si){var l=i.__data__;if(!tr||l.length<n-1)return l.push([e,t]),this.size=++i.size,this;i=this.__data__=new ai(l)}return i.set(e,t),this.size=i.size,this}Ut.prototype.clear=xf,Ut.prototype.delete=Cf,Ut.prototype.get=yf,Ut.prototype.has=Sf,Ut.prototype.set=Mf;function fa(e,t){var i=Z(e),l=!i&&en(e),a=!i&&!l&&wi(e),u=!i&&!l&&!a&&vn(e),f=i||l||a||u,d=f?bl(e.length,Lp):[],_=d.length;for(var E in e)(t||ue.call(e,E))&&!(f&&(E=="length"||a&&(E=="offset"||E=="parent")||u&&(E=="buffer"||E=="byteLength"||E=="byteOffset")||pi(E,_)))&&d.push(E);return d}function da(e){var t=e.length;return t?e[Ol(0,t-1)]:o}function If(e,t){return co(Ze(e),Zi(t,0,e.length))}function Ef(e){return co(Ze(e))}function yl(e,t,i){(i!==o&&!qt(e[t],i)||i===o&&!(t in e))&&ci(e,t,i)}function or(e,t,i){var l=e[t];(!(ue.call(e,t)&&qt(l,i))||i===o&&!(t in e))&&ci(e,t,i)}function Zr(e,t){for(var i=e.length;i--;)if(qt(e[i][0],t))return i;return-1}function Af(e,t,i,l){return Ii(e,function(a,u,f){t(l,a,i(a),f)}),l}function ga(e,t){return e&&Gt(t,Oe(t),e)}function Bf(e,t){return e&&Gt(t,Je(t),e)}function ci(e,t,i){t=="__proto__"&&Gr?Gr(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}function Sl(e,t){for(var i=-1,l=t.length,a=S(l),u=e==null;++i<l;)a[i]=u?o:rs(e,t[i]);return a}function Zi(e,t,i){return e===e&&(i!==o&&(e=e<=i?e:i),t!==o&&(e=e>=t?e:t)),e}function vt(e,t,i,l,a,u){var f,d=t&U,_=t&de,E=t&ce;if(i&&(f=a?i(e,l,a,u):i(e)),f!==o)return f;if(!ve(e))return e;var A=Z(e);if(A){if(f=_0(e),!d)return Ze(e,f)}else{var B=We(e),N=B==Ar||B==_s;if(wi(e))return Pa(e,d);if(B==li||B==sn||N&&!a){if(f=_||N?{}:rc(e),!d)return _?l0(e,Bf(f,e)):o0(e,ga(f,e))}else{if(!ge[B])return a?e:{};f=h0(e,B,d)}}u||(u=new Ut);var P=u.get(e);if(P)return P;u.set(e,f),Oc(e)?e.forEach(function(Y){f.add(vt(Y,t,i,Y,e,u))}):Rc(e)&&e.forEach(function(Y,ee){f.set(ee,vt(Y,t,i,ee,e,u))});var z=E?_?Gl:Vl:_?Je:Oe,J=A?o:z(e);return _t(J||e,function(Y,ee){J&&(ee=Y,Y=e[ee]),or(f,ee,vt(Y,t,i,ee,e,u))}),f}function wf(e){var t=Oe(e);return function(i){return ba(i,e,t)}}function ba(e,t,i){var l=i.length;if(e==null)return!l;for(e=fe(e);l--;){var a=i[l],u=t[a],f=e[a];if(f===o&&!(a in e)||!u(f))return!1}return!0}function _a(e,t,i){if(typeof e!="function")throw new ht(c);return pr(function(){e.apply(o,i)},t)}function lr(e,t,i,l){var a=-1,u=Or,f=!0,d=e.length,_=[],E=t.length;if(!d)return _;i&&(t=Te(t,ct(i))),l?(u=ml,f=!1):t.length>=n&&(u=Xn,f=!1,t=new Ki(t));e:for(;++a<d;){var A=e[a],B=i==null?A:i(A);if(A=l||A!==0?A:0,f&&B===B){for(var N=E;N--;)if(t[N]===B)continue e;_.push(A)}else u(t,B,l)||_.push(A)}return _}var Ii=Ga(Vt),ha=Ga(Il,!0);function Rf(e,t){var i=!0;return Ii(e,function(l,a,u){return i=!!t(l,a,u),i}),i}function Qr(e,t,i){for(var l=-1,a=e.length;++l<a;){var u=e[l],f=t(u);if(f!=null&&(d===o?f===f&&!ut(f):i(f,d)))var d=f,_=u}return _}function Df(e,t,i,l){var a=e.length;for(i=Q(i),i<0&&(i=-i>a?0:a+i),l=l===o||l>a?a:Q(l),l<0&&(l+=a),l=i>l?0:Nc(l);i<l;)e[i++]=t;return e}function Ta(e,t){var i=[];return Ii(e,function(l,a,u){t(l,a,u)&&i.push(l)}),i}function Fe(e,t,i,l,a){var u=-1,f=e.length;for(i||(i=v0),a||(a=[]);++u<f;){var d=e[u];t>0&&i(d)?t>1?Fe(d,t-1,i,l,a):Ci(a,d):l||(a[a.length]=d)}return a}var Ml=ka(),va=ka(!0);function Vt(e,t){return e&&Ml(e,t,Oe)}function Il(e,t){return e&&va(e,t,Oe)}function Jr(e,t){return xi(t,function(i){return fi(e[i])})}function Qi(e,t){t=Ai(t,e);for(var i=0,l=t.length;e!=null&&i<l;)e=e[kt(t[i++])];return i&&i==l?e:o}function xa(e,t,i){var l=t(e);return Z(e)?l:Ci(l,i(e))}function je(e){return e==null?e===o?lu:ru:zi&&zi in fe(e)?d0(e):E0(e)}function El(e,t){return e>t}function Of(e,t){return e!=null&&ue.call(e,t)}function Lf(e,t){return e!=null&&t in fe(e)}function Nf(e,t,i){return e>=He(t,i)&&e<we(t,i)}function Al(e,t,i){for(var l=i?ml:Or,a=e[0].length,u=e.length,f=u,d=S(u),_=1/0,E=[];f--;){var A=e[f];f&&t&&(A=Te(A,ct(t))),_=He(A.length,_),d[f]=!i&&(t||a>=120&&A.length>=120)?new Ki(f&&A):o}A=e[0];var B=-1,N=d[0];e:for(;++B<a&&E.length<_;){var P=A[B],z=t?t(P):P;if(P=i||P!==0?P:0,!(N?Xn(N,z):l(E,z,i))){for(f=u;--f;){var J=d[f];if(!(J?Xn(J,z):l(e[f],z,i)))continue e}N&&N.push(z),E.push(P)}}return E}function Ff(e,t,i,l){return Vt(e,function(a,u,f){t(l,i(a),u,f)}),l}function sr(e,t,i){t=Ai(t,e),e=ac(e,t);var l=e==null?e:e[kt(Ct(t))];return l==null?o:at(l,e,i)}function Ca(e){return xe(e)&&je(e)==sn}function Uf(e){return xe(e)&&je(e)==Jn}function qf(e){return xe(e)&&je(e)==zn}function ar(e,t,i,l,a){return e===t?!0:e==null||t==null||!xe(e)&&!xe(t)?e!==e&&t!==t:Pf(e,t,i,l,ar,a)}function Pf(e,t,i,l,a,u){var f=Z(e),d=Z(t),_=f?Ir:We(e),E=d?Ir:We(t);_=_==sn?li:_,E=E==sn?li:E;var A=_==li,B=E==li,N=_==E;if(N&&wi(e)){if(!wi(t))return!1;f=!0,A=!1}if(N&&!A)return u||(u=new Ut),f||vn(e)?tc(e,t,i,l,a,u):p0(e,t,_,i,l,a,u);if(!(i&ot)){var P=A&&ue.call(e,"__wrapped__"),z=B&&ue.call(t,"__wrapped__");if(P||z){var J=P?e.value():e,Y=z?t.value():t;return u||(u=new Ut),a(J,Y,i,l,u)}}return N?(u||(u=new Ut),f0(e,t,i,l,a,u)):!1}function $f(e){return xe(e)&&We(e)==Lt}function Bl(e,t,i,l){var a=i.length,u=a,f=!l;if(e==null)return!u;for(e=fe(e);a--;){var d=i[a];if(f&&d[2]?d[1]!==e[d[0]]:!(d[0]in e))return!1}for(;++a<u;){d=i[a];var _=d[0],E=e[_],A=d[1];if(f&&d[2]){if(E===o&&!(_ in e))return!1}else{var B=new Ut;if(l)var N=l(E,A,_,e,t,B);if(!(N===o?ar(A,E,ot|ni,l,B):N))return!1}}return!0}function ya(e){if(!ve(e)||C0(e))return!1;var t=fi(e)?Pp:Bu;return t.test(Xi(e))}function Hf(e){return xe(e)&&je(e)==Kn}function Wf(e){return xe(e)&&We(e)==Nt}function Vf(e){return xe(e)&&bo(e.length)&&!!be[je(e)]}function Sa(e){return typeof e=="function"?e:e==null?Xe:typeof e=="object"?Z(e)?Ea(e[0],e[1]):Ia(e):jc(e)}function wl(e){if(!ur(e))return kp(e);var t=[];for(var i in fe(e))ue.call(e,i)&&i!="constructor"&&t.push(i);return t}function Gf(e){if(!ve(e))return I0(e);var t=ur(e),i=[];for(var l in e)l=="constructor"&&(t||!ue.call(e,l))||i.push(l);return i}function Rl(e,t){return e<t}function Ma(e,t){var i=-1,l=Qe(e)?S(e.length):[];return Ii(e,function(a,u,f){l[++i]=t(a,u,f)}),l}function Ia(e){var t=jl(e);return t.length==1&&t[0][2]?lc(t[0][0],t[0][1]):function(i){return i===e||Bl(i,e,t)}}function Ea(e,t){return Yl(e)&&oc(t)?lc(kt(e),t):function(i){var l=rs(i,e);return l===o&&l===t?os(i,e):ar(t,l,ot|ni)}}function Xr(e,t,i,l,a){e!==t&&Ml(t,function(u,f){if(a||(a=new Ut),ve(u))kf(e,t,f,i,Xr,l,a);else{var d=l?l(Zl(e,f),u,f+"",e,t,a):o;d===o&&(d=u),yl(e,f,d)}},Je)}function kf(e,t,i,l,a,u,f){var d=Zl(e,i),_=Zl(t,i),E=f.get(_);if(E){yl(e,i,E);return}var A=u?u(d,_,i+"",e,t,f):o,B=A===o;if(B){var N=Z(_),P=!N&&wi(_),z=!N&&!P&&vn(_);A=_,N||P||z?Z(d)?A=d:Ie(d)?A=Ze(d):P?(B=!1,A=Pa(_,!0)):z?(B=!1,A=$a(_,!0)):A=[]:fr(_)||en(_)?(A=d,en(d)?A=Fc(d):(!ve(d)||fi(d))&&(A=rc(_))):B=!1}B&&(f.set(_,A),a(A,_,l,u,f),f.delete(_)),yl(e,i,A)}function Aa(e,t){var i=e.length;if(i)return t+=t<0?i:0,pi(t,i)?e[t]:o}function Ba(e,t,i){t.length?t=Te(t,function(u){return Z(u)?function(f){return Qi(f,u.length===1?u[0]:u)}:u}):t=[Xe];var l=-1;t=Te(t,ct(k()));var a=Ma(e,function(u,f,d){var _=Te(t,function(E){return E(u)});return{criteria:_,index:++l,value:u}});return _p(a,function(u,f){return r0(u,f,i)})}function jf(e,t){return wa(e,t,function(i,l){return os(e,l)})}function wa(e,t,i){for(var l=-1,a=t.length,u={};++l<a;){var f=t[l],d=Qi(e,f);i(d,f)&&cr(u,Ai(f,e),d)}return u}function zf(e){return function(t){return Qi(t,e)}}function Dl(e,t,i,l){var a=l?bp:mn,u=-1,f=t.length,d=e;for(e===t&&(t=Ze(t)),i&&(d=Te(e,ct(i)));++u<f;)for(var _=0,E=t[u],A=i?i(E):E;(_=a(d,A,_,l))>-1;)d!==e&&Vr.call(d,_,1),Vr.call(e,_,1);return e}function Ra(e,t){for(var i=e?t.length:0,l=i-1;i--;){var a=t[i];if(i==l||a!==u){var u=a;pi(a)?Vr.call(e,a,1):Fl(e,a)}}return e}function Ol(e,t){return e+jr(ua()*(t-e+1))}function Yf(e,t,i,l){for(var a=-1,u=we(kr((t-e)/(i||1)),0),f=S(u);u--;)f[l?u:++a]=e,e+=i;return f}function Ll(e,t){var i="";if(!e||t<1||t>vi)return i;do t%2&&(i+=e),t=jr(t/2),t&&(e+=e);while(t);return i}function X(e,t){return Ql(sc(e,t,Xe),e+"")}function Kf(e){return da(xn(e))}function Zf(e,t){var i=xn(e);return co(i,Zi(t,0,i.length))}function cr(e,t,i,l){if(!ve(e))return e;t=Ai(t,e);for(var a=-1,u=t.length,f=u-1,d=e;d!=null&&++a<u;){var _=kt(t[a]),E=i;if(_==="__proto__"||_==="constructor"||_==="prototype")return e;if(a!=f){var A=d[_];E=l?l(A,_,d):o,E===o&&(E=ve(A)?A:pi(t[a+1])?[]:{})}or(d,_,E),d=d[_]}return e}var Da=zr?function(e,t){return zr.set(e,t),e}:Xe,Qf=Gr?function(e,t){return Gr(e,"toString",{configurable:!0,enumerable:!1,value:ss(t),writable:!0})}:Xe;function Jf(e){return co(xn(e))}function xt(e,t,i){var l=-1,a=e.length;t<0&&(t=-t>a?0:a+t),i=i>a?a:i,i<0&&(i+=a),a=t>i?0:i-t>>>0,t>>>=0;for(var u=S(a);++l<a;)u[l]=e[l+t];return u}function Xf(e,t){var i;return Ii(e,function(l,a,u){return i=t(l,a,u),!i}),!!i}function eo(e,t,i){var l=0,a=e==null?l:e.length;if(typeof t=="number"&&t===t&&a<=eu){for(;l<a;){var u=l+a>>>1,f=e[u];f!==null&&!ut(f)&&(i?f<=t:f<t)?l=u+1:a=u}return a}return Nl(e,t,Xe,i)}function Nl(e,t,i,l){var a=0,u=e==null?0:e.length;if(u===0)return 0;t=i(t);for(var f=t!==t,d=t===null,_=ut(t),E=t===o;a<u;){var A=jr((a+u)/2),B=i(e[A]),N=B!==o,P=B===null,z=B===B,J=ut(B);if(f)var Y=l||z;else E?Y=z&&(l||N):d?Y=z&&N&&(l||!P):_?Y=z&&N&&!P&&(l||!J):P||J?Y=!1:Y=l?B<=t:B<t;Y?a=A+1:u=A}return He(u,Xm)}function Oa(e,t){for(var i=-1,l=e.length,a=0,u=[];++i<l;){var f=e[i],d=t?t(f):f;if(!i||!qt(d,_)){var _=d;u[a++]=f===0?0:f}}return u}function La(e){return typeof e=="number"?e:ut(e)?Mr:+e}function mt(e){if(typeof e=="string")return e;if(Z(e))return Te(e,mt)+"";if(ut(e))return pa?pa.call(e):"";var t=e+"";return t=="0"&&1/e==-ki?"-0":t}function Ei(e,t,i){var l=-1,a=Or,u=e.length,f=!0,d=[],_=d;if(i)f=!1,a=ml;else if(u>=n){var E=t?null:m0(e);if(E)return Nr(E);f=!1,a=Xn,_=new Ki}else _=t?[]:d;e:for(;++l<u;){var A=e[l],B=t?t(A):A;if(A=i||A!==0?A:0,f&&B===B){for(var N=_.length;N--;)if(_[N]===B)continue e;t&&_.push(B),d.push(A)}else a(_,B,i)||(_!==d&&_.push(B),d.push(A))}return d}function Fl(e,t){return t=Ai(t,e),e=ac(e,t),e==null||delete e[kt(Ct(t))]}function Na(e,t,i,l){return cr(e,t,i(Qi(e,t)),l)}function to(e,t,i,l){for(var a=e.length,u=l?a:-1;(l?u--:++u<a)&&t(e[u],u,e););return i?xt(e,l?0:u,l?u+1:a):xt(e,l?u+1:0,l?a:u)}function Fa(e,t){var i=e;return i instanceof te&&(i=i.value()),ul(t,function(l,a){return a.func.apply(a.thisArg,Ci([l],a.args))},i)}function Ul(e,t,i){var l=e.length;if(l<2)return l?Ei(e[0]):[];for(var a=-1,u=S(l);++a<l;)for(var f=e[a],d=-1;++d<l;)d!=a&&(u[a]=lr(u[a]||f,e[d],t,i));return Ei(Fe(u,1),t,i)}function Ua(e,t,i){for(var l=-1,a=e.length,u=t.length,f={};++l<a;){var d=l<u?t[l]:o;i(f,e[l],d)}return f}function ql(e){return Ie(e)?e:[]}function Pl(e){return typeof e=="function"?e:Xe}function Ai(e,t){return Z(e)?e:Yl(e,t)?[e]:pc(me(e))}var e0=X;function Bi(e,t,i){var l=e.length;return i=i===o?l:i,!t&&i>=l?e:xt(e,t,i)}var qa=$p||function(e){return De.clearTimeout(e)};function Pa(e,t){if(t)return e.slice();var i=e.length,l=la?la(i):new e.constructor(i);return e.copy(l),l}function $l(e){var t=new e.constructor(e.byteLength);return new Hr(t).set(new Hr(e)),t}function t0(e,t){var i=t?$l(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}function i0(e){var t=new e.constructor(e.source,Cs.exec(e));return t.lastIndex=e.lastIndex,t}function n0(e){return rr?fe(rr.call(e)):{}}function $a(e,t){var i=t?$l(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}function Ha(e,t){if(e!==t){var i=e!==o,l=e===null,a=e===e,u=ut(e),f=t!==o,d=t===null,_=t===t,E=ut(t);if(!d&&!E&&!u&&e>t||u&&f&&_&&!d&&!E||l&&f&&_||!i&&_||!a)return 1;if(!l&&!u&&!E&&e<t||E&&i&&a&&!l&&!u||d&&i&&a||!f&&a||!_)return-1}return 0}function r0(e,t,i){for(var l=-1,a=e.criteria,u=t.criteria,f=a.length,d=i.length;++l<f;){var _=Ha(a[l],u[l]);if(_){if(l>=d)return _;var E=i[l];return _*(E=="desc"?-1:1)}}return e.index-t.index}function Wa(e,t,i,l){for(var a=-1,u=e.length,f=i.length,d=-1,_=t.length,E=we(u-f,0),A=S(_+E),B=!l;++d<_;)A[d]=t[d];for(;++a<f;)(B||a<u)&&(A[i[a]]=e[a]);for(;E--;)A[d++]=e[a++];return A}function Va(e,t,i,l){for(var a=-1,u=e.length,f=-1,d=i.length,_=-1,E=t.length,A=we(u-d,0),B=S(A+E),N=!l;++a<A;)B[a]=e[a];for(var P=a;++_<E;)B[P+_]=t[_];for(;++f<d;)(N||a<u)&&(B[P+i[f]]=e[a++]);return B}function Ze(e,t){var i=-1,l=e.length;for(t||(t=S(l));++i<l;)t[i]=e[i];return t}function Gt(e,t,i,l){var a=!i;i||(i={});for(var u=-1,f=t.length;++u<f;){var d=t[u],_=l?l(i[d],e[d],d,i,e):o;_===o&&(_=e[d]),a?ci(i,d,_):or(i,d,_)}return i}function o0(e,t){return Gt(e,zl(e),t)}function l0(e,t){return Gt(e,ic(e),t)}function io(e,t){return function(i,l){var a=Z(i)?mp:Af,u=t?t():{};return a(i,e,k(l,2),u)}}function _n(e){return X(function(t,i){var l=-1,a=i.length,u=a>1?i[a-1]:o,f=a>2?i[2]:o;for(u=e.length>3&&typeof u=="function"?(a--,u):o,f&&ze(i[0],i[1],f)&&(u=a<3?o:u,a=1),t=fe(t);++l<a;){var d=i[l];d&&e(t,d,l,u)}return t})}function Ga(e,t){return function(i,l){if(i==null)return i;if(!Qe(i))return e(i,l);for(var a=i.length,u=t?a:-1,f=fe(i);(t?u--:++u<a)&&l(f[u],u,f)!==!1;);return i}}function ka(e){return function(t,i,l){for(var a=-1,u=fe(t),f=l(t),d=f.length;d--;){var _=f[e?d:++a];if(i(u[_],_,u)===!1)break}return t}}function s0(e,t,i){var l=t&ke,a=mr(e);function u(){var f=this&&this!==De&&this instanceof u?a:e;return f.apply(l?i:this,arguments)}return u}function ja(e){return function(t){t=me(t);var i=un(t)?Ft(t):o,l=i?i[0]:t.charAt(0),a=i?Bi(i,1).join(""):t.slice(1);return l[e]()+a}}function hn(e){return function(t){return ul(Gc(Vc(t).replace(Zu,"")),e,"")}}function mr(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var i=bn(e.prototype),l=e.apply(i,t);return ve(l)?l:i}}function a0(e,t,i){var l=mr(e);function a(){for(var u=arguments.length,f=S(u),d=u,_=Tn(a);d--;)f[d]=arguments[d];var E=u<3&&f[0]!==_&&f[u-1]!==_?[]:yi(f,_);if(u-=E.length,u<i)return Qa(e,t,no,a.placeholder,o,f,E,o,o,i-u);var A=this&&this!==De&&this instanceof a?l:e;return at(A,this,f)}return a}function za(e){return function(t,i,l){var a=fe(t);if(!Qe(t)){var u=k(i,3);t=Oe(t),i=function(d){return u(a[d],d,a)}}var f=e(t,i,l);return f>-1?a[u?t[f]:f]:o}}function Ya(e){return ui(function(t){var i=t.length,l=i,a=Tt.prototype.thru;for(e&&t.reverse();l--;){var u=t[l];if(typeof u!="function")throw new ht(c);if(a&&!f&&so(u)=="wrapper")var f=new Tt([],!0)}for(l=f?l:i;++l<i;){u=t[l];var d=so(u),_=d=="wrapper"?kl(u):o;_&&Kl(_[0])&&_[1]==(gt|lt|st|kn)&&!_[4].length&&_[9]==1?f=f[so(_[0])].apply(f,_[3]):f=u.length==1&&Kl(u)?f[d]():f.thru(u)}return function(){var E=arguments,A=E[0];if(f&&E.length==1&&Z(A))return f.plant(A).value();for(var B=0,N=i?t[B].apply(this,E):A;++B<i;)N=t[B].call(this,N);return N}})}function no(e,t,i,l,a,u,f,d,_,E){var A=t&gt,B=t&ke,N=t&Ht,P=t&(lt|ri),z=t&ko,J=N?o:mr(e);function Y(){for(var ee=arguments.length,re=S(ee),pt=ee;pt--;)re[pt]=arguments[pt];if(P)var Ye=Tn(Y),ft=Tp(re,Ye);if(l&&(re=Wa(re,l,a,P)),u&&(re=Va(re,u,f,P)),ee-=ft,P&&ee<E){var Ee=yi(re,Ye);return Qa(e,t,no,Y.placeholder,i,re,Ee,d,_,E-ee)}var Pt=B?i:this,gi=N?Pt[e]:e;return ee=re.length,d?re=A0(re,d):z&&ee>1&&re.reverse(),A&&_<ee&&(re.length=_),this&&this!==De&&this instanceof Y&&(gi=J||mr(gi)),gi.apply(Pt,re)}return Y}function Ka(e,t){return function(i,l){return Ff(i,e,t(l),{})}}function ro(e,t){return function(i,l){var a;if(i===o&&l===o)return t;if(i!==o&&(a=i),l!==o){if(a===o)return l;typeof i=="string"||typeof l=="string"?(i=mt(i),l=mt(l)):(i=La(i),l=La(l)),a=e(i,l)}return a}}function Hl(e){return ui(function(t){return t=Te(t,ct(k())),X(function(i){var l=this;return e(t,function(a){return at(a,l,i)})})})}function oo(e,t){t=t===o?" ":mt(t);var i=t.length;if(i<2)return i?Ll(t,e):t;var l=Ll(t,kr(e/pn(t)));return un(t)?Bi(Ft(l),0,e).join(""):l.slice(0,e)}function c0(e,t,i,l){var a=t&ke,u=mr(e);function f(){for(var d=-1,_=arguments.length,E=-1,A=l.length,B=S(A+_),N=this&&this!==De&&this instanceof f?u:e;++E<A;)B[E]=l[E];for(;_--;)B[E++]=arguments[++d];return at(N,a?i:this,B)}return f}function Za(e){return function(t,i,l){return l&&typeof l!="number"&&ze(t,i,l)&&(i=l=o),t=di(t),i===o?(i=t,t=0):i=di(i),l=l===o?t<i?1:-1:di(l),Yf(t,i,l,e)}}function lo(e){return function(t,i){return typeof t=="string"&&typeof i=="string"||(t=yt(t),i=yt(i)),e(t,i)}}function Qa(e,t,i,l,a,u,f,d,_,E){var A=t&lt,B=A?f:o,N=A?o:f,P=A?u:o,z=A?o:u;t|=A?st:oi,t&=~(A?oi:st),t&Gn||(t&=~(ke|Ht));var J=[e,t,a,P,B,z,N,d,_,E],Y=i.apply(o,J);return Kl(e)&&cc(Y,J),Y.placeholder=l,mc(Y,e,t)}function Wl(e){var t=Be[e];return function(i,l){if(i=yt(i),l=l==null?0:He(Q(l),292),l&&ma(i)){var a=(me(i)+"e").split("e"),u=t(a[0]+"e"+(+a[1]+l));return a=(me(u)+"e").split("e"),+(a[0]+"e"+(+a[1]-l))}return t(i)}}var m0=dn&&1/Nr(new dn([,-0]))[1]==ki?function(e){return new dn(e)}:ms;function Ja(e){return function(t){var i=We(t);return i==Lt?hl(t):i==Nt?Ip(t):hp(t,e(t))}}function mi(e,t,i,l,a,u,f,d){var _=t&Ht;if(!_&&typeof e!="function")throw new ht(c);var E=l?l.length:0;if(E||(t&=~(st|oi),l=a=o),f=f===o?f:we(Q(f),0),d=d===o?d:Q(d),E-=a?a.length:0,t&oi){var A=l,B=a;l=a=o}var N=_?o:kl(e),P=[e,t,i,l,a,A,B,u,f,d];if(N&&M0(P,N),e=P[0],t=P[1],i=P[2],l=P[3],a=P[4],d=P[9]=P[9]===o?_?0:e.length:we(P[9]-E,0),!d&&t&(lt|ri)&&(t&=~(lt|ri)),!t||t==ke)var z=s0(e,t,i);else t==lt||t==ri?z=a0(e,t,d):(t==st||t==(ke|st))&&!a.length?z=c0(e,t,i,l):z=no.apply(o,P);var J=N?Da:cc;return mc(J(z,P),e,t)}function Xa(e,t,i,l){return e===o||qt(e,fn[i])&&!ue.call(l,i)?t:e}function ec(e,t,i,l,a,u){return ve(e)&&ve(t)&&(u.set(t,e),Xr(e,t,o,ec,u),u.delete(t)),e}function u0(e){return fr(e)?o:e}function tc(e,t,i,l,a,u){var f=i&ot,d=e.length,_=t.length;if(d!=_&&!(f&&_>d))return!1;var E=u.get(e),A=u.get(t);if(E&&A)return E==t&&A==e;var B=-1,N=!0,P=i&ni?new Ki:o;for(u.set(e,t),u.set(t,e);++B<d;){var z=e[B],J=t[B];if(l)var Y=f?l(J,z,B,t,e,u):l(z,J,B,e,t,u);if(Y!==o){if(Y)continue;N=!1;break}if(P){if(!pl(t,function(ee,re){if(!Xn(P,re)&&(z===ee||a(z,ee,i,l,u)))return P.push(re)})){N=!1;break}}else if(!(z===J||a(z,J,i,l,u))){N=!1;break}}return u.delete(e),u.delete(t),N}function p0(e,t,i,l,a,u,f){switch(i){case an:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Jn:return!(e.byteLength!=t.byteLength||!u(new Hr(e),new Hr(t)));case jn:case zn:case Yn:return qt(+e,+t);case Er:return e.name==t.name&&e.message==t.message;case Kn:case Zn:return e==t+"";case Lt:var d=hl;case Nt:var _=l&ot;if(d||(d=Nr),e.size!=t.size&&!_)return!1;var E=f.get(e);if(E)return E==t;l|=ni,f.set(e,t);var A=tc(d(e),d(t),l,a,u,f);return f.delete(e),A;case Br:if(rr)return rr.call(e)==rr.call(t)}return!1}function f0(e,t,i,l,a,u){var f=i&ot,d=Vl(e),_=d.length,E=Vl(t),A=E.length;if(_!=A&&!f)return!1;for(var B=_;B--;){var N=d[B];if(!(f?N in t:ue.call(t,N)))return!1}var P=u.get(e),z=u.get(t);if(P&&z)return P==t&&z==e;var J=!0;u.set(e,t),u.set(t,e);for(var Y=f;++B<_;){N=d[B];var ee=e[N],re=t[N];if(l)var pt=f?l(re,ee,N,t,e,u):l(ee,re,N,e,t,u);if(!(pt===o?ee===re||a(ee,re,i,l,u):pt)){J=!1;break}Y||(Y=N=="constructor")}if(J&&!Y){var Ye=e.constructor,ft=t.constructor;Ye!=ft&&"constructor"in e&&"constructor"in t&&!(typeof Ye=="function"&&Ye instanceof Ye&&typeof ft=="function"&&ft instanceof ft)&&(J=!1)}return u.delete(e),u.delete(t),J}function ui(e){return Ql(sc(e,o,bc),e+"")}function Vl(e){return xa(e,Oe,zl)}function Gl(e){return xa(e,Je,ic)}var kl=zr?function(e){return zr.get(e)}:ms;function so(e){for(var t=e.name+"",i=gn[t],l=ue.call(gn,t)?i.length:0;l--;){var a=i[l],u=a.func;if(u==null||u==e)return a.name}return t}function Tn(e){var t=ue.call(m,"placeholder")?m:e;return t.placeholder}function k(){var e=m.iteratee||as;return e=e===as?Sa:e,arguments.length?e(arguments[0],arguments[1]):e}function ao(e,t){var i=e.__data__;return x0(t)?i[typeof t=="string"?"string":"hash"]:i.map}function jl(e){for(var t=Oe(e),i=t.length;i--;){var l=t[i],a=e[l];t[i]=[l,a,oc(a)]}return t}function Ji(e,t){var i=yp(e,t);return ya(i)?i:o}function d0(e){var t=ue.call(e,zi),i=e[zi];try{e[zi]=o;var l=!0}catch{}var a=Pr.call(e);return l&&(t?e[zi]=i:delete e[zi]),a}var zl=vl?function(e){return e==null?[]:(e=fe(e),xi(vl(e),function(t){return aa.call(e,t)}))}:us,ic=vl?function(e){for(var t=[];e;)Ci(t,zl(e)),e=Wr(e);return t}:us,We=je;(xl&&We(new xl(new ArrayBuffer(1)))!=an||tr&&We(new tr)!=Lt||Cl&&We(Cl.resolve())!=hs||dn&&We(new dn)!=Nt||ir&&We(new ir)!=Qn)&&(We=function(e){var t=je(e),i=t==li?e.constructor:o,l=i?Xi(i):"";if(l)switch(l){case Kp:return an;case Zp:return Lt;case Qp:return hs;case Jp:return Nt;case Xp:return Qn}return t});function g0(e,t,i){for(var l=-1,a=i.length;++l<a;){var u=i[l],f=u.size;switch(u.type){case"drop":e+=f;break;case"dropRight":t-=f;break;case"take":t=He(t,e+f);break;case"takeRight":e=we(e,t-f);break}}return{start:e,end:t}}function b0(e){var t=e.match(xu);return t?t[1].split(Cu):[]}function nc(e,t,i){t=Ai(t,e);for(var l=-1,a=t.length,u=!1;++l<a;){var f=kt(t[l]);if(!(u=e!=null&&i(e,f)))break;e=e[f]}return u||++l!=a?u:(a=e==null?0:e.length,!!a&&bo(a)&&pi(f,a)&&(Z(e)||en(e)))}function _0(e){var t=e.length,i=new e.constructor(t);return t&&typeof e[0]=="string"&&ue.call(e,"index")&&(i.index=e.index,i.input=e.input),i}function rc(e){return typeof e.constructor=="function"&&!ur(e)?bn(Wr(e)):{}}function h0(e,t,i){var l=e.constructor;switch(t){case Jn:return $l(e);case jn:case zn:return new l(+e);case an:return t0(e,i);case jo:case zo:case Yo:case Ko:case Zo:case Qo:case Jo:case Xo:case el:return $a(e,i);case Lt:return new l;case Yn:case Zn:return new l(e);case Kn:return i0(e);case Nt:return new l;case Br:return n0(e)}}function T0(e,t){var i=t.length;if(!i)return e;var l=i-1;return t[l]=(i>1?"& ":"")+t[l],t=t.join(i>2?", ":" "),e.replace(vu,`{
/* [wrapped with `+t+`] */
`)}function v0(e){return Z(e)||en(e)||!!(ca&&e&&e[ca])}function pi(e,t){var i=typeof e;return t=t??vi,!!t&&(i=="number"||i!="symbol"&&Ru.test(e))&&e>-1&&e%1==0&&e<t}function ze(e,t,i){if(!ve(i))return!1;var l=typeof t;return(l=="number"?Qe(i)&&pi(t,i.length):l=="string"&&t in i)?qt(i[t],e):!1}function Yl(e,t){if(Z(e))return!1;var i=typeof e;return i=="number"||i=="symbol"||i=="boolean"||e==null||ut(e)?!0:bu.test(e)||!gu.test(e)||t!=null&&e in fe(t)}function x0(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Kl(e){var t=so(e),i=m[t];if(typeof i!="function"||!(t in te.prototype))return!1;if(e===i)return!0;var l=kl(i);return!!l&&e===l[0]}function C0(e){return!!oa&&oa in e}var y0=Ur?fi:ps;function ur(e){var t=e&&e.constructor,i=typeof t=="function"&&t.prototype||fn;return e===i}function oc(e){return e===e&&!ve(e)}function lc(e,t){return function(i){return i==null?!1:i[e]===t&&(t!==o||e in fe(i))}}function S0(e){var t=fo(e,function(l){return i.size===y&&i.clear(),l}),i=t.cache;return t}function M0(e,t){var i=e[1],l=t[1],a=i|l,u=a<(ke|Ht|gt),f=l==gt&&i==lt||l==gt&&i==kn&&e[7].length<=t[8]||l==(gt|kn)&&t[7].length<=t[8]&&i==lt;if(!(u||f))return e;l&ke&&(e[2]=t[2],a|=i&ke?0:Gn);var d=t[3];if(d){var _=e[3];e[3]=_?Wa(_,d,t[4]):d,e[4]=_?yi(e[3],L):t[4]}return d=t[5],d&&(_=e[5],e[5]=_?Va(_,d,t[6]):d,e[6]=_?yi(e[5],L):t[6]),d=t[7],d&&(e[7]=d),l&gt&&(e[8]=e[8]==null?t[8]:He(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=a,e}function I0(e){var t=[];if(e!=null)for(var i in fe(e))t.push(i);return t}function E0(e){return Pr.call(e)}function sc(e,t,i){return t=we(t===o?e.length-1:t,0),function(){for(var l=arguments,a=-1,u=we(l.length-t,0),f=S(u);++a<u;)f[a]=l[t+a];a=-1;for(var d=S(t+1);++a<t;)d[a]=l[a];return d[t]=i(f),at(e,this,d)}}function ac(e,t){return t.length<2?e:Qi(e,xt(t,0,-1))}function A0(e,t){for(var i=e.length,l=He(t.length,i),a=Ze(e);l--;){var u=t[l];e[l]=pi(u,i)?a[u]:o}return e}function Zl(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var cc=uc(Da),pr=Wp||function(e,t){return De.setTimeout(e,t)},Ql=uc(Qf);function mc(e,t,i){var l=t+"";return Ql(e,T0(l,B0(b0(l),i)))}function uc(e){var t=0,i=0;return function(){var l=jp(),a=Km-(l-i);if(i=l,a>0){if(++t>=Ym)return arguments[0]}else t=0;return e.apply(o,arguments)}}function co(e,t){var i=-1,l=e.length,a=l-1;for(t=t===o?l:t;++i<t;){var u=Ol(i,a),f=e[u];e[u]=e[i],e[i]=f}return e.length=t,e}var pc=S0(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(_u,function(i,l,a,u){t.push(a?u.replace(Mu,"$1"):l||i)}),t});function kt(e){if(typeof e=="string"||ut(e))return e;var t=e+"";return t=="0"&&1/e==-ki?"-0":t}function Xi(e){if(e!=null){try{return qr.call(e)}catch{}try{return e+""}catch{}}return""}function B0(e,t){return _t(tu,function(i){var l="_."+i[0];t&i[1]&&!Or(e,l)&&e.push(l)}),e.sort()}function fc(e){if(e instanceof te)return e.clone();var t=new Tt(e.__wrapped__,e.__chain__);return t.__actions__=Ze(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function w0(e,t,i){(i?ze(e,t,i):t===o)?t=1:t=we(Q(t),0);var l=e==null?0:e.length;if(!l||t<1)return[];for(var a=0,u=0,f=S(kr(l/t));a<l;)f[u++]=xt(e,a,a+=t);return f}function R0(e){for(var t=-1,i=e==null?0:e.length,l=0,a=[];++t<i;){var u=e[t];u&&(a[l++]=u)}return a}function D0(){var e=arguments.length;if(!e)return[];for(var t=S(e-1),i=arguments[0],l=e;l--;)t[l-1]=arguments[l];return Ci(Z(i)?Ze(i):[i],Fe(t,1))}var O0=X(function(e,t){return Ie(e)?lr(e,Fe(t,1,Ie,!0)):[]}),L0=X(function(e,t){var i=Ct(t);return Ie(i)&&(i=o),Ie(e)?lr(e,Fe(t,1,Ie,!0),k(i,2)):[]}),N0=X(function(e,t){var i=Ct(t);return Ie(i)&&(i=o),Ie(e)?lr(e,Fe(t,1,Ie,!0),o,i):[]});function F0(e,t,i){var l=e==null?0:e.length;return l?(t=i||t===o?1:Q(t),xt(e,t<0?0:t,l)):[]}function U0(e,t,i){var l=e==null?0:e.length;return l?(t=i||t===o?1:Q(t),t=l-t,xt(e,0,t<0?0:t)):[]}function q0(e,t){return e&&e.length?to(e,k(t,3),!0,!0):[]}function P0(e,t){return e&&e.length?to(e,k(t,3),!0):[]}function $0(e,t,i,l){var a=e==null?0:e.length;return a?(i&&typeof i!="number"&&ze(e,t,i)&&(i=0,l=a),Df(e,t,i,l)):[]}function dc(e,t,i){var l=e==null?0:e.length;if(!l)return-1;var a=i==null?0:Q(i);return a<0&&(a=we(l+a,0)),Lr(e,k(t,3),a)}function gc(e,t,i){var l=e==null?0:e.length;if(!l)return-1;var a=l-1;return i!==o&&(a=Q(i),a=i<0?we(l+a,0):He(a,l-1)),Lr(e,k(t,3),a,!0)}function bc(e){var t=e==null?0:e.length;return t?Fe(e,1):[]}function H0(e){var t=e==null?0:e.length;return t?Fe(e,ki):[]}function W0(e,t){var i=e==null?0:e.length;return i?(t=t===o?1:Q(t),Fe(e,t)):[]}function V0(e){for(var t=-1,i=e==null?0:e.length,l={};++t<i;){var a=e[t];l[a[0]]=a[1]}return l}function _c(e){return e&&e.length?e[0]:o}function G0(e,t,i){var l=e==null?0:e.length;if(!l)return-1;var a=i==null?0:Q(i);return a<0&&(a=we(l+a,0)),mn(e,t,a)}function k0(e){var t=e==null?0:e.length;return t?xt(e,0,-1):[]}var j0=X(function(e){var t=Te(e,ql);return t.length&&t[0]===e[0]?Al(t):[]}),z0=X(function(e){var t=Ct(e),i=Te(e,ql);return t===Ct(i)?t=o:i.pop(),i.length&&i[0]===e[0]?Al(i,k(t,2)):[]}),Y0=X(function(e){var t=Ct(e),i=Te(e,ql);return t=typeof t=="function"?t:o,t&&i.pop(),i.length&&i[0]===e[0]?Al(i,o,t):[]});function K0(e,t){return e==null?"":Gp.call(e,t)}function Ct(e){var t=e==null?0:e.length;return t?e[t-1]:o}function Z0(e,t,i){var l=e==null?0:e.length;if(!l)return-1;var a=l;return i!==o&&(a=Q(i),a=a<0?we(l+a,0):He(a,l-1)),t===t?Ap(e,t,a):Lr(e,Qs,a,!0)}function Q0(e,t){return e&&e.length?Aa(e,Q(t)):o}var J0=X(hc);function hc(e,t){return e&&e.length&&t&&t.length?Dl(e,t):e}function X0(e,t,i){return e&&e.length&&t&&t.length?Dl(e,t,k(i,2)):e}function ed(e,t,i){return e&&e.length&&t&&t.length?Dl(e,t,o,i):e}var td=ui(function(e,t){var i=e==null?0:e.length,l=Sl(e,t);return Ra(e,Te(t,function(a){return pi(a,i)?+a:a}).sort(Ha)),l});function id(e,t){var i=[];if(!(e&&e.length))return i;var l=-1,a=[],u=e.length;for(t=k(t,3);++l<u;){var f=e[l];t(f,l,e)&&(i.push(f),a.push(l))}return Ra(e,a),i}function Jl(e){return e==null?e:Yp.call(e)}function nd(e,t,i){var l=e==null?0:e.length;return l?(i&&typeof i!="number"&&ze(e,t,i)?(t=0,i=l):(t=t==null?0:Q(t),i=i===o?l:Q(i)),xt(e,t,i)):[]}function rd(e,t){return eo(e,t)}function od(e,t,i){return Nl(e,t,k(i,2))}function ld(e,t){var i=e==null?0:e.length;if(i){var l=eo(e,t);if(l<i&&qt(e[l],t))return l}return-1}function sd(e,t){return eo(e,t,!0)}function ad(e,t,i){return Nl(e,t,k(i,2),!0)}function cd(e,t){var i=e==null?0:e.length;if(i){var l=eo(e,t,!0)-1;if(qt(e[l],t))return l}return-1}function md(e){return e&&e.length?Oa(e):[]}function ud(e,t){return e&&e.length?Oa(e,k(t,2)):[]}function pd(e){var t=e==null?0:e.length;return t?xt(e,1,t):[]}function fd(e,t,i){return e&&e.length?(t=i||t===o?1:Q(t),xt(e,0,t<0?0:t)):[]}function dd(e,t,i){var l=e==null?0:e.length;return l?(t=i||t===o?1:Q(t),t=l-t,xt(e,t<0?0:t,l)):[]}function gd(e,t){return e&&e.length?to(e,k(t,3),!1,!0):[]}function bd(e,t){return e&&e.length?to(e,k(t,3)):[]}var _d=X(function(e){return Ei(Fe(e,1,Ie,!0))}),hd=X(function(e){var t=Ct(e);return Ie(t)&&(t=o),Ei(Fe(e,1,Ie,!0),k(t,2))}),Td=X(function(e){var t=Ct(e);return t=typeof t=="function"?t:o,Ei(Fe(e,1,Ie,!0),o,t)});function vd(e){return e&&e.length?Ei(e):[]}function xd(e,t){return e&&e.length?Ei(e,k(t,2)):[]}function Cd(e,t){return t=typeof t=="function"?t:o,e&&e.length?Ei(e,o,t):[]}function Xl(e){if(!(e&&e.length))return[];var t=0;return e=xi(e,function(i){if(Ie(i))return t=we(i.length,t),!0}),bl(t,function(i){return Te(e,fl(i))})}function Tc(e,t){if(!(e&&e.length))return[];var i=Xl(e);return t==null?i:Te(i,function(l){return at(t,o,l)})}var yd=X(function(e,t){return Ie(e)?lr(e,t):[]}),Sd=X(function(e){return Ul(xi(e,Ie))}),Md=X(function(e){var t=Ct(e);return Ie(t)&&(t=o),Ul(xi(e,Ie),k(t,2))}),Id=X(function(e){var t=Ct(e);return t=typeof t=="function"?t:o,Ul(xi(e,Ie),o,t)}),Ed=X(Xl);function Ad(e,t){return Ua(e||[],t||[],or)}function Bd(e,t){return Ua(e||[],t||[],cr)}var wd=X(function(e){var t=e.length,i=t>1?e[t-1]:o;return i=typeof i=="function"?(e.pop(),i):o,Tc(e,i)});function vc(e){var t=m(e);return t.__chain__=!0,t}function Rd(e,t){return t(e),e}function mo(e,t){return t(e)}var Dd=ui(function(e){var t=e.length,i=t?e[0]:0,l=this.__wrapped__,a=function(u){return Sl(u,e)};return t>1||this.__actions__.length||!(l instanceof te)||!pi(i)?this.thru(a):(l=l.slice(i,+i+(t?1:0)),l.__actions__.push({func:mo,args:[a],thisArg:o}),new Tt(l,this.__chain__).thru(function(u){return t&&!u.length&&u.push(o),u}))});function Od(){return vc(this)}function Ld(){return new Tt(this.value(),this.__chain__)}function Nd(){this.__values__===o&&(this.__values__=Lc(this.value()));var e=this.__index__>=this.__values__.length,t=e?o:this.__values__[this.__index__++];return{done:e,value:t}}function Fd(){return this}function Ud(e){for(var t,i=this;i instanceof Kr;){var l=fc(i);l.__index__=0,l.__values__=o,t?a.__wrapped__=l:t=l;var a=l;i=i.__wrapped__}return a.__wrapped__=e,t}function qd(){var e=this.__wrapped__;if(e instanceof te){var t=e;return this.__actions__.length&&(t=new te(this)),t=t.reverse(),t.__actions__.push({func:mo,args:[Jl],thisArg:o}),new Tt(t,this.__chain__)}return this.thru(Jl)}function Pd(){return Fa(this.__wrapped__,this.__actions__)}var $d=io(function(e,t,i){ue.call(e,i)?++e[i]:ci(e,i,1)});function Hd(e,t,i){var l=Z(e)?Ks:Rf;return i&&ze(e,t,i)&&(t=o),l(e,k(t,3))}function Wd(e,t){var i=Z(e)?xi:Ta;return i(e,k(t,3))}var Vd=za(dc),Gd=za(gc);function kd(e,t){return Fe(uo(e,t),1)}function jd(e,t){return Fe(uo(e,t),ki)}function zd(e,t,i){return i=i===o?1:Q(i),Fe(uo(e,t),i)}function xc(e,t){var i=Z(e)?_t:Ii;return i(e,k(t,3))}function Cc(e,t){var i=Z(e)?up:ha;return i(e,k(t,3))}var Yd=io(function(e,t,i){ue.call(e,i)?e[i].push(t):ci(e,i,[t])});function Kd(e,t,i,l){e=Qe(e)?e:xn(e),i=i&&!l?Q(i):0;var a=e.length;return i<0&&(i=we(a+i,0)),_o(e)?i<=a&&e.indexOf(t,i)>-1:!!a&&mn(e,t,i)>-1}var Zd=X(function(e,t,i){var l=-1,a=typeof t=="function",u=Qe(e)?S(e.length):[];return Ii(e,function(f){u[++l]=a?at(t,f,i):sr(f,t,i)}),u}),Qd=io(function(e,t,i){ci(e,i,t)});function uo(e,t){var i=Z(e)?Te:Ma;return i(e,k(t,3))}function Jd(e,t,i,l){return e==null?[]:(Z(t)||(t=t==null?[]:[t]),i=l?o:i,Z(i)||(i=i==null?[]:[i]),Ba(e,t,i))}var Xd=io(function(e,t,i){e[i?0:1].push(t)},function(){return[[],[]]});function eg(e,t,i){var l=Z(e)?ul:Xs,a=arguments.length<3;return l(e,k(t,4),i,a,Ii)}function tg(e,t,i){var l=Z(e)?pp:Xs,a=arguments.length<3;return l(e,k(t,4),i,a,ha)}function ig(e,t){var i=Z(e)?xi:Ta;return i(e,go(k(t,3)))}function ng(e){var t=Z(e)?da:Kf;return t(e)}function rg(e,t,i){(i?ze(e,t,i):t===o)?t=1:t=Q(t);var l=Z(e)?If:Zf;return l(e,t)}function og(e){var t=Z(e)?Ef:Jf;return t(e)}function lg(e){if(e==null)return 0;if(Qe(e))return _o(e)?pn(e):e.length;var t=We(e);return t==Lt||t==Nt?e.size:wl(e).length}function sg(e,t,i){var l=Z(e)?pl:Xf;return i&&ze(e,t,i)&&(t=o),l(e,k(t,3))}var ag=X(function(e,t){if(e==null)return[];var i=t.length;return i>1&&ze(e,t[0],t[1])?t=[]:i>2&&ze(t[0],t[1],t[2])&&(t=[t[0]]),Ba(e,Fe(t,1),[])}),po=Hp||function(){return De.Date.now()};function cg(e,t){if(typeof t!="function")throw new ht(c);return e=Q(e),function(){if(--e<1)return t.apply(this,arguments)}}function yc(e,t,i){return t=i?o:t,t=e&&t==null?e.length:t,mi(e,gt,o,o,o,o,t)}function Sc(e,t){var i;if(typeof t!="function")throw new ht(c);return e=Q(e),function(){return--e>0&&(i=t.apply(this,arguments)),e<=1&&(t=o),i}}var es=X(function(e,t,i){var l=ke;if(i.length){var a=yi(i,Tn(es));l|=st}return mi(e,l,t,i,a)}),Mc=X(function(e,t,i){var l=ke|Ht;if(i.length){var a=yi(i,Tn(Mc));l|=st}return mi(t,l,e,i,a)});function Ic(e,t,i){t=i?o:t;var l=mi(e,lt,o,o,o,o,o,t);return l.placeholder=Ic.placeholder,l}function Ec(e,t,i){t=i?o:t;var l=mi(e,ri,o,o,o,o,o,t);return l.placeholder=Ec.placeholder,l}function Ac(e,t,i){var l,a,u,f,d,_,E=0,A=!1,B=!1,N=!0;if(typeof e!="function")throw new ht(c);t=yt(t)||0,ve(i)&&(A=!!i.leading,B="maxWait"in i,u=B?we(yt(i.maxWait)||0,t):u,N="trailing"in i?!!i.trailing:N);function P(Ee){var Pt=l,gi=a;return l=a=o,E=Ee,f=e.apply(gi,Pt),f}function z(Ee){return E=Ee,d=pr(ee,t),A?P(Ee):f}function J(Ee){var Pt=Ee-_,gi=Ee-E,zc=t-Pt;return B?He(zc,u-gi):zc}function Y(Ee){var Pt=Ee-_,gi=Ee-E;return _===o||Pt>=t||Pt<0||B&&gi>=u}function ee(){var Ee=po();if(Y(Ee))return re(Ee);d=pr(ee,J(Ee))}function re(Ee){return d=o,N&&l?P(Ee):(l=a=o,f)}function pt(){d!==o&&qa(d),E=0,l=_=a=d=o}function Ye(){return d===o?f:re(po())}function ft(){var Ee=po(),Pt=Y(Ee);if(l=arguments,a=this,_=Ee,Pt){if(d===o)return z(_);if(B)return qa(d),d=pr(ee,t),P(_)}return d===o&&(d=pr(ee,t)),f}return ft.cancel=pt,ft.flush=Ye,ft}var mg=X(function(e,t){return _a(e,1,t)}),ug=X(function(e,t,i){return _a(e,yt(t)||0,i)});function pg(e){return mi(e,ko)}function fo(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new ht(c);var i=function(){var l=arguments,a=t?t.apply(this,l):l[0],u=i.cache;if(u.has(a))return u.get(a);var f=e.apply(this,l);return i.cache=u.set(a,f)||u,f};return i.cache=new(fo.Cache||ai),i}fo.Cache=ai;function go(e){if(typeof e!="function")throw new ht(c);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function fg(e){return Sc(2,e)}var dg=e0(function(e,t){t=t.length==1&&Z(t[0])?Te(t[0],ct(k())):Te(Fe(t,1),ct(k()));var i=t.length;return X(function(l){for(var a=-1,u=He(l.length,i);++a<u;)l[a]=t[a].call(this,l[a]);return at(e,this,l)})}),ts=X(function(e,t){var i=yi(t,Tn(ts));return mi(e,st,o,t,i)}),Bc=X(function(e,t){var i=yi(t,Tn(Bc));return mi(e,oi,o,t,i)}),gg=ui(function(e,t){return mi(e,kn,o,o,o,t)});function bg(e,t){if(typeof e!="function")throw new ht(c);return t=t===o?t:Q(t),X(e,t)}function _g(e,t){if(typeof e!="function")throw new ht(c);return t=t==null?0:we(Q(t),0),X(function(i){var l=i[t],a=Bi(i,0,t);return l&&Ci(a,l),at(e,this,a)})}function hg(e,t,i){var l=!0,a=!0;if(typeof e!="function")throw new ht(c);return ve(i)&&(l="leading"in i?!!i.leading:l,a="trailing"in i?!!i.trailing:a),Ac(e,t,{leading:l,maxWait:t,trailing:a})}function Tg(e){return yc(e,1)}function vg(e,t){return ts(Pl(t),e)}function xg(){if(!arguments.length)return[];var e=arguments[0];return Z(e)?e:[e]}function Cg(e){return vt(e,ce)}function yg(e,t){return t=typeof t=="function"?t:o,vt(e,ce,t)}function Sg(e){return vt(e,U|ce)}function Mg(e,t){return t=typeof t=="function"?t:o,vt(e,U|ce,t)}function Ig(e,t){return t==null||ba(e,t,Oe(t))}function qt(e,t){return e===t||e!==e&&t!==t}var Eg=lo(El),Ag=lo(function(e,t){return e>=t}),en=Ca(function(){return arguments}())?Ca:function(e){return xe(e)&&ue.call(e,"callee")&&!aa.call(e,"callee")},Z=S.isArray,Bg=Vs?ct(Vs):Uf;function Qe(e){return e!=null&&bo(e.length)&&!fi(e)}function Ie(e){return xe(e)&&Qe(e)}function wg(e){return e===!0||e===!1||xe(e)&&je(e)==jn}var wi=Vp||ps,Rg=Gs?ct(Gs):qf;function Dg(e){return xe(e)&&e.nodeType===1&&!fr(e)}function Og(e){if(e==null)return!0;if(Qe(e)&&(Z(e)||typeof e=="string"||typeof e.splice=="function"||wi(e)||vn(e)||en(e)))return!e.length;var t=We(e);if(t==Lt||t==Nt)return!e.size;if(ur(e))return!wl(e).length;for(var i in e)if(ue.call(e,i))return!1;return!0}function Lg(e,t){return ar(e,t)}function Ng(e,t,i){i=typeof i=="function"?i:o;var l=i?i(e,t):o;return l===o?ar(e,t,o,i):!!l}function is(e){if(!xe(e))return!1;var t=je(e);return t==Er||t==nu||typeof e.message=="string"&&typeof e.name=="string"&&!fr(e)}function Fg(e){return typeof e=="number"&&ma(e)}function fi(e){if(!ve(e))return!1;var t=je(e);return t==Ar||t==_s||t==iu||t==ou}function wc(e){return typeof e=="number"&&e==Q(e)}function bo(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=vi}function ve(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function xe(e){return e!=null&&typeof e=="object"}var Rc=ks?ct(ks):$f;function Ug(e,t){return e===t||Bl(e,t,jl(t))}function qg(e,t,i){return i=typeof i=="function"?i:o,Bl(e,t,jl(t),i)}function Pg(e){return Dc(e)&&e!=+e}function $g(e){if(y0(e))throw new K(s);return ya(e)}function Hg(e){return e===null}function Wg(e){return e==null}function Dc(e){return typeof e=="number"||xe(e)&&je(e)==Yn}function fr(e){if(!xe(e)||je(e)!=li)return!1;var t=Wr(e);if(t===null)return!0;var i=ue.call(t,"constructor")&&t.constructor;return typeof i=="function"&&i instanceof i&&qr.call(i)==Up}var ns=js?ct(js):Hf;function Vg(e){return wc(e)&&e>=-vi&&e<=vi}var Oc=zs?ct(zs):Wf;function _o(e){return typeof e=="string"||!Z(e)&&xe(e)&&je(e)==Zn}function ut(e){return typeof e=="symbol"||xe(e)&&je(e)==Br}var vn=Ys?ct(Ys):Vf;function Gg(e){return e===o}function kg(e){return xe(e)&&We(e)==Qn}function jg(e){return xe(e)&&je(e)==su}var zg=lo(Rl),Yg=lo(function(e,t){return e<=t});function Lc(e){if(!e)return[];if(Qe(e))return _o(e)?Ft(e):Ze(e);if(er&&e[er])return Mp(e[er]());var t=We(e),i=t==Lt?hl:t==Nt?Nr:xn;return i(e)}function di(e){if(!e)return e===0?e:0;if(e=yt(e),e===ki||e===-ki){var t=e<0?-1:1;return t*Jm}return e===e?e:0}function Q(e){var t=di(e),i=t%1;return t===t?i?t-i:t:0}function Nc(e){return e?Zi(Q(e),0,Wt):0}function yt(e){if(typeof e=="number")return e;if(ut(e))return Mr;if(ve(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ve(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=ea(e);var i=Au.test(e);return i||wu.test(e)?ap(e.slice(2),i?2:8):Eu.test(e)?Mr:+e}function Fc(e){return Gt(e,Je(e))}function Kg(e){return e?Zi(Q(e),-vi,vi):e===0?e:0}function me(e){return e==null?"":mt(e)}var Zg=_n(function(e,t){if(ur(t)||Qe(t)){Gt(t,Oe(t),e);return}for(var i in t)ue.call(t,i)&&or(e,i,t[i])}),Uc=_n(function(e,t){Gt(t,Je(t),e)}),ho=_n(function(e,t,i,l){Gt(t,Je(t),e,l)}),Qg=_n(function(e,t,i,l){Gt(t,Oe(t),e,l)}),Jg=ui(Sl);function Xg(e,t){var i=bn(e);return t==null?i:ga(i,t)}var eb=X(function(e,t){e=fe(e);var i=-1,l=t.length,a=l>2?t[2]:o;for(a&&ze(t[0],t[1],a)&&(l=1);++i<l;)for(var u=t[i],f=Je(u),d=-1,_=f.length;++d<_;){var E=f[d],A=e[E];(A===o||qt(A,fn[E])&&!ue.call(e,E))&&(e[E]=u[E])}return e}),tb=X(function(e){return e.push(o,ec),at(qc,o,e)});function ib(e,t){return Zs(e,k(t,3),Vt)}function nb(e,t){return Zs(e,k(t,3),Il)}function rb(e,t){return e==null?e:Ml(e,k(t,3),Je)}function ob(e,t){return e==null?e:va(e,k(t,3),Je)}function lb(e,t){return e&&Vt(e,k(t,3))}function sb(e,t){return e&&Il(e,k(t,3))}function ab(e){return e==null?[]:Jr(e,Oe(e))}function cb(e){return e==null?[]:Jr(e,Je(e))}function rs(e,t,i){var l=e==null?o:Qi(e,t);return l===o?i:l}function mb(e,t){return e!=null&&nc(e,t,Of)}function os(e,t){return e!=null&&nc(e,t,Lf)}var ub=Ka(function(e,t,i){t!=null&&typeof t.toString!="function"&&(t=Pr.call(t)),e[t]=i},ss(Xe)),pb=Ka(function(e,t,i){t!=null&&typeof t.toString!="function"&&(t=Pr.call(t)),ue.call(e,t)?e[t].push(i):e[t]=[i]},k),fb=X(sr);function Oe(e){return Qe(e)?fa(e):wl(e)}function Je(e){return Qe(e)?fa(e,!0):Gf(e)}function db(e,t){var i={};return t=k(t,3),Vt(e,function(l,a,u){ci(i,t(l,a,u),l)}),i}function gb(e,t){var i={};return t=k(t,3),Vt(e,function(l,a,u){ci(i,a,t(l,a,u))}),i}var bb=_n(function(e,t,i){Xr(e,t,i)}),qc=_n(function(e,t,i,l){Xr(e,t,i,l)}),_b=ui(function(e,t){var i={};if(e==null)return i;var l=!1;t=Te(t,function(u){return u=Ai(u,e),l||(l=u.length>1),u}),Gt(e,Gl(e),i),l&&(i=vt(i,U|de|ce,u0));for(var a=t.length;a--;)Fl(i,t[a]);return i});function hb(e,t){return Pc(e,go(k(t)))}var Tb=ui(function(e,t){return e==null?{}:jf(e,t)});function Pc(e,t){if(e==null)return{};var i=Te(Gl(e),function(l){return[l]});return t=k(t),wa(e,i,function(l,a){return t(l,a[0])})}function vb(e,t,i){t=Ai(t,e);var l=-1,a=t.length;for(a||(a=1,e=o);++l<a;){var u=e==null?o:e[kt(t[l])];u===o&&(l=a,u=i),e=fi(u)?u.call(e):u}return e}function xb(e,t,i){return e==null?e:cr(e,t,i)}function Cb(e,t,i,l){return l=typeof l=="function"?l:o,e==null?e:cr(e,t,i,l)}var $c=Ja(Oe),Hc=Ja(Je);function yb(e,t,i){var l=Z(e),a=l||wi(e)||vn(e);if(t=k(t,4),i==null){var u=e&&e.constructor;a?i=l?new u:[]:ve(e)?i=fi(u)?bn(Wr(e)):{}:i={}}return(a?_t:Vt)(e,function(f,d,_){return t(i,f,d,_)}),i}function Sb(e,t){return e==null?!0:Fl(e,t)}function Mb(e,t,i){return e==null?e:Na(e,t,Pl(i))}function Ib(e,t,i,l){return l=typeof l=="function"?l:o,e==null?e:Na(e,t,Pl(i),l)}function xn(e){return e==null?[]:_l(e,Oe(e))}function Eb(e){return e==null?[]:_l(e,Je(e))}function Ab(e,t,i){return i===o&&(i=t,t=o),i!==o&&(i=yt(i),i=i===i?i:0),t!==o&&(t=yt(t),t=t===t?t:0),Zi(yt(e),t,i)}function Bb(e,t,i){return t=di(t),i===o?(i=t,t=0):i=di(i),e=yt(e),Nf(e,t,i)}function wb(e,t,i){if(i&&typeof i!="boolean"&&ze(e,t,i)&&(t=i=o),i===o&&(typeof t=="boolean"?(i=t,t=o):typeof e=="boolean"&&(i=e,e=o)),e===o&&t===o?(e=0,t=1):(e=di(e),t===o?(t=e,e=0):t=di(t)),e>t){var l=e;e=t,t=l}if(i||e%1||t%1){var a=ua();return He(e+a*(t-e+sp("1e-"+((a+"").length-1))),t)}return Ol(e,t)}var Rb=hn(function(e,t,i){return t=t.toLowerCase(),e+(i?Wc(t):t)});function Wc(e){return ls(me(e).toLowerCase())}function Vc(e){return e=me(e),e&&e.replace(Du,vp).replace(Qu,"")}function Db(e,t,i){e=me(e),t=mt(t);var l=e.length;i=i===o?l:Zi(Q(i),0,l);var a=i;return i-=t.length,i>=0&&e.slice(i,a)==t}function Ob(e){return e=me(e),e&&pu.test(e)?e.replace(vs,xp):e}function Lb(e){return e=me(e),e&&hu.test(e)?e.replace(tl,"\\$&"):e}var Nb=hn(function(e,t,i){return e+(i?"-":"")+t.toLowerCase()}),Fb=hn(function(e,t,i){return e+(i?" ":"")+t.toLowerCase()}),Ub=ja("toLowerCase");function qb(e,t,i){e=me(e),t=Q(t);var l=t?pn(e):0;if(!t||l>=t)return e;var a=(t-l)/2;return oo(jr(a),i)+e+oo(kr(a),i)}function Pb(e,t,i){e=me(e),t=Q(t);var l=t?pn(e):0;return t&&l<t?e+oo(t-l,i):e}function $b(e,t,i){e=me(e),t=Q(t);var l=t?pn(e):0;return t&&l<t?oo(t-l,i)+e:e}function Hb(e,t,i){return i||t==null?t=0:t&&(t=+t),zp(me(e).replace(il,""),t||0)}function Wb(e,t,i){return(i?ze(e,t,i):t===o)?t=1:t=Q(t),Ll(me(e),t)}function Vb(){var e=arguments,t=me(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var Gb=hn(function(e,t,i){return e+(i?"_":"")+t.toLowerCase()});function kb(e,t,i){return i&&typeof i!="number"&&ze(e,t,i)&&(t=i=o),i=i===o?Wt:i>>>0,i?(e=me(e),e&&(typeof t=="string"||t!=null&&!ns(t))&&(t=mt(t),!t&&un(e))?Bi(Ft(e),0,i):e.split(t,i)):[]}var jb=hn(function(e,t,i){return e+(i?" ":"")+ls(t)});function zb(e,t,i){return e=me(e),i=i==null?0:Zi(Q(i),0,e.length),t=mt(t),e.slice(i,i+t.length)==t}function Yb(e,t,i){var l=m.templateSettings;i&&ze(e,t,i)&&(t=o),e=me(e),t=ho({},t,l,Xa);var a=ho({},t.imports,l.imports,Xa),u=Oe(a),f=_l(a,u),d,_,E=0,A=t.interpolate||wr,B="__p += '",N=Tl((t.escape||wr).source+"|"+A.source+"|"+(A===xs?Iu:wr).source+"|"+(t.evaluate||wr).source+"|$","g"),P="//# sourceURL="+(ue.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ip+"]")+`
`;e.replace(N,function(Y,ee,re,pt,Ye,ft){return re||(re=pt),B+=e.slice(E,ft).replace(Ou,Cp),ee&&(d=!0,B+=`' +
__e(`+ee+`) +
'`),Ye&&(_=!0,B+=`';
`+Ye+`;
__p += '`),re&&(B+=`' +
((__t = (`+re+`)) == null ? '' : __t) +
'`),E=ft+Y.length,Y}),B+=`';
`;var z=ue.call(t,"variable")&&t.variable;if(!z)B=`with (obj) {
`+B+`
}
`;else if(Su.test(z))throw new K(p);B=(_?B.replace(au,""):B).replace(cu,"$1").replace(mu,"$1;"),B="function("+(z||"obj")+`) {
`+(z?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(d?", __e = _.escape":"")+(_?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+B+`return __p
}`;var J=kc(function(){return ae(u,P+"return "+B).apply(o,f)});if(J.source=B,is(J))throw J;return J}function Kb(e){return me(e).toLowerCase()}function Zb(e){return me(e).toUpperCase()}function Qb(e,t,i){if(e=me(e),e&&(i||t===o))return ea(e);if(!e||!(t=mt(t)))return e;var l=Ft(e),a=Ft(t),u=ta(l,a),f=ia(l,a)+1;return Bi(l,u,f).join("")}function Jb(e,t,i){if(e=me(e),e&&(i||t===o))return e.slice(0,ra(e)+1);if(!e||!(t=mt(t)))return e;var l=Ft(e),a=ia(l,Ft(t))+1;return Bi(l,0,a).join("")}function Xb(e,t,i){if(e=me(e),e&&(i||t===o))return e.replace(il,"");if(!e||!(t=mt(t)))return e;var l=Ft(e),a=ta(l,Ft(t));return Bi(l,a).join("")}function e_(e,t){var i=jm,l=zm;if(ve(t)){var a="separator"in t?t.separator:a;i="length"in t?Q(t.length):i,l="omission"in t?mt(t.omission):l}e=me(e);var u=e.length;if(un(e)){var f=Ft(e);u=f.length}if(i>=u)return e;var d=i-pn(l);if(d<1)return l;var _=f?Bi(f,0,d).join(""):e.slice(0,d);if(a===o)return _+l;if(f&&(d+=_.length-d),ns(a)){if(e.slice(d).search(a)){var E,A=_;for(a.global||(a=Tl(a.source,me(Cs.exec(a))+"g")),a.lastIndex=0;E=a.exec(A);)var B=E.index;_=_.slice(0,B===o?d:B)}}else if(e.indexOf(mt(a),d)!=d){var N=_.lastIndexOf(a);N>-1&&(_=_.slice(0,N))}return _+l}function t_(e){return e=me(e),e&&uu.test(e)?e.replace(Ts,Bp):e}var i_=hn(function(e,t,i){return e+(i?" ":"")+t.toUpperCase()}),ls=ja("toUpperCase");function Gc(e,t,i){return e=me(e),t=i?o:t,t===o?Sp(e)?Dp(e):gp(e):e.match(t)||[]}var kc=X(function(e,t){try{return at(e,o,t)}catch(i){return is(i)?i:new K(i)}}),n_=ui(function(e,t){return _t(t,function(i){i=kt(i),ci(e,i,es(e[i],e))}),e});function r_(e){var t=e==null?0:e.length,i=k();return e=t?Te(e,function(l){if(typeof l[1]!="function")throw new ht(c);return[i(l[0]),l[1]]}):[],X(function(l){for(var a=-1;++a<t;){var u=e[a];if(at(u[0],this,l))return at(u[1],this,l)}})}function o_(e){return wf(vt(e,U))}function ss(e){return function(){return e}}function l_(e,t){return e==null||e!==e?t:e}var s_=Ya(),a_=Ya(!0);function Xe(e){return e}function as(e){return Sa(typeof e=="function"?e:vt(e,U))}function c_(e){return Ia(vt(e,U))}function m_(e,t){return Ea(e,vt(t,U))}var u_=X(function(e,t){return function(i){return sr(i,e,t)}}),p_=X(function(e,t){return function(i){return sr(e,i,t)}});function cs(e,t,i){var l=Oe(t),a=Jr(t,l);i==null&&!(ve(t)&&(a.length||!l.length))&&(i=t,t=e,e=this,a=Jr(t,Oe(t)));var u=!(ve(i)&&"chain"in i)||!!i.chain,f=fi(e);return _t(a,function(d){var _=t[d];e[d]=_,f&&(e.prototype[d]=function(){var E=this.__chain__;if(u||E){var A=e(this.__wrapped__),B=A.__actions__=Ze(this.__actions__);return B.push({func:_,args:arguments,thisArg:e}),A.__chain__=E,A}return _.apply(e,Ci([this.value()],arguments))})}),e}function f_(){return De._===this&&(De._=qp),this}function ms(){}function d_(e){return e=Q(e),X(function(t){return Aa(t,e)})}var g_=Hl(Te),b_=Hl(Ks),__=Hl(pl);function jc(e){return Yl(e)?fl(kt(e)):zf(e)}function h_(e){return function(t){return e==null?o:Qi(e,t)}}var T_=Za(),v_=Za(!0);function us(){return[]}function ps(){return!1}function x_(){return{}}function C_(){return""}function y_(){return!0}function S_(e,t){if(e=Q(e),e<1||e>vi)return[];var i=Wt,l=He(e,Wt);t=k(t),e-=Wt;for(var a=bl(l,t);++i<e;)t(i);return a}function M_(e){return Z(e)?Te(e,kt):ut(e)?[e]:Ze(pc(me(e)))}function I_(e){var t=++Fp;return me(e)+t}var E_=ro(function(e,t){return e+t},0),A_=Wl("ceil"),B_=ro(function(e,t){return e/t},1),w_=Wl("floor");function R_(e){return e&&e.length?Qr(e,Xe,El):o}function D_(e,t){return e&&e.length?Qr(e,k(t,2),El):o}function O_(e){return Js(e,Xe)}function L_(e,t){return Js(e,k(t,2))}function N_(e){return e&&e.length?Qr(e,Xe,Rl):o}function F_(e,t){return e&&e.length?Qr(e,k(t,2),Rl):o}var U_=ro(function(e,t){return e*t},1),q_=Wl("round"),P_=ro(function(e,t){return e-t},0);function $_(e){return e&&e.length?gl(e,Xe):0}function H_(e,t){return e&&e.length?gl(e,k(t,2)):0}return m.after=cg,m.ary=yc,m.assign=Zg,m.assignIn=Uc,m.assignInWith=ho,m.assignWith=Qg,m.at=Jg,m.before=Sc,m.bind=es,m.bindAll=n_,m.bindKey=Mc,m.castArray=xg,m.chain=vc,m.chunk=w0,m.compact=R0,m.concat=D0,m.cond=r_,m.conforms=o_,m.constant=ss,m.countBy=$d,m.create=Xg,m.curry=Ic,m.curryRight=Ec,m.debounce=Ac,m.defaults=eb,m.defaultsDeep=tb,m.defer=mg,m.delay=ug,m.difference=O0,m.differenceBy=L0,m.differenceWith=N0,m.drop=F0,m.dropRight=U0,m.dropRightWhile=q0,m.dropWhile=P0,m.fill=$0,m.filter=Wd,m.flatMap=kd,m.flatMapDeep=jd,m.flatMapDepth=zd,m.flatten=bc,m.flattenDeep=H0,m.flattenDepth=W0,m.flip=pg,m.flow=s_,m.flowRight=a_,m.fromPairs=V0,m.functions=ab,m.functionsIn=cb,m.groupBy=Yd,m.initial=k0,m.intersection=j0,m.intersectionBy=z0,m.intersectionWith=Y0,m.invert=ub,m.invertBy=pb,m.invokeMap=Zd,m.iteratee=as,m.keyBy=Qd,m.keys=Oe,m.keysIn=Je,m.map=uo,m.mapKeys=db,m.mapValues=gb,m.matches=c_,m.matchesProperty=m_,m.memoize=fo,m.merge=bb,m.mergeWith=qc,m.method=u_,m.methodOf=p_,m.mixin=cs,m.negate=go,m.nthArg=d_,m.omit=_b,m.omitBy=hb,m.once=fg,m.orderBy=Jd,m.over=g_,m.overArgs=dg,m.overEvery=b_,m.overSome=__,m.partial=ts,m.partialRight=Bc,m.partition=Xd,m.pick=Tb,m.pickBy=Pc,m.property=jc,m.propertyOf=h_,m.pull=J0,m.pullAll=hc,m.pullAllBy=X0,m.pullAllWith=ed,m.pullAt=td,m.range=T_,m.rangeRight=v_,m.rearg=gg,m.reject=ig,m.remove=id,m.rest=bg,m.reverse=Jl,m.sampleSize=rg,m.set=xb,m.setWith=Cb,m.shuffle=og,m.slice=nd,m.sortBy=ag,m.sortedUniq=md,m.sortedUniqBy=ud,m.split=kb,m.spread=_g,m.tail=pd,m.take=fd,m.takeRight=dd,m.takeRightWhile=gd,m.takeWhile=bd,m.tap=Rd,m.throttle=hg,m.thru=mo,m.toArray=Lc,m.toPairs=$c,m.toPairsIn=Hc,m.toPath=M_,m.toPlainObject=Fc,m.transform=yb,m.unary=Tg,m.union=_d,m.unionBy=hd,m.unionWith=Td,m.uniq=vd,m.uniqBy=xd,m.uniqWith=Cd,m.unset=Sb,m.unzip=Xl,m.unzipWith=Tc,m.update=Mb,m.updateWith=Ib,m.values=xn,m.valuesIn=Eb,m.without=yd,m.words=Gc,m.wrap=vg,m.xor=Sd,m.xorBy=Md,m.xorWith=Id,m.zip=Ed,m.zipObject=Ad,m.zipObjectDeep=Bd,m.zipWith=wd,m.entries=$c,m.entriesIn=Hc,m.extend=Uc,m.extendWith=ho,cs(m,m),m.add=E_,m.attempt=kc,m.camelCase=Rb,m.capitalize=Wc,m.ceil=A_,m.clamp=Ab,m.clone=Cg,m.cloneDeep=Sg,m.cloneDeepWith=Mg,m.cloneWith=yg,m.conformsTo=Ig,m.deburr=Vc,m.defaultTo=l_,m.divide=B_,m.endsWith=Db,m.eq=qt,m.escape=Ob,m.escapeRegExp=Lb,m.every=Hd,m.find=Vd,m.findIndex=dc,m.findKey=ib,m.findLast=Gd,m.findLastIndex=gc,m.findLastKey=nb,m.floor=w_,m.forEach=xc,m.forEachRight=Cc,m.forIn=rb,m.forInRight=ob,m.forOwn=lb,m.forOwnRight=sb,m.get=rs,m.gt=Eg,m.gte=Ag,m.has=mb,m.hasIn=os,m.head=_c,m.identity=Xe,m.includes=Kd,m.indexOf=G0,m.inRange=Bb,m.invoke=fb,m.isArguments=en,m.isArray=Z,m.isArrayBuffer=Bg,m.isArrayLike=Qe,m.isArrayLikeObject=Ie,m.isBoolean=wg,m.isBuffer=wi,m.isDate=Rg,m.isElement=Dg,m.isEmpty=Og,m.isEqual=Lg,m.isEqualWith=Ng,m.isError=is,m.isFinite=Fg,m.isFunction=fi,m.isInteger=wc,m.isLength=bo,m.isMap=Rc,m.isMatch=Ug,m.isMatchWith=qg,m.isNaN=Pg,m.isNative=$g,m.isNil=Wg,m.isNull=Hg,m.isNumber=Dc,m.isObject=ve,m.isObjectLike=xe,m.isPlainObject=fr,m.isRegExp=ns,m.isSafeInteger=Vg,m.isSet=Oc,m.isString=_o,m.isSymbol=ut,m.isTypedArray=vn,m.isUndefined=Gg,m.isWeakMap=kg,m.isWeakSet=jg,m.join=K0,m.kebabCase=Nb,m.last=Ct,m.lastIndexOf=Z0,m.lowerCase=Fb,m.lowerFirst=Ub,m.lt=zg,m.lte=Yg,m.max=R_,m.maxBy=D_,m.mean=O_,m.meanBy=L_,m.min=N_,m.minBy=F_,m.stubArray=us,m.stubFalse=ps,m.stubObject=x_,m.stubString=C_,m.stubTrue=y_,m.multiply=U_,m.nth=Q0,m.noConflict=f_,m.noop=ms,m.now=po,m.pad=qb,m.padEnd=Pb,m.padStart=$b,m.parseInt=Hb,m.random=wb,m.reduce=eg,m.reduceRight=tg,m.repeat=Wb,m.replace=Vb,m.result=vb,m.round=q_,m.runInContext=g,m.sample=ng,m.size=lg,m.snakeCase=Gb,m.some=sg,m.sortedIndex=rd,m.sortedIndexBy=od,m.sortedIndexOf=ld,m.sortedLastIndex=sd,m.sortedLastIndexBy=ad,m.sortedLastIndexOf=cd,m.startCase=jb,m.startsWith=zb,m.subtract=P_,m.sum=$_,m.sumBy=H_,m.template=Yb,m.times=S_,m.toFinite=di,m.toInteger=Q,m.toLength=Nc,m.toLower=Kb,m.toNumber=yt,m.toSafeInteger=Kg,m.toString=me,m.toUpper=Zb,m.trim=Qb,m.trimEnd=Jb,m.trimStart=Xb,m.truncate=e_,m.unescape=t_,m.uniqueId=I_,m.upperCase=i_,m.upperFirst=ls,m.each=xc,m.eachRight=Cc,m.first=_c,cs(m,function(){var e={};return Vt(m,function(t,i){ue.call(m.prototype,i)||(e[i]=t)}),e}(),{chain:!1}),m.VERSION=r,_t(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){m[e].placeholder=m}),_t(["drop","take"],function(e,t){te.prototype[e]=function(i){i=i===o?1:we(Q(i),0);var l=this.__filtered__&&!t?new te(this):this.clone();return l.__filtered__?l.__takeCount__=He(i,l.__takeCount__):l.__views__.push({size:He(i,Wt),type:e+(l.__dir__<0?"Right":"")}),l},te.prototype[e+"Right"]=function(i){return this.reverse()[e](i).reverse()}}),_t(["filter","map","takeWhile"],function(e,t){var i=t+1,l=i==bs||i==Qm;te.prototype[e]=function(a){var u=this.clone();return u.__iteratees__.push({iteratee:k(a,3),type:i}),u.__filtered__=u.__filtered__||l,u}}),_t(["head","last"],function(e,t){var i="take"+(t?"Right":"");te.prototype[e]=function(){return this[i](1).value()[0]}}),_t(["initial","tail"],function(e,t){var i="drop"+(t?"":"Right");te.prototype[e]=function(){return this.__filtered__?new te(this):this[i](1)}}),te.prototype.compact=function(){return this.filter(Xe)},te.prototype.find=function(e){return this.filter(e).head()},te.prototype.findLast=function(e){return this.reverse().find(e)},te.prototype.invokeMap=X(function(e,t){return typeof e=="function"?new te(this):this.map(function(i){return sr(i,e,t)})}),te.prototype.reject=function(e){return this.filter(go(k(e)))},te.prototype.slice=function(e,t){e=Q(e);var i=this;return i.__filtered__&&(e>0||t<0)?new te(i):(e<0?i=i.takeRight(-e):e&&(i=i.drop(e)),t!==o&&(t=Q(t),i=t<0?i.dropRight(-t):i.take(t-e)),i)},te.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},te.prototype.toArray=function(){return this.take(Wt)},Vt(te.prototype,function(e,t){var i=/^(?:filter|find|map|reject)|While$/.test(t),l=/^(?:head|last)$/.test(t),a=m[l?"take"+(t=="last"?"Right":""):t],u=l||/^find/.test(t);a&&(m.prototype[t]=function(){var f=this.__wrapped__,d=l?[1]:arguments,_=f instanceof te,E=d[0],A=_||Z(f),B=function(ee){var re=a.apply(m,Ci([ee],d));return l&&N?re[0]:re};A&&i&&typeof E=="function"&&E.length!=1&&(_=A=!1);var N=this.__chain__,P=!!this.__actions__.length,z=u&&!N,J=_&&!P;if(!u&&A){f=J?f:new te(this);var Y=e.apply(f,d);return Y.__actions__.push({func:mo,args:[B],thisArg:o}),new Tt(Y,N)}return z&&J?e.apply(this,d):(Y=this.thru(B),z?l?Y.value()[0]:Y.value():Y)})}),_t(["pop","push","shift","sort","splice","unshift"],function(e){var t=Fr[e],i=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",l=/^(?:pop|shift)$/.test(e);m.prototype[e]=function(){var a=arguments;if(l&&!this.__chain__){var u=this.value();return t.apply(Z(u)?u:[],a)}return this[i](function(f){return t.apply(Z(f)?f:[],a)})}}),Vt(te.prototype,function(e,t){var i=m[t];if(i){var l=i.name+"";ue.call(gn,l)||(gn[l]=[]),gn[l].push({name:t,func:i})}}),gn[no(o,Ht).name]=[{name:"wrapper",func:o}],te.prototype.clone=ef,te.prototype.reverse=tf,te.prototype.value=nf,m.prototype.at=Dd,m.prototype.chain=Od,m.prototype.commit=Ld,m.prototype.next=Nd,m.prototype.plant=Ud,m.prototype.reverse=qd,m.prototype.toJSON=m.prototype.valueOf=m.prototype.value=Pd,m.prototype.first=m.prototype.head,er&&(m.prototype[er]=Fd),m},Si=Op();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(De._=Si,define(function(){return Si})):ji?((ji.exports=Si)._=Si,al._=Si):De._=Si}).call(Vn)});var Ke=class extends Li{idUser;idTimbre;acquis;doublon;constructor(r,n,s,c){super(),this.idUser=r||null,this.idTimbre=n||null,this.acquis=s||!1,this.doublon=c||!1}getIdUser(){return this.idUser}setIdUser(r){this.idUser=r}getIdTimbre(){return this.idTimbre}setIdTimbre(r){this.idTimbre=r}isAcquis(){return this.acquis}setAcquis(r){this.acquis=r}isDoublon(){return this.doublon}setDoublon(r){this.doublon=r}};oe([le("Identifiant Utilisateur")],Ke.prototype,"idUser",2),oe([le("Identifiant timbre")],Ke.prototype,"idTimbre",2),oe([le("Acquis")],Ke.prototype,"acquis",2),oe([le("Doublon")],Ke.prototype,"doublon",2);var hr=class{key;dossier;maxWidth;maxHeight;getKey(){return this.key}setKey(r){this.key=r}getDossier(){return this.dossier}setDossier(r){this.dossier=r}getMaxWidth(){return this.maxWidth}setMaxWidth(r){this.maxWidth=r}getMaxHeight(){return this.maxHeight}setMaxHeight(r){this.maxHeight=r}};var Wi=class{dossier;nom;alignLabel;detail;file;getDossier(){return this.dossier}setDossier(r){this.dossier=r}getNom(){return this.nom}setNom(r){this.nom=r}getAlignLabel(){return this.alignLabel}setAlignLabel(r){this.alignLabel=r}getDetail(){return this.detail}setDetail(r){this.detail=r}getFile(){return this.file}setFile(r){this.file=r}};var dt=class extends Li{idUser;idBloc;acquis;doublon;constructor(r,n,s,c){super(),this.idUser=r||null,this.idBloc=n||null,this.acquis=s||!1,this.doublon=c||!1}getIdUser(){return this.idUser}setIdUser(r){this.idUser=r}getIdBloc(){return this.idBloc}setIdBloc(r){this.idBloc=r}isAcquis(){return this.acquis}setAcquis(r){this.acquis=r}isDoublon(){return this.doublon}setDoublon(r){this.doublon=r}};oe([le("Identifiant Utilisateur")],dt.prototype,"idUser",2),oe([le("Identifiant bloc")],dt.prototype,"idBloc",2),oe([le("Acquis")],dt.prototype,"acquis",2),oe([le("Doublon")],dt.prototype,"doublon",2);var Me=class o{constructor(r,n,s){this.authService=r;this.firestore=n;this.dialog=s}reinitResume$=new _e(!0);initUpload(){let r=new Wi;r.setDossier("table"),r.setNom(new Date().getTime()?.toString());let n=new hr;n.setMaxWidth(100),n.setMaxHeight(100),n.setDossier("autre");let s=new hr;return s.setMaxWidth(700),s.setMaxHeight(700),s.setDossier("zoom"),r.setDetail([n,s]),r}getAnneesAsync(r){return this.firestore.collection(r,n=>{let s=n;return s=s.orderBy("annee","desc"),s}).valueChanges().pipe(jt(n=>{let s=n.map(c=>Number(c.annee)).filter(c=>I(c)&&c!=0);return Array.from(new Set(s))}))}getAllTimbres(r){return this.firestore.collection("/timbres",n=>{let s=n;return I(r)&&(I(r.getAnnees())&&r.getAnnees()?.length>0&&(s=s.where("annee","in",r.getAnnees())),r?.getType()?.length==0||r?.getType()?.length==1&&r?.getType()?.find(c=>c=="TIMBRE")?s=s.where("idBloc","==",null):r?.getType()?.length>0&&!r?.getType()?.find(c=>c=="TIMBRE")?s=s.where("idBloc","!=",null):I(r.getIdBloc())&&(s=s.where("idBloc","==",r.getIdBloc()))),s}).valueChanges()}constructTimbres(r,n,s,c){let p=[];return r?.length>0&&r.forEach(b=>{let y=this.constructTimbre(b,n,s),L=!1;I(c)?((c?.getType()?.find(U=>U=="TIMBRE")&&Le(y?.getTimbreBlocModel())||c?.getType()?.find(U=>U=="BLOC")&&I(y?.getTimbreBlocModel())&&y?.getTimbreBlocModel()?.getType()=="BLOC"||c?.getType()?.find(U=>U=="CARNET")&&I(y?.getTimbreBlocModel())&&y?.getTimbreBlocModel()?.getType()=="CARNET")&&(L=!0),I(y.getTimbreAcquisModel())&&(I(c.getAcquis())&&!(c.getAcquis()=="TOUS"||c.getAcquis()=="OUI"&&y.getTimbreAcquisModel().isAcquis()||c.getAcquis()=="NON"&&!y.getTimbreAcquisModel().isAcquis())&&(L=!1),I(c.getDoublon())&&!(c.getDoublon()=="TOUS"||c.getDoublon()=="OUI"&&y.getTimbreAcquisModel().isDoublon()||c.getDoublon()=="NON"&&!y.getTimbreAcquisModel().isDoublon())&&(L=!1))):L=!0,L==!0&&p.push(y)}),p}constructTimbre(r,n,s){let c=Ni(Ot,r);if(I(s)){let p=s.find(b=>b.getId()==c?.getIdBloc());I(p)&&c.setTimbreBlocModel(p)}if(I(n)){let p=n.find(b=>b.idTimbre==c.getId());I(p)?c.setTimbreAcquisModel(Ni(Ke,p)):c.setTimbreAcquisModel(new Ke)}return c}supprimerTimbreAcquis(r){this.firestore.collection("/timbres_acquis").ref.where("idTimbre","==",r.getId()).get().then(n=>{n.forEach(s=>{s.ref.delete()})})}supprimerTimbre(r){this.firestore.collection("/timbres").ref.where("id","==",r.getId()).get().then(n=>{n.forEach(s=>{s.ref.delete()})}).catch(n=>{console.error("Erreur de suppression :",n)})}acquis(r,n,s){this.authService.userSelect$.pipe(q(c=>I(c))).subscribe(c=>{this.firestore.collection("/timbres_acquis").ref.where("idTimbre","==",r.getId()).where("idUser","==",c.getId()).get().then(p=>{p?.size==0&&this.addAcquis(c.getId(),r,n),p.forEach(b=>{let y=Ni(Ke,b.data());n?(y.setAcquis(!0),y.setDoublon(s||!y.isDoublon())):(y.setAcquis(s||!y.isAcquis()),y.isAcquis()||y.setDoublon(!1),r.getTimbreBlocModel().setNbTimbresAcquis(r.getTimbreBlocModel().getNbTimbresAcquis()+(y.isAcquis()?1:-1)),this.verifBloc(r.getTimbreBlocModel())),b.ref.update(Object.assign(new Object,y)).then(L=>{r.setTimbreAcquisModel(y)}).catch(L=>{console.error("Erreur de mise \xE0 jour:",L)})})}).catch(p=>{console.error("Erreur de mise \xE0 jour id introuvable :",p)}),this.reinitResume$.next(!0)})}supprimerAcquisTimbreByUser(r,n,s,c){this.firestore.collection("/timbres_acquis").ref.where("idTimbre","==",n.getId()).where("idUser","==",r).get().then(p=>{p?.size==0&&c&&this.addAcquis(r,n,s),p.forEach(b=>{b.ref.delete().then(y=>{c&&this.supprimerTimbreAcquis(n)})})}).catch(p=>{console.error("Erreur de suppression :",p)})}addAcquis(r,n,s){let c=new Ke;c.setIdUser(r),c.setIdTimbre(n.getId()),c.setAcquis(!0),c.setDoublon(s),n.setTimbreAcquisModel(c),this.firestore.collection("/timbres_acquis").add(Object.assign(new Object,c))}verifBloc(r){r.getType()=="CARNET"&&(r.getNbTimbresAcquis()>0&&r.getNbTimbres()==r.getNbTimbresAcquis()&&!r.getTimbreBlocAcquisModel().isAcquis()?(r.getTimbreBlocAcquisModel().setAcquis(!0),this.acquisCarnetDialog(r)):r.getNbTimbres()>r.getNbTimbresAcquis()&&r.getTimbreBlocAcquisModel().isAcquis()&&(r.getTimbreBlocAcquisModel().setAcquis(!1),this.acquisCarnetDialog(r)))}acquisCarnetDialog(r){let s=this.dialog.open(Ti,{maxHeight:"95vh",data:{titre:"Confirmation",message:"Souhaitez-vous <b>"+"Incoh\xE9rence sur le carnet, souhaitez-vous r\xE9gulariser ?"+"</b> les timbres du "+r?.getType()?.toLowerCase()+" ?",btnDroite:"Oui",btnGauche:"Non"}});s.afterClosed().subscribe(()=>{s.componentInstance.data.resultat==="valider"&&this.acquisBloc(r,!1,!0)})}acquisBloc(r,n,s){return this.authService.userSelect$.pipe(q(c=>I(c))).subscribe(c=>{I(r?.getTimbreBlocAcquisModel()?.getIdUser())?this.firestore.collection("/timbres_bloc_acquis").ref.where("idBloc","==",r.getId()).where("idUser","==",c.getId()).get().then(p=>{p.forEach(b=>{let y=r.getTimbreBlocAcquisModel();n?(y.setAcquis(!0),y.setDoublon(!y.isDoublon())):(s||y.setAcquis(!y.isAcquis()),y.isAcquis()||y.setDoublon(!1)),b.ref.update(Object.assign(new Object,y)).then(L=>{r.setTimbreBlocAcquisModel(y)}).catch(L=>{console.error("Erreur de mise \xE0 jour:",L)})})}).catch(p=>{console.error("Erreur de mise \xE0 jour:",p)}):this.addAcquisBloc(c?.getId(),r,n),this.reinitResume$.next(!0)})}addAcquisBloc(r,n,s){let c=new dt;c.setIdUser(r),c.setIdBloc(n.getId()),c.setAcquis(!0),c.setDoublon(s),n.setTimbreBlocAcquisModel(c),this.firestore.collection("/timbres_bloc_acquis").add(Object.assign(new Object,c))}getTimbresByCritereAsync(r){return Re([this.getAllTimbres(r),this.getTimbreAcquis()]).pipe(q(),jt(([n,s])=>this.constructTimbres(n,s,null,null)))}getTimbreAcquis(){return this.authService.userSelect$.pipe(q(r=>I(r)),To(r=>I(r)?this.getTimbreAcquisByUser(r.getId()).pipe(q(),jt(n=>n)):null))}getTimbreAcquisByUser(r){return this.firestore.collection("/timbres_acquis",n=>n.where("idUser","==",r)).valueChanges()}isValidImage(r){return I(r)&&r!=="nok"}static \u0275fac=function(n){return new(n||o)(he(Ve),he(Sn),he(nt))};static \u0275prov=Oi({token:o,factory:o.\u0275fac})};var K_=["canvas"];function Z_(o,r){if(o&1&&(v(0,"span",6)(1,"b"),w(2),x()()),o&2){let n=C();h(2),H("N\xB0",n.timbreModel==null?null:n.timbreModel.getId(),"")}}function Q_(o,r){o&1&&G(0,"lib-spinner",7),o&2&&T("textSpec","Chargement en cours ...")}function J_(o,r){if(o&1&&(G(0,"mat-error",27),R(1,"async")),o&2){let n=C(2);T("innerHTML",D(1,1,n.messageError$),Cn)}}function X_(o,r){if(o&1&&(v(0,"mat-option",18),w(1),x()),o&2){let n=r.$implicit,s=C(2);T("value",n),h(),Xc(" ",n.getAnnee()," - ",n.getId()," ",(n==null?null:n.getType())==s.TypeTimbreEnum.CARNET?" (carnet)":""," ")}}function eh(o,r){if(o&1){let n=se();v(0,"img",28),j("click",function(){let c;W(n);let p=C(2);return V(p.utilsService.zoom(p.timbreModel==null||(c=p.timbreModel.getTimbreBlocModel())==null?null:c.getImageZoom()))}),x()}if(o&2){let n,s=C(2);T("src",s.timbreModel==null||(n=s.timbreModel.getTimbreBlocModel())==null?null:n.getImage(),yn)}}function th(o,r){if(o&1){let n=se();v(0,"form",8,1),j("ngSubmit",function(){W(n);let c=ye(1),p=C();return V(p.valider(c))}),v(2,"div",9),O(3,J_,2,3,"mat-error",10),R(4,"async"),v(5,"div",11)(6,"div",12)(7,"label"),G(8,"lib-libelle-model",13),x(),v(9,"input",14),Pe("ngModelChange",function(c){W(n);let p=C();return qe(p.timbreModel.annee,c)||(p.timbreModel.annee=c),V(c)}),j("ngModelChange",function(c){W(n);let p=C();return V(p.changeAnnee(c))}),x()(),v(10,"div",15)(11,"label"),G(12,"lib-libelle-model",13),x(),v(13,"div",16)(14,"mat-select",17),R(15,"async"),j("ngModelChange",function(c){W(n);let p=C();return V(p.changeBloc(c))}),G(16,"mat-option",18),O(17,X_,2,4,"mat-option",19),R(18,"async"),x(),O(19,eh,1,1,"img",20),x()()(),v(20,"div",11)(21,"div",12)(22,"label"),G(23,"lib-libelle-model",13),x(),v(24,"input",21),Pe("ngModelChange",function(c){W(n);let p=C();return qe(p.timbreModel.yt,c)||(p.timbreModel.yt=c),V(c)}),x()(),v(25,"div",12)(26,"label"),G(27,"lib-libelle-model",13),x(),v(28,"input",22),Pe("ngModelChange",function(c){W(n);let p=C();return qe(p.timbreModel.type,c)||(p.timbreModel.type=c),V(c)}),x()()(),v(29,"lib-upload",23),j("outPutObject",function(c){W(n);let p=C();return V(p.timbreModel=c)}),x()(),v(30,"div",24)(31,"button",25),j("click",function(){W(n);let c=C();return V(c.close())}),w(32," Annuler "),x(),v(33,"button",26),w(34," Enregistrer "),x()()()}if(o&2){let n,s,c=ye(1),p=C();T("ngClass",c!=null&&c.submitted?"red-color":"blue-color"),h(3),T("ngIf",D(4,27,p.messageError$)),h(5),T("object",p.timbreModel)("key","annee"),h(),Ue("ngModel",p.timbreModel.annee),T("max",p.maxAnnee)("zMax",p.maxAnnee)("disabled",!!(p.timbreModel!=null&&p.timbreModel.getId())),h(3),T("object",p.timbreModel)("key","timbreBlocModel"),h(2),T("ngModel",p.timbreModel.getTimbreBlocModel())("placeholder","Choix bloc")("disabled",!!(p.timbreModel!=null&&p.timbreModel.getId())||((n=D(15,29,p.timbreBlocService.timbresBlocModel$))==null?null:n.length)<=0),h(2),T("value",null),h(),T("ngForOf",D(18,31,p.timbreBlocService.timbresBlocModel$)),h(2),T("ngIf",p.timbreModel==null||(s=p.timbreModel.getTimbreBlocModel())==null?null:s.getImage()),h(4),T("object",p.timbreModel)("key","yt"),h(),Ue("ngModel",p.timbreModel.yt),h(3),T("object",p.timbreModel)("key","type"),h(),Ue("ngModel",p.timbreModel.type),h(),T("object",p.timbreModel)("key","image")("zoom",p.timbreModel.getImageZoom())("maxWidth",p.DimensionImageEnum.WIDTH_TIMBRE)("maxHeight",p.DimensionImageEnum.HEIGTH_TIMBRE)}}var qn=class o{constructor(r,n,s,c,p,b){this.httpResponseHandlerService=r;this.dialogRef=n;this.timbreService=s;this.timbreBlocService=c;this.timbreUtilsService=p;this.utilsService=b}canvas;messageError$=new _e(null);load$=new _e(null);id;maxAnnee=new Date().getFullYear();timbreModel=new Ot;fileUploadModel=new Wi;TypeTimbreEnum=$t;DimensionImageEnum=nn;ngOnInit(){this.fileUploadModel=this.timbreUtilsService.initUpload(),this.load$.next(!1),I(this.id)?this.timbreService.getTimbreByIdAsync(this.id).subscribe(r=>{this.timbreModel=r,I(r.getTimbreBlocModel())&&(this.timbreModel.setAnnee(r.getTimbreBlocModel().getAnnee()),this.timbreModel.setMonnaie(r.getTimbreBlocModel().getMonnaie())),this.load$.next(!0)}):(this.timbreModel.setAnnee(new Date().getFullYear()),this.timbreModel.setMonnaie("E"),this.load$.next(!0)),this.changeAnnee(this.timbreModel.getAnnee())}valider(r){if(this.messageError$.next(null),r?.valid)if(I(this.timbreModel.getImage()))this.saveData();else{this.messageError$.next("Veuillez s\xE9lectionner une image");return}}saveData(){this.load$.next(!1),I(this.timbreModel.getId())?this.save():this.ajouter()}ajouter(){this.utilsService.getMaxIdentAsync("/timbres").pipe(q()).subscribe(r=>{this.timbreModel.setId(r),this.save(!0)})}save(r){this.timbreModel.getAnnee()>=2002?this.timbreModel.setMonnaie("E"):this.timbreModel.getAnnee()>=1999?this.timbreModel.setMonnaie("FE"):this.timbreModel.setMonnaie("F"),Re([this.timbreService.upload(this.timbreModel,"autre"),this.timbreService.upload(this.timbreModel,"table"),this.timbreService.upload(this.timbreModel,"zoom")]).pipe(Ri(([n,s,c])=>I(n)&&I(s)&&I(c)),Di(1),gr(n=>(this.httpResponseHandlerService.showNotificationError("Transaction non aboutie",r?"Votre timbre n'a pas pu \xEAtre ajout\xE9.":"Votre timbre n'a pas pu \xEAtre modifi\xE9."),this.load$.next(!0),dr))).subscribe(([n,s,c])=>{this.timbreUtilsService.isValidImage(n)&&this.timbreModel.setImage(n),this.timbreUtilsService.isValidImage(s)&&this.timbreModel.setImageTable(s),this.timbreUtilsService.isValidImage(c)&&this.timbreModel.setImageZoom(c),r?this.timbreService.ajouter(this.timbreModel,!0):this.timbreService.modifier(this.timbreModel),this.httpResponseHandlerService.showNotificationSuccess("Transaction termin\xE9e",r?"Votre timbre a bien \xE9t\xE9 ajout\xE9.":"Votre timbre a bien \xE9t\xE9 modifi\xE9."),this.load$.next(!0),this.dialogRef.close()})}close(){this.dialogRef.close()}changeAnnee(r){if(this.timbreModel.setTimbreBlocModel(null),I(r)){let n=new _r;n.initCritereBloc(),n.setAnnees([r]),n.setSort("desc"),this.timbreBlocService.getBlocs(n,!1)}}changeBloc(r){I(r)?(this.timbreModel.setIdBloc(r.getId()),this.timbreModel.setTimbreBlocModel(r),this.timbreModel.setMonnaie(r.getMonnaie()),this.timbreModel.setAnnee(r.getAnnee())):(this.timbreModel.setIdBloc(null),this.timbreModel.setTimbreBlocModel(null),this.timbreModel.setMonnaie("E"))}static \u0275fac=function(n){return new(n||o)($(Io),$(Zt),$(Ne),$(Ge),$(Me),$(rt))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-modifier"]],viewQuery:function(n,s){if(n&1&&bi(K_,5),n&2){let c;_i(c=hi())&&(s.canvas=c.first)}},decls:9,vars:6,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],["class","accent",4,"ngIf"],[3,"ngIf","ngIfElse"],[1,"accent"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","space-between stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","column","fxLayoutGap","20px",1,"bloc-modal"],[3,"innerHTML",4,"ngIf"],["fxLayout","row","fxLayout.lt-lg","column","fxLayoutGap","30px","fxLayoutGap.lt-lg","5px"],["fxLayout","column",1,"form-input"],[3,"object","key"],["name","page","type","number","minlength","4","maxlength","4","min","1900","zMin","1900","required","","zControl","",1,"annee",2,"width","60px !important",3,"ngModelChange","ngModel","max","zMax","disabled"],["fxLayout","column",1,"form-input","select"],["fxLayout","row","fxLayoutGap","15px"],["name","bloc",2,"width","180px !important",3,"ngModelChange","ngModel","placeholder","disabled"],[1,"selectMin",3,"value"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],["style","max-height: 40px","class","click",3,"src","click",4,"ngIf"],["name","yt","type","text","trim","","zControl","",3,"ngModelChange","ngModel"],["name","type","type","text","trim","","zControl","",3,"ngModelChange","ngModel"],[3,"outPutObject","object","key","zoom","maxWidth","maxHeight"],["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"],[3,"innerHTML"],[1,"click",2,"max-height","40px",3,"click","src"]],template:function(n,s){if(n&1&&(v(0,"div",2)(1,"div",3)(2,"span"),w(3),x(),O(4,Z_,3,1,"span",4),x(),O(5,Q_,1,1,"ng-template",5),R(6,"async"),O(7,th,35,33,"ng-template",null,0,et),x()),n&2){let c=ye(8);h(3),H("",s.timbreModel!=null&&s.timbreModel.getId()?"MODIFICATION":"AJOUT"," "),h(),T("ngIf",s.timbreModel==null?null:s.timbreModel.getId()),h(),T("ngIf",D(6,4,s.load$)==!1)("ngIfElse",c)}},dependencies:[it,Dn,Rt,wt,St,tt,Se,zt,Fi,Kt,Yt,Ui,Et,$i,Mn,In,At,qi,Bn,wn,Rn,An,En,Bt,Pi,Dt,Ln,On,Eo,Nn,Fn,Ao,Ae],encapsulation:2})};var Ne=class o{constructor(r,n,s,c,p,b,y,L){this.firestore=r;this.authService=n;this.timbreBlocService=s;this.uploadService=c;this.utilsService=p;this.timbreUtilsService=b;this.dialog=y;this.preferenceService=L}total$=new _e(0);timbres$=new _e(null);load$=new _e(!1);getTimbre(r){return this.firestore.collection("/timbres",n=>n.where("id","==",r)).valueChanges()}getTimbreByIdAsync(r){return Re([this.getTimbre(r),this.timbreBlocService.getBlocsAsync()]).pipe(jt(([n,s])=>this.timbreUtilsService.constructTimbre(n[0],null,s)))}setTotal(r){this.total$.pipe(q()).subscribe(n=>{this.total$.next(n+r)})}getTotal(r){this.total$.next(null),this.timbreUtilsService.getAllTimbres(r).subscribe(n=>{this.total$.next(n?.length)})}getTimbres(r,n){n&&this.getTotal(),this.timbres$.next(null),this.load$.next(!1),Re([this.timbreUtilsService.getAllTimbres(r),this.timbreUtilsService.getTimbreAcquis(),this.timbreBlocService.getBlocsAsync(r)]).pipe(q()).subscribe(([s,c,p])=>{this.timbres$.next(this.triTimbres(this.timbreUtilsService.constructTimbres(s,c,p,r))),this.load$.next(!0)})}triTimbres(r){return r?.length>0&&r.sort((n,s)=>{let c=n?.getTimbreBlocModel()?.getNbTimbres(),p=s?.getTimbreBlocModel()?.getNbTimbres(),b=c==null,y=p==null;if(b&&!y)return-1;if(!b&&y)return 1;if(!b&&!y)return c-p;let L=n?.getIdBloc(),U=s?.getIdBloc();return L==null&&U!=null?-1:L!=null&&U==null?1:L!=null&&U!=null?L-U:0}),console.log("timbresRetour",r),r}ajouterSansId(r){this.utilsService.getMaxIdentAsync("/timbres").pipe(q()).subscribe(n=>{r.setId(n),I(r.getIdBloc())&&r.setMonnaie(null),this.ajouter(r,!0)})}ajouter(r,n){this.getTimbre(r.getId()).pipe(q()).subscribe(s=>{Le(s)||Le(s[0])||I(s[0])&&s[0]?.length==0?(r.setTimbreAcquisModel(null),r.setTimbreBlocModel(null),this.firestore.collection("/timbres").add(Object.assign(new Object,r)).then(c=>{n&&(this.preferenceService.getTimbreCritere("timbreCritere").pipe(q()).subscribe(p=>{I(p.getAnnees().find(b=>b==r.getAnnee()))&&this.timbres$.pipe(q()).subscribe(b=>{Le(b)&&(b=[]),b.push(r),this.setTotal(1)})}),this.timbreUtilsService.reinitResume$.next(!0))}).catch(c=>{console.error("Erreur d'ajout :",c)})):console.error("timbre "+r.getId()+" d\xE9j\xE0 existant")})}modifier(r){r.setTimbreBlocModel(null),r.setTimbreAcquisModel(null),this.firestore.collection("/timbres").ref.where("id","==",r.getId()).get().then(n=>{n.forEach(s=>{s.ref.update(Object.assign(new Object,r)).then(c=>{this.timbres$.pipe(q(p=>I(p)&&p?.length>0)).subscribe(p=>{let b=p.find(y=>y.getId()==r.getId());I(b)&&Object.assign(b,r)})}).catch(c=>{console.error("Erreur de mise \xE0 jour :",c)})})}).catch(n=>{console.error("Erreur de mise \xE0 jour id introuvable :",n)})}supprimerTimbre(r){this.firestore.collection("/timbres").ref.where("id","==",r.getId()).get().then(n=>{n.forEach(s=>{s.ref.delete().then(c=>{this.timbres$.pipe(q()).subscribe(p=>{let b=p.findIndex(y=>y.getId()==r.getId());b>=0&&(p.splice(b,1),this.setTotal(-1))})}).catch(c=>{console.error("Erreur de suppression :",c)})})}).catch(n=>{console.error("Erreur de suppression id introuvable :",n)})}supprimer(r){this.timbreUtilsService.supprimerTimbreAcquis(r),this.supprimerTimbre(r),this.timbreUtilsService.reinitResume$.next(!0)}getBouchon(){let r=new Ot;return r.setAnnee(new Date().getFullYear()),r.setMonnaie("E"),r.setType(""),r.setYt(""),r}upload(r,n,s){let c=100,p=100;return n=="table"?(c=c*(50/p),p=50):n=="zoom"&&(c=c*(700/p),p=700),this.uploadService.processAndUploadImage(r?.getImage(),c,p,I(s)?s:r?.getId(),this.getDossier(r,n))}getDossier(r,n){let s="timbre//";return I(r.getIdBloc())?s=s+r.getTimbreBlocModel().getAnnee():s=s+r.getAnnee(),I(n)&&(s=s+"/"+n),I(r.getIdBloc())&&(s=s+"/bloc/"+r.getIdBloc()),s}acquisDoublon(r,n){this.authService.user$.pipe(q(s=>I(s))).subscribe(s=>{s?.getDroit()>=9?this.timbreUtilsService.acquis(r,n):this.utilsService.droitInsuffisant()})}modifierDialog(r){let n=this.dialog.open(qn,{height:"75vh",maxHeight:"750px",width:"30%"});n.componentInstance.id=r.getId(),n.afterClosed().subscribe(()=>{n.close()})}supprimerDialog(r){let n=this.dialog.open(Ti,{maxHeight:"95vh",data:{titre:"Confirmation",message:"Souhaitez-vous supprimer le timbre <b>n\xB0 "+r?.getId()+"</b> ?",btnDroite:"Oui",btnGauche:"Non"}});n.afterClosed().subscribe(()=>{n.componentInstance.data.resultat==="valider"&&this.supprimer(r)})}static \u0275fac=function(n){return new(n||o)(he(Sn),he(Ve),he(Ge),he(Un),he(rt),he(Me),he(nt),he(Jt))};static \u0275prov=Oi({token:o,factory:o.\u0275fac})};var ih=["canvas"];function nh(o,r){if(o&1&&(ie(0),G(1,"img",6),ne()),o&2){let n=r.$implicit;h(),T("src",n,yn)}}function rh(o,r){if(o&1&&(v(0,"div",4),O(1,nh,2,1,"ng-container",5),x()),o&2){let n=C();h(),T("ngForOf",n.selectedImages)}}var No=class o{constructor(r){this.utilsService=r}canvas;label="Choisir les images";maxWidth=100;maxHeight=200;alignLabel;outPutFiles=new Qc;selectedImages=[];id="file"+Math.floor(Math.random()*Math.floor(1e3));FontAwesomeEnum=It;FontAwesomeTypeEnum=Mt;triggerFileInput(){document.getElementById(this.id).click()}onFileSelected(r){let n=r.target.files;this.selectedImages=[];let s=[];n&&n?.length>0&&(Array.from(n).forEach(c=>{let p=new FileReader;p.onload=b=>{b.target?.result&&this.selectedImages.push(b.target.result)},p.readAsDataURL(c),s.push(c)}),this.outPutFiles.emit(s))}static \u0275fac=function(n){return new(n||o)($(rt))};static \u0275cmp=Ce({type:o,selectors:[["lib-upload-multiple"]],viewQuery:function(n,s){if(n&1&&bi(ih,5),n&2){let c;_i(c=hi())&&(s.canvas=c.first)}},inputs:{label:"label",maxWidth:"maxWidth",maxHeight:"maxHeight",alignLabel:"alignLabel"},outputs:{outPutFiles:"outPutFiles"},decls:5,vars:3,consts:[[1,"form-input","uploadMultiple"],["type","file","accept","image/*","multiple","","hidden","",3,"change","id"],["type","button","mat-raised-button","","color","accent",1,"rounded","large","color-white",3,"click"],["class","listeImage",4,"ngIf"],[1,"listeImage"],[4,"ngFor","ngForOf"],["alt","Image preview",1,"imgSelect",3,"src"]],template:function(n,s){n&1&&(v(0,"div",0)(1,"input",1),j("change",function(p){return s.onFileSelected(p)}),x(),v(2,"button",2),j("click",function(){return s.triggerFileInput()}),w(3),x(),O(4,rh,2,1,"div",3),x()),n&2&&(h(),xo("id",s.id),h(2),H(" ",s.label," "),h(),T("ngIf",s.selectedImages.length))},dependencies:[tt,Se,it],styles:[".uploadMultiple[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:start;align-items:stretch;gap:10px;width:100%}.uploadMultiple[_ngcontent-%COMP%]   .listeImage[_ngcontent-%COMP%]{flex-direction:row;flex-wrap:wrap;justify-content:left;width:100%}.uploadMultiple[_ngcontent-%COMP%]   .listeImage[_ngcontent-%COMP%]   .imgSelect[_ngcontent-%COMP%]{margin:5px;max-width:100px;max-height:150px}"]})};var $n=class o{transform(r,n){let s=[],c=Object.keys(r),p=Object.values(r);for(let b=0;b<c.length;b++)s.push({key:c[b],value:p[b]});return n=="sort"?s?.sort(function(b,y){return b.key<y.key?-1:b.key>y.key?1:0}):s}static \u0275fac=function(n){return new(n||o)};static \u0275pipe=vo({name:"enumToArray",type:o,pure:!0})};var Hn=class o{transform(r,n){return I(r)&&typeof r=="string"?(r=r.toLowerCase(),r.charAt(0).toUpperCase()+r.slice(1)):r}static \u0275fac=function(n){return new(n||o)};static \u0275pipe=vo({name:"capitalize",type:o,pure:!0})};var lh=["canvas"];function sh(o,r){o&1&&G(0,"lib-spinner",5),o&2&&T("textSpec","Chargement en cours ...")}function ah(o,r){if(o&1&&(G(0,"mat-error",23),R(1,"async")),o&2){let n=C(2);T("innerHTML",D(1,1,n.messageError$),Cn)}}function ch(o,r){if(o&1&&(v(0,"mat-option",25),w(1),R(2,"capitalize"),x()),o&2){let n=C().$implicit;T("value",n.value),h(),H(" ",D(2,2,n.value)," ")}}function mh(o,r){if(o&1&&(ie(0),O(1,ch,3,4,"mat-option",24),ne()),o&2){let n=r.$implicit,s=C(2);h(),T("ngIf",n.value!=s.TypeTimbreEnum.TIMBRE)}}function uh(o,r){if(o&1){let n=se();v(0,"form",6,1),j("ngSubmit",function(){W(n);let c=ye(1),p=C();return V(p.valider(c))}),v(2,"div",7),O(3,ah,2,3,"mat-error",8),R(4,"async"),v(5,"div",9)(6,"div",10)(7,"label"),G(8,"lib-libelle-model",11),x(),v(9,"input",12),Pe("ngModelChange",function(c){W(n);let p=C();return qe(p.timbreBlocModel.annee,c)||(p.timbreBlocModel.annee=c),V(c)}),x()(),v(10,"div",13)(11,"label"),G(12,"lib-libelle-model",11),x(),v(13,"mat-select",14),Pe("ngModelChange",function(c){W(n);let p=C();return qe(p.timbreBlocModel.type,c)||(p.timbreBlocModel.type=c),V(c)}),O(14,mh,2,1,"ng-container",15),R(15,"enumToArray"),x()()(),v(16,"div",9)(17,"div",10)(18,"label"),G(19,"lib-libelle-model",11),x(),v(20,"input",16),Pe("ngModelChange",function(c){W(n);let p=C();return qe(p.timbreBlocModel.yt,c)||(p.timbreBlocModel.yt=c),V(c)}),x()(),G(21,"div",17),x(),v(22,"lib-upload",18),j("outPutObject",function(c){W(n);let p=C();return V(p.setImageBloc(c))}),x(),v(23,"lib-upload-multiple",19),j("outPutFiles",function(c){W(n);let p=C();return V(p.selectTimbres(c))}),x()(),v(24,"div",20)(25,"button",21),j("click",function(){W(n);let c=C();return V(c.close())}),w(26," Annuler "),x(),v(27,"button",22),w(28," Enregistrer "),x()()()}if(o&2){let n=ye(1),s=C();T("ngClass",n!=null&&n.submitted?"red-color":"blue-color"),h(3),T("ngIf",D(4,23,s.messageError$)),h(5),T("object",s.timbreBlocModel)("key","annee"),h(),Ue("ngModel",s.timbreBlocModel.annee),T("max",s.maxAnnee)("zMax",s.maxAnnee),h(3),T("object",s.timbreBlocModel)("key","type"),h(),Ue("ngModel",s.timbreBlocModel.type),T("placeholder","Type"),h(),T("ngForOf",D(15,25,s.TypeTimbreEnum)),h(5),T("object",s.timbreBlocModel)("key","yt"),h(),Ue("ngModel",s.timbreBlocModel.yt),h(2),T("object",s.timbreBlocModel)("key","image")("zoom",s.timbreBlocModel.getImageZoom())("maxWidth",s.DimensionImageEnum.WIDTH_TIMBRE)("maxHeight",s.DimensionImageEnum.HEIGTH_TIMBRE),h(),T("label","Timbres")("maxWidth",s.DimensionImageEnum.WIDTH_TIMBRE)("maxHeight",s.DimensionImageEnum.HEIGTH_TIMBRE)}}var Wn=class o{constructor(r,n,s,c,p,b){this.httpResponseHandlerService=r;this.dialogRef=n;this.utilsService=s;this.timbreBlocService=c;this.timbreService=p;this.timbreUtilsService=b}canvas;messageError$=new _e(null);load$=new _e(null);id;maxAnnee=new Date().getFullYear()+1;timbreBlocModel=new Hi;fileUploadModel=new Wi;DimensionImageEnum=nn;TypeTimbreEnum=$t;ngOnInit(){this.fileUploadModel=this.timbreUtilsService.initUpload(),this.load$.next(!1),I(this.id)?this.timbreBlocService.getBlocByIdAsync(this.id).subscribe(r=>{this.timbreBlocModel=r,this.load$.next(!0)}):(this.timbreBlocModel.setAnnee(new Date().getFullYear()),this.timbreBlocModel.setMonnaie("E"),this.load$.next(!0))}setImageBloc(r){this.timbreBlocModel=r,r.getYt()?.includes("BK")?r.setType("BLOC"):r.getYt()?.includes("CARNET")?r.setType("CARNET"):r.getYt()?.includes("MTAM")&&r.setType("COLLECTOR")}valider(r){if(this.messageError$.next(null),r?.valid)if(I(this.timbreBlocModel.getImage()))this.saveData();else{this.messageError$.next("Veuillez s\xE9lectionner une image");return}}saveData(){this.load$.next(!1),I(this.timbreBlocModel.getId())?this.save():this.ajouter()}ajouter(){this.utilsService.getMaxIdentAsync("/timbres_bloc").pipe(q()).subscribe(r=>{this.timbreBlocModel.setId(r),this.save(!0)})}save(r){this.timbreBlocModel.getAnnee()>=2002?this.timbreBlocModel.setMonnaie("E"):this.timbreBlocModel.getAnnee()>=1999?this.timbreBlocModel.setMonnaie("FE"):this.timbreBlocModel.setMonnaie("F"),Re([this.timbreBlocService.upload(this.timbreBlocModel,"autre"),this.timbreBlocService.upload(this.timbreBlocModel,"table"),this.timbreBlocService.upload(this.timbreBlocModel,"zoom")]).pipe(Ri(([n,s,c])=>I(n)&&I(s)&&I(c)),Di(1),gr(n=>(this.httpResponseHandlerService.showNotificationError("Transaction non aboutie",r?"Votre bloc de timbre n'a pas pu \xEAtre ajout\xE9.":"Votre bloc de timbre n'a pas pu \xEAtre modifi\xE9."),dr))).subscribe(([n,s,c])=>{this.timbreUtilsService.isValidImage(n)&&this.timbreBlocModel.setImage(n),this.timbreUtilsService.isValidImage(s)&&this.timbreBlocModel.setImageTable(s),this.timbreUtilsService.isValidImage(c)&&this.timbreBlocModel.setImageZoom(c),r?this.timbreBlocService.ajouter(this.timbreBlocModel,!0):this.timbreBlocService.modifier(this.timbreBlocModel),this.timbreBlocModel?.getTimbres()?.length>0?this.saveTimbres(r):this.validSuccess(r)})}validSuccess(r){this.httpResponseHandlerService.showNotificationSuccess("Transaction termin\xE9e",r?"Votre bloc de timbre a bien \xE9t\xE9 ajout\xE9.":"Votre bloc de timbre a bien \xE9t\xE9 modifi\xE9."),this.load$.next(!0),this.dialogRef.close()}saveTimbres(r){this.timbreBlocModel?.getTimbres()?.length>0&&this.utilsService.getMaxIdentAsync("/timbres").pipe(q()).subscribe(n=>{this.timbreBlocModel?.getTimbres().forEach((s,c)=>{s.setIdBloc(this.timbreBlocModel.getId()),s.setTimbreBlocModel(this.timbreBlocModel),s.setMonnaie(this.timbreBlocModel.getMonnaie()),s.setAnnee(this.timbreBlocModel.getAnnee()),s.setId(n),n++,Re([this.timbreService.upload(s,"autre"),this.timbreService.upload(s,"table"),this.timbreService.upload(s,"zoom")]).pipe(Ri(([p,b,y])=>I(p)&&I(b)&&I(y)),Di(1),gr(p=>(this.httpResponseHandlerService.showNotificationError("Transaction non aboutie","Votre timbre n'a pas pu \xEAtre ajout\xE9."),this.load$.next(!0),dr))).subscribe(([p,b,y])=>{this.timbreUtilsService.isValidImage(p)&&s.setImage(p),this.timbreUtilsService.isValidImage(b)&&s.setImageTable(b),this.timbreUtilsService.isValidImage(y)&&s.setImageZoom(y),this.timbreService.ajouter(s,!0),c==this.timbreBlocModel.getTimbres().length-1&&this.validSuccess(r)})})})}close(){this.dialogRef.close()}selectTimbres(r){this.timbreBlocModel.setTimbres(null),I(r)&&r?.length>0&&r.forEach(n=>{let s=new Ot;s.setImage(n),s.setYt(n?.name?.replace(/\.([a-z]+)$/,"")),this.timbreBlocModel.addTimbre(s)})}static \u0275fac=function(n){return new(n||o)($(Io),$(Zt),$(rt),$(Ge),$(Ne),$(Me))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-modifier-bloc"]],viewQuery:function(n,s){if(n&1&&bi(lh,5),n&2){let c;_i(c=hi())&&(s.canvas=c.first)}},decls:10,vars:6,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","space-between stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","column","fxLayoutGap","20px",1,"bloc-modal"],[3,"innerHTML",4,"ngIf"],["fxLayout","row","fxLayout.lt-lg","column","fxLayoutGap","30px","fxLayoutGap.lt-lg","5px"],["fxLayout","column",1,"form-input"],[3,"object","key"],["name","page","type","number","minlength","4","maxlength","4","min","1900","zMin","1900","required","","zControl","",1,"annee",2,"width","60px !important",3,"ngModelChange","ngModel","max","zMax"],[1,"form-input","select"],["name","type","required","",1,"scrollBarAccent",2,"width","100px",3,"ngModelChange","ngModel","placeholder"],[4,"ngFor","ngForOf"],["name","yt","type","text","trim","","zControl","",3,"ngModelChange","ngModel"],["fxHide.lt-lg","","fxLayout","column",1,"form-input"],[3,"outPutObject","object","key","zoom","maxWidth","maxHeight"],[3,"outPutFiles","label","maxWidth","maxHeight"],["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"],[3,"innerHTML"],["class","selectMin",3,"value",4,"ngIf"],[1,"selectMin",3,"value"]],template:function(n,s){if(n&1&&(v(0,"div",2)(1,"div",3)(2,"span"),w(3),x(),v(4,"span"),w(5),x()(),O(6,sh,1,1,"ng-template",4),R(7,"async"),O(8,uh,29,27,"ng-template",null,0,et),x()),n&2){let c=ye(9);h(3),H("",s.timbreBlocModel!=null&&s.timbreBlocModel.getId()?"MODIFICATION":"AJOUT"," BLOC "),h(2),Co(s.timbreBlocModel==null?null:s.timbreBlocModel.getId()),h(),T("ngIf",D(7,4,s.load$)==!1)("ngIfElse",c)}},dependencies:[it,Dn,Rt,wt,St,tt,Se,zt,Fi,Kt,Yt,Ui,yo,Et,$i,Mn,In,At,qi,Bn,wn,Rn,An,En,Bt,Pi,Ln,Dt,On,Eo,Nn,Fn,Ao,No,Ae,$n,Hn],encapsulation:2})};var ln=class extends Li{type;total;constructor(r,n){super(),this.type=r||null,this.total=n||null}getType(){return this.type}setType(r){this.type=r}getTotal(){return this.total}setTotal(r){this.total=r}};oe([le("Type")],ln.prototype,"type",2),oe([le("Total")],ln.prototype,"total",2);var gs=Yc(Hm());var Ge=class o{constructor(r,n,s,c,p,b,y){this.firestore=r;this.authService=n;this.uploadService=s;this.utilsService=c;this.timbreUtilsService=p;this.dialog=b;this.preferenceService=y}total$=new _e([]);timbresBlocModel$=new _e(null);load$=new _e(!1);upload(r,n,s){let c=100,p=100;return n=="table"?(c=c*(50/p),p=50):n=="zoom"&&(c=c*(700/p),p=700),this.uploadService.processAndUploadImage(r?.getImage(),c,p,"bloc-"+r.getId(),this.getDossier(r,n,s))}setTotal(r,n){this.total$.pipe(q()).subscribe(s=>{let c=s.find(p=>p.getType()==r?.getType());I(c)?c.setTotal(c.getTotal()+1):s.push(new ln(r?.getType(),1)),this.total$.next(s)})}getTotal(r){this.total$.next(null),this.getAllBlocs(r).subscribe(n=>{let s=[];Object.keys($t).forEach(c=>{c!="TIMBRE"&&s.push(new ln(c,n?.filter(p=>p.type==c)?.length))}),this.total$.next(s)})}getBloc(r){return this.firestore.collection("/timbres_bloc",n=>n.where("id","==",r)).valueChanges()}getBlocByIdAsync(r){return this.getBloc(r).pipe(jt(n=>Ni(Hi,n[0])))}getRef(r,n){let s=r;return I(n)&&(I(n.getAnnees())&&n.getAnnees()?.length>0&&(s=s.where("annee","in",n.getAnnees())),I(n.getType())&&n.getType()?.length>0&&(s=s.where("type","in",n.getType()))),s=s.orderBy("id",n?.getSort()=="desc"?"desc":"asc"),s}getAllBlocs(r){return this.firestore.collection("/timbres_bloc",n=>this.getRef(n,r)).valueChanges()}getTimbreBlocAcquis(){return this.authService.userSelect$.pipe(q(r=>I(r)),To(r=>I(r)?this.getTimbreBlocAcquisByUser(r.getId()).pipe(q(),jt(n=>n)):null))}getTimbreBlocAcquisByUser(r){return this.firestore.collection("/timbres_bloc_acquis",n=>n.where("idUser","==",r)).valueChanges()}getBlocs(r,n){this.load$.next(!1),this.timbresBlocModel$.next(null),n&&this.getTotal(),Re([this.getAllBlocs(r),this.getTimbreBlocAcquis()]).pipe(q()).subscribe(([s,c])=>{this.timbresBlocModel$.next(this.constructBlocs(s,c,r)),this.load$.next(!0)})}getBlocsAsync(r){return this.timbresBlocModel$.next(null),Re([this.getAllBlocs(r),this.getTimbreBlocAcquis()]).pipe(q(),jt(([n,s])=>this.constructBlocs(n,s,r)))}constructBloc(r,n){let s=Ni(Hi,r);if(I(n)){let c=n.find(p=>p.idBloc==s.getId());I(c)?s.setTimbreBlocAcquisModel(Ni(dt,c)):s.setTimbreBlocAcquisModel(new dt)}return s}constructBlocs(r,n,s){let c=[];return r?.length>0&&r.forEach(p=>{let b=this.constructBloc(p,n);this.getTimbresByBlocAsync(b.getId()).subscribe(L=>{b.setNbTimbres(L?.length);let U=L?.filter(de=>de?.getTimbreAcquisModel()?.isAcquis())?.length;b.setNbTimbresAcquis(U)});let y=!0;I(s)?I(b.getTimbreBlocAcquisModel())&&(I(s.getAcquis())&&!(s.getAcquis()=="TOUS"||s.getAcquis()=="OUI"&&b.getTimbreBlocAcquisModel().isAcquis()||s.getAcquis()=="NON"&&!b.getTimbreBlocAcquisModel().isAcquis())&&(y=!1),I(s.getDoublon())&&!(s.getDoublon()=="TOUS"||s.getDoublon()=="OUI"&&b.getTimbreBlocAcquisModel().isDoublon()||s.getDoublon()=="NON"&&!b.getTimbreBlocAcquisModel().isDoublon())&&(y=!1)):y=!0,y==!0&&c.push(b)}),c}ajouterSansId(r){this.utilsService.getMaxIdentAsync("/timbres_bloc").pipe(q()).subscribe(n=>{r.setId(n),this.ajouter(r,!0)})}ajouter(r,n){let s=(0,gs.cloneDeep)(r);this.getBloc(s.getId()).pipe(q()).subscribe(c=>{Le(c)||Le(c[0])||I(c[0])&&c[0]?.length==0?(s.setTimbreBlocAcquisModel(null),s.setTimbres(null),s.setIdOrigine(null),this.firestore.collection("/timbres_bloc").add(Object.assign(new Object,s)).then(p=>{this.preferenceService.getTimbreCritere("timbreCritere").pipe(q()).subscribe(b=>{I(b.getAnnees().find(y=>y==s.getAnnee()))&&this.timbresBlocModel$.pipe(q()).subscribe(y=>{Le(y)&&(y=[]),y.push(s),this.setTotal(s,1)})}),this.timbreUtilsService.reinitResume$.next(!0)}).catch(p=>{console.error("Erreur d'ajout :",p)})):console.error("bloc "+s.getId()+" d\xE9j\xE0 existant")})}isCarnet(r){this.authService.user$.pipe(q(n=>I(n))).subscribe(n=>{n?.getDroit()>=9?(r.getType()=="BLOC"?r.setType("CARNET"):r.getType()=="CARNET"?r.setType("COLLECTOR"):r.setType("BLOC"),this.modifier(r)):this.utilsService.droitInsuffisant()})}modifier(r){let n=(0,gs.cloneDeep)(r);n.setTimbreBlocAcquisModel(null),n.setTimbres(null),this.firestore.collection("/timbres_bloc").ref.where("id","==",n.getId()).get().then(s=>{s.forEach(c=>{c.ref.update(Object.assign(new Object,n)).then(p=>{this.timbresBlocModel$.pipe(q(b=>I(b)&&b?.length>0)).subscribe(b=>{let y=b.find(L=>L.getId()==n.getId());I(y)&&Object.assign(y,n)})}).catch(p=>{console.error("Erreur de mise \xE0 jour :",p)})})}).catch(s=>{console.error("Erreur de mise \xE0 jour id introuvable :",s)})}getTimbresByBlocAsync(r){let n=new _r;return n.setIdBloc(r),this.timbreUtilsService.getTimbresByCritereAsync(n)}supprimer(r){this.getTimbresByBlocAsync(r.getId()).pipe(q()).subscribe(n=>{n.forEach(s=>{this.timbreUtilsService.supprimerTimbreAcquis(s),this.timbreUtilsService.supprimerTimbre(s)})}),this.firestore.collection("/timbres_bloc_acquis").ref.where("idBloc","==",r.getId()).get().then(n=>{n.forEach(s=>{s.ref.delete()})}),this.firestore.collection("/timbres_bloc").ref.where("id","==",r.getId()).get().then(n=>{n.forEach(s=>{s.ref.delete().then(c=>{this.timbresBlocModel$.pipe(q()).subscribe(p=>{let b=p.findIndex(y=>y.getId()==r.getId());b>=0&&(p.splice(b,1),this.setTotal(r,-1))})}).catch(c=>{console.error("Erreur de suppression :",c)})})}).catch(n=>{console.error("Erreur de suppression id introuvable :",n)}),this.timbreUtilsService.reinitResume$.next(!0)}getDossier(r,n,s){let c="timbre//"+r.getAnnee();return I(n)&&(c=c+"/"+n),c=c+"/bloc/"+(I(s)?s:r.getId()),c}getBouchon(){let r=new Hi;return r.setAnnee(new Date().getFullYear()),r.setMonnaie("E"),r}acquisDoublon(r,n){this.authService.user$.pipe(q(s=>I(s))).subscribe(s=>{s?.getDroit()>=9?r?.getType()=="CARNET"?this.acquisCarnetDialog(r,n):this.timbreUtilsService.acquisBloc(r,n):this.utilsService.droitInsuffisant()})}acquisCarnetDialog(r,n){let s="";r?.getTimbreBlocAcquisModel()?.isDoublon()&&n?s="enlever les doublons":r?.getTimbreBlocAcquisModel()?.isAcquis()?s="enlever les acquis":s="mettre en "+(n?"doublon":"acquis")+" tous";let c=this.dialog.open(Ti,{maxHeight:"95vh",data:{titre:"Confirmation",message:"Souhaitez-vous <b>"+s+"</b> les timbres du "+r?.getType()?.toLowerCase()+" ?",btnDroite:"Oui",btnGauche:"Non"}});c.afterClosed().subscribe(()=>{c.componentInstance.data.resultat==="valider"?this.authService.userSelect$.pipe(q(p=>I(p))).subscribe(p=>{this.getTimbresByBlocAsync(r.getId()).pipe(q()).subscribe(b=>{b.forEach(y=>{this.timbreUtilsService.acquis(y,n,!r?.getTimbreBlocAcquisModel()?.isAcquis())})}),this.timbreUtilsService.acquisBloc(r,n)}):this.timbreUtilsService.acquisBloc(r,n)})}modifierDialog(r){let n=this.dialog.open(Wn,{height:"75vh",maxHeight:"750px",width:"30%"});n.componentInstance.id=r.getId(),n.afterClosed().subscribe(()=>{n.close()})}supprimerDialog(r){this.getTimbresByBlocAsync(r.getId()).pipe(q()).subscribe(n=>{let s="";I(n)&&n?.length>0&&(s="<span class='warn'>Attention <b>"+n.length+"</b> timbre",n?.length>1?s+="s sont reli\xE9s":s+=" est reli\xE9",s+=" \xE0 ce bloc.</span></br></br>"),s+="Souhaitez-vous supprimer le bloc <b>n\xB0 "+r?.getId()+"</b> ?";let c=this.dialog.open(Ti,{maxHeight:"95vh",data:{titre:"Confirmation",message:s,btnDroite:"Oui",btnGauche:"Non"}});c.afterClosed().subscribe(()=>{c.componentInstance.data.resultat==="valider"&&this.supprimer(r)})})}modifAll(){let r=new _r;this.getAllBlocs(r).pipe(q(n=>n?.length>0)).subscribe(n=>{n.forEach(s=>{s.carnet==!0?s.type="CARNET":s.type="BLOC",this.firestore.collection("/timbres_bloc").ref.where("id","==",s.id).get().then(c=>{c.forEach(p=>{p.ref.update(s)})})})})}static \u0275fac=function(n){return new(n||o)(he(Sn),he(Ve),he(Un),he(rt),he(Me),he(nt),he(Jt))};static \u0275prov=Oi({token:o,factory:o.\u0275fac})};var pe=class extends Li{annee;total;nombre;acquis;doublon;nombreCarnet;nombreTimbresCarnet;acquisTimbresCarnet;doublonTimbresCarnet;nombreCollector;acquisCollector;doublonCollector;nombreTimbresCollector;acquisTimbresCollector;doublonTimbresCollector;nombreBloc;acquisBloc;doublonBloc;nombreTimbresBloc;acquisTimbresBloc;doublonTimbresBloc;constructor(r,n,s,c,p,b,y,L,U,de,ce,ot,ni,ke,Ht,Gn,lt,ri,st,oi,gt){super(),this.annee=r||null,this.total=n||0,this.nombre=s||0,this.acquis=c||0,this.doublon=p||0,this.nombreCarnet=b||0,this.nombreTimbresCarnet=y||0,this.acquisTimbresCarnet=L||0,this.doublonTimbresCarnet=U||0,this.nombreCollector=de||0,this.nombreCollector=de||0,this.acquisCollector=ce||0,this.nombreTimbresCollector=ni||0,this.acquisTimbresCollector=ke||0,this.doublonTimbresCollector=Ht||0,this.nombreBloc=Gn||0,this.acquisBloc=lt||0,this.doublonBloc=ri||0,this.nombreTimbresBloc=st||0,this.acquisTimbresBloc=oi||0,this.doublonTimbresBloc=gt||0}getAnnee(){return this.annee}setAnnee(r){this.annee=r}getTotal(){return this.total}setTotal(r){this.total=r}getNombre(){return this.nombre}setNombre(r){this.nombre=r}getAcquis(){return this.acquis}setAcquis(r){this.acquis=r}getDoublon(){return this.doublon}setDoublon(r){this.doublon=r}getNombreCarnet(){return this.nombreCarnet}setNombreCarnet(r){this.nombreCarnet=r}getNombreTimbresCarnet(){return this.nombreTimbresCarnet}setNombreTimbresCarnet(r){this.nombreTimbresCarnet=r}getAcquisTimbresCarnet(){return this.acquisTimbresCarnet}setAcquisTimbresCarnet(r){this.acquisTimbresCarnet=r}getDoublonTimbresCarnet(){return this.doublonTimbresCarnet}setDoublonTimbresCarnet(r){this.doublonTimbresCarnet=r}getNombreCollector(){return this.nombreCollector}setNombreCollector(r){this.nombreCollector=r}getAcquisCollector(){return this.acquisCollector}setAcquisCollector(r){this.acquisCollector=r}getDoublonCollector(){return this.doublonCollector}setDoublonCollector(r){this.doublonCollector=r}getNombreTimbresCollector(){return this.nombreTimbresCollector}setNombreTimbresCollector(r){this.nombreTimbresCollector=r}getAcquisTimbresCollector(){return this.acquisTimbresCollector}setAcquisTimbresCollector(r){this.acquisTimbresCollector=r}getDoublonTimbresCollector(){return this.doublonTimbresCollector}setDoublonTimbresCollector(r){this.doublonTimbresCollector=r}getNombreBloc(){return this.nombreBloc}setNombreBloc(r){this.nombreBloc=r}getAcquisBloc(){return this.acquisBloc}setAcquisBloc(r){this.acquisBloc=r}getDoublonBloc(){return this.doublonBloc}setDoublonBloc(r){this.doublonBloc=r}getNombreTimbresBloc(){return this.nombreTimbresBloc}setNombreTimbresBloc(r){this.nombreTimbresBloc=r}getAcquisTimbresBloc(){return this.acquisTimbresBloc}setAcquisTimbresBloc(r){this.acquisTimbresBloc=r}getDoublonTimbresBloc(){return this.doublonTimbresBloc}setDoublonTimbresBloc(r){this.doublonTimbresBloc=r}};oe([le("Ann\xE9e")],pe.prototype,"annee",2),oe([le("Total")],pe.prototype,"total",2),oe([le("Nombre timbres")],pe.prototype,"nombre",2),oe([le("Total de timbres acquis")],pe.prototype,"acquis",2),oe([le("Total de timbres en doublon")],pe.prototype,"doublon",2),oe([le("Carnet")],pe.prototype,"nombreCarnet",2),oe([le("Timbres carnet")],pe.prototype,"nombreTimbresCarnet",2),oe([le("Total timbres carnet acquis")],pe.prototype,"acquisTimbresCarnet",2),oe([le("Total timbres carnet en doublon")],pe.prototype,"doublonTimbresCarnet",2),oe([le("Collector")],pe.prototype,"nombreCollector",2),oe([le("Total bloc collector")],pe.prototype,"acquisCollector",2),oe([le("Total bloc en collector")],pe.prototype,"doublonCollector",2),oe([le("Timbres collector")],pe.prototype,"nombreTimbresCollector",2),oe([le("Total timbres collector acquis")],pe.prototype,"acquisTimbresCollector",2),oe([le("Total timbres collector en doublon")],pe.prototype,"doublonTimbresCollector",2),oe([le("Nombre bloc")],pe.prototype,"nombreBloc",2),oe([le("Total bloc acquis")],pe.prototype,"acquisBloc",2),oe([le("Total bloc en doublon")],pe.prototype,"doublonBloc",2),oe([le("Timbres bloc")],pe.prototype,"nombreTimbresBloc",2),oe([le("Total timbres bloc acquis")],pe.prototype,"acquisTimbresBloc",2),oe([le("Total timbres bloc en doublon")],pe.prototype,"doublonTimbresBloc",2);var Fo=class o{constructor(r,n,s){this.timbreService=r;this.timbreBlocService=n;this.timbreUtilsService=s}load$=new _e(!1);timbresResume$=new _e(null);totalTimbreResume$=new _e(null);getResume(r){this.load$.next(!1),this.timbresResume$.next(null),this.totalTimbreResume$.next(null),Re([this.timbreUtilsService.getAllTimbres(r),this.timbreUtilsService.getTimbreAcquis(),this.timbreBlocService.getAllBlocs(r),this.timbreBlocService.getTimbreBlocAcquis()]).pipe(q()).subscribe(([n,s,c,p])=>{this.timbresResume$.next(this.construct(n,s,c,p)),this.timbreUtilsService.reinitResume$.next(!1)})}construct(r,n,s,c){let p=[];if(r?.length>0&&(r.forEach(b=>{let y=b.annee;if(I(s)&&Le(b.annee)&&I(b.idBloc)){let de=s.find(ce=>ce.id==b.idBloc);I(de)&&(y=de.annee)}let L=p.find(de=>de.getAnnee()==y);Le(L)&&(L=new pe,L.setAnnee(y),p.push(L)),L.setTotal(L.getTotal()+1);let U=I(b.idBloc)?s.find(de=>de.id==b.idBloc):null;if(I(b.idBloc)?I(U)&&U.type=="CARNET"?L.setNombreTimbresCarnet(L.getNombreTimbresCarnet()+1):I(U)&&U.type=="COLLECTOR"?L.setNombreTimbresCollector(L.getNombreTimbresCollector()+1):L.setNombreTimbresBloc(L.getNombreTimbresBloc()+1):L.setNombre(L.getNombre()+1),I(n)){let de=n.find(ce=>ce.idTimbre==b.id);I(de)&&(de.acquis==!0&&(I(b.idBloc)?I(U)&&U.type=="CARNET"?L.setAcquisTimbresCarnet(L.getAcquisTimbresCarnet()+1):I(U)&&U.type=="COLLECTOR"?L.setAcquisTimbresCollector(L.getAcquisTimbresCollector()+1):L.setAcquisTimbresBloc(L.getAcquisTimbresBloc()+1):L.setAcquis(L.getAcquis()+1)),de.doublon==!0&&(I(b.idBloc)?I(U)&&U.type=="CARNET"?L.setDoublonTimbresCarnet(L.getDoublonTimbresCarnet()+1):I(U)&&U.type=="COLLECTOR"?L.setDoublonTimbresCollector(L.getDoublonTimbresCollector()+1):L.setDoublonTimbresBloc(L.getDoublonTimbresBloc()+1):L.setDoublon(L.getDoublon()+1)))}}),s.forEach(b=>{let y=p.find(L=>L.getAnnee()==b.annee);if(Le(y)&&(y=new pe,y.setAnnee(b.annee),p.push(y)),b.type=="CARNET"?y.setNombreCarnet(y.getNombreCarnet()+1):b.type=="COLLECTOR"?y.setNombreCollector(y.getNombreCollector()+1):y.setNombreBloc(y.getNombreBloc()+1),I(c)){let L=c.find(U=>U.idBloc==b.id);I(L)&&(L.acquis==!0&&(Le(b.type)||b.type=="BLOC"?y.setAcquisBloc(y.getAcquisBloc()+1):b.type=="COLLECTOR"&&y.setAcquisCollector(y.getAcquisCollector()+1)),L.doublon==!0&&(Le(b.type)||b.type=="BLOC"?y.setDoublonBloc(y.getDoublonBloc()+1):b.type=="COLLECTOR"&&y.setDoublonCollector(y.getDoublonCollector()+1)))}})),I(p)&&p?.length>0){let b=new pe;p.forEach(y=>{b.setTotal(b.getTotal()+y.getTotal()),b.setNombre(b.getNombre()+y.getNombre()),b.setAcquis(b.getAcquis()+y.getAcquis()),b.setDoublon(b.getDoublon()+y.getDoublon()),b.setNombreCarnet(b.getNombreCarnet()+y.getNombreCarnet()),b.setNombreTimbresCarnet(b.getNombreTimbresCarnet()+y.getNombreTimbresCarnet()),b.setAcquisTimbresCarnet(b.getAcquisTimbresCarnet()+y.getAcquisTimbresCarnet()),b.setDoublonTimbresCarnet(b.getDoublonTimbresCarnet()+y.getDoublonTimbresCarnet()),b.setNombreBloc(b.getNombreBloc()+y.getNombreBloc()),b.setAcquisBloc(b.getAcquisBloc()+y.getAcquisBloc()),b.setDoublonBloc(b.getDoublonBloc()+y.getDoublonBloc()),b.setNombreTimbresBloc(b.getNombreTimbresBloc()+y.getNombreTimbresBloc()),b.setAcquisTimbresBloc(b.getAcquisTimbresBloc()+y.getAcquisTimbresBloc()),b.setDoublonTimbresBloc(b.getDoublonTimbresBloc()+y.getDoublonTimbresBloc()),b.setNombreCollector(b.getNombreCollector()+y.getNombreCollector()),b.setAcquisCollector(b.getAcquisCollector()+y.getAcquisCollector()),b.setDoublonCollector(b.getDoublonCollector()+y.getDoublonCollector()),b.setNombreTimbresCollector(b.getNombreTimbresCollector()+y.getNombreTimbresCollector()),b.setAcquisTimbresCollector(b.getAcquisTimbresCollector()+y.getAcquisTimbresCollector()),b.setDoublonTimbresCollector(b.getDoublonTimbresCollector()+y.getDoublonTimbresCollector())}),this.totalTimbreResume$.next(b)}return this.load$.next(!0),p}static \u0275fac=function(n){return new(n||o)(he(Ne),he(Ge),he(Me))};static \u0275prov=Oi({token:o,factory:o.\u0275fac})};var Wm=class o{static \u0275fac=function(n){return new(n||o)};static \u0275mod=Zc({type:o});static \u0275inj=Kc({imports:[tm,lm,sm,cm,mm,um,am,fm,pm,wm,it,Rm,wt,Rt,Mo]})};var Vm=o=>({accent50:o});function fh(o,r){o&1&&G(0,"lib-spinner",2),o&2&&T("textSpec","Chargement en cours ...")}function dh(o,r){if(o&1&&(v(0,"th",35),G(1,"lib-libelle-model",36),x()),o&2){let n=C(2);h(),T("object",n.timbreResumeModel)("key","annee")}}function gh(o,r){if(o&1&&(v(0,"td",37),w(1),x()),o&2){let n=r.$implicit;h(),H(" ",n==null?null:n.getAnnee()," ")}}function bh(o,r){o&1&&G(0,"td",38)}function _h(o,r){if(o&1&&(v(0,"th",35),G(1,"lib-libelle-model",36),x()),o&2){let n=C(2);h(),T("object",n.timbreResumeModel)("key","total")}}function hh(o,r){if(o&1&&(v(0,"td",37),w(1),x()),o&2){let n=r.$implicit;h(),H(" ",n==null?null:n.getTotal()," ")}}function Th(o,r){if(o&1&&(v(0,"td",38)(1,"b"),w(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),H("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getTotal()," ")}}function vh(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-libelle-model",36),x()),o&2){let n=C(2);h(),T("object",n.timbreResumeModel)("key","nombre")}}function xh(o,r){if(o&1&&(v(0,"td",40),w(1),x()),o&2){let n=r.$implicit;h(),H(" ",n==null?null:n.getNombre()," ")}}function Ch(o,r){if(o&1&&(v(0,"td",38)(1,"b"),w(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),H("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombre()," ")}}function yh(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK)("info",n.timbreResumeModel.getPropertyLibelle("acquis"))}}function Sh(o,r){if(o&1&&(ie(0),w(1),ne()),o&2){let n=C().$implicit;h(),H(" ",n==null?null:n.getAcquis()," ")}}function Mh(o,r){if(o&1&&(v(0,"td",42),R(1,"percent"),O(2,Sh,2,1,"ng-container",43),x()),o&2){let n=r.$implicit;T("ngClass",br(5,Vm,(n==null?null:n.getNombre())==(n==null?null:n.getAcquis())))("matTooltip",(n==null?null:n.getAcquis())>0?D(1,3,(n==null?null:n.getAcquis())/(n==null?null:n.getNombre())):""),h(2),T("ngIf",(n==null?null:n.getAcquis())>0)}}function Ih(o,r){if(o&1&&(ie(0),v(1,"b"),w(2),R(3,"async"),R(4,"async"),R(5,"async"),R(6,"percent"),x(),ne()),o&2){let n,s=C(3);h(2),Jc("",(n=D(3,2,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquis()," (",D(6,8,((n=D(4,4,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquis())/((n=D(5,6,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombre())),")")}}function Eh(o,r){if(o&1&&(v(0,"td",38),O(1,Ih,7,10,"ng-container",43),R(2,"async"),x()),o&2){let n,s=C(2);h(),T("ngIf",((n=D(2,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquis())>0)}}function Ah(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK_DOUBLE)("info",n.timbreResumeModel.getPropertyLibelle("doublon"))}}function Bh(o,r){if(o&1&&(v(0,"td",44),w(1),x()),o&2){let n=r.$implicit;T("ngClass",br(2,Vm,(n==null?null:n.getNombre())==(n==null?null:n.getDoublon()))),h(),H(" ",n==null?null:n.getDoublon()," ")}}function wh(o,r){if(o&1&&(v(0,"td",38)(1,"b"),w(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),H("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getDoublon()," ")}}function Rh(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-libelle-model",36),x()),o&2){let n=C(2);h(),T("object",n.timbreResumeModel)("key","nombreCarnet")}}function Dh(o,r){if(o&1&&(v(0,"td",44),w(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreCarnet())==0?"gray25":"primary25"),h(),H(" ",(n==null?null:n.getNombreCarnet())>0?n==null?null:n.getNombreCarnet():""," ")}}function Oh(o,r){if(o&1&&(v(0,"td",38)(1,"b"),w(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),H("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombreCarnet()," ")}}function Lh(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-libelle-model",36),x()),o&2){let n=C(2);h(),T("object",n.timbreResumeModel)("key","nombreTimbresCarnet")}}function Nh(o,r){if(o&1&&(v(0,"td",44),w(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreCarnet())==0?"gray25":"primary25"),h(),H(" ",(n==null?null:n.getNombreCarnet())>0?n==null?null:n.getNombreTimbresCarnet():""," ")}}function Fh(o,r){if(o&1&&(v(0,"td",38)(1,"b"),w(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),H("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombreTimbresCarnet()," ")}}function Uh(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK)("info",n.timbreResumeModel.getPropertyLibelle("acquisTimbresCarnet"))}}function qh(o,r){if(o&1&&(v(0,"td",44),w(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreTimbresCarnet())==0?"gray25":(n==null?null:n.getNombreTimbresCarnet())==(n==null?null:n.getAcquisTimbresCarnet())?"accent50":"primary25"),h(),H(" ",(n==null?null:n.getNombreCarnet())>0?n==null?null:n.getAcquisTimbresCarnet():""," ")}}function Ph(o,r){if(o&1&&(v(0,"td",38)(1,"b"),w(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),H("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquisTimbresCarnet()," ")}}function $h(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK_DOUBLE)("info",n.timbreResumeModel.getPropertyLibelle("doublonTimbresCarnet"))}}function Hh(o,r){if(o&1&&(v(0,"td",44),w(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreTimbresCarnet())==0?"gray25":(n==null?null:n.getNombreTimbresCarnet())==(n==null?null:n.getDoublonTimbresCarnet())?"accent50":"primary25"),h(),H(" ",(n==null?null:n.getNombreCarnet())>0?n==null?null:n.getDoublonTimbresCarnet():""," ")}}function Wh(o,r){if(o&1&&(v(0,"td",38)(1,"b"),w(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),H("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getDoublonTimbresCarnet()," ")}}function Vh(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-libelle-model",36),x()),o&2){let n=C(2);h(),T("object",n.timbreResumeModel)("key","nombreBloc")}}function Gh(o,r){if(o&1&&(v(0,"td",44),w(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreBloc())==0?"gray25":""),h(),H(" ",(n==null?null:n.getNombreBloc())>0?n==null?null:n.getNombreBloc():""," ")}}function kh(o,r){if(o&1&&(v(0,"td",38)(1,"b"),w(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),H("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombreBloc()," ")}}function jh(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK)("info",n.timbreResumeModel.getPropertyLibelle("acquisBloc"))}}function zh(o,r){if(o&1&&(v(0,"td",44),w(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreBloc())==0?"gray25":n.getNombreBloc()==(n==null?null:n.getAcquisBloc())?"accent50":""),h(),H(" ",(n==null?null:n.getNombreBloc())>0?n==null?null:n.getAcquisBloc():""," ")}}function Yh(o,r){if(o&1&&(v(0,"td",38)(1,"b"),w(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),H("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquisBloc()," ")}}function Kh(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK_DOUBLE)("info",n.timbreResumeModel.getPropertyLibelle("doublonBloc"))}}function Zh(o,r){if(o&1&&(v(0,"td",44),w(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreBloc())==0?"gray25":n.getNombreBloc()==(n==null?null:n.getDoublonBloc())?"accent50":""),h(),H(" ",(n==null?null:n.getNombreBloc())>0?n==null?null:n.getDoublonBloc():""," ")}}function Qh(o,r){if(o&1&&(v(0,"td",38)(1,"b"),w(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),H("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getDoublonBloc()," ")}}function Jh(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-libelle-model",36),x()),o&2){let n=C(2);h(),T("object",n.timbreResumeModel)("key","nombreTimbresBloc")}}function Xh(o,r){if(o&1&&(v(0,"td",44),w(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreTimbresBloc())==0?"gray25":"primary25"),h(),H(" ",(n==null?null:n.getNombreTimbresBloc())>0?n==null?null:n.getNombreTimbresBloc():""," ")}}function e1(o,r){if(o&1&&(v(0,"td",38)(1,"b"),w(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),H("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombreTimbresBloc()," ")}}function t1(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK)("info",n.timbreResumeModel.getPropertyLibelle("acquisTimbresBloc"))}}function i1(o,r){if(o&1&&(v(0,"td",44),w(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreTimbresBloc())==0?"gray25":(n==null?null:n.getNombreTimbresBloc())==(n==null?null:n.getAcquisTimbresBloc())?"accent50":"primary25"),h(),H(" ",(n==null?null:n.getNombreTimbresBloc())>0?n==null?null:n.getAcquisTimbresBloc():""," ")}}function n1(o,r){if(o&1&&(v(0,"td",38)(1,"b"),w(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),H("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquisTimbresBloc()," ")}}function r1(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK_DOUBLE)("info",n.timbreResumeModel.getPropertyLibelle("doublonTimbresBloc"))}}function o1(o,r){if(o&1&&(v(0,"td",44),w(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreTimbresBloc())==0?"gray25":(n==null?null:n.getNombreTimbresBloc())==(n==null?null:n.getDoublonTimbresBloc())?"accent50":"primary25"),h(),H(" ",(n==null?null:n.getNombreTimbresBloc())>0?n==null?null:n.getDoublonTimbresBloc():""," ")}}function l1(o,r){if(o&1&&(v(0,"td",38)(1,"b"),w(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),H("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getDoublonTimbresBloc()," ")}}function s1(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-libelle-model",36),x()),o&2){let n=C(2);h(),T("object",n.timbreResumeModel)("key","nombreCollector")}}function a1(o,r){if(o&1&&(v(0,"td",44),w(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreCollector())==0?"gray25":"primary25"),h(),H(" ",(n==null?null:n.getNombreCollector())>0?n==null?null:n.getNombreCollector():""," ")}}function c1(o,r){if(o&1&&(v(0,"td",38)(1,"b"),w(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),H("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombreCollector()," ")}}function m1(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK)("info",n.timbreResumeModel.getPropertyLibelle("acquisCollector"))}}function u1(o,r){if(o&1&&(v(0,"td",44),w(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreCollector())==0?"gray25":n.getNombreCollector()==(n==null?null:n.getAcquisCollector())?"accent50":""),h(),H(" ",(n==null?null:n.getNombreCollector())>0?n==null?null:n.getAcquisCollector():""," ")}}function p1(o,r){if(o&1&&(v(0,"td",38)(1,"b"),w(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),H("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquisCollector()," ")}}function f1(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK_DOUBLE)("info",n.timbreResumeModel.getPropertyLibelle("doublonCollector"))}}function d1(o,r){if(o&1&&(v(0,"td",44),w(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreCollector())==0?"gray25":n.getNombreCollector()==(n==null?null:n.getDoublonCollector())?"accent50":""),h(),H(" ",(n==null?null:n.getNombreCollector())>0?n==null?null:n.getDoublonCollector():""," ")}}function g1(o,r){if(o&1&&(v(0,"td",38)(1,"b"),w(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),H("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getDoublonCollector()," ")}}function b1(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-libelle-model",36),x()),o&2){let n=C(2);h(),T("object",n.timbreResumeModel)("key","nombreTimbresCollector")}}function _1(o,r){if(o&1&&(v(0,"td",44),w(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreCollector())==0?"gray25":"primary25"),h(),H(" ",(n==null?null:n.getNombreCollector())>0?n==null?null:n.getNombreTimbresCollector():""," ")}}function h1(o,r){if(o&1&&(v(0,"td",38)(1,"b"),w(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),H("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombreTimbresCollector()," ")}}function T1(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK)("info",n.timbreResumeModel.getPropertyLibelle("acquisTimbresCollector"))}}function v1(o,r){if(o&1&&(v(0,"td",44),w(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreTimbresCollector())==0?"gray25":(n==null?null:n.getNombreTimbresCollector())==(n==null?null:n.getAcquisTimbresCollector())?"accent50":"primary25"),h(),H(" ",(n==null?null:n.getNombreCollector())>0?n==null?null:n.getAcquisTimbresCollector():""," ")}}function x1(o,r){if(o&1&&(v(0,"td",38)(1,"b"),w(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),H("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquisTimbresCollector()," ")}}function C1(o,r){if(o&1&&(v(0,"th",39),G(1,"lib-icon",41),x()),o&2){let n=C(2);h(),T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK_DOUBLE)("info",n.timbreResumeModel.getPropertyLibelle("doublonTimbresCollector"))}}function y1(o,r){if(o&1&&(v(0,"td",44),w(1),x()),o&2){let n=r.$implicit;T("ngClass",(n==null?null:n.getNombreTimbresCollector())==0?"gray25":(n==null?null:n.getNombreTimbresCollector())==(n==null?null:n.getDoublonTimbresCollector())?"accent50":"primary25"),h(),H(" ",(n==null?null:n.getNombreCollector())>0?n==null?null:n.getDoublonTimbresCollector():""," ")}}function S1(o,r){if(o&1&&(v(0,"td",38)(1,"b"),w(2),R(3,"async"),x()()),o&2){let n,s=C(2);h(2),H("",(n=D(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getDoublonTimbresCollector()," ")}}function M1(o,r){o&1&&G(0,"tr",45)}function I1(o,r){if(o&1){let n=se();v(0,"tr",46),j("click",function(){let c=W(n).$implicit,p=C(2);return V(p.filtreParAnnee(c))}),x()}}function E1(o,r){o&1&&G(0,"tr",47)}function A1(o,r){if(o&1){let n=se();v(0,"table",3),j("matSortChange",function(c){W(n);let p=C();return V(p.sortData(c))}),ie(1,4),O(2,dh,2,2,"th",5)(3,gh,2,1,"td",6)(4,bh,1,0,"td",7),ne(),ie(5,8),O(6,_h,2,2,"th",5)(7,hh,2,1,"td",6)(8,Th,4,3,"td",7),ne(),ie(9,9),O(10,vh,2,2,"th",10)(11,xh,2,1,"td",11)(12,Ch,4,3,"td",7),ne(),ie(13,12),O(14,yh,2,3,"th",10)(15,Mh,3,7,"td",13)(16,Eh,3,3,"td",7),ne(),ie(17,14),O(18,Ah,2,3,"th",10)(19,Bh,2,4,"td",15)(20,wh,4,3,"td",7),ne(),ie(21,16),O(22,Rh,2,2,"th",10)(23,Dh,2,2,"td",15)(24,Oh,4,3,"td",7),ne(),ie(25,17),O(26,Lh,2,2,"th",10)(27,Nh,2,2,"td",15)(28,Fh,4,3,"td",7),ne(),ie(29,18),O(30,Uh,2,3,"th",10)(31,qh,2,2,"td",15)(32,Ph,4,3,"td",7),ne(),ie(33,19),O(34,$h,2,3,"th",10)(35,Hh,2,2,"td",15)(36,Wh,4,3,"td",7),ne(),ie(37,20),O(38,Vh,2,2,"th",10)(39,Gh,2,2,"td",15)(40,kh,4,3,"td",7),ne(),ie(41,21),O(42,jh,2,3,"th",10)(43,zh,2,2,"td",15)(44,Yh,4,3,"td",7),ne(),ie(45,22),O(46,Kh,2,3,"th",10)(47,Zh,2,2,"td",15)(48,Qh,4,3,"td",7),ne(),ie(49,23),O(50,Jh,2,2,"th",10)(51,Xh,2,2,"td",15)(52,e1,4,3,"td",7),ne(),ie(53,24),O(54,t1,2,3,"th",10)(55,i1,2,2,"td",15)(56,n1,4,3,"td",7),ne(),ie(57,25),O(58,r1,2,3,"th",10)(59,o1,2,2,"td",15)(60,l1,4,3,"td",7),ne(),ie(61,26),O(62,s1,2,2,"th",10)(63,a1,2,2,"td",15)(64,c1,4,3,"td",7),ne(),w(65,"> "),ie(66,27),O(67,m1,2,3,"th",10)(68,u1,2,2,"td",15)(69,p1,4,3,"td",7),ne(),ie(70,28),O(71,f1,2,3,"th",10)(72,d1,2,2,"td",15)(73,g1,4,3,"td",7),ne(),ie(74,29),O(75,b1,2,2,"th",10)(76,_1,2,2,"td",15)(77,h1,4,3,"td",7),ne(),ie(78,30),O(79,T1,2,3,"th",10)(80,v1,2,2,"td",15)(81,x1,4,3,"td",7),ne(),ie(82,31),O(83,C1,2,3,"th",10)(84,y1,2,2,"td",15)(85,S1,4,3,"td",7),ne(),O(86,M1,1,0,"tr",32)(87,I1,1,0,"tr",33)(88,E1,1,0,"tr",34),x()}if(o&2){let n=C();T("dataSource",n.dataSource),h(86),T("matHeaderRowDef",n.displayedColumns)("matHeaderRowDefSticky",!0),h(),T("matRowDefColumns",n.displayedColumns),h(),T("matFooterRowDef",n.displayedColumns)("matFooterRowDefSticky",!0)}}var Uo=class o{constructor(r,n,s,c,p,b,y){this.authService=r;this.dialogRef=n;this.timbreResumeService=s;this.timbreService=c;this.timbreBlocService=p;this.timbreUtilsService=b;this.preferenceService=y;this.dataSource=new fs([])}paginator;sort;dataSource=new fs;displayedColumns=[];timbreResumeModel=new pe;FontAwesomeEnum=It;FontAwesomeTypeEnum=Mt;ngOnInit(){this.initColumns(),this.timbreUtilsService.reinitResume$.pipe(q()).subscribe(r=>{r==!0&&this.timbreResumeService.getResume(),this.initData()})}initColumns(){this.authService.user$.pipe(q(r=>I(r))).subscribe(r=>{let n=[];n.push("annee","total","nombre","acquis"),r?.getDroit()==10&&n.push("doublon"),n.push("nombreCarnet","nombreTimbresCarnet","acquisTimbresCarnet"),r?.getDroit()==10&&n.push("doublonTimbresCarnet"),n.push("nombreBloc","acquisBloc"),r?.getDroit()==10&&n.push("doublonBloc"),n.push("nombreTimbresBloc","acquisTimbresBloc"),r?.getDroit()==10&&n.push("doublonTimbresBloc"),n.push(),(r?.getDroit()==2||r?.getDroit()==10)&&n.push("nombreCollector","acquisCollector"),this.displayedColumns=n})}initData(){this.timbreResumeService.timbresResume$.pipe(q(r=>I(r)&&r?.length>0)).subscribe(r=>{this.dataSource.data=r})}ngAfterViewInit(){this.dataSource.paginator=this.paginator}sortData(r){I(r)&&(this.dataSource.sort=this.sort)}filtreParAnnee(r){window.location.href.indexOf("bloc")>0?this.preferenceService.getTimbreCritere("blocCritere").pipe(q()).subscribe(n=>{n.initCritereBloc(),n.setAnnees([r.getAnnee()]),this.preferenceService.modifier("blocCritere",n),this.timbreBlocService.getBlocs(n,!1)}):this.preferenceService.getTimbreCritere("timbreCritere").pipe(q()).subscribe(n=>{n.initCritere(),n.setAnnees([r.getAnnee()]),this.preferenceService.modifier("timbreCritere",n),this.timbreService.getTimbres(n,!1)}),this.dialogRef.close()}static \u0275fac=function(n){return new(n||o)($(Ve),$(Zt),$(Fo),$(Ne),$(Ge),$(Me),$(Jt))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-resume"]],viewQuery:function(n,s){if(n&1&&(bi(gm,5),bi(So,5)),n&2){let c;_i(c=hi())&&(s.paginator=c.first),_i(c=hi())&&(s.sort=c.first)}},decls:4,vars:4,consts:[["load",""],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["mat-table","","matSort","",3,"matSortChange","dataSource"],["matColumnDef","annee","sticky",""],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","primary50",4,"matCellDef"],["mat-footer-cell","",4,"matFooterCellDef"],["matColumnDef","total","sticky",""],["matColumnDef","nombre"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","acquis"],["mat-cell","",3,"ngClass","matTooltip",4,"matCellDef"],["matColumnDef","doublon"],["mat-cell","",3,"ngClass",4,"matCellDef"],["matColumnDef","nombreCarnet"],["matColumnDef","nombreTimbresCarnet"],["matColumnDef","acquisTimbresCarnet"],["matColumnDef","doublonTimbresCarnet"],["matColumnDef","nombreBloc"],["matColumnDef","acquisBloc"],["matColumnDef","doublonBloc"],["matColumnDef","nombreTimbresBloc"],["matColumnDef","acquisTimbresBloc"],["matColumnDef","doublonTimbresBloc"],["matColumnDef","nombreCollector"],["matColumnDef","acquisCollector"],["matColumnDef","doublonCollector"],["matColumnDef","nombreTimbresCollector"],["matColumnDef","acquisTimbresCollector"],["matColumnDef","doublonTimbresCollector"],["mat-header-row","","class","bg-primary color-white",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","mat-row",3,"click",4,"matRowDef","matRowDefColumns"],["mat-footer-row","","class","bg-primary color-white",4,"matFooterRowDef","matFooterRowDefSticky"],["mat-header-cell","","mat-sort-header",""],[3,"object","key"],["mat-cell","",1,"primary50"],["mat-footer-cell",""],["mat-header-cell",""],["mat-cell",""],[1,"click",2,"font-size","1.2em",3,"type","icone","info"],["mat-cell","",3,"ngClass","matTooltip"],[4,"ngIf"],["mat-cell","",3,"ngClass"],["mat-header-row","",1,"bg-primary","color-white"],["mat-row","",1,"mat-row",3,"click"],["mat-footer-row","",1,"bg-primary","color-white"]],template:function(n,s){if(n&1&&(O(0,fh,1,1,"ng-template",1),R(1,"async"),O(2,A1,89,6,"ng-template",null,0,et)),n&2){let c=ye(3);T("ngIf",D(1,2,s.timbreResumeService.load$)==!1)("ngIfElse",c)}},dependencies:[dm,bm,hm,Sm,vm,_m,Im,Tm,Mm,xm,ym,Cm,Em,Bm,Am,So,Mo,St,Se,Yt,Et,Dt,Qt,Ln,Ae,em],styles:["th[_ngcontent-%COMP%], tr[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{text-align:center}th[_ngcontent-%COMP%]{width:40px!important;max-width:40px!important}.mat-row[_ngcontent-%COMP%]{padding:0!important;height:30px}.mat-row[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{width:40px!important}@media screen and (max-width: 800px){th[_ngcontent-%COMP%]{width:25px!important;max-width:25px!important}.mat-row[_ngcontent-%COMP%]{padding:0!important;height:15px}.mat-row[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{width:25px!important}th[_ngcontent-%COMP%], .mat-row[_ngcontent-%COMP%]{font-size:.8em}}"]})};var Gm=Yc(V_());function B1(o,r){if(o&1&&(v(0,"mat-option",7),w(1),R(2,"capitalize"),x()),o&2){let n=C().$implicit;T("value",n.value),h(),H(" ",D(2,2,n.value)," ")}}function w1(o,r){if(o&1&&(ie(0),O(1,B1,3,4,"mat-option",11),ne()),o&2){let n=r.$implicit,s=C(2);h(),T("ngIf",n.value!=s.TypeTimbreEnum.COLLECTOR)}}function R1(o,r){if(o&1&&(v(0,"mat-option",7),w(1),x()),o&2){let n=r.$implicit;T("value",n),h(),H(" ",n," ")}}function D1(o,r){if(o&1){let n=se();v(0,"div",1)(1,"div",2)(2,"mat-select",3),Pe("ngModelChange",function(c){W(n);let p=C();return qe(p.preferenceService.timbreCritereModel.type,c)||(p.preferenceService.timbreCritereModel.type=c),V(c)}),j("ngModelChange",function(){W(n);let c=C();return V(c.filtreByCritere())}),O(3,w1,2,1,"ng-container",4),R(4,"enumToArray"),x()(),v(5,"div",5)(6,"mat-select",6),Pe("ngModelChange",function(c){W(n);let p=C();return qe(p.preferenceService.timbreCritereModel.acquis,c)||(p.preferenceService.timbreCritereModel.acquis=c),V(c)}),j("ngModelChange",function(){W(n);let c=C();return V(c.filtreByCritere())}),v(7,"mat-option",7),w(8," Oui"),x(),v(9,"mat-option",7),w(10," Non"),x(),v(11,"mat-option",7),w(12," Tous"),x()()(),v(13,"div",5)(14,"mat-select",8),Pe("ngModelChange",function(c){W(n);let p=C();return qe(p.preferenceService.timbreCritereModel.doublon,c)||(p.preferenceService.timbreCritereModel.doublon=c),V(c)}),j("ngModelChange",function(){W(n);let c=C();return V(c.filtreByCritere())}),v(15,"mat-option",7),w(16," Oui"),x(),v(17,"mat-option",7),w(18," Non"),x(),v(19,"mat-option",7),w(20," Tous"),x()()(),v(21,"div",5)(22,"mat-select",9),Pe("ngModelChange",function(c){W(n);let p=C();return qe(p.preferenceService.timbreCritereModel.annees,c)||(p.preferenceService.timbreCritereModel.annees=c),V(c)}),j("ngModelChange",function(){W(n);let c=C();return V(c.filtreByCritere())}),O(23,R1,2,2,"mat-option",10),R(24,"async"),x()()()}if(o&2){let n=C();h(2),Ue("ngModel",n.preferenceService.timbreCritereModel.type),T("placeholder","Type"),h(),T("ngForOf",D(4,16,n.TypeTimbreEnum)),h(3),Ue("ngModel",n.preferenceService.timbreCritereModel.acquis),T("placeholder","Acquis"),h(),T("value","OUI"),h(2),T("value","NON"),h(2),T("value","TOUS"),h(3),Ue("ngModel",n.preferenceService.timbreCritereModel.doublon),T("placeholder","Doublon"),h(),T("value","OUI"),h(2),T("value","NON"),h(2),T("value","TOUS"),h(3),Ue("ngModel",n.preferenceService.timbreCritereModel.annees),T("placeholder","Ann\xE9es"),h(),T("ngForOf",D(24,18,n.annees$))}}var Po=class o{constructor(r,n,s,c){this.authService=r;this.timbreService=n;this.timbreUtilsService=s;this.preferenceService=c}modif=!0;annees$;TypeTimbreEnum=$t;ngOnInit(){this.annees$=this.timbreUtilsService.getAnneesAsync("/timbres")}filtreByCritere(){this.preferenceService.timbreCritereModel.getAcquis()=="NON"&&this.preferenceService.timbreCritereModel.setDoublon("TOUS"),this.preferenceService.modifier("timbreCritere",this.preferenceService.timbreCritereModel),this.recherche()}recherche(){I(this.preferenceService.timbreCritereModel.getAnnees())&&this.preferenceService.timbreCritereModel.getAnnees().length>0&&this.timbreService.getTimbres(this.preferenceService.timbreCritereModel,!1)}static \u0275fac=function(n){return new(n||o)($(Ve),$(Ne),$(Me),$(Jt))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-recherche"]],inputs:{modif:"modif"},decls:1,vars:1,consts:[["class","menuRecherche",4,"ngIf"],[1,"menuRecherche"],[1,"form-input","select",2,"width","120px"],["name","type","multiple","",1,"scrollBarAccent",3,"ngModelChange","ngModel","placeholder"],[4,"ngFor","ngForOf"],[1,"form-input","select",2,"width","100px"],["name","acquis",3,"ngModelChange","ngModel","placeholder"],[1,"selectMin",3,"value"],["name","doublon",1,"scrollBarAccent",3,"ngModelChange","ngModel","placeholder"],["name","anneeSelect","multiple","",3,"ngModelChange","ngModel","placeholder"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],["class","selectMin",3,"value",4,"ngIf"]],template:function(n,s){n&1&&O(0,D1,25,20,"div",0),n&2&&T("ngIf",s.modif)},dependencies:[Rt,wt,tt,Se,At,Bt,Ae,$n,Hn],styles:[".menuRecherche[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:left;width:100%}.menuRecherche[_ngcontent-%COMP%] > .form-input[_ngcontent-%COMP%]{margin:0 10px;display:flex;flex-direction:column;justify-content:space-between;align-items:stretch}@media screen and (max-width: 800px){.menuRecherche[_ngcontent-%COMP%] > .form-input[_ngcontent-%COMP%]{margin:5px 10px}}"]})};function L1(o,r){if(o&1&&(v(0,"div",3)(1,"span"),w(2,"Nombre de timbres : "),x(),v(3,"span",4),w(4),R(5,"async"),x()()),o&2){let n=C();h(4),Co(D(5,1,n.total$))}}var $o=class o{constructor(r){this.dialog=r}total$;FontAwesomeEnum=It;FontAwesomeTypeEnum=Mt;resume(){this.dialog.open(Uo,{height:"auto",maxHeight:"95vh",width:"1200px"})}static \u0275fac=function(n){return new(n||o)($(nt))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-total"]],inputs:{total$:"total$"},decls:4,vars:6,consts:[[1,"timbreTotal"],["class","nbTimbre",4,"ngIf"],[1,"accent","click",3,"click","icone","type","info"],[1,"nbTimbre"],[1,"bold"]],template:function(n,s){n&1&&(v(0,"div",0),O(1,L1,6,3,"div",1),R(2,"async"),v(3,"lib-icon",2),j("click",function(){return s.resume()}),x()()),n&2&&(h(),T("ngIf",D(2,4,s.total$)),h(2),T("icone",s.FontAwesomeEnum.CHART_LINE_UP)("type",s.FontAwesomeTypeEnum.TYPE_SOLID)("info","D\xE9tail par ann\xE9e"))},dependencies:[Se,Qt,Ae],styles:[".timbreTotal[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:start;align-content:center;gap:10px}.timbreTotal[_ngcontent-%COMP%]   .nbTimbre[_ngcontent-%COMP%]{font-size:1.2em;justify-content:start;align-content:center}.timbreTotal[_ngcontent-%COMP%]   lib-icon[_ngcontent-%COMP%]{font-size:1.5em}@media screen and (max-width: 800px){.timbreTotal[_ngcontent-%COMP%]{height:25px;gap:5px}.timbreTotal[_ngcontent-%COMP%]   .nbTimbre[_ngcontent-%COMP%]{font-size:1em}.timbreTotal[_ngcontent-%COMP%]   lib-icon[_ngcontent-%COMP%]{font-size:1.2em}}"]})};function F1(o,r){if(o&1){let n=se();v(0,"lib-icon",21),j("click",function(){W(n);let c=C().$implicit,p=C();return V(p.timbreService.acquisDoublon(c,!1))}),x()}if(o&2){let n,s,c,p=C().$implicit,b=C();T("classIcone",!(p==null||(n=p.getTimbreAcquisModel())==null)&&n.isAcquis()?"accent":"primary")("type",b.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",!(p==null||(s=p.getTimbreAcquisModel())==null)&&s.isAcquis()?b.FontAwesomeEnum.CIRCLE_MINUS:b.FontAwesomeEnum.CIRCLE_PLUS)("info",!(p==null||(c=p.getTimbreAcquisModel())==null)&&c.isAcquis()?"pas acquis":"acquis")}}function U1(o,r){if(o&1){let n=se();v(0,"lib-icon",21),j("click",function(){W(n);let c=C().$implicit,p=C();return V(p.timbreService.acquisDoublon(c,!0))}),x()}if(o&2){let n,s,c,p=C().$implicit,b=C();T("classIcone",!(p==null||(n=p.getTimbreAcquisModel())==null)&&n.isDoublon()?"accent900":"primary")("type",b.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",!(p==null||(s=p.getTimbreAcquisModel())==null)&&s.isDoublon()?b.FontAwesomeEnum.CIRCLE_MINUS:b.FontAwesomeEnum.CIRCLE_PLUS)("info",!(p==null||(c=p.getTimbreAcquisModel())==null)&&c.isDoublon()?"pas en double":"en double")}}function q1(o,r){if(o&1){let n=se();v(0,"lib-icon",22),j("click",function(){W(n);let c=C().$implicit,p=C();return V(p.timbreService.modifierDialog(c))}),x()}if(o&2){let n=C(2);T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.PENCIL)("info","Modifier")}}function P1(o,r){if(o&1){let n=se();v(0,"lib-icon",22),j("click",function(){W(n);let c=C().$implicit,p=C();return V(p.timbreService.supprimerDialog(c))}),x()}if(o&2){let n=C(2);T("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.TRASH)("info","Supprimer")}}function $1(o,r){if(o&1){let n=se();v(0,"img",23),j("click",function(){W(n);let c=C().$implicit,p=C();return V(p.utilsService.zoom(c==null?null:c.getImageZoom()))}),x()}if(o&2){let n=C().$implicit;T("src",n==null?null:n.getImage(),yn)}}function H1(o,r){if(o&1&&w(0),o&2){let n,s=C().$implicit;H(" ",s==null||(n=s.getTimbreBlocModel())==null?null:n.getAnnee()," ")}}function W1(o,r){if(o&1&&w(0),o&2){let n=C().$implicit;H(" ",n==null?null:n.getAnnee()," ")}}function V1(o,r){if(o&1){let n=se();v(0,"lib-icon",24),j("click",function(){let c;W(n);let p=C().$implicit,b=C();return V(b.utilsService.zoom(p==null||(c=p.getTimbreBlocModel())==null?null:c.getImageZoom()))}),x()}if(o&2){let n,s,c=C().$implicit,p=C();T("classIcone",!(c==null||(n=c.getTimbreBlocModel())==null||(n=n.getTimbreBlocAcquisModel())==null)&&n.isDoublon()?"accent900":!(c==null||(n=c.getTimbreBlocModel())==null||(n=n.getTimbreBlocAcquisModel())==null)&&n.isAcquis()?"accent":"primary")("type",p.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",p.FontAwesomeEnum.IMAGE_POLAROID)("classInfo","imageHoverBloc")("info","<img src='"+(c==null||(s=c.getTimbreBlocModel())==null?null:s.getImageZoom())+"'/>")}}function G1(o,r){if(o&1&&G(0,"lib-icon",25),o&2){let n=C().$implicit,s=C();T("classIcone","primary")("type",s.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",s.FontAwesomeEnum.CIRCLE_INFO)("info",n==null?null:n.getYt())}}function k1(o,r){if(o&1&&(v(0,"div",8)(1,"div",9)(2,"div",10),O(3,F1,1,4,"lib-icon",11),R(4,"async"),O(5,U1,1,4,"lib-icon",11),R(6,"async"),x(),v(7,"div",12),O(8,q1,1,3,"lib-icon",13),R(9,"async"),O(10,P1,1,3,"lib-icon",13),R(11,"async"),x()(),v(12,"div",14),O(13,$1,1,1,"img",15),x(),v(14,"div",16),O(15,H1,1,1,"ng-template",17)(16,W1,1,1,"ng-template",null,0,et),v(18,"div",18),O(19,V1,1,5,"lib-icon",19)(20,G1,1,4,"lib-icon",20),x()()()),o&2){let n,s,c,p,b,y=r.$implicit,L=ye(17),U=C();T("ngClass",!(y==null||(n=y.getTimbreAcquisModel())==null)&&n.isDoublon()?"border-accent900 bg-accentA400":!(y==null||(n=y.getTimbreAcquisModel())==null)&&n.isAcquis()?"border-accent bg-accentA200":"border-primary"),h(3),T("ngIf",((s=D(4,10,U.authService.user$))==null?null:s.getDroit())>=U.DroitEnum.PARTIEL),h(2),T("ngIf",((c=D(6,12,U.authService.user$))==null?null:c.getDroit())==U.DroitEnum.TOTAL),h(3),T("ngIf",((p=D(9,14,U.authService.user$))==null?null:p.getDroit())==U.DroitEnum.TOTAL),h(2),T("ngIf",((b=D(11,16,U.authService.user$))==null?null:b.getDroit())==U.DroitEnum.TOTAL),h(3),T("ngIf",y==null?null:y.getImage()),h(2),T("ngIf",y==null?null:y.getIdBloc())("ngIfElse",L),h(4),T("ngIf",y==null?null:y.getIdBloc()),h(),T("ngIf",y==null?null:y.getYt())}}var Ho=class o{constructor(r,n,s,c){this.authService=r;this.timbreService=n;this.timbreUtilsService=s;this.utilsService=c}timbres$;load$;total$;modif=!0;timbre=new Ot;annees$;DroitEnum=tn;FontAwesomeEnum=It;FontAwesomeTypeEnum=Mt;ngOnInit(){this.annees$=this.timbreUtilsService.getAnneesAsync("/timbres"),this.timbre.setTimbreAcquisModel(new Ke)}static \u0275fac=function(n){return new(n||o)($(Ve),$(Ne),$(Me),$(rt))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-resultat"]],inputs:{timbres$:"timbres$",load$:"load$",total$:"total$",modif:"modif"},decls:10,vars:12,consts:[["noBloc",""],[1,"responsiveDirection","responsiveMenu"],[3,"total$"],[3,"modif"],[1,"spinner",3,"fxHide","textSpec"],[3,"fxHide"],[1,"listeTimbre","primary"],["class","detailTimbre",3,"ngClass",4,"ngFor","ngForOf"],[1,"detailTimbre",3,"ngClass"],[1,"headerTimbre"],[1,"actionTimbre"],["class","click",3,"classIcone","type","icone","info","click",4,"ngIf"],[1,"actionTimbre2"],["class","primary click",3,"type","icone","info","click",4,"ngIf"],[1,"imgTimbre"],["class","image zoomIn",3,"src","click",4,"ngIf"],[1,"footerTimbre"],[3,"ngIf","ngIfElse"],[1,"infoTimbre"],["class","click",3,"classIcone","type","icone","classInfo","info","click",4,"ngIf"],["class","click",3,"classIcone","type","icone","info",4,"ngIf"],[1,"click",3,"click","classIcone","type","icone","info"],[1,"primary","click",3,"click","type","icone","info"],[1,"image","zoomIn",3,"click","src"],[1,"click",3,"click","classIcone","type","icone","classInfo","info"],[1,"click",3,"classIcone","type","icone","info"]],template:function(n,s){n&1&&(v(0,"div",1),G(1,"app-timbre-total",2)(2,"app-timbre-recherche",3),x(),G(3,"lib-spinner",4),R(4,"async"),v(5,"section",5),R(6,"async"),v(7,"div",6),O(8,k1,21,18,"div",7),R(9,"async"),x()()),n&2&&(h(),T("total$",s.total$),h(),T("modif",s.modif),h(),T("fxHide",D(4,6,s.load$)==!0)("textSpec","Chargement en cours ..."),h(2),T("fxHide",D(6,8,s.load$)==!1),h(3),T("ngForOf",D(9,10,s.timbres$)))},dependencies:[St,tt,Se,yo,Et,Dt,Qt,Po,$o,Ae],styles:[".spinner[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;align-items:stretch;flex:100%;height:100%}.listeTimbre[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:left;width:100%}.listeTimbre[_ngcontent-%COMP%]   lib-icon[_ngcontent-%COMP%]{font-size:1.2em}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]{margin:10px;width:115px;height:150px;border-radius:10px;border:1px solid;padding:5px 10px;display:flex;flex-direction:column;justify-content:space-between;align-items:stretch}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .headerTimbre[_ngcontent-%COMP%]{height:25px;display:flex;flex-direction:row;justify-content:space-between;align-items:end;width:100%;padding-bottom:5px}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .headerTimbre[_ngcontent-%COMP%]   .actionTimbre[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:start;gap:5px}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .headerTimbre[_ngcontent-%COMP%]   .actionTimbre2[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:end;gap:5px}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .imgTimbre[_ngcontent-%COMP%]{width:100%;display:flex;flex:auto;justify-content:center;align-items:center}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .imgTimbre[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100px;max-height:100px}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .footerTimbre[_ngcontent-%COMP%]{height:25px;display:flex;flex-direction:row;justify-content:space-between;align-items:end;width:100%}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .footerTimbre[_ngcontent-%COMP%]   .infoTimbre[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:end;align-items:end;gap:5px}@media screen and (max-width: 800px){.listeTimbre[_ngcontent-%COMP%]{justify-content:space-evenly}}"]})};function z1(o,r){if(o&1&&(G(0,"lib-spinner",5),R(1,"async")),o&2){let n=C();T("textSpec",D(1,1,n.messageLoad$))}}function Y1(o,r){if(o&1&&(G(0,"mat-error",16),R(1,"async")),o&2){let n=C(2);T("innerHTML",D(1,1,n.messageError$),Cn)}}function K1(o,r){if(o&1&&G(0,"app-timbre-resultat",17),o&2){let n=C(2);T("load$",n.load$)("timbres$",n.timbres$)("modif",!1)}}function Z1(o,r){if(o&1&&(v(0,"mat-option",21),w(1),x()),o&2){let n=r.$implicit;T("value",n),h(),H(" ",n," ")}}function Q1(o,r){if(o&1){let n=se();v(0,"div",18)(1,"mat-select",19),Pe("ngModelChange",function(c){W(n);let p=C(2);return qe(p.annees,c)||(p.annees=c),V(c)}),O(2,Z1,2,2,"mat-option",20),x()()}if(o&2){let n=C(2);h(),Ue("ngModel",n.annees),T("placeholder","Ann\xE9es"),h(),T("ngForOf",n.anneesDispo)}}function J1(o,r){o&1&&(v(0,"button",22),w(1," Enregistrer "),x())}function X1(o,r){if(o&1){let n=se();v(0,"form",6,1),j("ngSubmit",function(){W(n);let c=ye(1),p=C();return V(p.valider(c))}),v(2,"div",7),O(3,Y1,2,3,"mat-error",8),R(4,"async"),O(5,K1,1,3,"app-timbre-resultat",9),R(6,"async"),x(),v(7,"div",10),O(8,Q1,3,3,"div",11),R(9,"async"),R(10,"async"),v(11,"button",12),j("click",function(){W(n);let c=C();return V(c.close())}),w(12," Annuler "),x(),v(13,"input",13),j("change",function(c){W(n);let p=C();return V(p.onFileChange(c))}),x(),v(14,"button",14),j("click",function(){W(n);let c=C();return V(c.triggerFileInput())}),w(15," Choisir un fichier "),x(),O(16,J1,2,0,"button",15),R(17,"async"),x()()}if(o&2){let n,s,c,p=ye(1),b=C();T("ngClass",p!=null&&p.submitted?"red-color":"blue-color"),h(3),T("ngIf",D(4,6,b.messageError$)),h(2),T("ngIf",((n=D(6,8,b.timbres$))==null?null:n.length)>0),h(3),T("ngIf",!D(9,10,b.timbres$)||((s=D(10,12,b.timbres$))==null?null:s.length)==0),h(5),xo("id",b.idFile),h(3),T("ngIf",((c=D(17,14,b.timbres$))==null?null:c.length)>0)}}var Wo=class o{constructor(r,n,s,c,p,b,y){this.authService=r;this.timbreService=n;this.timbreBlocService=s;this.timbreUtilsService=c;this.uploadService=p;this.utilsService=b;this.dialogRef=y}dossier="/assets/images/timbres/";timbres$=new _e(null);messageError$=new _e(null);messageLoad$=new _e("Chargement en cours ...");load$=new _e(null);idFile="fileImport";identTimbre=1;identBloc=1;timbresModel=[];timbresBlocsModel=[];anneesDispo=[];annees=[new Date().getFullYear()];ngOnInit(){for(let r=new Date().getFullYear();r>=1900;r--)this.anneesDispo.push(r)}triggerFileInput(){document.getElementById(this.idFile).click()}onFileChange(r){let n=r.target.files[0];n&&(this.load$.next(!1),this.messageLoad$.next("Chargement en cours ..."),this.saveCsv(n))}saveCsv(r){let n=new FileReader;n.onload=()=>{let s=n.result;this.parseCsv(s)},n.readAsText(r)}parseCsv(r){I(this.annees)&&this.annees.length>0&&Re([this.utilsService.getMaxIdentAsync("/timbres"),this.utilsService.getMaxIdentAsync("/timbres_bloc"),this.authService.userSelect$]).pipe(q(([n,s,c])=>I(c))).subscribe(([n,s,c])=>{this.identTimbre=n,this.identBloc=s,this.timbresModel=[],this.timbres$.next(null),Gm.parse(r,{header:!0,skipEmptyLines:!0,complete:p=>{I(p.data)&&p.data?.length>0&&(this.timbresBlocsModel=[],p.data.forEach((b,y)=>{let L=this.setTimbre(b,c);I(L?.getId())&&(this.timbresModel.push(L),this.identTimbre++),y==p.data.length-1&&(this.timbres$.next(this.timbresModel),this.load$.next(!0))}))},error:p=>{console.error("Erreur lors du parsing du CSV :",p)}})})}setTimbre(r,n){let s=new Ot,c=r.CODE!="NULL"&&r.CODE!=""?Number(r.CODE):null,p=r.IDENT_BLOC!="NULL"&&r.IDENT_BLOC!=""&&I(r.IDENT_BLOC)?Number(r.IDENT_BLOC):null,b=r.ANNEE!="NULL"&&r.ANNEE!=""?Number(r.ANNEE):null,y=r.MONNAIE!="NULL"&&r.MONNAIE!=""?r.MONNAIE:null;if(this.annees.includes(b)){s.setId(this.identTimbre),s.setType(r.TYPE!="NULL"&&r.TYPE!=""?r.TYPE:null),s.setYt(r.YT!="NULL"&&r.YT!=""?r.YT:null),s.setAnnee(b);let L=new Ke;L.setIdTimbre(s.getId()),L.setIdUser(n.getId()),L.setAcquis(r.ACQUIS=="1"),L.setDoublon(r.DOUBLON=="1"),s.setTimbreAcquisModel(L);let U=this.dossier+b+"/",de="";if(I(p)){if(U+="bloc/"+p,de=U+".png",U+="-",s.setTimbreBlocModel(this.timbresBlocsModel.find(ce=>ce.getAnnee()==b&&ce.idOrigine==p)),Le(s.getTimbreBlocModel())){let ce=new Hi;ce.setId(this.identBloc),ce.setAnnee(b),ce.setMonnaie(y),ce.setType(r.CARNET=="1"?"CARNET":"BLOC"),ce.idOrigine=p;let ot=new dt;ot.setIdBloc(this.identBloc),ot.setIdUser(n.getId()),ot.setAcquis(r.ACQUIS_BLOC=="1"),ot.setDoublon(r.DOUBLON_BLOC=="1"),ce.setTimbreBlocAcquisModel(ot),this.uploadService.checkIfImageExists(de).pipe(q()).subscribe(ni=>{ni&&(ce.setImage(de),ce.setImageTable(de),ce.setImageZoom(de))}),this.timbresBlocsModel.push(ce),s.setTimbreBlocModel(ce),this.identBloc++}s.setIdBloc(s.getTimbreBlocModel()?.getId())}else s.setMonnaie(y);U+=c+".png",this.uploadService.checkIfImageExists(U).pipe(q()).subscribe(ce=>{ce&&(s.setImage(U),s.setImageTable(U),s.setImageZoom(U))})}return s}valider(r){this.messageError$.next(null),r?.valid&&(this.load$.next(!1),this.messageLoad$.next("Import en cours ..."),I(this.timbresBlocsModel)&&this.timbresBlocsModel?.length>0&&this.timbresBlocsModel.forEach((n,s)=>{this.saveBloc(n)}),this.timbres$.pipe(q()).subscribe(n=>{if(I(n)&&n?.length>0)n.forEach((s,c)=>{this.saveTimbre(s,c==n.length-1)});else{this.messageError$.next("Donn\xE9es incorrectes");return}}))}saveBloc(r){Re([this.timbreBlocService.upload(r,"autre"),this.timbreBlocService.upload(r,"table"),this.timbreBlocService.upload(r,"zoom")]).pipe(Ri(([n,s,c])=>I(n)&&I(s)&&I(c)),Di(1)).subscribe(([n,s,c])=>{this.timbreUtilsService.isValidImage(n)&&r.setImage(n),this.timbreUtilsService.isValidImage(s)&&r.setImageTable(s),this.timbreUtilsService.isValidImage(c)&&r.setImageZoom(c),r?.getTimbreBlocAcquisModel()?.isAcquis()&&this.timbreUtilsService.addAcquisBloc(r?.getTimbreBlocAcquisModel()?.getIdUser(),r,r?.getTimbreBlocAcquisModel()?.isDoublon()),this.timbreBlocService.ajouter(r,!1)})}saveTimbre(r,n){Re([this.timbreService.upload(r,"autre"),this.timbreService.upload(r,"table"),this.timbreService.upload(r,"zoom")]).pipe(Ri(([s,c,p])=>I(s)&&I(c)&&I(p)),Di(1)).subscribe(([s,c,p])=>{this.timbreUtilsService.isValidImage(s)&&r.setImage(s),this.timbreUtilsService.isValidImage(c)&&r.setImageTable(c),this.timbreUtilsService.isValidImage(p)&&r.setImageZoom(p),r?.getTimbreAcquisModel()?.isAcquis()&&this.timbreUtilsService.addAcquis(r?.getTimbreAcquisModel()?.getIdUser(),r,r?.getTimbreAcquisModel()?.isDoublon()),this.timbreService.ajouter(r,n),n&&(this.load$.next(!0),this.close())})}close(){this.dialogRef.close()}static \u0275fac=function(n){return new(n||o)($(Ve),$(Ne),$(Ge),$(Me),$(Un),$(rt),$(Zt))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-importer"]],decls:8,vars:4,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","start stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","column","fxLayoutGap","20px",1,"bloc-modal"],[3,"innerHTML",4,"ngIf"],[3,"load$","timbres$","modif",4,"ngIf"],["fxLayout","row","fxLayoutGap","20px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["fxLayout","row","fxLayoutAlign","end center","class","form-input select noError","style","width: 100px",4,"ngIf"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","file","accept",".xls, .xlsx, .csv","hidden","","required","",3,"change","id"],["type","button","mat-raised-button","","color","accent",1,"rounded","large","color-white",3,"click"],["type","submit","class","rounded large color-white","mat-raised-button","","color","accent",4,"ngIf"],[3,"innerHTML"],[3,"load$","timbres$","modif"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input","select","noError",2,"width","100px"],["name","anneeSelect","multiple","",3,"ngModelChange","ngModel","placeholder"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],[1,"selectMin",3,"value"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"]],template:function(n,s){if(n&1&&(v(0,"div",2)(1,"div",3)(2,"span"),w(3,"TIMBRE IMPORTER"),x()(),O(4,z1,2,3,"ng-template",4),R(5,"async"),O(6,X1,18,16,"ng-template",null,0,et),x()),n&2){let c=ye(7);h(4),T("ngIf",D(5,2,s.load$)==!1)("ngIfElse",c)}},dependencies:[it,Dn,Rt,wt,St,tt,Se,zt,Fi,Kt,Yt,Ui,Et,$i,At,qi,Bt,Pi,Dt,Ho,Ae]})};function tT(o,r){o&1&&G(0,"lib-spinner",5),o&2&&T("textSpec","Suppression en cours")}function iT(o,r){if(o&1){let n=se();v(0,"form",6,1),j("ngSubmit",function(){W(n);let c=ye(1),p=C();return V(p.valider(c))}),v(2,"div",7)(3,"div",8)(4,"input",9),Pe("ngModelChange",function(c){W(n);let p=C();return qe(p.annee,c)||(p.annee=c),V(c)}),x()(),v(5,"button",10),j("click",function(){W(n);let c=C();return V(c.close())}),w(6," Annuler "),x(),v(7,"button",11),w(8," Supprimer "),x()()()}if(o&2){let n=ye(1),s=C();T("ngClass",n!=null&&n.submitted?"red-color":"blue-color"),h(4),Ue("ngModel",s.annee),T("max",s.maxAnnee)("zMax",s.maxAnnee)}}var Vo=class o{constructor(r,n,s){this.dialog=r;this.dialogRef=n;this.timbreSupprimService=s}maxAnnee=new Date().getFullYear();annee=new Date().getFullYear();valider(r){if(r?.valid){let n=this.dialog.open(Ti,{maxHeight:"95vh",data:{titre:"Confirmation",message:"Souhaitez-vous supprimer les timbres ?",btnDroite:"Oui",btnGauche:"Non"}});n.afterClosed().subscribe(()=>{n.componentInstance.data.resultat==="valider"&&(this.timbreSupprimService.loadGlob$.next(!1),this.timbreSupprimService.supprimerTimbres(this.annee),this.timbreSupprimService.load$.pipe(q(s=>s==!0)).subscribe(s=>{this.timbreSupprimService.supprimerBlocs(this.annee),this.timbreSupprimService.load$.pipe(q(c=>c==!0)).subscribe(c=>{this.timbreSupprimService.loadGlob$.next(!0)})}))})}}close(){this.dialogRef.close()}static \u0275fac=function(n){return new(n||o)($(nt),$(Zt),$(Bo))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-supprim-choix-annee"]],decls:8,vars:4,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","start stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","row","fxLayoutGap","20px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["fxLayout","column","fxFlex","20","fxLayoutAlign","end end",1,"form-input","noError"],["name","annee","type","number","minlength","4","maxlength","4","min","1900","zMin","1900","required","","zControl","",2,"width","60px !important",3,"ngModelChange","ngModel","max","zMax"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"]],template:function(n,s){if(n&1&&(v(0,"div",2)(1,"div",3)(2,"span"),w(3,"TIMBRE IMPORTER"),x()(),O(4,tT,1,1,"ng-template",4),R(5,"async"),O(6,iT,9,4,"ng-template",null,0,et),x()),n&2){let c=ye(7);h(4),T("ngIf",D(5,2,s.timbreSupprimService.loadGlob$)==!1)("ngIfElse",c)}},dependencies:[it,St,Se,zt,Fi,Kt,Yt,Ui,Et,$i,Mn,In,At,qi,Bn,wn,Rn,An,En,Bt,Pi,Dt,On,Nn,Fn,Ae],encapsulation:2})};var nT=o=>[o];function rT(o,r){if(o&1){let n=se();v(0,"lib-icon",2),j("click",function(){W(n);let c=C();return V(c.supprimer())}),x()}if(o&2){let n=C();T("icone",n.FontAwesomeEnum.ROTATE)("type",n.FontAwesomeTypeEnum.TYPE_SOLID)("attribs",br(4,nT,n.FontAwesomeAttributEnum.SPIN))("info","Supprimer en cours")}}function oT(o,r){if(o&1){let n=se();v(0,"lib-icon",3),j("click",function(){W(n);let c=C();return V(c.supprimer())}),x()}if(o&2){let n=C();T("icone",n.FontAwesomeEnum.TRASH)("type",n.FontAwesomeTypeEnum.TYPE_SOLID)("info","Supprimer les timbres")}}var Go=class o{constructor(r,n){this.dialog=r;this.timbreSupprimService=n}FontAwesomeEnum=It;FontAwesomeTypeEnum=Mt;FontAwesomeAttributEnum=nm;supprimer(){this.dialog.open(Vo,{maxHeight:"50vh",width:"300px"})}static \u0275fac=function(n){return new(n||o)($(nt),$(Bo))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-supprim"]],decls:4,vars:6,consts:[["class","warn click","style","font-size: 2em",3,"icone","type","attribs","info","click",4,"ngIf"],["class","warn click","style","font-size: 2em",3,"icone","type","info","click",4,"ngIf"],[1,"warn","click",2,"font-size","2em",3,"click","icone","type","attribs","info"],[1,"warn","click",2,"font-size","2em",3,"click","icone","type","info"]],template:function(n,s){n&1&&(O(0,rT,1,6,"lib-icon",0),R(1,"async"),O(2,oT,1,3,"lib-icon",1),R(3,"async")),n&2&&(T("ngIf",D(1,2,s.timbreSupprimService.loadGlob$)==!1),h(2),T("ngIf",D(3,4,s.timbreSupprimService.loadGlob$)==!0))},dependencies:[Se,Qt,Ae],encapsulation:2})};function sT(o,r){if(o&1){let n=se();v(0,"button",9),j("click",function(){W(n);let c=C(2);return V(c.ajouter())}),w(1," Ajouter "),x()}}function aT(o,r){o&1&&(ie(0),w(1,"\xA0Bloc"),ne())}function cT(o,r){if(o&1){let n=se();ie(0),O(1,sT,2,0,"button",8),R(2,"async"),v(3,"button",9),j("click",function(){W(n);let c=C();return V(c.ajouterBloc())}),w(4," Ajouter "),O(5,aT,2,0,"ng-container",3),R(6,"async"),x(),ne()}if(o&2){let n=C();h(),T("ngIf",D(2,2,n.headerService.route$)==n.RouteEnum.TIMBRE),h(4),T("ngIf",D(6,4,n.headerService.route$)==n.RouteEnum.TIMBRE)}}function mT(o,r){if(o&1){let n=se();ie(0),v(1,"lib-icon",11),j("click",function(){let c=W(n).$implicit,p=C(2);return V(p.headerService.setRoute(c.getRoute()))}),x(),ne()}if(o&2){let n=r.$implicit;h(),T("icone",n==null?null:n.getIcone())("type",n==null?null:n.getType())("info",n==null?null:n.getInfo())}}function uT(o,r){if(o&1&&(ie(0),O(1,mT,2,3,"ng-container",10),R(2,"async"),ne()),o&2){let n=C();h(),T("ngForOf",D(2,1,n.headerService.choixRoutesTimbre$))}}function pT(o,r){if(o&1){let n=se();v(0,"lib-icon",13),j("click",function(){W(n);let c=C(2);return V(c.headerService.mode=c.ModeEnum.TABLE)}),x()}if(o&2){let n=C(2);T("icone",n.FontAwesomeEnum.TABLE)("type",n.FontAwesomeTypeEnum.TYPE_SOLID)("info","Mode tableau")}}function fT(o,r){if(o&1){let n=se();v(0,"lib-icon",13),j("click",function(){W(n);let c=C(2);return V(c.headerService.mode=c.ModeEnum.GRAPH)}),x()}if(o&2){let n=C(2);T("icone",n.FontAwesomeEnum.MEMO)("type",n.FontAwesomeTypeEnum.TYPE_SOLID)("info","Mode tableau")}}function dT(o,r){if(o&1&&(ie(0),O(1,pT,1,3,"ng-template",12)(2,fT,1,3,"ng-template",null,0,et),ne()),o&2){let n=ye(3),s=C();h(),T("ngIf",s.headerService.mode==s.ModeEnum.GRAPH)("ngIfElse",n)}}function gT(o,r){if(o&1){let n=se();v(0,"lib-icon",14),j("click",function(){W(n);let c=C();return V(c.importer())}),x()}if(o&2){let n=C();T("icone",n.FontAwesomeEnum.UPLOAD)("type",n.FontAwesomeTypeEnum.TYPE_SOLID)("info","Importer les timbres")}}function bT(o,r){o&1&&G(0,"app-timbre-supprim",15)}function _T(o,r){if(o&1&&(v(0,"mat-option",19),w(1),x()),o&2){let n=r.$implicit;T("value",n),h(),H(" ",n==null?null:n.getPrenom()," ")}}function hT(o,r){if(o&1){let n=se();v(0,"div",16)(1,"mat-select",17),R(2,"async"),j("ngModelChange",function(c){W(n);let p=C();return V(p.setUser(c))}),O(3,_T,2,2,"mat-option",18),R(4,"async"),x()()}if(o&2){let n=C();h(),T("ngModel",D(2,3,n.authService.userSelect$))("placeholder","Utilisateur"),h(2),T("ngForOf",D(4,5,n.authService.users$))}}var km=class o{constructor(r,n,s,c,p,b,y){this.preferenceService=r;this.authService=n;this.headerService=s;this.timbreService=c;this.timbreBlocService=p;this.timbreUtilsService=b;this.dialog=y;this.verifRoute()}FontAwesomeEnum=It;RouteEnum=im;FontAwesomeTypeEnum=Mt;DroitEnum=tn;ModeEnum=rm;ajouter(){let r=this.dialog.open(qn,{maxHeight:"95vh",width:"30%",minWidth:"300px"});r.afterClosed().subscribe(()=>{r.close()})}ajouterBloc(){let r=this.dialog.open(Wn,{maxHeight:"95vh",width:"30%",minWidth:"300px"});r.afterClosed().subscribe(()=>{r.close()})}ajouterBouchon(){this.timbreService.ajouterSansId(this.timbreService.getBouchon())}importer(){let r=this.dialog.open(Wo,{height:"90vh",width:"70%",minWidth:"300px"});r.afterClosed().subscribe(()=>{r.close()})}verifRoute(){window.location.href.indexOf("bloc")>0?this.preferenceService.getTimbreCritere("blocCritere").pipe(q()).subscribe(r=>{I(r.getAnnees())&&r.getAnnees().length>0?this.timbreBlocService.getBlocs(r,!0):this.timbreUtilsService.getAnneesAsync("/timbres_bloc").pipe(q(n=>I(n)&&n?.length>0)).subscribe(n=>{r.initCritere(),r.setAcquis("NON"),r.setAnnees([n[0]]),this.preferenceService.timbreCritereBlocModel=r,this.preferenceService.modifier("blocCritere",r),this.timbreBlocService.getBlocs(r,!0)})}):this.preferenceService.getTimbreCritere("timbreCritere").pipe(q()).subscribe(r=>{I(r.getAnnees())&&r.getAnnees().length>0?this.timbreService.getTimbres(r,!0):this.timbreUtilsService.getAnneesAsync("/timbres").pipe(q(n=>I(n)&&n?.length>0)).subscribe(n=>{r.initCritere(),r.setAcquis("NON"),r.setAnnees([n[0]]),this.preferenceService.timbreCritereModel=r,this.preferenceService.modifier("timbreCritere",r),this.timbreService.getTimbres(r,!0)})})}setUser(r){this.authService.userSelect$.next(r),this.verifRoute(),this.timbreUtilsService.reinitResume$.next(!0)}static \u0275fac=function(n){return new(n||o)($(Jt),$(Ve),$(om),$(Ne),$(Ge),$(Me),$(nt))};static \u0275cmp=Ce({type:o,selectors:[["app-menu"]],decls:22,vars:32,consts:[["modeTable",""],[1,"menu"],[1,"sousMenu","sousMenuBouton"],[4,"ngIf"],[1,"sousMenu"],["class","accent click hide-on-mobile","style","font-size: 2em",3,"icone","type","info","click",4,"ngIf"],["class","hide-on-mobile",4,"ngIf"],["fxLayout","row","fxLayoutAlign","end center","class","form-input select","style","width: 120px",4,"ngIf"],["class","rounded large color-white","mat-raised-button","","color","primary",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],[4,"ngFor","ngForOf"],[1,"primary","click",2,"font-size","2em",3,"click","icone","type","info"],[3,"ngIf","ngIfElse"],[1,"primary","click","hide-on-mobile",2,"font-size","2em",3,"click","icone","type","info"],[1,"accent","click","hide-on-mobile",2,"font-size","2em",3,"click","icone","type","info"],[1,"hide-on-mobile"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input","select",2,"width","120px"],["name","user",1,"scrollBarAccent",3,"ngModelChange","ngModel","placeholder"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],[1,"selectMin",3,"value"]],template:function(n,s){if(n&1&&(v(0,"div",1)(1,"div",2),O(2,cT,7,6,"ng-container",3),R(3,"async"),x(),v(4,"div",4),O(5,uT,3,3,"ng-container",3),R(6,"async"),O(7,dT,4,2,"ng-container",3),R(8,"async"),R(9,"async"),R(10,"async"),R(11,"async"),O(12,gT,1,3,"lib-icon",5),R(13,"async"),R(14,"async"),O(15,bT,1,0,"app-timbre-supprim",6),R(16,"async"),R(17,"async"),O(18,hT,5,7,"div",7),R(19,"async"),R(20,"async"),R(21,"async"),x()()),n&2){let c,p,b,y,L,U;h(2),T("ngIf",((c=D(3,6,s.authService.user$))==null?null:c.getDroit())==s.DroitEnum.TOTAL),h(3),T("ngIf",((p=D(6,8,s.headerService.choixRoutesTimbre$))==null?null:p.length)>0),h(2),T("ngIf",(((b=D(8,10,s.authService.user$))==null?null:b.getDroit())==s.DroitEnum.TOTAL||((b=D(9,12,s.authService.user$))==null?null:b.getDroit())==s.DroitEnum.CONSULT_TOTAL)&&(D(10,14,s.headerService.route$)==s.RouteEnum.TIMBRE||D(11,16,s.headerService.route$)==s.RouteEnum.BLOC)),h(5),T("ngIf",((y=D(13,18,s.authService.user$))==null?null:y.getDroit())==s.DroitEnum.TOTAL&&D(14,20,s.headerService.route$)==s.RouteEnum.TIMBRE),h(3),T("ngIf",((L=D(16,22,s.authService.user$))==null?null:L.getDroit())==s.DroitEnum.TOTAL&&D(17,24,s.headerService.route$)==s.RouteEnum.TIMBRE),h(3),T("ngIf",(((U=D(19,26,s.authService.user$))==null?null:U.getDroit())==s.DroitEnum.TOTAL||((U=D(20,28,s.authService.user$))==null?null:U.getDroit())==s.DroitEnum.CONSULT_TOTAL)&&((U=D(21,30,s.authService.users$))==null?null:U.length)>0)}},dependencies:[tt,Se,zt,Kt,At,Bt,Qt,it,Go,wt,Rt,Ae],styles:[".menu[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:10px;padding:0 5px}.menu[_ngcontent-%COMP%]   .sousMenu[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:15px}@media screen and (max-width: 800px){.menu[_ngcontent-%COMP%]{flex-direction:column}.menu[_ngcontent-%COMP%]   .sousMenuBouton[_ngcontent-%COMP%]{justify-content:space-between}.menu[_ngcontent-%COMP%]   .sousMenu[_ngcontent-%COMP%]{gap:10px}}"]})};export{dt as a,Ke as b,Me as c,$n as d,Hn as e,Ge as f,Ne as g,Po as h,Fo as i,Uo as j,$o as k,Ho as l,Wo as m,km as n,Wm as o};

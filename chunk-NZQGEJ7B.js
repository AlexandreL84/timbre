import{l,m as I,n as p,s as O,u as L}from"./chunk-UWEOJGZJ.js";import{H as S,K as d,c as h,k as c,l as U,nb as m,ob as T,x as b}from"./chunk-XASVH4YM.js";import{g as o}from"./chunk-GOLCFQAC.js";var v=(t=>(t[t.CONSULT=0]="CONSULT",t[t.CONSULT_TOTAL=1]="CONSULT_TOTAL",t[t.PARTIEL=9]="PARTIEL",t[t.TOTAL=10]="TOTAL",t))(v||{});var s=class extends I{id;nom;prenom;droit;constructor(e,r,i,t){super(),this.id=e||null,this.nom=r||null,this.prenom=i||null,this.droit=t||null}getId(){return this.id}setId(e){this.id=e}getNom(){return this.nom}setNom(e){this.nom=e}getPrenom(){return this.prenom}setPrenom(e){this.prenom=e}getDroit(){return this.droit}setDroit(e){this.droit=e}};o([l("Identifiant")],s.prototype,"id",2),o([l("Nom")],s.prototype,"nom",2),o([l("Pr\xE9nom")],s.prototype,"prenom",2),o([l("Droit")],s.prototype,"droit",2);var x=class u{constructor(e,r){this.afAuth=e;this.firestore=r}user$=new h(null);userSelect$=new h(null);users$=new h(null);signIn(e,r){return this.afAuth.signInWithEmailAndPassword(e,r)}signUp(e,r){return this.afAuth.createUserWithEmailAndPassword(e,r)}signOut(){return this.user$.next(null),this.userSelect$.next(null),this.afAuth.signOut()}getCurrentUser(){return this.afAuth.authState}getUser(){let e=this.firestore.collection("/user").valueChanges();return U([this.afAuth.authState,e,this.user$]).pipe(c(([r,i,t])=>{if(console.log(t),m(t))return t;{let a=i.find(n=>n.id==r?.uid);if(m(a)){let n=p(s,a);return this.user$.next(n),n?.getDroit()==10||n?.getDroit()==1?this.getUsers(9).pipe(b(f=>m(f))).subscribe(f=>{let A=f.find(g=>g.getId()==n.getId());A?this.userSelect$.next(A):this.userSelect$.next(f.find(g=>g.getNom()=="LEFAIX"))}):this.userSelect$.next(n),n}return null}}))}getUsers(e){return this.users$.next(null),T(e)&&(e=0),this.firestore.collection("/user",r=>{let i=r;return i=i.where("droit",">=",e),i}).valueChanges().pipe(c(r=>{let i=[];return r?.length>0&&r.forEach(t=>{let a=p(s,t);i.push(a)}),this.users$.next(i),i}))}static \u0275fac=function(r){return new(r||u)(d(O),d(L))};static \u0275prov=S({token:u,factory:u.\u0275fac,providedIn:"root"})};export{v as a,x as b};

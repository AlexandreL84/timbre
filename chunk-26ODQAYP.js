import{bb as m,c as h,cb as T,f as g,g as U,gb as u,hb as I,ib as p,l as b,nb as O,p as S,pb as L,s as d}from"./chunk-JRN57LZL.js";import{i as o}from"./chunk-GV7GV3NK.js";var s=class extends I{id;nom;prenom;droit;constructor(e,t,i,r){super(),this.id=e||null,this.nom=t||null,this.prenom=i||null,this.droit=r||null}getId(){return this.id}setId(e){this.id=e}getNom(){return this.nom}setNom(e){this.nom=e}getPrenom(){return this.prenom}setPrenom(e){this.prenom=e}getDroit(){return this.droit}setDroit(e){this.droit=e}};o([u("Identifiant")],s.prototype,"id",2),o([u("Nom")],s.prototype,"nom",2),o([u("Pr\xE9nom")],s.prototype,"prenom",2),o([u("Droit")],s.prototype,"droit",2);var v=(r=>(r[r.CONSULT=0]="CONSULT",r[r.CONSULT_TOTAL=1]="CONSULT_TOTAL",r[r.PARTIEL=9]="PARTIEL",r[r.TOTAL=10]="TOTAL",r))(v||{});var x=class l{constructor(e,t){this.afAuth=e;this.firestore=t}user$=new h(null);userSelect$=new h(null);users$=new h(null);signIn(e,t){return this.afAuth.signInWithEmailAndPassword(e,t)}signUp(e,t){return this.afAuth.createUserWithEmailAndPassword(e,t)}signOut(){return this.user$.next(null),this.userSelect$.next(null),this.afAuth.signOut()}getCurrentUser(){return this.afAuth.authState}getUser(){let e=this.firestore.collection("/user").valueChanges();return U([this.afAuth.authState,e,this.user$]).pipe(g(([t,i,r])=>{if(m(r))return r;{let a=i.find(n=>n.id==t?.uid);if(m(a)){let n=p(s,a);return this.user$.next(n),n?.getDroit()==10||n?.getDroit()==1?this.getUsers(9).pipe(b(f=>m(f))).subscribe(f=>{let A=f.find(c=>c.getId()==n.getId());A?this.userSelect$.next(A):this.userSelect$.next(f.find(c=>c.getNom()=="LEFAIX"))}):this.userSelect$.next(n),n}return null}}))}getUsers(e){return this.users$.next(null),T(e)&&(e=0),this.firestore.collection("/user",t=>{let i=t;return i=i.where("droit",">=",e),i}).valueChanges().pipe(g(t=>{let i=[];return t?.length>0&&t.forEach(r=>{let a=p(s,r);i.push(a)}),this.users$.next(i),i}))}static \u0275fac=function(t){return new(t||l)(d(O),d(L))};static \u0275prov=S({token:l,factory:l.\u0275fac,providedIn:"root"})};export{v as a,x as b};

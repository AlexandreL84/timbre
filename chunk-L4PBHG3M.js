import{a as St,b as X}from"./chunk-6LZF5SW5.js";import{a as ve,b as Ve,c as Ue,d as oe,e as Ot,f as rt,g as ot,h as Di,i as Nt,j as ke,k as lt,l as Hi}from"./chunk-VW2NLLUS.js";import{e as Rt}from"./chunk-WDH6RHXI.js";import{a as pi,d as it,e as re,f as Ai,h as nt}from"./chunk-SKMENTVJ.js";import{l as E,m as Ee,n as we,u as Ae,v as oi,w as li}from"./chunk-FG7OFSHW.js";import{a as Et}from"./chunk-XQP67XMC.js";import{$ as We,Aa as f,Ab as De,Ac as wt,Ba as Mt,Bb as Re,Bc as At,Ca as S,Cb as fe,Cc as fi,D as Tt,Db as ge,Dc as gi,Ea as ii,Eb as mi,Ec as _i,Fa as V,Fb as Bt,Fc as hi,Ga as k,Gb as Qe,Gc as Ti,H as se,Ha as H,Hc as xi,I as xt,Ic as vi,Jb as ee,Jc as Ci,K as R,Kb as Oe,Kc as Mi,La as ct,Lb as Ne,Lc as yi,M as $,Mb as te,Mc as Si,N as vt,Na as _,Nb as Le,Nc as Bi,Oa as h,Ob as Ye,Oc as Ii,P as ei,Pa as K,Pb as Ze,Pc as Ei,Qb as Ke,Qc as Qt,Rb as Je,Rc as wi,S as x,Sb as Xe,Sc as xe,T as v,Tb as et,Tc as Dt,Ub as It,Vb as si,Wb as _e,Xa as ae,Xb as ai,Ya as ce,Yb as ci,Za as j,aa as Ct,ab as P,ba as m,bb as yt,c as D,ca as C,ha as g,ia as s,ic as tt,jc as ie,k as me,kc as ui,l as Y,ma as a,mc as he,na as c,nb as ni,oa as M,ob as p,oc as ne,pa as L,pb as J,qa as U,sa as w,ta as y,tc as di,ua as u,ub as pe,uc as Te,va as ti,vb as ue,wa as $e,wb as ri,x as T,xa as je,xb as de,xc as bi,ya as Pe,yb as ze,za as F,zb as be}from"./chunk-MY6LMDNH.js";import{f as ki,g as I}from"./chunk-GOLCFQAC.js";var G=class extends Ee{annees;acquis;doublon;idBloc;type;user;getAnnees(){return this.annees}setAnnees(t){this.annees=t}getAcquis(){return this.acquis}setAcquis(t){this.acquis=t}getDoublon(){return this.doublon}setDoublon(t){this.doublon=t}getIdBloc(){return this.idBloc}setIdBloc(t){this.idBloc=t}getUser(){return this.user}setUser(t){this.user=t}getType(){return this.type}setType(t){this.type=t}};I([E("Ann\xE9e")],G.prototype,"annees",2),I([E("Acquis")],G.prototype,"acquis",2),I([E("Doublon")],G.prototype,"doublon",2),I([E("Ident bloc")],G.prototype,"idBloc",2),I([E("Type")],G.prototype,"type",2),I([E("User")],G.prototype,"user",2);var Z=class extends Ee{idUser;idTimbre;acquis;doublon;constructor(t,e,i,n){super(),this.idUser=t||null,this.idTimbre=e||null,this.acquis=i||!1,this.doublon=n||!1}getIdUser(){return this.idUser}setIdUser(t){this.idUser=t}getIdTimbre(){return this.idTimbre}setIdTimbre(t){this.idTimbre=t}isAcquis(){return this.acquis}setAcquis(t){this.acquis=t}isDoublon(){return this.doublon}setDoublon(t){this.doublon=t}};I([E("Identifiant Utilisateur")],Z.prototype,"idUser",2),I([E("Identifiant timbre")],Z.prototype,"idTimbre",2),I([E("Acquis")],Z.prototype,"acquis",2),I([E("Doublon")],Z.prototype,"doublon",2);var pt=class{key;dossier;maxWidth;maxHeight;getKey(){return this.key}setKey(t){this.key=t}getDossier(){return this.dossier}setDossier(t){this.dossier=t}getMaxWidth(){return this.maxWidth}setMaxWidth(t){this.maxWidth=t}getMaxHeight(){return this.maxHeight}setMaxHeight(t){this.maxHeight=t}};var Fe=class{dossier;nom;alignLabel;detail;file;getDossier(){return this.dossier}setDossier(t){this.dossier=t}getNom(){return this.nom}setNom(t){this.nom=t}getAlignLabel(){return this.alignLabel}setAlignLabel(t){this.alignLabel=t}getDetail(){return this.detail}setDetail(t){this.detail=t}getFile(){return this.file}setFile(t){this.file=t}};var ut=(i=>(i.TIMBRE="Timbre",i.BLOC="Bloc",i.CARNET="Carnet",i))(ut||{});var q=class r{constructor(t,e){this.authService=t;this.firestore=e;this.initCritere(),this.timbreCritereModel.setAcquis("NON"),this.initCritereBloc(),this.timbreCritereBlocModel.setAcquis("NON")}reinitResume$=new D(!0);timbreCritereModel=new G;timbreCritereBlocModel=new G;initCritere(){this.timbreCritereModel=new G,this.timbreCritereModel.setType(["Timbre","Carnet","Bloc"])}initCritereBloc(){this.timbreCritereBlocModel=new G,this.timbreCritereBlocModel.setType(["Carnet","Bloc"])}initUpload(){let t=new Fe;t.setDossier("table"),t.setNom(new Date().getTime()?.toString());let e=new pt;e.setMaxWidth(100),e.setMaxHeight(100),e.setDossier("autre");let i=new pt;return i.setMaxWidth(700),i.setMaxHeight(700),i.setDossier("zoom"),t.setDetail([e,i]),t}getAnneesAsync(t){return this.firestore.collection(t,e=>{let i=e;return i=i.orderBy("annee","desc"),i}).valueChanges().pipe(me(e=>{let i=e.map(n=>Number(n.annee)).filter(n=>p(n)&&n!=0);return Array.from(new Set(i))}))}getTimbresByCritereAsync(t){return this.getAllTimbres(t).pipe(me(e=>this.constructTimbres(e,null,null)))}getAllTimbres(t){return this.firestore.collection("/timbres",e=>{let i=e;return p(t)&&(p(t.getAnnees())&&t.getAnnees()?.length>0&&(i=i.where("annee","in",t.getAnnees())),t?.getType()?.length==0||t?.getType()?.length==1&&t?.getType()?.find(n=>n=="Timbre")?i=i.where("idBloc","==",null):t?.getType()?.length>0&&!t?.getType()?.find(n=>n=="Timbre")?i=i.where("idBloc","!=",null):p(t.getIdBloc())&&(i=i.where("idBloc","==",t.getIdBloc()))),i=i.orderBy("id","asc"),i}).valueChanges()}constructTimbres(t,e,i,n){let o=[];return t?.length>0&&t.forEach(l=>{let d=this.constructTimbre(l,e,i),b=!1;p(n)?((n?.getType()?.find(B=>B=="Timbre")&&J(d?.getTimbreBlocModel())||n?.getType()?.find(B=>B=="Bloc")&&p(d?.getTimbreBlocModel())&&!d?.getTimbreBlocModel()?.isCarnet()||n?.getType()?.find(B=>B=="Carnet")&&p(d?.getTimbreBlocModel())&&d?.getTimbreBlocModel()?.isCarnet())&&(b=!0),p(d.getTimbreAcquisModel())&&(p(n.getAcquis())&&!(n.getAcquis()=="TOUS"||n.getAcquis()=="OUI"&&d.getTimbreAcquisModel().isAcquis()||n.getAcquis()=="NON"&&!d.getTimbreAcquisModel().isAcquis())&&(b=!1),p(n.getDoublon())&&!(n.getDoublon()=="TOUS"||n.getDoublon()=="OUI"&&d.getTimbreAcquisModel().isDoublon()||n.getDoublon()=="NON"&&!d.getTimbreAcquisModel().isDoublon())&&(b=!1))):b=!0,b==!0&&o.push(d)}),o}constructTimbre(t,e,i){let n=we(ve,t);if(p(i)){let o=i.find(l=>l.getId()==n?.getIdBloc());p(o)&&n.setTimbreBlocModel(o)}if(p(e)){let o=e.find(l=>l.idTimbre==n.getId());p(o)?n.setTimbreAcquisModel(we(Z,o)):n.setTimbreAcquisModel(new Z)}return n}supprimerTimbreAcquis(t){this.firestore.collection("/timbres_acquis").ref.where("idTimbre","==",t.getId()).get().then(e=>{e.forEach(i=>{i.ref.delete()})})}supprimerTimbre(t){this.firestore.collection("/timbres").ref.where("id","==",t.getId()).get().then(e=>{e.forEach(i=>{i.ref.delete()})}).catch(e=>{console.error("Erreur de suppression :",e)})}acquis(t,e,i){this.authService.userSelect$.pipe(T(n=>p(n))).subscribe(n=>{this.firestore.collection("/timbres_acquis").ref.where("idTimbre","==",t.getId()).where("idUser","==",n.getId()).get().then(o=>{o?.size==0&&this.addAcquis(n.getId(),t,e),o.forEach(l=>{let d=we(Z,l.data());e?(d.setAcquis(!0),d.setDoublon(i||!d.isDoublon())):(d.setAcquis(i||!d.isAcquis()),d.isAcquis()||d.setDoublon(!1)),l.ref.update(Object.assign(new Object,d)).then(b=>{t.setTimbreAcquisModel(d)}).catch(b=>{console.error("Erreur de mise \xE0 jour:",b)})})}).catch(o=>{console.error("Erreur de mise \xE0 jour id introuvable :",o)}),this.reinitResume$.next(!0)})}supprimerAcquisTimbreByUser(t,e,i,n){this.firestore.collection("/timbres_acquis").ref.where("idTimbre","==",e.getId()).where("idUser","==",t).get().then(o=>{o?.size==0&&n&&this.addAcquis(t,e,i),o.forEach(l=>{l.ref.delete().then(d=>{n&&this.supprimerTimbreAcquis(e)})})}).catch(o=>{console.error("Erreur de suppression :",o)})}addAcquis(t,e,i){let n=new Z;n.setIdUser(t),n.setIdTimbre(e.getId()),n.setAcquis(!0),n.setDoublon(i),e.setTimbreAcquisModel(n),this.firestore.collection("/timbres_acquis").add(Object.assign(new Object,n))}static \u0275fac=function(e){return new(e||r)(R(X),R(Ae))};static \u0275prov=se({token:r,factory:r.\u0275fac})};var le=class extends Ee{idUser;idBloc;acquis;doublon;constructor(t,e,i,n){super(),this.idUser=t||null,this.idBloc=e||null,this.acquis=i||!1,this.doublon=n||!1}getIdUser(){return this.idUser}setIdUser(t){this.idUser=t}getIdBloc(){return this.idBloc}setIdBloc(t){this.idBloc=t}isAcquis(){return this.acquis}setAcquis(t){this.acquis=t}isDoublon(){return this.doublon}setDoublon(t){this.doublon=t}};I([E("Identifiant Utilisateur")],le.prototype,"idUser",2),I([E("Identifiant bloc")],le.prototype,"idBloc",2),I([E("Acquis")],le.prototype,"acquis",2),I([E("Doublon")],le.prototype,"doublon",2);var Zi=["canvas"];function Ki(r,t){r&1&&M(0,"lib-spinner",5),r&2&&s("textSpec","Chargement en cours ...")}function Ji(r,t){if(r&1&&(M(0,"mat-error",21),_(1,"async")),r&2){let e=u(2);s("innerHTML",h(1,1,e.messageError$),We)}}function Xi(r,t){if(r&1){let e=w();a(0,"div",10)(1,"label"),M(2,"lib-libelle-model",11),c(),a(3,"input",22),H("ngModelChange",function(n){x(e);let o=u(2);return k(o.timbreBlocModel.id,n)||(o.timbreBlocModel.id=n),v(n)}),c()()}if(r&2){let e=u(2);m(2),s("object",e.timbreBlocModel)("key","id"),m(),V("ngModel",e.timbreBlocModel.id),s("disabled",!!(e.timbreBlocModel!=null&&e.timbreBlocModel.getId()))}}function en(r,t){if(r&1){let e=w();a(0,"form",6,1),y("ngSubmit",function(){x(e);let n=F(1),o=u();return v(o.valider(n))}),a(2,"div",7),g(3,Ji,2,3,"mat-error",8),_(4,"async"),g(5,Xi,4,4,"div",9),a(6,"div",10)(7,"label"),M(8,"lib-libelle-model",11),c(),a(9,"input",12),H("ngModelChange",function(n){x(e);let o=u();return k(o.timbreBlocModel.annee,n)||(o.timbreBlocModel.annee=n),v(n)}),c()(),a(10,"div",10)(11,"label"),M(12,"lib-libelle-model",11),c(),a(13,"input",13),H("ngModelChange",function(n){x(e);let o=u();return k(o.timbreBlocModel.monnaie,n)||(o.timbreBlocModel.monnaie=n),v(n)}),c()(),a(14,"div",14)(15,"div",10)(16,"label"),M(17,"lib-libelle-model",11),c(),a(18,"input",15),H("ngModelChange",function(n){x(e);let o=u();return k(o.timbreBlocModel.yt,n)||(o.timbreBlocModel.yt=n),v(n)}),c()(),M(19,"div",16),c(),a(20,"lib-upload",17),y("outPutObject",function(n){x(e);let o=u();return v(o.timbreBlocModel=n)}),c()(),a(21,"div",18)(22,"button",19),y("click",function(){x(e);let n=u();return v(n.close())}),f(23," Annuler "),c(),a(24,"button",20),f(25," Enregistrer "),c()()()}if(r&2){let e=F(1),i=u();s("ngClass",e!=null&&e.submitted?"red-color":"blue-color"),m(3),s("ngIf",h(4,19,i.messageError$)),m(2),s("ngIf",i.timbreBlocModel==null?null:i.timbreBlocModel.getId()),m(3),s("object",i.timbreBlocModel)("key","annee"),m(),V("ngModel",i.timbreBlocModel.annee),s("max",i.maxAnnee)("zMax",i.maxAnnee),m(3),s("object",i.timbreBlocModel)("key","monnaie"),m(),V("ngModel",i.timbreBlocModel.monnaie),m(4),s("object",i.timbreBlocModel)("key","yt"),m(),V("ngModel",i.timbreBlocModel.yt),m(2),s("object",i.timbreBlocModel)("key","image")("zoom",i.timbreBlocModel.getImageZoom())("maxWidth",i.DimensionImageEnum.WIDTH_TIMBRE)("maxHeight",i.DimensionImageEnum.HEIGTH_TIMBRE)}}var st=class r{constructor(t,e,i,n,o){this.httpResponseHandlerService=t;this.dialogRef=e;this.utilsService=i;this.timbreBlocService=n;this.timbreUtilsService=o}canvas;messageError$=new D(null);load$=new D(null);id;maxAnnee=new Date().getFullYear()+1;timbreBlocModel=new Ue;fileUploadModel=new Fe;DimensionImageEnum=Ve;ngOnInit(){this.fileUploadModel=this.timbreUtilsService.initUpload(),this.load$.next(!1),p(this.id)?this.timbreBlocService.getBlocByIdAsync(this.id).subscribe(t=>{this.timbreBlocModel=t,this.load$.next(!0)}):(this.timbreBlocModel.setAnnee(new Date().getFullYear()),this.timbreBlocModel.setMonnaie("E"),this.load$.next(!0))}valider(t){if(this.messageError$.next(null),t?.valid)if(p(this.timbreBlocModel.getImage()))this.saveData();else{this.messageError$.next("Veuillez s\xE9lectionner une image");return}}saveData(){this.load$.next(!1),p(this.timbreBlocModel.getId())?this.save():this.ajouter()}ajouter(){this.utilsService.getMaxIdentAsync("/timbres_bloc").pipe(T()).subscribe(t=>{this.timbreBlocModel.setId(t),this.save(!0)})}save(t){try{Y([this.timbreBlocService.upload(this.timbreBlocModel,"autre"),this.timbreBlocService.upload(this.timbreBlocModel,"table"),this.timbreBlocService.upload(this.timbreBlocModel,"zoom")]).pipe(T(([e,i,n])=>p(e)&&p(n)&&p(i))).subscribe(([e,i,n])=>{p(e)&&e!="nok"&&this.timbreBlocModel.setImage(e),p(i)&&i!="nok"&&this.timbreBlocModel.setImageTable(i),p(n)&&n!="nok"&&this.timbreBlocModel.setImageZoom(n),t?this.timbreBlocService.ajouter(this.timbreBlocModel,!0):this.timbreBlocService.modifier(this.timbreBlocModel),this.httpResponseHandlerService.showNotificationSuccess("Transaction termin\xE9e","Votre timbre a bien \xE9t\xE9 modifi\xE9e."),this.load$.next(!0),this.dialogRef.close()})}catch{this.httpResponseHandlerService.showNotificationError("Transaction non aboutie","Votre timbre n'a pas pu \xEAtre modifi\xE9."),this.load$.next(!0)}}close(){this.dialogRef.close()}static \u0275fac=function(e){return new(e||r)(C(Rt),C(he),C(oe),C(z),C(q))};static \u0275cmp=$({type:r,selectors:[["app-timbre-modifier-bloc"]],viewQuery:function(e,i){if(e&1&&$e(Zi,5),e&2){let n;je(n=Pe())&&(i.canvas=n.first)}},decls:10,vars:6,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","space-between stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","column","fxLayoutGap","20px",1,"bloc-modal"],[3,"innerHTML",4,"ngIf"],["fxLayout","column","class","form-input",4,"ngIf"],["fxLayout","column",1,"form-input"],[3,"object","key"],["name","page","type","number","minlength","4","maxlength","4","min","1900","zMin","1900","required","","zControl","",1,"annee",2,"width","60px !important",3,"ngModelChange","ngModel","max","zMax"],["name","monnaie","type","text","trim","","minlength","1","maxlength","2","required","","zControl","",2,"width","25px !important",3,"ngModelChange","ngModel"],["fxLayout","row","fxLayout.lt-lg","column","fxLayoutGap","30px","fxLayoutGap.lt-lg","5px"],["name","yt","type","text","trim","","zControl","",3,"ngModelChange","ngModel"],["fxHide.lt-lg","","fxLayout","column",1,"form-input"],[3,"outPutObject","object","key","zoom","maxWidth","maxHeight"],["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"],[3,"innerHTML"],["name","code","type","text","trim","","upperCase","","noEspace","","required","","zControl","",3,"ngModelChange","ngModel","disabled"]],template:function(e,i){if(e&1&&(a(0,"div",2)(1,"div",3)(2,"span"),f(3),c(),a(4,"span"),f(5),c()(),g(6,Ki,1,1,"ng-template",4),_(7,"async"),g(8,en,26,21,"ng-template",null,0,K),c()),e&2){let n=F(9);m(3),S("",i.timbreBlocModel!=null&&i.timbreBlocModel.getId()?"MODIFICATION":"AJOUT"," BLOC "),m(2),Mt(i.timbreBlocModel==null?null:i.timbreBlocModel.getId()),m(),s("ngIf",h(7,4,i.load$)==!1)("ngIfElse",n)}},dependencies:[ie,tt,ae,j,be,De,ge,fe,Re,ze,de,Le,Qe,Ye,ee,Oe,Je,Xe,et,Ke,Ze,te,Ne,nt,re,pi,it,Ot,rt,ot,Di,Nt,P],encapsulation:2})};var z=class r{constructor(t,e,i,n,o,l){this.firestore=t;this.authService=e;this.uploadService=i;this.utilsService=n;this.timbreUtilsService=o;this.dialog=l}total$=new D(0);totalCarnet$=new D(0);timbresBlocModel$=new D(null);load$=new D(!1);upload(t,e,i){let n=100,o=100;return e=="table"?(n=n*(50/o),o=50):e=="zoom"&&(n=n*(700/o),o=700),this.uploadService.processAndUploadImage(t?.getImage(),n,o,"bloc-"+t.getId(),this.getDossier(t,e,i))}setTotal(t,e){t.isCarnet()?this.total$.pipe(T()).subscribe(i=>{this.total$.next(i+1)}):this.totalCarnet$.pipe(T()).subscribe(i=>{this.totalCarnet$.next(i+e)})}getTotal(t){this.total$.next(null),this.totalCarnet$.next(null),this.getAllBlocs(t).subscribe(e=>{this.total$.next(e?.filter(i=>!i.carnet)?.length),this.totalCarnet$.next(e?.filter(i=>i.carnet)?.length)})}getBloc(t){return this.firestore.collection("/timbres_bloc",e=>e.where("id","==",t)).valueChanges()}getBlocByIdAsync(t){return this.getBloc(t).pipe(me(e=>we(Ue,e[0])))}getRef(t,e){let i=t;return p(e)&&p(e.getAnnees())&&e.getAnnees()?.length>0&&(i=i.where("annee","in",e.getAnnees())),i=i.orderBy("id","asc"),i}getAllBlocs(t){return this.firestore.collection("/timbres_bloc",e=>this.getRef(e,t)).valueChanges()}getTimbreBlocAcquis(){return this.authService.userSelect$.pipe(T(t=>p(t)),Tt(t=>p(t)?this.getTimbreBlocAcquisByUser(t.getId()).pipe(T(),me(e=>e)):null))}getTimbreBlocAcquisByUser(t){return this.firestore.collection("/timbres_bloc_acquis",e=>e.where("idUser","==",t)).valueChanges()}getBlocs(t,e){this.load$.next(!1),this.timbresBlocModel$.next(null),e&&this.getTotal(),Y([this.getAllBlocs(t),this.getTimbreBlocAcquis()]).pipe(T()).subscribe(([i,n])=>{this.timbresBlocModel$.next(this.constructBlocs(i,n,t)),this.load$.next(!0)})}getBlocsAsync(t){return this.timbresBlocModel$.next(null),this.getAllBlocs(t).pipe(T(),me(e=>this.constructBlocs(e,null,t)))}constructBloc(t,e){let i=we(Ue,t);if(p(e)){let n=e.find(o=>o.idBloc==i.getId());p(n)?i.setTimbreBlocAcquisModel(we(le,n)):i.setTimbreBlocAcquisModel(new le)}return i}constructBlocs(t,e,i){let n=[];return t?.length>0&&t.forEach(o=>{let l=this.constructBloc(o,e);this.getTimbresByBlocAsync(l.getId()).subscribe(b=>{l.setNbTimbres(b?.length)});let d=!1;p(i)?((i?.getType()?.find(b=>b=="Carnet")&&l?.isCarnet()||i?.getType()?.find(b=>b=="Bloc")&&!l?.isCarnet())&&(d=!0),p(l.getTimbreBlocAcquisModel())&&(p(i.getAcquis())&&!(i.getAcquis()=="TOUS"||i.getAcquis()=="OUI"&&l.getTimbreBlocAcquisModel().isAcquis()||i.getAcquis()=="NON"&&!l.getTimbreBlocAcquisModel().isAcquis())&&(d=!1),p(i.getDoublon())&&!(i.getDoublon()=="TOUS"||i.getDoublon()=="OUI"&&l.getTimbreBlocAcquisModel().isDoublon()||i.getDoublon()=="NON"&&!l.getTimbreBlocAcquisModel().isDoublon())&&(d=!1))):d=!0,d==!0&&n.push(l)}),n}acquis(t,e){return this.authService.userSelect$.pipe(T(i=>p(i))).subscribe(i=>{p(t?.getTimbreBlocAcquisModel()?.getIdUser())?this.firestore.collection("/timbres_bloc_acquis").ref.where("idBloc","==",t.getId()).where("idUser","==",i.getId()).get().then(n=>{n.forEach(o=>{let l=t.getTimbreBlocAcquisModel();e?(l.setAcquis(!0),l.setDoublon(!l.isDoublon())):(l.setAcquis(!l.isAcquis()),l.isAcquis()||l.setDoublon(!1)),o.ref.update(Object.assign(new Object,l)).then(d=>{t.setTimbreBlocAcquisModel(l)}).catch(d=>{console.error("Erreur de mise \xE0 jour:",d)})})}).catch(n=>{console.error("Erreur de mise \xE0 jour:",n)}):this.addAcquis(i?.getId(),t,e),this.timbreUtilsService.reinitResume$.next(!0)})}addAcquis(t,e,i){let n=new le;n.setIdUser(t),n.setIdBloc(e.getId()),n.setAcquis(!0),n.setDoublon(i),e.setTimbreBlocAcquisModel(n),this.firestore.collection("/timbres_bloc_acquis").add(Object.assign(new Object,n))}ajouterSansId(t){this.utilsService.getMaxIdentAsync("/timbres_bloc").pipe(T()).subscribe(e=>{t.setId(e),this.ajouter(t,!0)})}ajouter(t,e){this.getBloc(t.getId()).pipe(T()).subscribe(i=>{J(i)||J(i[0])||p(i[0])&&i[0]?.length==0?(t.setTimbreBlocAcquisModel(null),t.setIdOrigine(null),this.firestore.collection("/timbres_bloc").add(Object.assign(new Object,t)).then(n=>{this.timbresBlocModel$.pipe(T()).subscribe(o=>{o.push(t),this.setTotal(t,1)}),this.timbreUtilsService.reinitResume$.next(!0)}).catch(n=>{console.error("Erreur d'ajout :",n)})):console.error("bloc "+t.getId()+" d\xE9j\xE0 existant")})}isCarnet(t){this.authService.user$.pipe(T(e=>p(e))).subscribe(e=>{e?.getDroit()>=9?(t.setCarnet(!t.isCarnet()),this.modifier(t)):this.utilsService.droitInsuffisant()})}modifier(t){t.setTimbreBlocAcquisModel(null),this.firestore.collection("/timbres_bloc").ref.where("id","==",t.getId()).get().then(e=>{e.forEach(i=>{i.ref.update(Object.assign(new Object,t)).then(n=>{this.timbresBlocModel$.pipe(T(o=>p(o)&&o?.length>0)).subscribe(o=>{let l=o.find(d=>d.getId()==t.getId());p(l)&&Object.assign(l,t)})}).catch(n=>{console.error("Erreur de mise \xE0 jour :",n)})})}).catch(e=>{console.error("Erreur de mise \xE0 jour id introuvable :",e)})}getTimbresByBlocAsync(t){let e=new G;return e.setIdBloc(t),this.timbreUtilsService.getTimbresByCritereAsync(e)}supprimer(t){this.getTimbresByBlocAsync(t.getId()).pipe(T()).subscribe(e=>{e.forEach(i=>{this.timbreUtilsService.supprimerTimbreAcquis(i),this.timbreUtilsService.supprimerTimbre(i)})}),this.firestore.collection("/timbres_bloc_acquis").ref.where("idBloc","==",t.getId()).get().then(e=>{e.forEach(i=>{i.ref.delete()})}),this.firestore.collection("/timbres_bloc").ref.where("id","==",t.getId()).get().then(e=>{e.forEach(i=>{i.ref.delete().then(n=>{this.timbresBlocModel$.pipe(T()).subscribe(o=>{let l=o.findIndex(d=>d.getId()==t.getId());l>=0&&(o.splice(l,1),this.setTotal(t,-1))})}).catch(n=>{console.error("Erreur de suppression :",n)})})}).catch(e=>{console.error("Erreur de suppression id introuvable :",e)}),this.timbreUtilsService.reinitResume$.next(!0)}getDossier(t,e,i){let n="timbre//"+t.getAnnee();return p(e)&&(n=n+"/"+e),n=n+"/bloc/"+(p(i)?i:t.getId()),n}getBouchon(){let t=new Ue;return t.setAnnee(new Date().getFullYear()),t.setMonnaie("E"),t}acquisDoublon(t,e){this.authService.user$.pipe(T(i=>p(i))).subscribe(i=>{i?.getDroit()>=9?t?.isCarnet()?this.acquisCarnetDialog(t,e):this.acquis(t,e):this.utilsService.droitInsuffisant()})}acquisCarnetDialog(t,e){let i="";t?.getTimbreBlocAcquisModel()?.isDoublon()&&e?i="enlever les doublons":t?.getTimbreBlocAcquisModel()?.isAcquis()?i="enlever les acquis":i="mettre en "+(e?"doublon":"acquis")+" tous";let n=this.dialog.open(ke,{maxHeight:"95vh",data:{titre:"Confirmation",message:"Souhaitez-vous <b>"+i+"</b> les timbres du carnet ?",btnDroite:"Oui",btnGauche:"Non"}});n.afterClosed().subscribe(()=>{n.componentInstance.data.resultat==="valider"&&this.authService.userSelect$.pipe(T(o=>p(o))).subscribe(o=>{this.getTimbresByBlocAsync(t.getId()).pipe(T()).subscribe(l=>{l.forEach(d=>{this.timbreUtilsService.acquis(d,e,!t?.getTimbreBlocAcquisModel()?.isAcquis())})}),this.acquis(t,e)})})}modifierDialog(t){let e=this.dialog.open(st,{height:"75vh",maxHeight:"750px",width:"30%"});e.componentInstance.id=t.getId(),e.afterClosed().subscribe(()=>{e.close()})}supprimerDialog(t){this.getTimbresByBlocAsync(t.getId()).pipe(T()).subscribe(e=>{let i="";p(e)&&e?.length>0&&(i="<span class='warn'>Attention <b>"+e.length+"</b> timbre",e?.length>1?i+="s sont reli\xE9s":i+=" est reli\xE9",i+=" \xE0 ce bloc.</span></br></br>"),i+="Souhaitez-vous supprimer le bloc <b>n\xB0 "+t?.getId()+"</b> ?";let n=this.dialog.open(ke,{maxHeight:"95vh",data:{titre:"Confirmation",message:i,btnDroite:"Oui",btnGauche:"Non"}});n.afterClosed().subscribe(()=>{n.componentInstance.data.resultat==="valider"&&this.supprimer(t)})})}static \u0275fac=function(e){return new(e||r)(R(Ae),R(X),R(lt),R(oe),R(q),R(ne))};static \u0275prov=se({token:r,factory:r.\u0275fac})};var tn=["canvas"];function nn(r,t){if(r&1&&(a(0,"span",6)(1,"b"),f(2),c()()),r&2){let e=u();m(2),S("N\xB0",e.timbreModel==null?null:e.timbreModel.getId(),"")}}function rn(r,t){r&1&&M(0,"lib-spinner",7),r&2&&s("textSpec","Chargement en cours ...")}function on(r,t){if(r&1&&(M(0,"mat-error",29),_(1,"async")),r&2){let e=u(2);s("innerHTML",h(1,1,e.messageError$),We)}}function ln(r,t){if(r&1&&(a(0,"mat-option",18),f(1),c()),r&2){let e=t.$implicit;s("value",e),m(),ii(" ",e.getAnnee()," - ",e.getId()," ",e.isCarnet()?" (carnet)":""," ")}}function mn(r,t){if(r&1){let e=w();a(0,"img",30),y("click",function(){let n;x(e);let o=u(2);return v(o.utilsService.zoom(o.timbreModel==null||(n=o.timbreModel.getTimbreBlocModel())==null?null:n.getImageZoom()))}),c()}if(r&2){let e,i=u(2);s("src",i.timbreModel==null||(e=i.timbreModel.getTimbreBlocModel())==null?null:e.getImage(),Ct)}}function sn(r,t){if(r&1){let e=w();a(0,"form",8,1),y("ngSubmit",function(){x(e);let n=F(1),o=u();return v(o.valider(n))}),a(2,"div",9),g(3,on,2,3,"mat-error",10),_(4,"async"),a(5,"div",11)(6,"div",12)(7,"label"),M(8,"lib-libelle-model",13),c(),a(9,"input",14),H("ngModelChange",function(n){x(e);let o=u();return k(o.timbreModel.annee,n)||(o.timbreModel.annee=n),v(n)}),y("ngModelChange",function(n){x(e);let o=u();return v(o.changeAnnee(n))}),c()(),a(10,"div",15)(11,"label"),M(12,"lib-libelle-model",13),c(),a(13,"div",16)(14,"mat-select",17),_(15,"async"),y("ngModelChange",function(n){x(e);let o=u();return v(o.changeBloc(n))}),M(16,"mat-option",18),g(17,ln,2,4,"mat-option",19),_(18,"async"),c(),g(19,mn,1,1,"img",20),c()()(),a(20,"div",11)(21,"div",12)(22,"label"),M(23,"lib-libelle-model",13),c(),a(24,"input",21),H("ngModelChange",function(n){x(e);let o=u();return k(o.timbreModel.type,n)||(o.timbreModel.type=n),v(n)}),c()(),a(25,"div",12)(26,"label"),M(27,"lib-libelle-model",13),c(),a(28,"input",22),H("ngModelChange",function(n){x(e);let o=u();return k(o.timbreModel.monnaie,n)||(o.timbreModel.monnaie=n),v(n)}),c()()(),a(29,"div",11)(30,"div",12)(31,"label"),M(32,"lib-libelle-model",13),c(),a(33,"input",23),H("ngModelChange",function(n){x(e);let o=u();return k(o.timbreModel.yt,n)||(o.timbreModel.yt=n),v(n)}),c()(),M(34,"div",24),c(),a(35,"lib-upload",25),y("outPutObject",function(n){x(e);let o=u();return v(o.timbreModel=n)}),c()(),a(36,"div",26)(37,"button",27),y("click",function(){x(e);let n=u();return v(n.close())}),f(38," Annuler "),c(),a(39,"button",28),f(40," Enregistrer "),c()()()}if(r&2){let e,i,n=F(1),o=u();s("ngClass",n!=null&&n.submitted?"red-color":"blue-color"),m(3),s("ngIf",h(4,31,o.messageError$)),m(5),s("object",o.timbreModel)("key","annee"),m(),V("ngModel",o.timbreModel.annee),s("max",o.maxAnnee)("zMax",o.maxAnnee)("disabled",!!(o.timbreModel!=null&&o.timbreModel.getId())),m(3),s("object",o.timbreModel)("key","timbreBlocModel"),m(2),s("ngModel",o.timbreModel.getTimbreBlocModel())("placeholder","Choix bloc")("disabled",!!(o.timbreModel!=null&&o.timbreModel.getId())||((e=h(15,33,o.timbreBlocService.timbresBlocModel$))==null?null:e.length)<=0),m(2),s("value",null),m(),s("ngForOf",h(18,35,o.timbreBlocService.timbresBlocModel$)),m(2),s("ngIf",o.timbreModel==null||(i=o.timbreModel.getTimbreBlocModel())==null?null:i.getImage()),m(4),s("object",o.timbreModel)("key","type"),m(),V("ngModel",o.timbreModel.type),m(3),s("object",o.timbreModel)("key","monnaie"),m(),V("ngModel",o.timbreModel.monnaie),s("disabled",!!o.timbreModel.getTimbreBlocModel()),m(4),s("object",o.timbreModel)("key","yt"),m(),V("ngModel",o.timbreModel.yt),m(2),s("object",o.timbreModel)("key","image")("zoom",o.timbreModel.getImageZoom())("maxWidth",o.DimensionImageEnum.WIDTH_TIMBRE)("maxHeight",o.DimensionImageEnum.HEIGTH_TIMBRE)}}var at=class r{constructor(t,e,i,n,o,l){this.httpResponseHandlerService=t;this.dialogRef=e;this.timbreService=i;this.timbreBlocService=n;this.timbreUtilsService=o;this.utilsService=l}canvas;messageError$=new D(null);load$=new D(null);id;maxAnnee=new Date().getFullYear();timbreModel=new ve;fileUploadModel=new Fe;DimensionImageEnum=Ve;ngOnInit(){this.fileUploadModel=this.timbreUtilsService.initUpload(),this.load$.next(!1),p(this.id)?this.timbreService.getTimbreByIdAsync(this.id).subscribe(t=>{this.timbreModel=t,p(t.getTimbreBlocModel())&&(this.timbreModel.setAnnee(t.getTimbreBlocModel().getAnnee()),this.timbreModel.setMonnaie(t.getTimbreBlocModel().getMonnaie())),this.load$.next(!0)}):(this.timbreModel.setAnnee(new Date().getFullYear()),this.timbreModel.setMonnaie("E"),this.load$.next(!0)),this.changeAnnee(this.timbreModel.getAnnee())}valider(t){if(this.messageError$.next(null),t?.valid)if(p(this.timbreModel.getImage()))this.saveData();else{this.messageError$.next("Veuillez s\xE9lectionner une image");return}}saveData(){this.load$.next(!1),p(this.timbreModel.getId())?this.save():this.ajouter()}ajouter(){this.utilsService.getMaxIdentAsync("/timbres").pipe(T()).subscribe(t=>{this.timbreModel.setId(t),this.save(!0)})}save(t){try{Y([this.timbreService.upload(this.timbreModel,"autre"),this.timbreService.upload(this.timbreModel,"table"),this.timbreService.upload(this.timbreModel,"zoom")]).pipe(T(([e,i,n])=>p(e)&&p(n)&&p(i))).subscribe(([e,i,n])=>{p(e)&&e!="nok"&&this.timbreModel.setImage(e),p(i)&&i!="nok"&&this.timbreModel.setImageTable(i),p(n)&&n!="nok"&&this.timbreModel.setImageZoom(n),t?this.timbreService.ajouter(this.timbreModel,!0):this.timbreService.modifier(this.timbreModel),this.httpResponseHandlerService.showNotificationSuccess("Transaction termin\xE9e","Votre timbre a bien \xE9t\xE9 modifi\xE9e."),this.load$.next(!0),this.dialogRef.close()})}catch{this.httpResponseHandlerService.showNotificationError("Transaction non aboutie","Votre timbre n'a pas pu \xEAtre modifi\xE9."),this.load$.next(!0)}}close(){this.dialogRef.close()}changeAnnee(t){if(this.timbreModel.setTimbreBlocModel(null),p(t)){let e=new G;e.setAnnees([t]),this.timbreBlocService.getBlocs(e,!1)}}changeBloc(t){p(t)?(this.timbreModel.setIdBloc(t.getId()),this.timbreModel.setTimbreBlocModel(t),this.timbreModel.setMonnaie(t.getMonnaie()),this.timbreModel.setAnnee(t.getAnnee())):(this.timbreModel.setIdBloc(null),this.timbreModel.setTimbreBlocModel(null),this.timbreModel.setMonnaie("E"))}static \u0275fac=function(e){return new(e||r)(C(Rt),C(he),C(Q),C(z),C(q),C(oe))};static \u0275cmp=$({type:r,selectors:[["app-timbre-modifier"]],viewQuery:function(e,i){if(e&1&&$e(tn,5),e&2){let n;je(n=Pe())&&(i.canvas=n.first)}},decls:9,vars:6,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],["class","accent",4,"ngIf"],[3,"ngIf","ngIfElse"],[1,"accent"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","space-between stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","column","fxLayoutGap","20px",1,"bloc-modal"],[3,"innerHTML",4,"ngIf"],["fxLayout","row","fxLayout.lt-lg","column","fxLayoutGap","30px","fxLayoutGap.lt-lg","5px"],["fxLayout","column",1,"form-input"],[3,"object","key"],["name","page","type","number","minlength","4","maxlength","4","min","1900","zMin","1900","required","","zControl","",1,"annee",2,"width","60px !important",3,"ngModelChange","ngModel","max","zMax","disabled"],["fxLayout","column",1,"form-input","select"],["fxLayout","row","fxLayoutGap","15px"],["name","bloc",2,"width","180px !important",3,"ngModelChange","ngModel","placeholder","disabled"],[1,"selectMin",3,"value"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],["style","max-height: 40px","class","click",3,"src","click",4,"ngIf"],["name","type","type","text","trim","","zControl","",3,"ngModelChange","ngModel"],["name","monnaie","type","text","trim","","minlength","1","maxlength","2","required","","zControl","",2,"width","25px !important",3,"ngModelChange","ngModel","disabled"],["name","yt","type","text","trim","","zControl","",3,"ngModelChange","ngModel"],["fxHide.lt-lg","","fxLayout","column",1,"form-input"],[3,"outPutObject","object","key","zoom","maxWidth","maxHeight"],["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"],[3,"innerHTML"],[1,"click",2,"max-height","40px",3,"click","src"]],template:function(e,i){if(e&1&&(a(0,"div",2)(1,"div",3)(2,"span"),f(3),c(),g(4,nn,3,1,"span",4),c(),g(5,rn,1,1,"ng-template",5),_(6,"async"),g(7,sn,41,37,"ng-template",null,0,K),c()),e&2){let n=F(8);m(3),S("",i.timbreModel!=null&&i.timbreModel.getId()?"MODIFICATION":"AJOUT"," "),m(),s("ngIf",i.timbreModel==null?null:i.timbreModel.getId()),m(),s("ngIf",h(6,4,i.load$)==!1)("ngIfElse",n)}},dependencies:[ie,tt,Te,_e,ae,ce,j,be,De,ge,fe,Re,ze,de,Le,Qe,Ye,ee,Oe,Je,Xe,et,Ke,Ze,te,Ne,re,nt,it,Ot,rt,ot,Nt,P],encapsulation:2})};var Q=class r{constructor(t,e,i,n,o,l,d){this.firestore=t;this.authService=e;this.timbreBlocService=i;this.uploadService=n;this.utilsService=o;this.timbreUtilsService=l;this.dialog=d}total$=new D(0);timbres$=new D(null);load$=new D(!1);getTimbre(t){return this.firestore.collection("/timbres",e=>e.where("id","==",t)).valueChanges()}getTimbreByIdAsync(t){return Y([this.getTimbre(t),this.timbreBlocService.getBlocsAsync()]).pipe(me(([e,i])=>this.timbreUtilsService.constructTimbre(e[0],null,i)))}setTotal(t){this.total$.pipe(T()).subscribe(e=>{this.total$.next(e+t)})}getTotal(t){this.total$.next(null),this.timbreUtilsService.getAllTimbres(t).subscribe(e=>{this.total$.next(e?.length)})}getTimbres(t,e){e&&this.getTotal(),this.timbres$.next(null),this.load$.next(!1),Y([this.timbreUtilsService.getAllTimbres(t),this.getTimbreAcquis(),this.timbreBlocService.getBlocsAsync(t)]).pipe(T()).subscribe(([i,n,o])=>{let l=this.timbreUtilsService.constructTimbres(i,n,o,t);l?.length>0&&(l=l.sort((d,b)=>d.getIdBloc()-b.getIdBloc()).sort((d,b)=>d?.getTimbreBlocModel()?.getNbTimbres()-b?.getTimbreBlocModel()?.getNbTimbres())),this.timbres$.next(l),this.load$.next(!0)})}getTimbreAcquis(){return this.authService.userSelect$.pipe(T(t=>p(t)),Tt(t=>p(t)?this.getTimbreAcquisByUser(t.getId()).pipe(T(),me(e=>e)):null))}getTimbreAcquisByUser(t){return this.firestore.collection("/timbres_acquis",e=>e.where("idUser","==",t)).valueChanges()}ajouterSansId(t){this.utilsService.getMaxIdentAsync("/timbres").pipe(T()).subscribe(e=>{t.setId(e),p(t.getIdBloc())&&t.setMonnaie(null),this.ajouter(t,!0)})}ajouter(t,e){this.getTimbre(t.getId()).pipe(T()).subscribe(i=>{J(i)||J(i[0])||p(i[0])&&i[0]?.length==0?(t.setTimbreAcquisModel(null),t.setTimbreBlocModel(null),this.firestore.collection("/timbres").add(Object.assign(new Object,t)).then(n=>{e&&(this.timbres$.pipe(T()).subscribe(o=>{o.push(t),this.setTotal(1)}),this.timbreUtilsService.reinitResume$.next(!0))}).catch(n=>{console.error("Erreur d'ajout :",n)})):console.error("timbre "+t.getId()+" d\xE9j\xE0 existant")})}modifier(t){t.setTimbreBlocModel(null),t.setTimbreAcquisModel(null),this.firestore.collection("/timbres").ref.where("id","==",t.getId()).get().then(e=>{e.forEach(i=>{i.ref.update(Object.assign(new Object,t)).then(n=>{this.timbres$.pipe(T(o=>p(o)&&o?.length>0)).subscribe(o=>{let l=o.find(d=>d.getId()==t.getId());p(l)&&Object.assign(l,t)})}).catch(n=>{console.error("Erreur de mise \xE0 jour :",n)})})}).catch(e=>{console.error("Erreur de mise \xE0 jour id introuvable :",e)})}supprimerTimbre(t){this.firestore.collection("/timbres").ref.where("id","==",t.getId()).get().then(e=>{e.forEach(i=>{i.ref.delete().then(n=>{this.timbres$.pipe(T()).subscribe(o=>{let l=o.findIndex(d=>d.getId()==t.getId());l>=0&&(o.splice(l,1),this.setTotal(-1))})}).catch(n=>{console.error("Erreur de suppression :",n)})})}).catch(e=>{console.error("Erreur de suppression id introuvable :",e)})}supprimer(t){this.timbreUtilsService.supprimerTimbreAcquis(t),this.supprimerTimbre(t),this.timbreUtilsService.reinitResume$.next(!0)}getBouchon(){let t=new ve;return t.setAnnee(new Date().getFullYear()),t.setMonnaie("E"),t.setType(""),t.setYt(""),t}upload(t,e,i){let n=100,o=100;return e=="table"?(n=n*(50/o),o=50):e=="zoom"&&(n=n*(700/o),o=700),this.uploadService.processAndUploadImage(t?.getImage(),n,o,p(i)?i:t?.getId(),this.getDossier(t,e))}getDossier(t,e){let i="timbre//";return p(t.getIdBloc())?i=i+t.getTimbreBlocModel().getAnnee():i=i+t.getAnnee(),p(e)&&(i=i+"/"+e),p(t.getIdBloc())&&(i=i+"/bloc/"+t.getIdBloc()),i}acquisDoublon(t,e){this.authService.user$.pipe(T(i=>p(i))).subscribe(i=>{i?.getDroit()>=9?this.timbreUtilsService.acquis(t,e):this.utilsService.droitInsuffisant()})}modifierDialog(t){let e=this.dialog.open(at,{height:"75vh",maxHeight:"750px",width:"30%"});e.componentInstance.id=t.getId(),e.afterClosed().subscribe(()=>{e.close()})}supprimerDialog(t){let e=this.dialog.open(ke,{maxHeight:"95vh",data:{titre:"Confirmation",message:"Souhaitez-vous supprimer le timbre <b>n\xB0 "+t?.getId()+"</b> ?",btnDroite:"Oui",btnGauche:"Non"}});e.afterClosed().subscribe(()=>{e.componentInstance.data.resultat==="valider"&&this.supprimer(t)})}static \u0275fac=function(e){return new(e||r)(R(Ae),R(X),R(z),R(lt),R(oe),R(q),R(ne))};static \u0275prov=se({token:r,factory:r.\u0275fac})};var N=class extends Ee{annee;total;nombre;acquis;doublon;nombreCarnet;nombreTimbresCarnet;acquisTimbresCarnet;doublonTimbresCarnet;nombreBloc;acquisBloc;doublonBloc;nombreTimbresBloc;acquisTimbresBloc;doublonTimbresBloc;constructor(t,e,i,n,o,l,d,b,B,A,O,Ie,ht,Jt,Xt){super(),this.annee=t||null,this.total=e||0,this.nombre=i||0,this.acquis=n||0,this.doublon=o||0,this.nombreCarnet=l||0,this.nombreTimbresCarnet=d||0,this.acquisTimbresCarnet=b||0,this.doublonTimbresCarnet=B||0,this.nombreBloc=A||0,this.acquisBloc=O||0,this.doublonBloc=Ie||0,this.nombreTimbresBloc=ht||0,this.acquisTimbresBloc=Jt||0,this.doublonTimbresBloc=Xt||0}getAnnee(){return this.annee}setAnnee(t){this.annee=t}getTotal(){return this.total}setTotal(t){this.total=t}getNombre(){return this.nombre}setNombre(t){this.nombre=t}getAcquis(){return this.acquis}setAcquis(t){this.acquis=t}getDoublon(){return this.doublon}setDoublon(t){this.doublon=t}getNombreCarnet(){return this.nombreCarnet}setNombreCarnet(t){this.nombreCarnet=t}getNombreTimbresCarnet(){return this.nombreTimbresCarnet}setNombreTimbresCarnet(t){this.nombreTimbresCarnet=t}getAcquisTimbresCarnet(){return this.acquisTimbresCarnet}setAcquisTimbresCarnet(t){this.acquisTimbresCarnet=t}getDoublonTimbresCarnet(){return this.doublonTimbresCarnet}setDoublonTimbresCarnet(t){this.doublonTimbresCarnet=t}getNombreBloc(){return this.nombreBloc}setNombreBloc(t){this.nombreBloc=t}getAcquisBloc(){return this.acquisBloc}setAcquisBloc(t){this.acquisBloc=t}getDoublonBloc(){return this.doublonBloc}setDoublonBloc(t){this.doublonBloc=t}getNombreTimbresBloc(){return this.nombreTimbresBloc}setNombreTimbresBloc(t){this.nombreTimbresBloc=t}getAcquisTimbresBloc(){return this.acquisTimbresBloc}setAcquisTimbresBloc(t){this.acquisTimbresBloc=t}getDoublonTimbresBloc(){return this.doublonTimbresBloc}setDoublonTimbresBloc(t){this.doublonTimbresBloc=t}};I([E("Ann\xE9e")],N.prototype,"annee",2),I([E("Total")],N.prototype,"total",2),I([E("Nombre timbres")],N.prototype,"nombre",2),I([E("Total de timbres acquis")],N.prototype,"acquis",2),I([E("Total de timbres en doublon")],N.prototype,"doublon",2),I([E("Carnet")],N.prototype,"nombreCarnet",2),I([E("Timbres carnet")],N.prototype,"nombreTimbresCarnet",2),I([E("Total timbres carnet acquis")],N.prototype,"acquisTimbresCarnet",2),I([E("Total timbres carnet en doublon")],N.prototype,"doublonTimbresCarnet",2),I([E("Bloc")],N.prototype,"nombreBloc",2),I([E("Total bloc acquis")],N.prototype,"acquisBloc",2),I([E("Total bloc en doublon")],N.prototype,"doublonBloc",2),I([E("Timbres bloc")],N.prototype,"nombreTimbresBloc",2),I([E("Total timbres bloc acquis")],N.prototype,"acquisTimbresBloc",2),I([E("Total timbres bloc en doublon")],N.prototype,"doublonTimbresBloc",2);var Ft=class r{constructor(t,e,i){this.timbreService=t;this.timbreBlocService=e;this.timbreUtilsService=i}load$=new D(!1);timbresResume$=new D(null);totalTimbreResume$=new D(null);getResume(t){this.load$.next(!1),this.timbresResume$.next(null),this.totalTimbreResume$.next(null),Y([this.timbreUtilsService.getAllTimbres(t),this.timbreService.getTimbreAcquis(),this.timbreBlocService.getAllBlocs(t),this.timbreBlocService.getTimbreBlocAcquis()]).pipe(T()).subscribe(([e,i,n,o])=>{this.timbresResume$.next(this.construct(e,i,n,o)),this.timbreUtilsService.reinitResume$.next(!1)})}construct(t,e,i,n){let o=[];if(t?.length>0&&(t.forEach(l=>{let d=l.annee;if(p(i)&&J(l.annee)&&p(l.idBloc)){let A=i.find(O=>O.id==l.idBloc);p(A)&&(d=A.annee)}let b=o.find(A=>A.getAnnee()==d);J(b)&&(b=new N,b.setAnnee(d),o.push(b)),b.setTotal(b.getTotal()+1);let B=p(l.idBloc)?i.find(A=>A.id==l.idBloc):null;if(p(l.idBloc)?p(B)&&B.carnet?b.setNombreTimbresCarnet(b.getNombreTimbresCarnet()+1):b.setNombreTimbresBloc(b.getNombreTimbresBloc()+1):b.setNombre(b.getNombre()+1),p(e)){let A=e.find(O=>O.idTimbre==l.id);p(A)&&(A.acquis==!0&&(p(l.idBloc)?p(B)&&B.carnet?b.setAcquisTimbresCarnet(b.getAcquisTimbresCarnet()+1):b.setAcquisTimbresBloc(b.getAcquisTimbresBloc()+1):b.setAcquis(b.getAcquis()+1)),A.doublon==!0&&(p(l.idBloc)?p(B)&&B.carnet?b.setDoublonTimbresCarnet(b.getDoublonTimbresCarnet()+1):b.setDoublonTimbresBloc(b.getDoublonTimbresBloc()+1):b.setDoublon(b.getDoublon()+1)))}}),i.forEach(l=>{let d=o.find(b=>b.getAnnee()==l.annee);if(J(d)&&(d=new N,d.setAnnee(l.annee),o.push(d)),l.carnet?d.setNombreCarnet(d.getNombreCarnet()+1):d.setNombreBloc(d.getNombreBloc()+1),p(n)){let b=n.find(B=>B.idBloc==l.id);p(b)&&(b.acquis==!0&&(l.carnet||d.setAcquisBloc(d.getAcquisBloc()+1)),b.doublon==!0&&(l.carnet||d.setDoublonBloc(d.getDoublonBloc()+1)))}})),p(o)&&o?.length>0){let l=new N;o.forEach(d=>{l.setTotal(l.getTotal()+d.getTotal()),l.setNombre(l.getNombre()+d.getNombre()),l.setAcquis(l.getAcquis()+d.getAcquis()),l.setDoublon(l.getDoublon()+d.getDoublon()),l.setNombreCarnet(l.getNombreCarnet()+d.getNombreCarnet()),l.setNombreTimbresCarnet(l.getNombreTimbresCarnet()+d.getNombreTimbresCarnet()),l.setAcquisTimbresCarnet(l.getAcquisTimbresCarnet()+d.getAcquisTimbresCarnet()),l.setDoublonTimbresCarnet(l.getDoublonTimbresCarnet()+d.getDoublonTimbresCarnet()),l.setNombreBloc(l.getNombreBloc()+d.getNombreBloc()),l.setAcquisBloc(l.getAcquisBloc()+d.getAcquisBloc()),l.setDoublonBloc(l.getDoublonBloc()+d.getDoublonBloc()),l.setNombreTimbresBloc(l.getNombreTimbresBloc()+d.getNombreTimbresBloc()),l.setAcquisTimbresBloc(l.getAcquisTimbresBloc()+d.getAcquisTimbresBloc()),l.setDoublonTimbresBloc(l.getDoublonTimbresBloc()+d.getDoublonTimbresBloc())}),this.totalTimbreResume$.next(l)}return this.load$.next(!0),o}static \u0275fac=function(e){return new(e||r)(R(Q),R(z),R(q))};static \u0275prov=se({token:r,factory:r.\u0275fac})};var qe=class r{constructor(t){this.firestore=t}loadGlob$=new D(!0);load$=new D(!0);supprimer(t,e){return this.load$.next(!1),this.firestore.collection(t).valueChanges().pipe(T()).subscribe(i=>{p(i)&&i?.length>0?i.forEach((n,o)=>{this.firestore.collection(t).ref.where(e,"==",n[e]).get().then(l=>{l.forEach(d=>{d.ref.delete(),o==i.length-1&&this.load$.next(!0)})}).catch(l=>{console.error("Erreur de suppression :",l)})}):this.load$.next(!0)})}supprimerTimbres(t){this.load$.next(!1),this.firestore.collection("/timbres",e=>{let i=e;return i=i.where("annee","==",t),i}).valueChanges().pipe(T()).subscribe(e=>{p(e)&&e?.length>0?e.forEach((i,n)=>{this.firestore.collection("/timbres").ref.where("id","==",i.id).get().then(o=>{o.forEach(l=>{this.supprimerAcquis(i.id),l.ref.delete(),n==e.length-1&&this.load$.next(!0)})}).catch(o=>{console.error("Erreur de suppression :",o)})}):this.load$.next(!0)})}supprimerAcquis(t){this.load$.next(!1),this.firestore.collection("/timbres_acquis",e=>{let i=e;return i=i.where("idTimbre","==",t),i}).valueChanges().pipe(T()).subscribe(e=>{p(e)&&e?.length>0?e.forEach((i,n)=>{this.firestore.collection("/timbres_acquis").ref.where("idTimbre","==",i.idTimbre).get().then(o=>{o.forEach(l=>{l.ref.delete(),n==e.length-1&&this.load$.next(!0)})}).catch(o=>{console.error("Erreur de suppression :",o)})}):this.load$.next(!0)})}supprimerBlocs(t){this.load$.next(!1),this.firestore.collection("/timbres_bloc",e=>{let i=e;return i=i.where("annee","==",t),i}).valueChanges().pipe(T()).subscribe(e=>{p(e)&&e?.length>0?e.forEach((i,n)=>{this.firestore.collection("/timbres_bloc").ref.where("id","==",i.id).get().then(o=>{o.forEach(l=>{this.supprimerBlocsAcquis(i.id),l.ref.delete(),n==e.length-1&&this.load$.next(!0)})}).catch(o=>{console.error("Erreur de suppression :",o)})}):this.load$.next(!0)})}supprimerBlocsAcquis(t){this.load$.next(!1),this.firestore.collection("/timbres_bloc_acquis",e=>{let i=e;return i=i.where("idBloc","==",t),i}).valueChanges().pipe(T()).subscribe(e=>{p(e)&&e?.length>0?e.forEach((i,n)=>{this.firestore.collection("/timbres_bloc_acquis").ref.where("id","==",i.id).get().then(o=>{o.forEach(l=>{l.ref.delete(),n==e.length-1&&this.load$.next(!0)})}).catch(o=>{console.error("Erreur de suppression :",o)})}):this.load$.next(!0)})}static \u0275fac=function(e){return new(e||r)(R(Ae))};static \u0275prov=se({token:r,factory:r.\u0275fac})};var qt=class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=vt({type:r});static \u0275inj=xt({providers:[qe],imports:[wi,yt,mi,Bt,It,Ai,Dt,Et]})};var $i=class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=vt({type:r});static \u0275inj=xt({imports:[yt,Bt,It,ai,ci,Et,si,di,ui,Dt,ie,qt,_e,Te,At]})};var ji=r=>({accent50:r});function cn(r,t){r&1&&M(0,"lib-spinner",2),r&2&&s("textSpec","Chargement en cours ...")}function pn(r,t){if(r&1&&(a(0,"th",28),M(1,"lib-libelle-model",29),c()),r&2){let e=u(2);m(),s("object",e.timbreResumeModel)("key","annee")}}function un(r,t){if(r&1&&(a(0,"td",30),f(1),c()),r&2){let e=t.$implicit;m(),S(" ",e==null?null:e.getAnnee()," ")}}function dn(r,t){r&1&&M(0,"td",31)}function bn(r,t){if(r&1&&(a(0,"th",28),M(1,"lib-libelle-model",29),c()),r&2){let e=u(2);m(),s("object",e.timbreResumeModel)("key","total")}}function fn(r,t){if(r&1&&(a(0,"td",30),f(1),c()),r&2){let e=t.$implicit;m(),S(" ",e==null?null:e.getTotal()," ")}}function gn(r,t){if(r&1&&(a(0,"td",31)(1,"b"),f(2),_(3,"async"),c()()),r&2){let e,i=u(2);m(2),S("",(e=h(3,1,i.timbreResumeService.totalTimbreResume$))==null?null:e.getTotal()," ")}}function _n(r,t){if(r&1&&(a(0,"th",32),M(1,"lib-libelle-model",29),c()),r&2){let e=u(2);m(),s("object",e.timbreResumeModel)("key","nombre")}}function hn(r,t){if(r&1&&(a(0,"td",33),f(1),c()),r&2){let e=t.$implicit;m(),S(" ",e==null?null:e.getNombre()," ")}}function Tn(r,t){if(r&1&&(a(0,"td",31)(1,"b"),f(2),_(3,"async"),c()()),r&2){let e,i=u(2);m(2),S("",(e=h(3,1,i.timbreResumeService.totalTimbreResume$))==null?null:e.getNombre()," ")}}function xn(r,t){if(r&1&&(a(0,"th",32),M(1,"lib-icon",34),c()),r&2){let e=u(2);m(),s("type",e.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",e.FontAwesomeEnum.CHECK)("info",e.timbreResumeModel.getPropertyLibelle("acquis"))}}function vn(r,t){if(r&1&&(a(0,"td",35),f(1),c()),r&2){let e=t.$implicit;s("ngClass",ct(2,ji,(e==null?null:e.getNombre())==(e==null?null:e.getAcquis()))),m(),S(" ",e==null?null:e.getAcquis()," ")}}function Cn(r,t){if(r&1&&(a(0,"td",31)(1,"b"),f(2),_(3,"async"),c()()),r&2){let e,i=u(2);m(2),S("",(e=h(3,1,i.timbreResumeService.totalTimbreResume$))==null?null:e.getAcquis()," ")}}function Mn(r,t){if(r&1&&(a(0,"th",32),M(1,"lib-icon",34),c()),r&2){let e=u(2);m(),s("type",e.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",e.FontAwesomeEnum.CHECK_DOUBLE)("info",e.timbreResumeModel.getPropertyLibelle("doublon"))}}function yn(r,t){if(r&1&&(a(0,"td",35),f(1),c()),r&2){let e=t.$implicit;s("ngClass",ct(2,ji,(e==null?null:e.getNombre())==(e==null?null:e.getDoublon()))),m(),S(" ",e==null?null:e.getDoublon()," ")}}function Sn(r,t){if(r&1&&(a(0,"td",31)(1,"b"),f(2),_(3,"async"),c()()),r&2){let e,i=u(2);m(2),S("",(e=h(3,1,i.timbreResumeService.totalTimbreResume$))==null?null:e.getDoublon()," ")}}function Bn(r,t){if(r&1&&(a(0,"th",32),M(1,"lib-libelle-model",29),c()),r&2){let e=u(2);m(),s("object",e.timbreResumeModel)("key","nombreCarnet")}}function In(r,t){if(r&1&&(a(0,"td",35),f(1),c()),r&2){let e=t.$implicit;s("ngClass",(e==null?null:e.getNombreCarnet())==0?"gray25":"primary25"),m(),S(" ",(e==null?null:e.getNombreCarnet())>0?e==null?null:e.getNombreCarnet():""," ")}}function En(r,t){if(r&1&&(a(0,"td",31)(1,"b"),f(2),_(3,"async"),c()()),r&2){let e,i=u(2);m(2),S("",(e=h(3,1,i.timbreResumeService.totalTimbreResume$))==null?null:e.getNombreCarnet()," ")}}function wn(r,t){if(r&1&&(a(0,"th",32),M(1,"lib-libelle-model",29),c()),r&2){let e=u(2);m(),s("object",e.timbreResumeModel)("key","nombreTimbresCarnet")}}function An(r,t){if(r&1&&(a(0,"td",35),f(1),c()),r&2){let e=t.$implicit;s("ngClass",(e==null?null:e.getNombreCarnet())==0?"gray25":"primary25"),m(),S(" ",(e==null?null:e.getNombreCarnet())>0?e==null?null:e.getNombreTimbresCarnet():""," ")}}function Dn(r,t){if(r&1&&(a(0,"td",31)(1,"b"),f(2),_(3,"async"),c()()),r&2){let e,i=u(2);m(2),S("",(e=h(3,1,i.timbreResumeService.totalTimbreResume$))==null?null:e.getNombreTimbresCarnet()," ")}}function Rn(r,t){if(r&1&&(a(0,"th",32),M(1,"lib-icon",34),c()),r&2){let e=u(2);m(),s("type",e.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",e.FontAwesomeEnum.CHECK)("info",e.timbreResumeModel.getPropertyLibelle("acquisTimbresCarnet"))}}function On(r,t){if(r&1&&(a(0,"td",35),f(1),c()),r&2){let e=t.$implicit;s("ngClass",(e==null?null:e.getNombreTimbresCarnet())==0?"gray25":(e==null?null:e.getNombreTimbresCarnet())==(e==null?null:e.getAcquisTimbresCarnet())?"accent50":"primary25"),m(),S(" ",(e==null?null:e.getNombreCarnet())>0?e==null?null:e.getAcquisTimbresCarnet():""," ")}}function Nn(r,t){if(r&1&&(a(0,"td",31)(1,"b"),f(2),_(3,"async"),c()()),r&2){let e,i=u(2);m(2),S("",(e=h(3,1,i.timbreResumeService.totalTimbreResume$))==null?null:e.getAcquisTimbresCarnet()," ")}}function Ln(r,t){if(r&1&&(a(0,"th",32),M(1,"lib-icon",34),c()),r&2){let e=u(2);m(),s("type",e.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",e.FontAwesomeEnum.CHECK_DOUBLE)("info",e.timbreResumeModel.getPropertyLibelle("doublonTimbresCarnet"))}}function Un(r,t){if(r&1&&(a(0,"td",35),f(1),c()),r&2){let e=t.$implicit;s("ngClass",(e==null?null:e.getNombreTimbresCarnet())==0?"gray25":(e==null?null:e.getNombreTimbresCarnet())==(e==null?null:e.getDoublonTimbresCarnet())?"accent50":"primary25"),m(),S(" ",(e==null?null:e.getNombreCarnet())>0?e==null?null:e.getDoublonTimbresCarnet():""," ")}}function Fn(r,t){if(r&1&&(a(0,"td",31)(1,"b"),f(2),_(3,"async"),c()()),r&2){let e,i=u(2);m(2),S("",(e=h(3,1,i.timbreResumeService.totalTimbreResume$))==null?null:e.getDoublonTimbresCarnet()," ")}}function qn(r,t){if(r&1&&(a(0,"th",32),M(1,"lib-libelle-model",29),c()),r&2){let e=u(2);m(),s("object",e.timbreResumeModel)("key","nombreBloc")}}function $n(r,t){if(r&1&&(a(0,"td",35),f(1),c()),r&2){let e=t.$implicit;s("ngClass",(e==null?null:e.getNombreBloc())==0?"gray25":""),m(),S(" ",(e==null?null:e.getNombreBloc())>0?e==null?null:e.getNombreBloc():""," ")}}function jn(r,t){if(r&1&&(a(0,"td",31)(1,"b"),f(2),_(3,"async"),c()()),r&2){let e,i=u(2);m(2),S("",(e=h(3,1,i.timbreResumeService.totalTimbreResume$))==null?null:e.getNombreBloc()," ")}}function Pn(r,t){if(r&1&&(a(0,"th",32),M(1,"lib-icon",34),c()),r&2){let e=u(2);m(),s("type",e.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",e.FontAwesomeEnum.CHECK)("info",e.timbreResumeModel.getPropertyLibelle("acquisBloc"))}}function Vn(r,t){if(r&1&&(a(0,"td",35),f(1),c()),r&2){let e=t.$implicit;s("ngClass",(e==null?null:e.getNombreBloc())==0?"gray25":e.getNombreBloc()==(e==null?null:e.getAcquisBloc())?"accent50":""),m(),S(" ",(e==null?null:e.getNombreBloc())>0?e==null?null:e.getAcquisBloc():""," ")}}function kn(r,t){if(r&1&&(a(0,"td",31)(1,"b"),f(2),_(3,"async"),c()()),r&2){let e,i=u(2);m(2),S("",(e=h(3,1,i.timbreResumeService.totalTimbreResume$))==null?null:e.getAcquisBloc()," ")}}function Hn(r,t){if(r&1&&(a(0,"th",32),M(1,"lib-icon",34),c()),r&2){let e=u(2);m(),s("type",e.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",e.FontAwesomeEnum.CHECK_DOUBLE)("info",e.timbreResumeModel.getPropertyLibelle("doublonBloc"))}}function Gn(r,t){if(r&1&&(a(0,"td",35),f(1),c()),r&2){let e=t.$implicit;s("ngClass",(e==null?null:e.getNombreBloc())==0?"gray25":e.getNombreBloc()==(e==null?null:e.getDoublonBloc())?"accent50":""),m(),S(" ",(e==null?null:e.getNombreBloc())>0?e==null?null:e.getDoublonBloc():""," ")}}function Wn(r,t){if(r&1&&(a(0,"td",31)(1,"b"),f(2),_(3,"async"),c()()),r&2){let e,i=u(2);m(2),S("",(e=h(3,1,i.timbreResumeService.totalTimbreResume$))==null?null:e.getDoublonBloc()," ")}}function zn(r,t){if(r&1&&(a(0,"th",32),M(1,"lib-libelle-model",29),c()),r&2){let e=u(2);m(),s("object",e.timbreResumeModel)("key","nombreTimbresBloc")}}function Qn(r,t){if(r&1&&(a(0,"td",35),f(1),c()),r&2){let e=t.$implicit;s("ngClass",(e==null?null:e.getNombreTimbresBloc())==0?"gray25":"primary25"),m(),S(" ",(e==null?null:e.getNombreTimbresBloc())>0?e==null?null:e.getNombreTimbresBloc():""," ")}}function Yn(r,t){if(r&1&&(a(0,"td",31)(1,"b"),f(2),_(3,"async"),c()()),r&2){let e,i=u(2);m(2),S("",(e=h(3,1,i.timbreResumeService.totalTimbreResume$))==null?null:e.getNombreTimbresBloc()," ")}}function Zn(r,t){if(r&1&&(a(0,"th",32),M(1,"lib-icon",34),c()),r&2){let e=u(2);m(),s("type",e.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",e.FontAwesomeEnum.CHECK)("info",e.timbreResumeModel.getPropertyLibelle("acquisTimbresBloc"))}}function Kn(r,t){if(r&1&&(a(0,"td",35),f(1),c()),r&2){let e=t.$implicit;s("ngClass",(e==null?null:e.getNombreTimbresBloc())==0?"gray25":(e==null?null:e.getNombreTimbresBloc())==(e==null?null:e.getAcquisTimbresBloc())?"accent50":"primary25"),m(),S(" ",(e==null?null:e.getNombreTimbresBloc())>0?e==null?null:e.getAcquisTimbresBloc():""," ")}}function Jn(r,t){if(r&1&&(a(0,"td",31)(1,"b"),f(2),_(3,"async"),c()()),r&2){let e,i=u(2);m(2),S("",(e=h(3,1,i.timbreResumeService.totalTimbreResume$))==null?null:e.getAcquisTimbresBloc()," ")}}function Xn(r,t){if(r&1&&(a(0,"th",32),M(1,"lib-icon",34),c()),r&2){let e=u(2);m(),s("type",e.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",e.FontAwesomeEnum.CHECK_DOUBLE)("info",e.timbreResumeModel.getPropertyLibelle("doublonTimbresBloc"))}}function er(r,t){if(r&1&&(a(0,"td",35),f(1),c()),r&2){let e=t.$implicit;s("ngClass",(e==null?null:e.getNombreTimbresBloc())==0?"gray25":(e==null?null:e.getNombreTimbresBloc())==(e==null?null:e.getDoublonTimbresBloc())?"accent50":"primary25"),m(),S(" ",(e==null?null:e.getNombreTimbresBloc())>0?e==null?null:e.getDoublonTimbresBloc():""," ")}}function tr(r,t){if(r&1&&(a(0,"td",31)(1,"b"),f(2),_(3,"async"),c()()),r&2){let e,i=u(2);m(2),S("",(e=h(3,1,i.timbreResumeService.totalTimbreResume$))==null?null:e.getDoublonTimbresBloc()," ")}}function ir(r,t){r&1&&M(0,"tr",36)}function nr(r,t){if(r&1){let e=w();a(0,"tr",37),y("click",function(){let n=x(e).$implicit,o=u(2);return v(o.filtreParAnnee(n))}),c()}}function rr(r,t){r&1&&M(0,"tr",38)}function or(r,t){if(r&1){let e=w();a(0,"table",3),y("matSortChange",function(n){x(e);let o=u();return v(o.sortData(n))}),L(1,4),g(2,pn,2,2,"th",5)(3,un,2,1,"td",6)(4,dn,1,0,"td",7),U(),L(5,8),g(6,bn,2,2,"th",5)(7,fn,2,1,"td",6)(8,gn,4,3,"td",7),U(),L(9,9),g(10,_n,2,2,"th",10)(11,hn,2,1,"td",11)(12,Tn,4,3,"td",7),U(),L(13,12),g(14,xn,2,3,"th",10)(15,vn,2,4,"td",13)(16,Cn,4,3,"td",7),U(),L(17,14),g(18,Mn,2,3,"th",10)(19,yn,2,4,"td",13)(20,Sn,4,3,"td",7),U(),L(21,15),g(22,Bn,2,2,"th",10)(23,In,2,2,"td",13)(24,En,4,3,"td",7),U(),L(25,16),g(26,wn,2,2,"th",10)(27,An,2,2,"td",13)(28,Dn,4,3,"td",7),U(),L(29,17),g(30,Rn,2,3,"th",10)(31,On,2,2,"td",13)(32,Nn,4,3,"td",7),U(),L(33,18),g(34,Ln,2,3,"th",10)(35,Un,2,2,"td",13)(36,Fn,4,3,"td",7),U(),L(37,19),g(38,qn,2,2,"th",10)(39,$n,2,2,"td",13)(40,jn,4,3,"td",7),U(),L(41,20),g(42,Pn,2,3,"th",10)(43,Vn,2,2,"td",13)(44,kn,4,3,"td",7),U(),L(45,21),g(46,Hn,2,3,"th",10)(47,Gn,2,2,"td",13)(48,Wn,4,3,"td",7),U(),L(49,22),g(50,zn,2,2,"th",10)(51,Qn,2,2,"td",13)(52,Yn,4,3,"td",7),U(),L(53,23),g(54,Zn,2,3,"th",10)(55,Kn,2,2,"td",13)(56,Jn,4,3,"td",7),U(),L(57,24),g(58,Xn,2,3,"th",10)(59,er,2,2,"td",13)(60,tr,4,3,"td",7),U(),g(61,ir,1,0,"tr",25)(62,nr,1,0,"tr",26)(63,rr,1,0,"tr",27),c()}if(r&2){let e=u();s("dataSource",e.dataSource),m(61),s("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),m(),s("matRowDefColumns",e.displayedColumns),m(),s("matFooterRowDef",e.displayedColumns)("matFooterRowDefSticky",!0)}}var $t=class r{constructor(t,e,i,n,o){this.dialogRef=t;this.timbreResumeService=e;this.timbreService=i;this.timbreBlocService=n;this.timbreUtilsService=o;this.dataSource=new Qt([])}paginator;sort;dataSource=new Qt;displayedColumns=["annee","total","nombre","acquis","doublon","nombreCarnet","nombreTimbresCarnet","acquisTimbresCarnet","doublonTimbresCarnet","nombreBloc","acquisBloc","doublonBloc","nombreTimbresBloc","acquisTimbresBloc","doublonTimbresBloc"];timbreResumeModel=new N;FontAwesomeEnum=ue;FontAwesomeTypeEnum=pe;ngOnInit(){this.timbreUtilsService.reinitResume$.pipe(T()).subscribe(t=>{t==!0&&this.timbreResumeService.getResume(),this.initData()})}initData(){this.timbreResumeService.timbresResume$.pipe(T(t=>p(t)&&t?.length>0)).subscribe(t=>{this.dataSource.data=t})}ngAfterViewInit(){this.dataSource.paginator=this.paginator}sortData(t){p(t)&&(this.dataSource.sort=this.sort)}filtreParAnnee(t){window.location.href.indexOf("bloc")>0?(this.timbreUtilsService.initCritereBloc(),this.timbreUtilsService.timbreCritereBlocModel.setAnnees([t.getAnnee()]),this.timbreBlocService.getBlocs(this.timbreUtilsService.timbreCritereBlocModel,!1)):(this.timbreUtilsService.initCritere(),this.timbreUtilsService.timbreCritereModel.setAnnees([t.getAnnee()]),this.timbreService.getTimbres(this.timbreUtilsService.timbreCritereModel,!1)),this.dialogRef.close()}static \u0275fac=function(e){return new(e||r)(C(he),C(Ft),C(Q),C(z),C(q))};static \u0275cmp=$({type:r,selectors:[["app-timbre-resume"]],viewQuery:function(e,i){if(e&1&&($e(bi,5),$e(wt,5)),e&2){let n;je(n=Pe())&&(i.paginator=n.first),je(n=Pe())&&(i.sort=n.first)}},decls:4,vars:4,consts:[["load",""],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["mat-table","","matSort","",3,"matSortChange","dataSource"],["matColumnDef","annee","sticky",""],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","primary50",4,"matCellDef"],["mat-footer-cell","",4,"matFooterCellDef"],["matColumnDef","total","sticky",""],["matColumnDef","nombre"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","acquis"],["mat-cell","",3,"ngClass",4,"matCellDef"],["matColumnDef","doublon"],["matColumnDef","nombreCarnet"],["matColumnDef","nombreTimbresCarnet"],["matColumnDef","acquisTimbresCarnet"],["matColumnDef","doublonTimbresCarnet"],["matColumnDef","nombreBloc"],["matColumnDef","acquisBloc"],["matColumnDef","doublonBloc"],["matColumnDef","nombreTimbresBloc"],["matColumnDef","acquisTimbresBloc"],["matColumnDef","doublonTimbresBloc"],["mat-header-row","","class","bg-primary color-white",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","mat-row",3,"click",4,"matRowDef","matRowDefColumns"],["mat-footer-row","","class","bg-primary color-white",4,"matFooterRowDef","matFooterRowDefSticky"],["mat-header-cell","","mat-sort-header",""],[3,"object","key"],["mat-cell","",1,"primary50"],["mat-footer-cell",""],["mat-header-cell",""],["mat-cell",""],[1,"click",2,"font-size","1.2em",3,"type","icone","info"],["mat-cell","",3,"ngClass"],["mat-header-row","",1,"bg-primary","color-white"],["mat-row","",1,"mat-row",3,"click"],["mat-footer-row","",1,"bg-primary","color-white"]],template:function(e,i){if(e&1&&(g(0,cn,1,1,"ng-template",1),_(1,"async"),g(2,or,64,6,"ng-template",null,0,K)),e&2){let n=F(3);s("ngIf",h(1,2,i.timbreResumeService.load$)==!1)("ngIfElse",n)}},dependencies:[fi,_i,Mi,Ti,gi,Si,hi,yi,xi,Ci,vi,Bi,Ei,Ii,wt,At,ae,j,fe,de,re,xe,nt,P],styles:["th[_ngcontent-%COMP%], tr[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{text-align:center}th[_ngcontent-%COMP%]{width:40px!important;max-width:40px!important}.mat-row[_ngcontent-%COMP%]{padding:0!important;height:30px}.mat-row[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{width:40px!important}@media screen and (max-width: 800px){th[_ngcontent-%COMP%]{width:25px!important;max-width:25px!important}.mat-row[_ngcontent-%COMP%]{padding:0!important;height:15px}.mat-row[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{width:25px!important}th[_ngcontent-%COMP%], .mat-row[_ngcontent-%COMP%]{font-size:.8em}}"]})};var Pi=ki(Hi());var Pt=class r{transform(t,e){let i=[],n=Object.keys(t),o=Object.values(t);for(let l=0;l<n.length;l++)i.push({key:n[l],value:o[l]});return e=="sort"?i?.sort(function(l,d){return l.key<d.key?-1:l.key>d.key?1:0}):i}static \u0275fac=function(e){return new(e||r)};static \u0275pipe=ei({name:"enumToArray",type:r,pure:!0})};function mr(r,t){if(r&1&&(a(0,"mat-option",6),f(1),c()),r&2){let e=t.$implicit;s("value",e.value),m(),S(" ",e.value," ")}}function sr(r,t){if(r&1&&(a(0,"mat-option",6),f(1),c()),r&2){let e=t.$implicit;s("value",e),m(),S(" ",e," ")}}function ar(r,t){if(r&1){let e=w();a(0,"div",1)(1,"div",2)(2,"mat-select",3),H("ngModelChange",function(n){x(e);let o=u();return k(o.timbreUtilsService.timbreCritereModel.type,n)||(o.timbreUtilsService.timbreCritereModel.type=n),v(n)}),y("ngModelChange",function(n){x(e);let o=u();return v(o.filtreByCritereEvent(n))}),g(3,mr,2,2,"mat-option",4),_(4,"enumToArray"),c()(),a(5,"div",2)(6,"mat-select",5),H("ngModelChange",function(n){x(e);let o=u();return k(o.timbreUtilsService.timbreCritereModel.acquis,n)||(o.timbreUtilsService.timbreCritereModel.acquis=n),v(n)}),y("ngModelChange",function(){x(e);let n=u();return v(n.filtreByCritere())}),a(7,"mat-option",6),f(8," Oui"),c(),a(9,"mat-option",6),f(10," Non"),c(),a(11,"mat-option",6),f(12," Tous"),c()()(),a(13,"div",2)(14,"mat-select",7),H("ngModelChange",function(n){x(e);let o=u();return k(o.timbreUtilsService.timbreCritereModel.doublon,n)||(o.timbreUtilsService.timbreCritereModel.doublon=n),v(n)}),y("ngModelChange",function(){x(e);let n=u();return v(n.filtreByCritere())}),a(15,"mat-option",6),f(16," Oui"),c(),a(17,"mat-option",6),f(18," Non"),c(),a(19,"mat-option",6),f(20," Tous"),c()()(),a(21,"div",8)(22,"mat-select",9),H("ngModelChange",function(n){x(e);let o=u();return k(o.timbreUtilsService.timbreCritereModel.annees,n)||(o.timbreUtilsService.timbreCritereModel.annees=n),v(n)}),y("ngModelChange",function(){x(e);let n=u();return v(n.filtreByCritere())}),g(23,sr,2,2,"mat-option",4),_(24,"async"),c()()()}if(r&2){let e=u();m(2),V("ngModel",e.timbreUtilsService.timbreCritereModel.type),s("placeholder","Type"),m(),s("ngForOf",h(4,16,e.TypeTimbreEnum)),m(3),V("ngModel",e.timbreUtilsService.timbreCritereModel.acquis),s("placeholder","Acquis"),m(),s("value","OUI"),m(2),s("value","NON"),m(2),s("value","TOUS"),m(3),V("ngModel",e.timbreUtilsService.timbreCritereModel.doublon),s("placeholder","Doublon"),m(),s("value","OUI"),m(2),s("value","NON"),m(2),s("value","TOUS"),m(3),V("ngModel",e.timbreUtilsService.timbreCritereModel.annees),s("placeholder","Ann\xE9es"),m(),s("ngForOf",h(24,18,e.annees$))}}var Vt=class r{constructor(t,e,i){this.authService=t;this.timbreService=e;this.timbreUtilsService=i}modif=!0;annees$;TypeTimbreEnum=ut;ngOnInit(){this.annees$=this.timbreUtilsService.getAnneesAsync("/timbres")}filtreByCritereEvent(t){this.timbreUtilsService.timbreCritereModel[t]="OUI",this.recherche()}filtreByCritere(){this.timbreUtilsService.timbreCritereModel.getAcquis()=="NON"&&this.timbreUtilsService.timbreCritereModel.setDoublon("TOUS"),this.recherche()}recherche(){p(this.timbreUtilsService.timbreCritereModel.getAnnees())&&this.timbreUtilsService.timbreCritereModel.getAnnees().length>0&&this.timbreService.getTimbres(this.timbreUtilsService.timbreCritereModel,!1)}static \u0275fac=function(e){return new(e||r)(C(X),C(Q),C(q))};static \u0275cmp=$({type:r,selectors:[["app-timbre-recherche"]],inputs:{modif:"modif"},decls:1,vars:1,consts:[["class","menuRecherche",4,"ngIf"],[1,"menuRecherche"],[1,"form-input","select",2,"width","100px"],["name","type","multiple","",1,"scrollBarAccent",3,"ngModelChange","ngModel","placeholder"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],["name","acquis",3,"ngModelChange","ngModel","placeholder"],[1,"selectMin",3,"value"],["name","doublon",1,"scrollBarAccent",3,"ngModelChange","ngModel","placeholder"],[1,"form-input","select",2,"width","150px"],["name","anneeSelect","multiple","",3,"ngModelChange","ngModel","placeholder"]],template:function(e,i){e&1&&g(0,ar,25,20,"div",0),e&2&&s("ngIf",i.modif)},dependencies:[Te,_e,ce,j,ee,te,P,Pt],styles:[".menuRecherche[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:left;width:100%}.menuRecherche[_ngcontent-%COMP%] > .form-input[_ngcontent-%COMP%]{margin:0 10px;display:flex;flex-direction:column;justify-content:space-between;align-items:stretch}@media screen and (max-width: 800px){.menuRecherche[_ngcontent-%COMP%] > .form-input[_ngcontent-%COMP%]{margin:5px 10px}}"]})};function pr(r,t){if(r&1&&(a(0,"div",3)(1,"span"),f(2,"Nombre de timbres : "),c(),a(3,"span",4),f(4),_(5,"async"),c()()),r&2){let e=u();m(4),Mt(h(5,1,e.total$))}}var kt=class r{constructor(t){this.dialog=t}total$;FontAwesomeEnum=ue;FontAwesomeTypeEnum=pe;resume(){this.dialog.open($t,{height:"auto",maxHeight:"95vh",width:"1000px"})}static \u0275fac=function(e){return new(e||r)(C(ne))};static \u0275cmp=$({type:r,selectors:[["app-timbre-total"]],inputs:{total$:"total$"},decls:4,vars:6,consts:[[1,"timbreTotal"],["class","nbTimbre",4,"ngIf"],[1,"accent","click",3,"click","icone","type","info"],[1,"nbTimbre"],[1,"bold"]],template:function(e,i){e&1&&(a(0,"div",0),g(1,pr,6,3,"div",1),_(2,"async"),a(3,"lib-icon",2),y("click",function(){return i.resume()}),c()()),e&2&&(m(),s("ngIf",h(2,4,i.total$)),m(2),s("icone",i.FontAwesomeEnum.CHART_LINE_UP)("type",i.FontAwesomeTypeEnum.TYPE_SOLID)("info","D\xE9tail par ann\xE9e"))},dependencies:[j,xe,P],styles:[".timbreTotal[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:start;align-content:center;gap:10px}.timbreTotal[_ngcontent-%COMP%]   .nbTimbre[_ngcontent-%COMP%]{font-size:1.2em}.timbreTotal[_ngcontent-%COMP%]   lib-icon[_ngcontent-%COMP%]{font-size:1.5em}@media screen and (max-width: 800px){.timbreTotal[_ngcontent-%COMP%]{height:25px;gap:5px}.timbreTotal[_ngcontent-%COMP%]   .nbTimbre[_ngcontent-%COMP%]{font-size:1em}.timbreTotal[_ngcontent-%COMP%]   lib-icon[_ngcontent-%COMP%]{font-size:1.2em}}"]})};function dr(r,t){if(r&1){let e=w();a(0,"img",21),y("click",function(){x(e);let n=u().$implicit,o=u();return v(o.utilsService.zoom(n==null?null:n.getImageZoom()))}),c()}if(r&2){let e=u().$implicit;s("src",e==null?null:e.getImage(),Ct)}}function br(r,t){if(r&1&&f(0),r&2){let e,i=u().$implicit;S(" ",i==null||(e=i.getTimbreBlocModel())==null?null:e.getAnnee()," ")}}function fr(r,t){if(r&1&&f(0),r&2){let e=u().$implicit;S(" ",e==null?null:e.getAnnee()," ")}}function gr(r,t){if(r&1){let e=w();a(0,"lib-icon",22),y("click",function(){let n;x(e);let o=u().$implicit,l=u();return v(l.utilsService.zoom(o==null||(n=o.getTimbreBlocModel())==null?null:n.getImageZoom()))}),c()}if(r&2){let e,i=u().$implicit,n=u();s("classIcone","primary")("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.IMAGE_POLAROID)("classInfo","imageHoverBloc")("info","<img src='"+(i==null||(e=i.getTimbreBlocModel())==null?null:e.getImageZoom())+"'/>")}}function _r(r,t){if(r&1&&M(0,"lib-icon",23),r&2){let e=u().$implicit,i=u();s("classIcone","primary")("type",i.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",i.FontAwesomeEnum.CIRCLE_INFO)("info",e==null?null:e.getYt())}}function hr(r,t){if(r&1){let e=w();a(0,"div",8)(1,"div",9)(2,"div",10)(3,"lib-icon",11),y("click",function(){let n=x(e).$implicit,o=u();return v(o.timbreService.acquisDoublon(n,!1))}),c(),a(4,"lib-icon",11),y("click",function(){let n=x(e).$implicit,o=u();return v(o.timbreService.acquisDoublon(n,!0))}),c()(),a(5,"div",12)(6,"lib-icon",13),y("click",function(){let n=x(e).$implicit,o=u();return v(o.timbreService.modifierDialog(n))}),c(),a(7,"lib-icon",13),y("click",function(){let n=x(e).$implicit,o=u();return v(o.timbreService.supprimerDialog(n))}),c()()(),a(8,"div",14),g(9,dr,1,1,"img",15),c(),a(10,"div",16),g(11,br,1,1,"ng-template",17)(12,fr,1,1,"ng-template",null,0,K),a(14,"div",18),g(15,gr,1,5,"lib-icon",19)(16,_r,1,4,"lib-icon",20),c()()()}if(r&2){let e,i,n,o,l,d,b=t.$implicit,B=F(13),A=u();m(3),s("classIcone",!(b==null||(e=b.getTimbreAcquisModel())==null)&&e.isAcquis()?"accent":"primary")("type",A.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",!(b==null||(i=b.getTimbreAcquisModel())==null)&&i.isAcquis()?A.FontAwesomeEnum.CIRCLE_MINUS:A.FontAwesomeEnum.CIRCLE_PLUS)("info",!(b==null||(n=b.getTimbreAcquisModel())==null)&&n.isAcquis()?"pas acquis":"acquis"),m(),s("classIcone",!(b==null||(o=b.getTimbreAcquisModel())==null)&&o.isDoublon()?"accent":"primary")("type",A.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",!(b==null||(l=b.getTimbreAcquisModel())==null)&&l.isDoublon()?A.FontAwesomeEnum.CIRCLE_MINUS:A.FontAwesomeEnum.CIRCLE_PLUS)("info",!(b==null||(d=b.getTimbreAcquisModel())==null)&&d.isDoublon()?"pas en double":"en double"),m(2),s("type",A.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",A.FontAwesomeEnum.PENCIL)("info","Modifier"),m(),s("type",A.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",A.FontAwesomeEnum.TRASH)("info","Supprimer"),m(2),s("ngIf",b==null?null:b.getImage()),m(2),s("ngIf",b==null?null:b.getIdBloc())("ngIfElse",B),m(4),s("ngIf",b==null?null:b.getIdBloc()),m(),s("ngIf",b==null?null:b.getYt())}}var Ht=class r{constructor(t,e,i,n){this.authService=t;this.timbreService=e;this.timbreUtilsService=i;this.utilsService=n}timbres$;load$;total$;modif=!0;timbre=new ve;annees$;FontAwesomeEnum=ue;FontAwesomeTypeEnum=pe;ngOnInit(){this.annees$=this.timbreUtilsService.getAnneesAsync("/timbres"),this.timbre.setTimbreAcquisModel(new Z)}static \u0275fac=function(e){return new(e||r)(C(X),C(Q),C(q),C(oe))};static \u0275cmp=$({type:r,selectors:[["app-timbre-resultat"]],inputs:{timbres$:"timbres$",load$:"load$",total$:"total$",modif:"modif"},decls:10,vars:12,consts:[["noBloc",""],[1,"responsiveDirection","responsiveMenu"],[3,"total$"],[3,"modif"],[1,"spinner",3,"fxHide","textSpec"],[3,"fxHide"],[1,"listeTimbre","primary"],["class","detailTimbre border-primary",4,"ngFor","ngForOf"],[1,"detailTimbre","border-primary"],[1,"headerTimbre"],[1,"actionTimbre"],[1,"click",3,"click","classIcone","type","icone","info"],[1,"actionTimbre2"],[1,"primary","click",3,"click","type","icone","info"],[1,"imgTimbre"],["class","image click",3,"src","click",4,"ngIf"],[1,"footerTimbre"],[3,"ngIf","ngIfElse"],[1,"infoTimbre"],["class","click",3,"classIcone","type","icone","classInfo","info","click",4,"ngIf"],["class","click",3,"classIcone","type","icone","info",4,"ngIf"],[1,"image","click",3,"click","src"],[1,"click",3,"click","classIcone","type","icone","classInfo","info"],[1,"click",3,"classIcone","type","icone","info"]],template:function(e,i){e&1&&(a(0,"div",1),M(1,"app-timbre-total",2)(2,"app-timbre-recherche",3),c(),M(3,"lib-spinner",4),_(4,"async"),a(5,"section",5),_(6,"async"),a(7,"div",6),g(8,hr,17,19,"div",7),_(9,"async"),c()()),e&2&&(m(),s("total$",i.total$),m(),s("modif",i.modif),m(),s("fxHide",h(4,6,i.load$)==!0)("textSpec","Chargement en cours ..."),m(2),s("fxHide",h(6,8,i.load$)==!1),m(3),s("ngForOf",h(9,10,i.timbres$)))},dependencies:[ce,j,ze,re,xe,Vt,kt,P],styles:[".spinner[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;align-items:stretch;flex:100%;height:100%}.listeTimbre[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:left;width:100%}.listeTimbre[_ngcontent-%COMP%]   lib-icon[_ngcontent-%COMP%]{font-size:1.2em}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]{margin:10px;width:115px;height:150px;border-radius:10px;border:1px solid;padding:5px 10px;display:flex;flex-direction:column;justify-content:space-between;align-items:stretch}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .headerTimbre[_ngcontent-%COMP%]{height:25px;display:flex;flex-direction:row;justify-content:space-between;align-items:end;width:100%;padding-bottom:5px}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .headerTimbre[_ngcontent-%COMP%]   .actionTimbre[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:start;gap:5px}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .headerTimbre[_ngcontent-%COMP%]   .actionTimbre2[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:end;gap:5px}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .imgTimbre[_ngcontent-%COMP%]{width:100%;display:flex;flex:auto;justify-content:center;align-items:center}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .imgTimbre[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100px;max-height:100px}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .footerTimbre[_ngcontent-%COMP%]{height:25px;display:flex;flex-direction:row;justify-content:space-between;align-items:end;width:100%}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .footerTimbre[_ngcontent-%COMP%]   .infoTimbre[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:end;align-items:end;gap:5px}@media screen and (max-width: 800px){.listeTimbre[_ngcontent-%COMP%]{justify-content:space-evenly}}"]})};function xr(r,t){if(r&1&&(M(0,"lib-spinner",5),_(1,"async")),r&2){let e=u();s("textSpec",h(1,1,e.messageLoad$))}}function vr(r,t){if(r&1&&(M(0,"mat-error",16),_(1,"async")),r&2){let e=u(2);s("innerHTML",h(1,1,e.messageError$),We)}}function Cr(r,t){if(r&1&&M(0,"app-timbre-resultat",17),r&2){let e=u(2);s("load$",e.load$)("timbres$",e.timbres$)("modif",!1)}}function Mr(r,t){if(r&1&&(a(0,"mat-option",21),f(1),c()),r&2){let e=t.$implicit;s("value",e),m(),S(" ",e," ")}}function yr(r,t){if(r&1){let e=w();a(0,"div",18)(1,"mat-select",19),H("ngModelChange",function(n){x(e);let o=u(2);return k(o.annees,n)||(o.annees=n),v(n)}),g(2,Mr,2,2,"mat-option",20),c()()}if(r&2){let e=u(2);m(),V("ngModel",e.annees),s("placeholder","Ann\xE9es"),m(),s("ngForOf",e.anneesDispo)}}function Sr(r,t){r&1&&(a(0,"button",22),f(1," Enregistrer "),c())}function Br(r,t){if(r&1){let e=w();a(0,"form",6,1),y("ngSubmit",function(){x(e);let n=F(1),o=u();return v(o.valider(n))}),a(2,"div",7),g(3,vr,2,3,"mat-error",8),_(4,"async"),g(5,Cr,1,3,"app-timbre-resultat",9),_(6,"async"),c(),a(7,"div",10),g(8,yr,3,3,"div",11),_(9,"async"),_(10,"async"),a(11,"button",12),y("click",function(){x(e);let n=u();return v(n.close())}),f(12," Annuler "),c(),a(13,"input",13),y("change",function(n){x(e);let o=u();return v(o.onFileChange(n))}),c(),a(14,"button",14),y("click",function(){x(e);let n=u();return v(n.triggerFileInput())}),f(15," Choisir un fichier "),c(),g(16,Sr,2,0,"button",15),_(17,"async"),c()()}if(r&2){let e,i,n,o=F(1),l=u();s("ngClass",o!=null&&o.submitted?"red-color":"blue-color"),m(3),s("ngIf",h(4,6,l.messageError$)),m(2),s("ngIf",((e=h(6,8,l.timbres$))==null?null:e.length)>0),m(3),s("ngIf",!h(9,10,l.timbres$)||((i=h(10,12,l.timbres$))==null?null:i.length)==0),m(5),ti("id",l.idFile),m(3),s("ngIf",((n=h(17,14,l.timbres$))==null?null:n.length)>0)}}var Gt=class r{constructor(t,e,i,n,o,l,d){this.authService=t;this.timbreService=e;this.timbreBlocService=i;this.timbreUtilsService=n;this.uploadService=o;this.utilsService=l;this.dialogRef=d}dossier="/assets/images/timbres/";timbres$=new D(null);messageError$=new D(null);messageLoad$=new D("Chargement en cours ...");load$=new D(null);idFile="fileImport";identTimbre=1;identBloc=1;timbresModel=[];timbresBlocsModel=[];anneesDispo=[];annees=[new Date().getFullYear()];ngOnInit(){for(let t=new Date().getFullYear();t>=1900;t--)this.anneesDispo.push(t)}triggerFileInput(){document.getElementById(this.idFile).click()}onFileChange(t){let e=t.target.files[0];e&&(this.load$.next(!1),this.messageLoad$.next("Chargement en cours ..."),this.saveCsv(e))}saveCsv(t){let e=new FileReader;e.onload=()=>{let i=e.result;this.parseCsv(i)},e.readAsText(t)}parseCsv(t){p(this.annees)&&this.annees.length>0&&Y([this.utilsService.getMaxIdentAsync("/timbres"),this.utilsService.getMaxIdentAsync("/timbres_bloc"),this.authService.userSelect$]).pipe(T(([e,i,n])=>p(n))).subscribe(([e,i,n])=>{this.identTimbre=e,this.identBloc=i,this.timbresModel=[],this.timbres$.next(null),Pi.parse(t,{header:!0,skipEmptyLines:!0,complete:o=>{p(o.data)&&o.data?.length>0&&(this.timbresBlocsModel=[],o.data.forEach((l,d)=>{let b=this.setTimbre(l,n);p(b?.getId())&&(this.timbresModel.push(b),this.identTimbre++),d==o.data.length-1&&(this.timbres$.next(this.timbresModel),this.load$.next(!0))}))},error:o=>{console.error("Erreur lors du parsing du CSV :",o)}})})}setTimbre(t,e){let i=new ve,n=t.CODE!="NULL"&&t.CODE!=""?Number(t.CODE):null,o=t.IDENT_BLOC!="NULL"&&t.IDENT_BLOC!=""&&p(t.IDENT_BLOC)?Number(t.IDENT_BLOC):null,l=t.ANNEE!="NULL"&&t.ANNEE!=""?Number(t.ANNEE):null,d=t.MONNAIE!="NULL"&&t.MONNAIE!=""?t.MONNAIE:null;if(this.annees.includes(l)){i.setId(this.identTimbre),i.setType(t.TYPE!="NULL"&&t.TYPE!=""?t.TYPE:null),i.setYt(t.YT!="NULL"&&t.YT!=""?t.YT:null),i.setAnnee(l);let b=new Z;b.setIdTimbre(i.getId()),b.setIdUser(e.getId()),b.setAcquis(t.ACQUIS=="1"),b.setDoublon(t.DOUBLON=="1"),i.setTimbreAcquisModel(b);let B=this.dossier+l+"/",A="";if(p(o)){if(B+="bloc/"+o,A=B+".png",B+="-",i.setTimbreBlocModel(this.timbresBlocsModel.find(O=>O.getAnnee()==l&&O.idOrigine==o)),J(i.getTimbreBlocModel())){let O=new Ue;O.setId(this.identBloc),O.setAnnee(l),O.setMonnaie(d),O.setCarnet(t.CARNET=="1"),O.idOrigine=o;let Ie=new le;Ie.setIdBloc(this.identBloc),Ie.setIdUser(e.getId()),Ie.setAcquis(t.ACQUIS_BLOC=="1"),Ie.setDoublon(t.DOUBLON_BLOC=="1"),O.setTimbreBlocAcquisModel(Ie),this.uploadService.checkIfImageExists(A).pipe(T()).subscribe(ht=>{ht&&(O.setImage(A),O.setImageTable(A),O.setImageZoom(A))}),this.timbresBlocsModel.push(O),i.setTimbreBlocModel(O),this.identBloc++}i.setIdBloc(i.getTimbreBlocModel()?.getId())}else i.setMonnaie(d);B+=n+".png",this.uploadService.checkIfImageExists(B).pipe(T()).subscribe(O=>{O&&(i.setImage(B),i.setImageTable(B),i.setImageZoom(B))})}return i}valider(t){this.messageError$.next(null),t?.valid&&(this.load$.next(!1),this.messageLoad$.next("Import en cours ..."),p(this.timbresBlocsModel)&&this.timbresBlocsModel?.length>0&&this.timbresBlocsModel.forEach((e,i)=>{this.saveBloc(e)}),this.timbres$.pipe(T()).subscribe(e=>{if(p(e)&&e?.length>0)e.forEach((i,n)=>{this.saveTimbre(i,n==e.length-1)});else{this.messageError$.next("Donn\xE9es incorrectes");return}}))}saveBloc(t){Y([this.timbreBlocService.upload(t,"autre"),this.timbreBlocService.upload(t,"table"),this.timbreBlocService.upload(t,"zoom")]).pipe(T(([e,i,n])=>p(e)&&p(n)&&p(i))).subscribe(([e,i,n])=>{p(e)&&e!="nok"&&t.setImage(e),p(i)&&i!="nok"&&t.setImageTable(i),p(n)&&n!="nok"&&t.setImageZoom(n),t?.getTimbreBlocAcquisModel()?.isAcquis()&&this.timbreBlocService.addAcquis(t?.getTimbreBlocAcquisModel()?.getIdUser(),t,t?.getTimbreBlocAcquisModel()?.isDoublon()),this.timbreBlocService.ajouter(t,!1)})}saveTimbre(t,e){Y([this.timbreService.upload(t,"autre"),this.timbreService.upload(t,"table"),this.timbreService.upload(t,"zoom")]).pipe(T(([i,n,o])=>p(i)&&p(o)&&p(n))).subscribe(([i,n,o])=>{p(i)&&i!="nok"&&t.setImage(i),p(n)&&n!="nok"&&t.setImageTable(n),p(o)&&o!="nok"&&t.setImageZoom(o),t?.getTimbreAcquisModel()?.isAcquis()&&this.timbreUtilsService.addAcquis(t?.getTimbreAcquisModel()?.getIdUser(),t,t?.getTimbreAcquisModel()?.isDoublon()),this.timbreService.ajouter(t,e),e&&(this.load$.next(!0),this.close())})}close(){this.dialogRef.close()}static \u0275fac=function(e){return new(e||r)(C(X),C(Q),C(z),C(q),C(lt),C(oe),C(he))};static \u0275cmp=$({type:r,selectors:[["app-timbre-importer"]],decls:8,vars:4,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","start stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","column","fxLayoutGap","20px",1,"bloc-modal"],[3,"innerHTML",4,"ngIf"],[3,"load$","timbres$","modif",4,"ngIf"],["fxLayout","row","fxLayoutGap","20px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["fxLayout","row","fxLayoutAlign","end center","class","form-input select noError","style","width: 150px",4,"ngIf"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","file","accept",".xls, .xlsx, .csv","hidden","","required","",3,"change","id"],["type","button","mat-raised-button","","color","accent",1,"rounded","large","color-white",3,"click"],["type","submit","class","rounded large color-white","mat-raised-button","","color","accent",4,"ngIf"],[3,"innerHTML"],[3,"load$","timbres$","modif"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input","select","noError",2,"width","150px"],["name","anneeSelect","multiple","",3,"ngModelChange","ngModel","placeholder"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],[1,"selectMin",3,"value"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"]],template:function(e,i){if(e&1&&(a(0,"div",2)(1,"div",3)(2,"span"),f(3,"TIMBRE IMPORTER"),c()(),g(4,xr,2,3,"ng-template",4),_(5,"async"),g(6,Br,18,16,"ng-template",null,0,K),c()),e&2){let n=F(7);m(4),s("ngIf",h(5,2,i.load$)==!1)("ngIfElse",n)}},dependencies:[ie,tt,Te,_e,ae,ce,j,be,De,ge,fe,Re,de,Le,ee,Oe,te,Ne,re,Ht,P]})};function Ir(r,t){r&1&&M(0,"lib-spinner",5),r&2&&s("textSpec","Suppression en cours")}function Er(r,t){if(r&1){let e=w();a(0,"form",6,1),y("ngSubmit",function(){x(e);let n=F(1),o=u();return v(o.valider(n))}),a(2,"div",7)(3,"div",8)(4,"input",9),H("ngModelChange",function(n){x(e);let o=u();return k(o.annee,n)||(o.annee=n),v(n)}),c()(),a(5,"button",10),y("click",function(){x(e);let n=u();return v(n.close())}),f(6," Annuler "),c(),a(7,"button",11),f(8," Supprimer "),c()()()}if(r&2){let e=F(1),i=u();s("ngClass",e!=null&&e.submitted?"red-color":"blue-color"),m(4),V("ngModel",i.annee),s("max",i.maxAnnee)("zMax",i.maxAnnee)}}var Wt=class r{constructor(t,e,i){this.dialog=t;this.dialogRef=e;this.timbreSupprimService=i}maxAnnee=new Date().getFullYear();annee=new Date().getFullYear();valider(t){if(t?.valid){let e=this.dialog.open(ke,{maxHeight:"95vh",data:{titre:"Confirmation",message:"Souhaitez-vous supprimer les timbres ?",btnDroite:"Oui",btnGauche:"Non"}});e.afterClosed().subscribe(()=>{e.componentInstance.data.resultat==="valider"&&(this.timbreSupprimService.loadGlob$.next(!1),this.timbreSupprimService.supprimerTimbres(this.annee),this.timbreSupprimService.load$.pipe(T(i=>i==!0)).subscribe(i=>{this.timbreSupprimService.supprimerBlocs(this.annee),this.timbreSupprimService.load$.pipe(T(n=>n==!0)).subscribe(n=>{this.timbreSupprimService.loadGlob$.next(!0)})}))})}}close(){this.dialogRef.close()}static \u0275fac=function(e){return new(e||r)(C(ne),C(he),C(qe))};static \u0275cmp=$({type:r,selectors:[["app-timbre-supprim-choix-annee"]],decls:8,vars:4,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","start stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","row","fxLayoutGap","20px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["fxLayout","column","fxFlex","20","fxLayoutAlign","end end",1,"form-input","noError"],["name","annee","type","number","minlength","4","maxlength","4","min","1900","zMin","1900","required","","zControl","",2,"width","60px !important",3,"ngModelChange","ngModel","max","zMax"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"]],template:function(e,i){if(e&1&&(a(0,"div",2)(1,"div",3)(2,"span"),f(3,"TIMBRE IMPORTER"),c()(),g(4,Ir,1,1,"ng-template",4),_(5,"async"),g(6,Er,9,4,"ng-template",null,0,K),c()),e&2){let n=F(7);m(4),s("ngIf",h(5,2,i.timbreSupprimService.loadGlob$)==!1)("ngIfElse",n)}},dependencies:[ie,ae,j,be,De,ge,fe,Re,de,Le,Qe,Ye,ee,Oe,Je,Xe,et,Ke,Ze,te,Ne,re,it,rt,ot,P],encapsulation:2})};var wr=r=>[r];function Ar(r,t){if(r&1){let e=w();a(0,"lib-icon",2),y("click",function(){x(e);let n=u();return v(n.supprimer())}),c()}if(r&2){let e=u();s("icone",e.FontAwesomeEnum.ROTATE)("type",e.FontAwesomeTypeEnum.TYPE_SOLID)("attribs",ct(4,wr,e.FontAwesomeAttributEnum.SPIN))("info","Supprimer en cours")}}function Dr(r,t){if(r&1){let e=w();a(0,"lib-icon",3),y("click",function(){x(e);let n=u();return v(n.supprimer())}),c()}if(r&2){let e=u();s("icone",e.FontAwesomeEnum.TRASH)("type",e.FontAwesomeTypeEnum.TYPE_SOLID)("info","Supprimer les timbres")}}var zt=class r{constructor(t,e){this.dialog=t;this.timbreSupprimService=e}FontAwesomeEnum=ue;FontAwesomeTypeEnum=pe;FontAwesomeAttributEnum=ri;supprimer(){this.dialog.open(Wt,{maxHeight:"50vh",width:"300px"})}static \u0275fac=function(e){return new(e||r)(C(ne),C(qe))};static \u0275cmp=$({type:r,selectors:[["app-timbre-supprim"]],decls:4,vars:6,consts:[["class","warn click","style","font-size: 2em",3,"icone","type","attribs","info","click",4,"ngIf"],["class","warn click","style","font-size: 2em",3,"icone","type","info","click",4,"ngIf"],[1,"warn","click",2,"font-size","2em",3,"click","icone","type","attribs","info"],[1,"warn","click",2,"font-size","2em",3,"click","icone","type","info"]],template:function(e,i){e&1&&(g(0,Ar,1,6,"lib-icon",0),_(1,"async"),g(2,Dr,1,3,"lib-icon",1),_(3,"async")),e&2&&(s("ngIf",h(1,2,i.timbreSupprimService.loadGlob$)==!1),m(2),s("ngIf",h(3,4,i.timbreSupprimService.loadGlob$)==!0))},dependencies:[j,xe,P],encapsulation:2})};function Or(r,t){if(r&1){let e=w();a(0,"button",9),y("click",function(){x(e);let n=u(2);return v(n.ajouter())}),f(1," Ajouter "),c()}}function Nr(r,t){r&1&&(L(0),f(1,"\xA0Bloc"),U())}function Lr(r,t){if(r&1){let e=w();L(0),g(1,Or,2,0,"button",8),_(2,"async"),a(3,"button",9),y("click",function(){x(e);let n=u();return v(n.ajouterBloc())}),f(4," Ajouter "),g(5,Nr,2,0,"ng-container",3),_(6,"async"),c(),U()}if(r&2){let e=u();m(),s("ngIf",h(2,2,e.headerService.route$)==e.RouteEnum.TIMBRE),m(4),s("ngIf",h(6,4,e.headerService.route$)==e.RouteEnum.TIMBRE)}}function Ur(r,t){if(r&1){let e=w();L(0),a(1,"lib-icon",11),y("click",function(){let n=x(e).$implicit,o=u(2);return v(o.headerService.setRoute(n.getRoute()))}),c(),U()}if(r&2){let e=t.$implicit;m(),s("icone",e==null?null:e.getIcone())("type",e==null?null:e.getType())("info",e==null?null:e.getInfo())}}function Fr(r,t){if(r&1&&(L(0),g(1,Ur,2,3,"ng-container",10),_(2,"async"),U()),r&2){let e=u();m(),s("ngForOf",h(2,1,e.headerService.choixRoutesTimbre$))}}function qr(r,t){if(r&1){let e=w();a(0,"lib-icon",13),y("click",function(){x(e);let n=u(2);return v(n.headerService.mode=n.ModeEnum.TABLE)}),c()}if(r&2){let e=u(2);s("icone",e.FontAwesomeEnum.TABLE)("type",e.FontAwesomeTypeEnum.TYPE_SOLID)("info","Mode tableau")}}function $r(r,t){if(r&1){let e=w();a(0,"lib-icon",13),y("click",function(){x(e);let n=u(2);return v(n.headerService.mode=n.ModeEnum.GRAPH)}),c()}if(r&2){let e=u(2);s("icone",e.FontAwesomeEnum.MEMO)("type",e.FontAwesomeTypeEnum.TYPE_SOLID)("info","Mode tableau")}}function jr(r,t){if(r&1&&(L(0),g(1,qr,1,3,"ng-template",12)(2,$r,1,3,"ng-template",null,0,K),U()),r&2){let e=F(3),i=u();m(),s("ngIf",i.headerService.mode==i.ModeEnum.GRAPH)("ngIfElse",e)}}function Pr(r,t){if(r&1){let e=w();a(0,"lib-icon",14),y("click",function(){x(e);let n=u();return v(n.importer())}),c()}if(r&2){let e=u();s("icone",e.FontAwesomeEnum.UPLOAD)("type",e.FontAwesomeTypeEnum.TYPE_SOLID)("info","Importer les timbres")}}function Vr(r,t){r&1&&M(0,"app-timbre-supprim",15)}function kr(r,t){if(r&1&&(a(0,"mat-option",19),f(1),c()),r&2){let e=t.$implicit;s("value",e),m(),S(" ",e==null?null:e.getPrenom()," ")}}function Hr(r,t){if(r&1){let e=w();a(0,"div",16)(1,"mat-select",17),_(2,"async"),y("ngModelChange",function(n){x(e);let o=u();return v(o.setUser(n))}),g(3,kr,2,2,"mat-option",18),_(4,"async"),c()()}if(r&2){let e=u();m(),s("ngModel",h(2,3,e.authService.userSelect$))("placeholder","Utilisateur"),m(2),s("ngForOf",h(4,5,e.authService.users$))}}var Vi=class r{constructor(t,e,i,n,o,l){this.authService=t;this.headerService=e;this.timbreService=i;this.timbreBlocService=n;this.timbreUtilsService=o;this.dialog=l;this.verifRoute()}FontAwesomeEnum=ue;RouteEnum=ni;FontAwesomeTypeEnum=pe;DroitEnum=St;ModeEnum=oi;ajouter(){let t=this.dialog.open(at,{maxHeight:"95vh",width:"30%"});t.afterClosed().subscribe(()=>{t.close()})}ajouterBloc(){let t=this.dialog.open(st,{maxHeight:"95vh",width:"30%"});t.afterClosed().subscribe(()=>{t.close()})}ajouterBouchon(){this.timbreService.ajouterSansId(this.timbreService.getBouchon())}importer(){let t=this.dialog.open(Gt,{height:"90vh",width:"70%"});t.afterClosed().subscribe(()=>{t.close()})}verifRoute(){window.location.href.indexOf("bloc")>0?p(this.timbreUtilsService.timbreCritereBlocModel.getAnnees())&&this.timbreUtilsService.timbreCritereBlocModel.getAnnees().length>0?this.timbreBlocService.getBlocs(this.timbreUtilsService.timbreCritereBlocModel,!0):this.timbreUtilsService.getAnneesAsync("/timbres_bloc").pipe(T(t=>p(t)&&t?.length>0)).subscribe(t=>{this.timbreUtilsService.timbreCritereBlocModel.setAnnees([t[0]]),this.timbreBlocService.getBlocs(this.timbreUtilsService.timbreCritereBlocModel,!0)}):p(this.timbreUtilsService.timbreCritereModel.getAnnees())&&this.timbreUtilsService.timbreCritereModel.getAnnees().length>0?this.timbreService.getTimbres(this.timbreUtilsService.timbreCritereModel,!0):this.timbreUtilsService.getAnneesAsync("/timbres").pipe(T(t=>p(t)&&t?.length>0)).subscribe(t=>{this.timbreUtilsService.timbreCritereModel.setAnnees([t[0]]),this.timbreService.getTimbres(this.timbreUtilsService.timbreCritereModel,!0)})}setUser(t){this.authService.userSelect$.next(t),this.verifRoute(),this.timbreUtilsService.reinitResume$.next(!0)}static \u0275fac=function(e){return new(e||r)(C(X),C(li),C(Q),C(z),C(q),C(ne))};static \u0275cmp=$({type:r,selectors:[["app-menu"]],decls:21,vars:30,consts:[["modeTable",""],[1,"menu"],[1,"sousMenu","sousMenuBouton"],[4,"ngIf"],[1,"sousMenu"],["class","accent click hide-on-mobile","style","font-size: 2em",3,"icone","type","info","click",4,"ngIf"],["class","hide-on-mobile",4,"ngIf"],["fxLayout","row","fxLayoutAlign","end center","class","form-input select","style","width: 120px",4,"ngIf"],["class","rounded large color-white","mat-raised-button","","color","primary",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],[4,"ngFor","ngForOf"],[1,"primary","click",2,"font-size","2em",3,"click","icone","type","info"],[3,"ngIf","ngIfElse"],[1,"primary","click","hide-on-mobile",2,"font-size","2em",3,"click","icone","type","info"],[1,"accent","click","hide-on-mobile",2,"font-size","2em",3,"click","icone","type","info"],[1,"hide-on-mobile"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input","select",2,"width","120px"],["name","user",1,"scrollBarAccent",3,"ngModelChange","ngModel","placeholder"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],[1,"selectMin",3,"value"]],template:function(e,i){if(e&1&&(a(0,"div",1)(1,"div",2),g(2,Lr,7,6,"ng-container",3),_(3,"async"),c(),a(4,"div",4),g(5,Fr,3,3,"ng-container",3),_(6,"async"),g(7,jr,4,2,"ng-container",3),_(8,"async"),_(9,"async"),_(10,"async"),g(11,Pr,1,3,"lib-icon",5),_(12,"async"),_(13,"async"),g(14,Vr,1,0,"app-timbre-supprim",6),_(15,"async"),_(16,"async"),g(17,Hr,5,7,"div",7),_(18,"async"),_(19,"async"),_(20,"async"),c()()),e&2){let n,o,l,d,b,B;m(2),s("ngIf",((n=h(3,6,i.authService.user$))==null?null:n.getDroit())==i.DroitEnum.TOTAL),m(3),s("ngIf",((o=h(6,8,i.headerService.choixRoutesTimbre$))==null?null:o.length)>0),m(2),s("ngIf",((l=h(8,10,i.authService.user$))==null?null:l.getDroit())==i.DroitEnum.TOTAL&&(h(9,12,i.headerService.route$)==i.RouteEnum.TIMBRE||h(10,14,i.headerService.route$)==i.RouteEnum.BLOC)),m(4),s("ngIf",((d=h(12,16,i.authService.user$))==null?null:d.getDroit())==i.DroitEnum.TOTAL&&h(13,18,i.headerService.route$)==i.RouteEnum.TIMBRE),m(3),s("ngIf",((b=h(15,20,i.authService.user$))==null?null:b.getDroit())==i.DroitEnum.TOTAL&&h(16,22,i.headerService.route$)==i.RouteEnum.TIMBRE),m(3),s("ngIf",(((B=h(18,24,i.authService.user$))==null?null:B.getDroit())==i.DroitEnum.TOTAL||((B=h(19,26,i.authService.user$))==null?null:B.getDroit())==i.DroitEnum.CONSULT_TOTAL)&&((B=h(20,28,i.authService.users$))==null?null:B.length)>0)}},dependencies:[ce,j,be,ge,ee,te,xe,ie,zt,_e,Te,P],styles:[".menu[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:10px;padding:0 5px}.menu[_ngcontent-%COMP%]   .sousMenu[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:15px}@media screen and (max-width: 800px){.menu[_ngcontent-%COMP%]{flex-direction:column}.menu[_ngcontent-%COMP%]   .sousMenuBouton[_ngcontent-%COMP%]{justify-content:space-between}.menu[_ngcontent-%COMP%]   .sousMenu[_ngcontent-%COMP%]{gap:10px}}"]})};export{le as a,Z as b,ut as c,q as d,z as e,Q as f,Vt as g,Ft as h,$t as i,kt as j,Ht as k,Gt as l,Vi as m,$i as n};

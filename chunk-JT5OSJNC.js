import{bb as g,c as f,cb as S,f as m,g as A,gb as u,hb as T,ib as d,l as U,nb as I,p as b,pb as O,s as c}from"./chunk-JRN57LZL.js";import{i as o}from"./chunk-GV7GV3NK.js";var n=class extends T{id;nom;prenom;droit;constructor(e,t,i,r){super(),this.id=e||null,this.nom=t||null,this.prenom=i||null,this.droit=r||null}getId(){return this.id}setId(e){this.id=e}getNom(){return this.nom}setNom(e){this.nom=e}getPrenom(){return this.prenom}setPrenom(e){this.prenom=e}getDroit(){return this.droit}setDroit(e){this.droit=e}};o([u("Identifiant")],n.prototype,"id",2),o([u("Nom")],n.prototype,"nom",2),o([u("Pr\xE9nom")],n.prototype,"prenom",2),o([u("Droit")],n.prototype,"droit",2);var L=(r=>(r[r.CONSULT=0]="CONSULT",r[r.CONSULT_TOTAL=1]="CONSULT_TOTAL",r[r.PARTIEL=9]="PARTIEL",r[r.TOTAL=10]="TOTAL",r))(L||{});var v=class l{constructor(e,t){this.afAuth=e;this.firestore=t}user$=new f(null);userSelect$=new f(null);users$=new f(null);signIn(e,t){return this.afAuth.signInWithEmailAndPassword(e,t)}signUp(e,t){return this.afAuth.createUserWithEmailAndPassword(e,t)}signOut(){return this.afAuth.signOut()}getCurrentUser(){return this.afAuth.authState}getUser(){this.user$.next(null),this.userSelect$.next(null);let e=this.firestore.collection("/user").valueChanges();return A([this.afAuth.authState,e]).pipe(m(([t,i])=>{let r=i.find(s=>s.id==t?.uid);if(g(r)){let s=d(n,r);return this.user$.next(s),s?.getDroit()==10||s?.getDroit()==1?this.getUsers(9).pipe(U(a=>g(a))).subscribe(a=>{let p=a.find(h=>h.getId()==s.getId());p?this.userSelect$.next(p):this.userSelect$.next(a.find(h=>h.getNom()=="LEFAIX"))}):this.userSelect$.next(s),s}return null}))}getUsers(e){return this.users$.next(null),S(e)&&(e=0),this.firestore.collection("/user",t=>{let i=t;return i=i.where("droit",">=",e),i}).valueChanges().pipe(m(t=>{let i=[];return t?.length>0&&t.forEach(r=>{let s=d(n,r);i.push(s)}),this.users$.next(i),i}))}static \u0275fac=function(t){return new(t||l)(c(I),c(O))};static \u0275prov=b({token:l,factory:l.\u0275fac,providedIn:"root"})};export{L as a,v as b};

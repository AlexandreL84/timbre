import{a as Wt,b as zt,c as Gt,d as Yt,e as z,f as di,g as qe,h as Xt,i as Pe,j as ui,k as Zt,l as Kt,m as Jt,n as ei,o as ti,p as ii,q as ni}from"./chunk-RKDYPSRW.js";import{g as $t,l as Qt}from"./chunk-QH45HNRI.js";import{A as At,B as Ft,C as Nt,D as Ut,E as Ot,F as Rt,G as jt,H as qt,I as Xe,J as Ne,K as Pt,M as kt,N as Ue,O as Oe,P as Bt,Q as oe,R as Re,S as Vt,T as Ht,U as je,V as re,a as Ce,b as ft,c as P,d as k,e as $,g as ne,h as B,i as bt,j as xe,m as wt,n as Ie,o as St,p as De,r as Le,w as Fe,x as Et,y as Dt,z as Lt}from"./chunk-2BQ7IWAY.js";import{$a as O,$d as It,Ab as ct,Ac as we,Bb as H,Bc as Se,Cc as ht,Dc as _t,E as at,Eb as te,Ec as yt,F as J,Fa as l,Fb as ye,Fc as Ct,Ga as a,Gc as xt,H as Ye,Ha as p,Hc as Tt,Ia as E,Ic as Mt,Ja as D,Jb as pt,L as U,La as I,M as ee,Oa as b,Qa as c,Qb as Qe,R as _,S as y,Ta as be,Va as Y,Wa as Q,Wd as Ee,Xa as X,Y as mt,Ya as V,Yd as W,Za as u,_a as ge,ac as f,bb as R,cb as j,d as S,db as q,dc as se,ec as x,ee as Ae,fa as ue,fc as ie,ga as fe,gb as st,gc as ce,ha as m,ia as T,j as de,k as nt,kb as M,kd as vt,lb as v,mb as he,mc as dt,nc as ut,r as ot,ta as g,uc as gt,v as rt,w as N,wa as s,xc as Te,yc as Me,z as lt,zb as _e,zc as ve}from"./chunk-25BRCYG3.js";import"./chunk-65CH3ZW6.js";import{g as it,i as C}from"./chunk-GV7GV3NK.js";var h=class extends ie{id;idBloc;code;annee;monnaie;type;yt;image;imageTable;imageZoom;timbreAcquisModel;constructor(e,t,i,o,r,d,w,F,K,et,tt){super(),this.id=e||null,this.idBloc=t||null,this.code=i||null,this.annee=o||null,this.monnaie=r||null,this.type=d||null,this.yt=w||null,this.image=F||null,this.imageTable=K||null,this.imageZoom=et||null,this.timbreAcquisModel=tt||null}getId(){return this.id}setId(e){this.id=e}getIdBloc(){return this.idBloc}setIdBloc(e){this.idBloc=e}getCode(){return this.code}setCode(e){this.code=e}getAnnee(){return this.annee}setAnnee(e){this.annee=e}getMonnaie(){return this.monnaie}setMonnaie(e){this.monnaie=e}getType(){return this.type}setType(e){this.type=e}getYt(){return this.yt}setYt(e){this.yt=e}getImage(){return this.image}setImage(e){this.image=e}getImageTable(){return this.imageTable}setImageTable(e){this.imageTable=e}getImageZoom(){return this.imageZoom}setImageZoom(e){this.imageZoom=e}getTimbreAcquisModel(){return this.timbreAcquisModel}setTimbreAcquisModel(e){this.timbreAcquisModel=e}};C([x("Identifiant")],h.prototype,"id",2),C([x("Identifiant bloc")],h.prototype,"idBloc",2),C([x("Code")],h.prototype,"code",2),C([x("Ann\xE9e")],h.prototype,"annee",2),C([x("Monnaie")],h.prototype,"monnaie",2),C([x("Type")],h.prototype,"type",2),C([x("R\xE9ference Yvert Tellier")],h.prototype,"yt",2),C([x("Image")],h.prototype,"image",2),C([x("Image tableau")],h.prototype,"imageTable",2),C([x("Image zoom")],h.prototype,"imageZoom",2),C([x("v\xE9rif")],h.prototype,"timbreAcquisModel",2);var ke=class{dossier;nom;alignLabel;detail;getDossier(){return this.dossier}setDossier(e){this.dossier=e}getNom(){return this.nom}setNom(e){this.nom=e}getAlignLabel(){return this.alignLabel}setAlignLabel(e){this.alignLabel=e}getDetail(){return this.detail}setDetail(e){this.detail=e}};var pe=class{key;dossier;maxWidth;maxHeight;getKey(){return this.key}setKey(e){this.key=e}getDossier(){return this.dossier}setDossier(e){this.dossier=e}getMaxWidth(){return this.maxWidth}setMaxWidth(e){this.maxWidth=e}getMaxHeight(){return this.maxHeight}setMaxHeight(e){this.maxHeight=e}};var L=class extends ie{idUser;idTimbre;acquis;doublon;constructor(e,t,i,o){super(),this.idUser=e||null,this.idTimbre=t||null,this.acquis=i||!1,this.doublon=o||!1}getIdUser(){return this.idUser}setIdUser(e){this.idUser=e}getIdTimbre(){return this.idTimbre}setIdTimbre(e){this.idTimbre=e}isAcquis(){return this.acquis}setAcquis(e){this.acquis=e}isDoublon(){return this.doublon}setDoublon(e){this.doublon=e}};C([x("Identifiant Utilisateur")],L.prototype,"idUser",2),C([x("Identifiant timbre")],L.prototype,"idTimbre",2),C([x("Acquis")],L.prototype,"acquis",2),C([x("Doublon")],L.prototype,"doublon",2);var A=class n{constructor(e,t){this.firestore=e;this.authService=t}basePath="/timbres";basePathAcquis="/timbre_acquis";dossierImage="timbres/";heigthTable=50;widthTimbre=100;heightTimbre=100;widthTimbreZoom=500;heightTimbreZoom=500;total$=new S(0);timbres$=new S(null);getTimbreByIdAsync(e){return this.firestore.collection(this.basePath,t=>t.where("id","==",e)).valueChanges().pipe(de(t=>new ce(h).map(t[0])))}getByCodeAsync(e){return this.firestore.collection(this.basePath,t=>t.where("code","==",e)).valueChanges().pipe(de(t=>new ce(h).map(t[0])))}getTimbres(e){this.timbres$.next(null),this.firestore.collection(this.basePath,t=>{let i=t;return f(e)&&f(e.getAnnees())&&e.getAnnees()?.length>0&&(i=i.where("annee","in",e.getAnnees())),i}).valueChanges().pipe(ot(this.getTimbreAcquis(e)),N()).subscribe(([t,i])=>{this.constructTimbres(t,i,e)})}constructTimbres(e,t,i){let o=[];e?.length>0&&e.forEach(r=>{let d=new ce(h).map(r),w=t.find(K=>K.idTimbre==d.getId());f(w)?d.setTimbreAcquisModel(new ce(L).map(w)):d.setTimbreAcquisModel(new L);let F=!0;f(i)?(f(i.getAcquis())&&!(i.getAcquis()=="TOUS"||i.getAcquis()=="OUI"&&d.getTimbreAcquisModel().isAcquis()||i.getAcquis()=="NON"&&!d.getTimbreAcquisModel().isAcquis())&&(F=!1),f(i.getDoublon())&&!(i.getDoublon()=="TOUS"||i.getDoublon()=="OUI"&&d.getTimbreAcquisModel().isDoublon()||i.getDoublon()=="NON"&&!d.getTimbreAcquisModel().isDoublon())&&(F=!1)):o.push(d),F==!0&&o.push(d)}),this.timbres$.next(o)}getTimbreAcquis(e){return this.authService.getUser().pipe(N(),lt(t=>f(t)?this.getTimbreAcquisByUser(t.getId(),e).pipe(N(),de(i=>i)):null))}getTimbreAcquisByUser(e,t){return this.firestore.collection(this.basePathAcquis,i=>i.where("idUser","==",e)).valueChanges()}acquis(e,t){return this.authService.getUser().pipe(N(i=>f(i))).subscribe(i=>{if(f(e?.getTimbreAcquisModel()?.getIdUser()))this.firestore.collection(this.basePathAcquis).ref.where("idTimbre","==",e.getId()).where("idUser","==",i.getId()).get().then(o=>{o.forEach(r=>{let d=e.getTimbreAcquisModel();t?(d.setAcquis(!0),d.setDoublon(!d.isDoublon())):(d.setAcquis(!d.isAcquis()),d.isAcquis()||d.setDoublon(!1)),r.ref.update(Object.assign(new Object,d))})}).catch(o=>{console.error("Erreur de mise \xE0 jour:",o)});else{let o=new L;o.setIdUser(i.getId()),o.setIdTimbre(e.getId()),o.setAcquis(!0),o.setDoublon(t),e.setTimbreAcquisModel(o),this.firestore.collection(this.basePathAcquis).add(Object.assign(new Object,o))}})}addTimbre(e){e.setId(se.getRandom(1e4)),this.firestore.collection(this.basePath).add(Object.assign(new Object,e)),this.getTimbres()}modifierTimbre(e){e.setTimbreAcquisModel(null),this.firestore.collection(this.basePath).ref.where("id","==",e.getId()).get().then(t=>{t.forEach(i=>{i.ref.update(Object.assign(new Object,e)),this.getTimbres()})}).catch(t=>{console.error("Erreur de mise \xE0 jour:",t)})}deleteTimbre(e){this.authService.getUser().pipe(N(t=>f(t))).subscribe(t=>{f(e?.getTimbreAcquisModel()?.getIdUser())&&this.firestore.collection(this.basePathAcquis).ref.where("idTimbre","==",e.getId()).where("idUser","==",t.getId()).get().then(i=>{i.forEach(o=>{o.ref.delete()})}),this.firestore.collection(this.basePath).ref.where("id","==",e.getId()).get().then(i=>{i.forEach(o=>{o.ref.delete(),this.getTimbres()})}).catch(i=>{console.error("Erreur de suppression :",i)})})}getBouchon(){let e=new h,t=se.getRandom(1e4);return e.setId(t),e.setCode(e.getId()?.toString()),e.setAnnee(2025),e.setMonnaie("E"),e.setType(""),e.setYt(""),e}static \u0275fac=function(t){return new(t||n)(Ye(dt),Ye(ut))};static \u0275prov=at({token:n,factory:n.\u0275fac})};var gi=["canvas"];function hi(n,e){if(n&1&&p(0,"img",9),n&2){let t=c();s("src",t.object[t.fileUploadModel.getDetail()[0].getKey()],fe)}}function _i(n,e){n&1&&p(0,"canvas",null,0)}function yi(n,e){if(n&1){let t=I();l(0,"lib-icon",10),b("click",function(){_(t);let o=c();return y(o.triggerFileInput())}),a()}if(n&2){let t=c();s("type",t.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",t.FontAwesomeEnum.FILE_PEN)("info","Modifier")}}function Ci(n,e){if(n&1){let t=I();l(0,"button",11),b("click",function(){_(t);let o=c();return y(o.triggerFileInput())}),u(1," Choisir une image "),a()}}var Ve=class n{constructor(e,t){this.storage=e;this.utilsService=t}canvas;object;fileUploadModel;outPutObject=new mt;selectedFile;id="file"+Math.floor(Math.random()*Math.floor(1e3));FontAwesomeEnum=Ie;FontAwesomeTypeEnum=Ue;triggerFileInput(){document.getElementById(this.id).click()}onFileSelected(e){this.fileUploadModel.getDetail().forEach(i=>{this.object[i.key]=""});let t=e.target.files?.[0];if(t){this.selectedFile=t;let i=new Image,o=new FileReader;o.onload=r=>{i.src=r.target?.result,i.onload=()=>{let d=this.canvas.nativeElement,w=d.getContext("2d");w&&this.fileUploadModel.getDetail().forEach(F=>{this.save(d,w,i,F)})}},o.readAsDataURL(t)}}save(e,t,i,o){let r=Math.min(o.maxWidth/i.width,o.maxHeight/i.height,1),d=i.width*r,w=i.height*r;e.width=o.maxWidth,e.height=o.maxHeight,t.clearRect(0,0,e.width,e.height);let F=(e.width-d)/2,K=(e.height-w)/2;t.drawImage(i,F,K,d,w),this.saveFile(o)}saveFile(e){let t;t="images/",f(this.fileUploadModel?.getDossier())&&(t+=this.fileUploadModel.getDossier()+"/"),f(e?.getDossier())&&(t+=e.getDossier()+"/"),f(this.fileUploadModel?.getNom())?t+=this.fileUploadModel.getNom():t+=new Date().getTime(),t+=".png";let i=this.storage.ref(t);try{this.canvas.nativeElement.toBlob(r=>{r&&this.storage.upload(t,r).snapshotChanges().pipe(rt(()=>{i.getDownloadURL().subscribe(w=>{this.object[e.getKey()]=w,this.outPutObject.emit(this.object)})})).subscribe()},"image/png")}catch(o){console.error("Error uploading image:",o)}}static \u0275fac=function(t){return new(t||n)(T(Qt),T(z))};static \u0275cmp=U({type:n,selectors:[["lib-upload-new"]],viewQuery:function(t,i){if(t&1&&Y(gi,5),t&2){let o;Q(o=X())&&(i.canvas=o.first)}},inputs:{object:"object",fileUploadModel:"fileUploadModel"},outputs:{outPutObject:"outPutObject"},decls:9,vars:11,consts:[["canvas",""],["fxLayout","column",1,"form-input",3,"fxLayoutAlign"],[3,"object","key","align"],["fxLayoutGap","10px","fxLayoutAlign","start center",3,"fxLayout","fxLayoutAlign"],["class","imgSelect click","alt","Image actuelle",3,"src",4,"ngIf"],[4,"ngIf"],["type","file","accept","image/*","hidden","",3,"change","id"],["class","primary click","style","font-size: 1.5em",3,"type","icone","info","click",4,"ngIf"],["type","button","class","rounded large color-white","mat-raised-button","","color","accent",3,"click",4,"ngIf"],["alt","Image actuelle",1,"imgSelect","click",3,"src"],[1,"primary","click",2,"font-size","1.5em",3,"click","type","icone","info"],["type","button","mat-raised-button","","color","accent",1,"rounded","large","color-white",3,"click"]],template:function(t,i){if(t&1&&(l(0,"div",1)(1,"label"),p(2,"lib-libelle-model",2),a(),l(3,"div",3),g(4,hi,1,1,"img",4)(5,_i,2,0,"canvas",5),l(6,"input",6),b("change",function(r){return i.onFileSelected(r)}),a(),g(7,yi,1,3,"lib-icon",7)(8,Ci,2,0,"button",8),a()()),t&2){let o;s("fxLayoutAlign",i.fileUploadModel.getAlignLabel()?"space-evenly center":"start stretch"),m(2),s("object",i.object)("key",(o=i.fileUploadModel.getDetail()[0].getKey())==null?null:o.toString())("align",i.fileUploadModel.getAlignLabel()),m(),s("fxLayout",i.fileUploadModel.getAlignLabel()&&!(i.selectedFile||i.object[i.fileUploadModel.getDetail()[0].getKey()])?"column":"row")("fxLayoutAlign",i.selectedFile||i.object[i.fileUploadModel.getDetail()[0].getKey()]?"space-evenly start":"start center"),m(),s("ngIf",i.object[i.fileUploadModel.getDetail()[0].getKey()]),m(),s("ngIf",i.selectedFile),m(),be("id",i.id),m(),s("ngIf",i.selectedFile||i.object[i.fileUploadModel.getDetail()[0].getKey()]),m(),s("ngIf",!(i.selectedFile||i.object[i.fileUploadModel.getDetail()[0].getKey()]))}},dependencies:[H,P,k,B,W,re,Oe],styles:["canvas[_ngcontent-%COMP%], .imgSelect[_ngcontent-%COMP%]{max-width:100px;max-height:200px}"]})};var Mi=["canvas"];function vi(n,e){n&1&&p(0,"lib-spinner",5),n&2&&s("textSpec","Chargement en cours ...")}function wi(n,e){if(n&1&&(p(0,"mat-error",20),M(1,"async")),n&2){let t=c(2);s("innerHTML",v(1,1,t.messageError$),ue)}}function Si(n,e){if(n&1){let t=I();l(0,"form",6,1),b("ngSubmit",function(){_(t);let o=V(1),r=c();return y(r.valider(o))}),l(2,"div",7),g(3,wi,2,3,"mat-error",8),M(4,"async"),l(5,"div",9)(6,"label"),p(7,"lib-libelle-model",10),a(),l(8,"input",11),q("ngModelChange",function(o){_(t);let r=c();return j(r.timbreModel.annee,o)||(r.timbreModel.annee=o),y(o)}),a()(),l(9,"div",9)(10,"label"),p(11,"lib-libelle-model",10),a(),l(12,"input",12),q("ngModelChange",function(o){_(t);let r=c();return j(r.timbreModel.code,o)||(r.timbreModel.code=o),y(o)}),a()(),l(13,"div",9)(14,"label"),p(15,"lib-libelle-model",10),a(),l(16,"input",13),q("ngModelChange",function(o){_(t);let r=c();return j(r.timbreModel.monnaie,o)||(r.timbreModel.monnaie=o),y(o)}),a()(),l(17,"div",9)(18,"label"),p(19,"lib-libelle-model",10),a(),l(20,"input",14),q("ngModelChange",function(o){_(t);let r=c();return j(r.timbreModel.type,o)||(r.timbreModel.type=o),y(o)}),a()(),l(21,"div",9)(22,"label"),p(23,"lib-libelle-model",10),a(),l(24,"input",15),q("ngModelChange",function(o){_(t);let r=c();return j(r.timbreModel.yt,o)||(r.timbreModel.yt=o),y(o)}),a()(),l(25,"lib-upload-new",16),b("outPutObject",function(o){_(t);let r=c();return y(r.timbreModel=o)}),a()(),l(26,"div",17)(27,"button",18),b("click",function(){_(t);let o=c();return y(o.close())}),u(28," Annuler "),a(),l(29,"button",19),u(30," Enregistrer "),a()()()}if(n&2){let t=V(1),i=c();s("ngClass",t!=null&&t.submitted?"red-color":"blue-color"),m(3),s("ngIf",v(4,21,i.messageError$)),m(4),s("object",i.timbreModel)("key","annee"),m(),R("ngModel",i.timbreModel.annee),s("max",i.maxAnnee)("zMax",i.maxAnnee),m(3),s("object",i.timbreModel)("key","code"),m(),R("ngModel",i.timbreModel.code),m(3),s("object",i.timbreModel)("key","monnaie"),m(),R("ngModel",i.timbreModel.monnaie),m(3),s("object",i.timbreModel)("key","type"),m(),R("ngModel",i.timbreModel.type),m(3),s("object",i.timbreModel)("key","yt"),m(),R("ngModel",i.timbreModel.yt),m(),s("object",i.timbreModel)("fileUploadModel",i.fileUploadModel)}}var le=class n{constructor(e,t,i){this.httpResponseHandlerService=e;this.dialogRef=t;this.timbreService=i}canvas;messageError$=new S(null);load$=new S(null);id;code;maxAnnee=new Date().getFullYear();timbreModel=new h;fileUploadModel=new ke;ngOnInit(){this.initUpload(),this.load$.next(!1),f(this.code)?this.timbreService.getByCodeAsync(this.code).subscribe(e=>{this.timbreModel=e,this.load$.next(!0)}):f(this.id)?this.timbreService.getTimbreByIdAsync(this.id).subscribe(e=>{this.timbreModel=e,this.load$.next(!0)}):(this.timbreModel.setAnnee(new Date().getFullYear()),this.timbreModel.setMonnaie("E"),this.load$.next(!0))}initUpload(){this.fileUploadModel.setDossier("timbre"),this.fileUploadModel.setNom(new Date().getTime()?.toString());let e=new pe;e.setMaxWidth(this.timbreService.widthTimbre),e.setMaxHeight(this.timbreService.heightTimbre),e.setDossier("autre");let t=new pe;t.setMaxWidth(this.timbreService.widthTimbreZoom),t.setMaxHeight(this.timbreService.heightTimbreZoom),t.setDossier("zoom"),this.fileUploadModel.setDetail([e,t])}valider(e){this.messageError$.next(null),e?.valid&&this.saveData()}saveData(){this.load$.next(!1);try{f(this.timbreModel.getId())?this.timbreService.modifierTimbre(this.timbreModel):this.timbreService.addTimbre(this.timbreModel),this.httpResponseHandlerService.showNotificationSuccess("Transaction termin\xE9e","Votre timbre a bien \xE9t\xE9 modifi\xE9e."),this.load$.next(!0),this.dialogRef.close()}catch{this.httpResponseHandlerService.showNotificationError("Transaction non aboutie","Votre timbre n'a pas pu \xEAtre modifi\xE9."),this.load$.next(!0)}}close(){this.dialogRef.close()}static \u0275fac=function(t){return new(t||n)(T($t),T(De),T(A))};static \u0275cmp=U({type:n,selectors:[["app-timbre-modifier"]],viewQuery:function(t,i){if(t&1&&Y(Mi,5),t&2){let o;Q(o=X())&&(i.canvas=o.first)}},decls:10,vars:6,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","space-between stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","column","fxLayoutGap","20px",1,"bloc-modal"],[3,"innerHTML",4,"ngIf"],["fxLayout","column",1,"form-input"],[3,"object","key"],["name","page","type","number","minlength","4","maxlength","4","min","1900","zMin","1900","required","","zControl","",1,"annee",2,"width","60px !important",3,"ngModelChange","ngModel","max","zMax"],["name","code","type","text","trim","","upperCase","","noEspace","","required","","zControl","",3,"ngModelChange","ngModel"],["name","monnaie","type","text","trim","","minlength","1","maxlength","2","required","","zControl","",2,"width","25px !important",3,"ngModelChange","ngModel"],["name","type","type","text","trim","","zControl","",3,"ngModelChange","ngModel"],["name","yt","type","text","trim","","zControl","",3,"ngModelChange","ngModel"],[3,"outPutObject","object","fileUploadModel"],["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"],[3,"innerHTML"]],template:function(t,i){if(t&1&&(l(0,"div",2)(1,"div",3)(2,"span"),u(3),a(),l(4,"span"),u(5),a()(),g(6,vi,1,1,"ng-template",4),M(7,"async"),g(8,Si,31,23,"ng-template",null,0,he),a()),t&2){let o=V(9);m(3),O("",i.timbreModel!=null&&i.timbreModel.getId()?"MODIFICATION":"AJOUT"," "),m(2),ge(i.timbreModel==null?null:i.timbreModel.getCode()),m(),s("ngIf",v(7,4,i.load$)==!1)("ngIfElse",o)}},dependencies:[W,Ee,_e,H,P,k,B,ne,$,Ce,Se,gt,ht,Te,Me,Ct,xt,Tt,yt,_t,we,ve,oe,re,St,kt,Wt,zt,Gt,Yt,Ve,te]})};var ci=it(di());var mi=it(ui());var Z=class extends ie{annees;acquis;doublon;getAnnees(){return this.annees}setAnnees(e){this.annees=e}getAcquis(){return this.acquis}setAcquis(e){this.acquis=e}getDoublon(){return this.doublon}setDoublon(e){this.doublon=e}};C([x("Ann\xE9e")],Z.prototype,"annees",2),C([x("Acquis")],Z.prototype,"acquis",2),C([x("Doublon")],Z.prototype,"doublon",2);var Ii=()=>[10,20,50,100];function Ei(n,e){if(n&1&&(l(0,"mat-option",7),u(1),a()),n&2){let t=e.$implicit;s("value",t==null?null:t.toString()),m(),O(" ",t," ")}}function Di(n,e){if(n&1&&(l(0,"th",37),p(1,"lib-libelle-model",38),a()),n&2){let t=c();m(),s("object",t.timbre)("key","image")}}function Li(n,e){if(n&1){let t=I();l(0,"img",41),b("click",function(){_(t);let o=c().$implicit,r=c();return y(r.utilsService.zoom(o==null?null:o.getImageZoom()))}),a()}if(n&2){let t=c().$implicit;s("src",t==null?null:t.getImageTable(),fe)}}function Ai(n,e){if(n&1&&(l(0,"td",39),g(1,Li,1,1,"img",40),a()),n&2){let t=e.$implicit;m(),s("ngIf",t==null?null:t.getImageTable())}}function Fi(n,e){if(n&1&&(l(0,"th",42),p(1,"lib-libelle-model",43),a()),n&2){let t=c();m(),s("object",t.timbre)("key","annee")}}function Ni(n,e){if(n&1&&(l(0,"td",44),u(1),a()),n&2){let t=e.$implicit;m(),O(" ",t==null?null:t.getAnnee()," ")}}function Ui(n,e){if(n&1&&(l(0,"th",42),p(1,"lib-libelle-model",43),a()),n&2){let t=c();m(),s("object",t.timbre)("key","code")}}function Oi(n,e){if(n&1&&(l(0,"td",44),u(1),a()),n&2){let t=e.$implicit;m(),O(" ",t==null?null:t.getCode()," ")}}function Ri(n,e){if(n&1&&(l(0,"th",42),p(1,"lib-libelle-model",43),a()),n&2){let t=c();m(),s("object",t.timbre)("key","idBloc")}}function ji(n,e){if(n&1&&(l(0,"td",44),u(1),a()),n&2){let t=e.$implicit;m(),O(" ",t!=null&&t.getIdBloc()?t==null?null:t.getIdBloc():"Non"," ")}}function qi(n,e){if(n&1&&(l(0,"th",45),p(1,"lib-libelle-model",43),a()),n&2){let t=c();m(),s("object",t.timbre)("key","monnaie")}}function Pi(n,e){if(n&1&&(l(0,"td",46),u(1),a()),n&2){let t=e.$implicit;m(),O(" ",(t==null?null:t.getMonnaie())=="E"?"\u20AC":"Francs"," ")}}function ki(n,e){if(n&1&&(l(0,"th",45),p(1,"lib-libelle-model",43),a()),n&2){let t=c();m(),s("object",t.timbre)("key","type")}}function Bi(n,e){if(n&1&&(l(0,"td",46),u(1),a()),n&2){let t=e.$implicit;m(),O(" ",t==null?null:t.getType()," ")}}function Vi(n,e){if(n&1&&(l(0,"th",45),p(1,"lib-libelle-model",43),a()),n&2){let t=c();m(),s("object",t.timbre)("key","yt")}}function Hi(n,e){if(n&1&&(l(0,"td",46),u(1),a()),n&2){let t=e.$implicit;m(),O(" ",t==null?null:t.getYt()," ")}}function $i(n,e){if(n&1&&(l(0,"th",42),p(1,"lib-libelle-model",43),a()),n&2){let t=c();m(),s("object",t.timbre==null?null:t.timbre.getTimbreAcquisModel())("key","acquis")}}function Wi(n,e){if(n&1){let t=I();l(0,"td",39)(1,"lib-icon",47),b("click",function(){let o=_(t).$implicit,r=c();return y(r.acquis(o))}),a()()}if(n&2){let t,i,o,r=e.$implicit,d=c();m(),s("classIcone",!(r==null||(t=r.getTimbreAcquisModel())==null)&&t.isAcquis()?"accent":"primary")("type",d.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",!(r==null||(i=r.getTimbreAcquisModel())==null)&&i.isAcquis()?d.FontAwesomeEnum.CIRCLE_MINUS:d.FontAwesomeEnum.CIRCLE_PLUS)("info",!(r==null||(o=r.getTimbreAcquisModel())==null)&&o.isAcquis()?"pas acquis":"acquis")}}function zi(n,e){if(n&1&&(l(0,"th",42),p(1,"lib-libelle-model",43),a()),n&2){let t=c();m(),s("object",t.timbre==null?null:t.timbre.getTimbreAcquisModel())("key","doublon")}}function Gi(n,e){if(n&1){let t=I();l(0,"td",39)(1,"lib-icon",47),b("click",function(){let o=_(t).$implicit,r=c();return y(r.doublon(o))}),a()()}if(n&2){let t,i,o,r=e.$implicit,d=c();m(),s("classIcone",!(r==null||(t=r.getTimbreAcquisModel())==null)&&t.isDoublon()?"accent":"primary")("type",d.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",!(r==null||(i=r.getTimbreAcquisModel())==null)&&i.isDoublon()?d.FontAwesomeEnum.CIRCLE_MINUS:d.FontAwesomeEnum.CIRCLE_PLUS)("info",!(r==null||(o=r.getTimbreAcquisModel())==null)&&o.isDoublon()?"pas en double":"en double")}}function Yi(n,e){if(n&1&&(l(0,"th",48),p(1,"lib-icon",49),a()),n&2){let t=c();m(),s("type",t.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",t.FontAwesomeEnum.PENCIL)("info","Modifier")}}function Qi(n,e){if(n&1){let t=I();l(0,"td",39)(1,"lib-icon",50),b("click",function(){let o=_(t).$implicit,r=c();return y(r.modifierTimbre(o))}),a()()}if(n&2){let t=c();m(),s("type",t.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",t.FontAwesomeEnum.PENCIL)("info","Modifier")}}function Xi(n,e){if(n&1&&(l(0,"th",48),p(1,"lib-icon",49),a()),n&2){let t=c();m(),s("type",t.FontAwesomeTypeEnum.TYPE_SOLID)("icone",t.FontAwesomeEnum.TRASH)("info","Modifier")}}function Zi(n,e){if(n&1){let t=I();l(0,"td",39)(1,"lib-icon",50),b("click",function(){let o=_(t).$implicit,r=c();return y(r.deleteTimbre(o))}),a()()}if(n&2){let t=c();m(),s("type",t.FontAwesomeTypeEnum.TYPE_SOLID)("icone",t.FontAwesomeEnum.TRASH)("info","Supprimer")}}function Ki(n,e){n&1&&p(0,"tr",51)}function Ji(n,e){n&1&&p(0,"tr",52)}var ae=class n{constructor(e,t,i){this.timbreService=e;this.dialog=t;this.utilsService=i;this.dataSource=new Xe([])}paginator;sort;timbres$;modif=!0;load$=new S(!1);dataSource=new Xe;displayedColumns;timbreCritereModel=new Z;timbre=new h;FontAwesomeEnum=Ie;FontAwesomeTypeEnum=Ue;Utils=se;anneeMin=2e3;anneeMax=new Date().getFullYear();ngOnInit(){this.timbre.setTimbreAcquisModel(new L),this.displayedColumns=["image","annee","code","idBloc","monnaie","type","yt","acquis","doublon"],this.modif&&this.displayedColumns.push("modifier","supprimer"),this.load$.next(!1),this.timbres$.subscribe(e=>{this.dataSource.data=e,this.load$.next(!0)})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.sort.active="idBloc",this.sort.direction="asc",this.dataSource.sort=this.sort}sortData(e){f(e)&&(this.dataSource.sort=this.sort)}filtreByCritere(){this.timbreCritereModel.getAcquis()=="NON"&&this.timbreCritereModel.setDoublon("TOUS"),this.timbreService.getTimbres(this.timbreCritereModel)}applyFilter(e){let t=e.target.value;this.dataSource.filter=t.trim().toLowerCase()}acquis(e){this.timbreService.acquis(e,!1)}doublon(e){this.timbreService.acquis(e,!0)}modifierTimbre(e){let t=this.dialog.open(le,{height:"75vh",maxHeight:"750px",width:"30%"});t.componentInstance.id=e.getId(),t.afterClosed().subscribe(()=>{t.close()})}deleteTimbre(e){let t=this.dialog.open(Zt,{maxHeight:"95vh",data:{titre:"Confirmation",message:"Souhaitez-vous supprimer le timbre <b>"+e?.getCode()+"</b> ?",btnDroite:"Oui",btnGauche:"Non"}});t.afterClosed().subscribe(()=>{t.componentInstance.data.resultat==="valider"&&this.timbreService.deleteTimbre(e)})}exportTable(){let e=Pe.json_to_sheet(this.dataSource.data),t=Pe.book_new();Pe.book_append_sheet(t,e,"Donn\xE9es");let i=Xt(t,{bookType:"xlsx",type:"array"}),o=new Blob([i],{type:"application/octet-stream"});(0,mi.saveAs)(o,"export_timbres.xlsx")}generatePDFByImage(){let e="https://firebasestorage.googleapis.com/v0/b/book-f941b.appspot.com/o/AF.png?alt=media&token=a1039f78-3cff-41ab-8569-ea1b2cefe2c1";this.generatePDF(null)}generatePDF(e){}static \u0275fac=function(t){return new(t||n)(T(A),T(Le),T(z))};static \u0275cmp=U({type:n,selectors:[["app-timbre-resultat"]],viewQuery:function(t,i){if(t&1&&(Y(Ae,5),Y(Fe,5)),t&2){let o;Q(o=X())&&(i.paginator=o.first),Q(o=X())&&(i.sort=o.first)}},inputs:{timbres$:"timbres$",modif:"modif"},decls:69,vars:30,consts:[["fxFlexFill","",3,"fxHide","textSpec"],[3,"fxHide"],["fxLayout","row","fxLayoutAlign","space-between center","fxLayoutGap","15px"],["fxFlex","",2,"font-size","1.2em"],[1,"bold"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input","select",2,"width","100px"],["name","acquis",3,"ngModelChange","ngModel","placeholder"],[1,"selectMin",3,"value"],["name","doublon",1,"scrollBarAccent",3,"ngModelChange","ngModel","placeholder"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input","select",2,"width","150px"],["name","anneeSelect","multiple","",3,"ngModelChange","ngModel","placeholder"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input",2,"width","200px","min-height","55px","height","55px"],["placeholder","Filtrer les donn\xE9es","type","text",3,"input"],[1,"primary","click",2,"font-size","1.7em",3,"click","type","icone","info"],["id","pdf-content","mat-table","","matSort","",3,"matSortChange","dataSource"],["matColumnDef","image"],["mat-header-cell","","class","image",4,"matHeaderCellDef"],["mat-cell","","class","alignCenter",4,"matCellDef"],["matColumnDef","annee"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","code"],["matColumnDef","idBloc"],["matColumnDef","monnaie"],["mat-header-cell","","mat-sort-header","","class","hide-on-mobile",4,"matHeaderCellDef"],["mat-cell","","class","hide-on-mobile",4,"matCellDef"],["matColumnDef","type"],["matColumnDef","yt"],["matColumnDef","acquis"],["matColumnDef","doublon"],["matColumnDef","modifier"],["mat-header-cell","","class","alignCenter",4,"matHeaderCellDef"],["matColumnDef","supprimer"],["mat-header-row","","class","bg-primary color-white",4,"matHeaderRowDef"],["mat-row","","class","mat-row",4,"matRowDef","matRowDefColumns"],[3,"pageSize","pageSizeOptions"],["mat-header-cell","",1,"image"],[1,"hide-on-mobile",3,"object","key"],["mat-cell","",1,"alignCenter"],["class","image click",3,"src","click",4,"ngIf"],[1,"image","click",3,"click","src"],["mat-header-cell","","mat-sort-header",""],[3,"object","key"],["mat-cell",""],["mat-header-cell","","mat-sort-header","",1,"hide-on-mobile"],["mat-cell","",1,"hide-on-mobile"],[1,"click",2,"font-size","1.2em",3,"click","classIcone","type","icone","info"],["mat-header-cell","",1,"alignCenter"],[2,"font-size","1.2em",3,"type","icone","info"],[1,"primary","click",2,"font-size","1.2em",3,"click","type","icone","info"],["mat-header-row","",1,"bg-primary","color-white"],["mat-row","",1,"mat-row"]],template:function(t,i){t&1&&(p(0,"lib-spinner",0),M(1,"async"),l(2,"section",1),M(3,"async"),l(4,"div",2)(5,"div",3)(6,"span"),u(7,"Nombre de timbres : "),a(),l(8,"span",4),u(9),a()(),l(10,"div",5)(11,"mat-select",6),q("ngModelChange",function(r){return j(i.timbreCritereModel.acquis,r)||(i.timbreCritereModel.acquis=r),r}),b("ngModelChange",function(){return i.filtreByCritere()}),l(12,"mat-option",7),u(13," Oui"),a(),l(14,"mat-option",7),u(15," Non"),a(),l(16,"mat-option",7),u(17," Tous"),a()()(),l(18,"div",5)(19,"mat-select",8),q("ngModelChange",function(r){return j(i.timbreCritereModel.doublon,r)||(i.timbreCritereModel.doublon=r),r}),b("ngModelChange",function(){return i.filtreByCritere()}),l(20,"mat-option",7),u(21," Oui"),a(),l(22,"mat-option",7),u(23," Non"),a(),l(24,"mat-option",7),u(25," Tous"),a()()(),l(26,"div",9)(27,"mat-select",10),q("ngModelChange",function(r){return j(i.timbreCritereModel.annees,r)||(i.timbreCritereModel.annees=r),r}),b("ngModelChange",function(){return i.filtreByCritere()}),g(28,Ei,2,2,"mat-option",11),a()(),l(29,"div",12)(30,"input",13),b("input",function(r){return i.applyFilter(r)}),a()(),l(31,"lib-icon",14),b("click",function(){return i.exportTable()}),a()(),l(32,"table",15),b("matSortChange",function(r){return i.sortData(r)}),E(33,16),g(34,Di,2,2,"th",17)(35,Ai,2,1,"td",18),D(),E(36,19),g(37,Fi,2,2,"th",20)(38,Ni,2,1,"td",21),D(),E(39,22),g(40,Ui,2,2,"th",20)(41,Oi,2,1,"td",21),D(),E(42,23),g(43,Ri,2,2,"th",20)(44,ji,2,1,"td",21),D(),E(45,24),g(46,qi,2,2,"th",25)(47,Pi,2,1,"td",26),D(),E(48,27),g(49,ki,2,2,"th",25)(50,Bi,2,1,"td",26),D(),E(51,28),g(52,Vi,2,2,"th",25)(53,Hi,2,1,"td",26),D(),E(54,29),g(55,$i,2,2,"th",20)(56,Wi,2,4,"td",18),D(),E(57,30),g(58,zi,2,2,"th",20)(59,Gi,2,4,"td",18),D(),E(60,31),g(61,Yi,2,3,"th",32)(62,Qi,2,3,"td",18),D(),E(63,33),g(64,Xi,2,3,"th",32)(65,Zi,2,3,"td",18),D(),g(66,Ki,1,0,"tr",34)(67,Ji,1,0,"tr",35),a(),p(68,"mat-paginator",36),a()),t&2&&(s("fxHide",v(1,25,i.load$)==!0)("textSpec","Chargement en cours ..."),m(2),s("fxHide",v(3,27,i.load$)==!1),m(7),ge(i.dataSource==null||i.dataSource.data==null?null:i.dataSource.data.length),m(2),R("ngModel",i.timbreCritereModel.acquis),s("placeholder","Acquis"),m(),s("value","OUI"),m(2),s("value","NON"),m(2),s("value","TOUS"),m(3),R("ngModel",i.timbreCritereModel.doublon),s("placeholder","Doublon"),m(),s("value","OUI"),m(2),s("value","NON"),m(2),s("value","TOUS"),m(3),R("ngModel",i.timbreCritereModel.annees),s("placeholder","Ann\xE9es"),m(),s("ngForOf",i.Utils.generateRange(i.anneeMin,i.anneeMax)),m(3),s("type",i.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",i.FontAwesomeEnum.FILE_EXEL)("info","Exporter tableauu"),m(),s("dataSource",i.dataSource),m(34),s("matHeaderRowDef",i.displayedColumns),m(),s("matRowDefColumns",i.displayedColumns),m(),s("pageSize",15)("pageSizeOptions",st(29,Ii)))},dependencies:[It,vt,Dt,At,Ot,Ft,Lt,Rt,Nt,Ut,jt,qt,Ae,Fe,Et,ct,H,P,k,B,ne,$,ft,Te,we,oe,Oe,re,te],styles:[".mat-row[_ngcontent-%COMP%]{height:35px}.image[_ngcontent-%COMP%]{max-height:30px!important}.mat-column-acquis[_ngcontent-%COMP%], .mat-column-doublon[_ngcontent-%COMP%]{width:60px!important;max-width:60px!important;padding:0!important}.mat-column-ajouter[_ngcontent-%COMP%], .mat-column-modifier[_ngcontent-%COMP%], .mat-column-supprimer[_ngcontent-%COMP%]{width:35px!important;max-width:35px!important;padding:0!important}@media screen and (max-width: 800px){.mat-row[_ngcontent-%COMP%]{height:25px}.image[_ngcontent-%COMP%]{max-height:20px!important}.mat-column-acquis[_ngcontent-%COMP%], .mat-column-doublon[_ngcontent-%COMP%]{width:50px!important;max-width:50px!important;padding:0!important}.mat-column-ajouter[_ngcontent-%COMP%], .mat-column-modifier[_ngcontent-%COMP%], .mat-column-supprimer[_ngcontent-%COMP%]{width:20px!important;max-width:20px!important;padding:0!important}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:0 5px!important}th[_ngcontent-%COMP%], .mat-row[_ngcontent-%COMP%]{font-size:.8em}.mat-column-libelle[_ngcontent-%COMP%],   .mat-column-libelle .mat-sort-header-container{width:40px!important;max-width:40px!important}.mat-column-drapeau[_ngcontent-%COMP%],   .mat-column-drapeau span{width:15px!important;max-width:15px!important}.mat-column-classeur[_ngcontent-%COMP%],   .mat-column-classeur .mat-sort-header-container, .mat-column-page[_ngcontent-%COMP%],   .mat-column-page .mat-sort-header-container{width:15px!important;max-width:15px!important}.mat-column-total[_ngcontent-%COMP%],   .mat-column-total .mat-sort-header-container{width:25px!important;max-width:25px!important}.hide-on-mobile[_ngcontent-%COMP%]{display:none}}"]})};function en(n,e){if(n&1&&(p(0,"lib-spinner",5),M(1,"async")),n&2){let t=c();s("textSpec",v(1,1,t.messageLoad$))}}function tn(n,e){if(n&1&&(p(0,"mat-error",15),M(1,"async")),n&2){let t=c(2);s("innerHTML",v(1,1,t.messageError$),ue)}}function nn(n,e){if(n&1&&p(0,"app-timbre-resultat",16),n&2){let t=c(2);s("timbres$",t.timbres$)("modif",!1)}}function on(n,e){n&1&&(l(0,"button",17),u(1," Enregistrer "),a())}function rn(n,e){if(n&1){let t=I();l(0,"form",6,1),b("ngSubmit",function(){_(t);let o=V(1),r=c();return y(r.valider(o))}),l(2,"div",7),g(3,tn,2,3,"mat-error",8),M(4,"async"),g(5,nn,1,2,"app-timbre-resultat",9),M(6,"async"),a(),l(7,"div",10)(8,"button",11),b("click",function(){_(t);let o=c();return y(o.close())}),u(9," Annuler "),a(),l(10,"input",12),b("change",function(o){_(t);let r=c();return y(r.onFileChange(o))}),a(),l(11,"button",13),b("click",function(){_(t);let o=c();return y(o.triggerFileInput())}),u(12," Choisir un fichier "),a(),g(13,on,2,0,"button",14),M(14,"async"),a()()}if(n&2){let t,i,o=V(1),r=c();s("ngClass",o!=null&&o.submitted?"red-color":"blue-color"),m(3),s("ngIf",v(4,5,r.messageError$)),m(2),s("ngIf",((t=v(6,7,r.timbres$))==null?null:t.length)>0),m(5),be("id",r.idFile),m(3),s("ngIf",((i=v(14,9,r.timbres$))==null?null:i.length)>0)}}var me=class n{constructor(e,t,i){this.timbreService=e;this.uploadService=t;this.dialogRef=i}timbres$=new S(null);messageError$=new S(null);messageLoad$=new S("Chargement en cours ...");load$=new S(null);idFile="fileImport";ngOnInit(){}triggerFileInput(){document.getElementById(this.idFile).click()}onFileChange(e){let t=e.target.files[0];if(t){this.load$.next(!1),this.messageLoad$.next("Chargement en cours ...");let i=new FileReader;this.saveCsv(t,i)}}saveCsv(e,t){t.onload=()=>{let i=t.result;this.parseCsv(i)},t.readAsText(e)}parseCsv(e){let t=[];this.timbres$.next(null),ci.parse(e,{header:!0,skipEmptyLines:!0,complete:i=>{f(i.data)&&i.data?.length>0&&i.data.forEach(o=>{t.push(this.setTimbre(o))}),this.timbres$.next(t),this.load$.next(!0)},error:i=>{console.error("Erreur lors du parsing du CSV :",i)}})}setTimbre(e){let t=new h;t.setId(e.CODE!="NULL"&&e.CODE!=""?e.CODE:null),t.setCode(e.CODE!="NULL"&&e.CODE!=""?e.CODE:null),t.setIdBloc(e.IDENT_BLOC!="NULL"&&e.IDENT_BLOC!=""?e.IDENT_BLOC:null),t.setAnnee(e.ANNEE!="NULL"&&e.ANNEE!=""?e.ANNEE:null),t.setMonnaie(e.MONNAIE!="NULL"&&e.MONNAIE!=""?e.MONNAIE:null),t.setType(e.TYPE!="NULL"&&e.TYPE!=""?e.TYPE:null),t.setYt(e.YT!="NULL"&&e.YT!=""?e.YT:null);let i="/assets/images/timbres/"+t.getAnnee()+"/";return f(t.getIdBloc())&&(i+="bloc/"+t.getIdBloc()+"-"),i+=t.getId()+".png",this.uploadService.checkIfImageExists(i).pipe(N()).subscribe(o=>{o&&t.setImageTable(i)}),t}valider(e){this.messageError$.next(null),e?.valid&&(this.load$.next(!1),this.messageLoad$.next("Import en cours ..."),this.timbres$.pipe(N()).subscribe(t=>{if(f(t)&&t?.length>0)t.forEach((i,o)=>{this.saveTimbre(i,o==t.length-1)});else{this.messageError$.next("Donn\xE9es incorrectes");return}}))}saveTimbre(e,t){nt([this.uploadService.processAndUploadImage(e?.getImageTable(),this.timbreService.widthTimbre*(this.timbreService.heigthTable/this.timbreService.heightTimbre),this.timbreService.heigthTable,e?.getCode(),this.timbreService.dossierImage+(f(e.getIdBloc())?"bloc/":"")+"table"),this.uploadService.processAndUploadImage(e?.getImageTable(),this.timbreService.widthTimbre,this.timbreService.heightTimbre,e?.getCode(),this.timbreService.dossierImage+(f(e.getIdBloc())?"bloc/":"")+"autre"),this.uploadService.processAndUploadImage(e?.getImageTable(),this.timbreService.widthTimbreZoom,this.timbreService.heightTimbreZoom,e?.getCode(),this.timbreService.dossierImage+(f(e.getIdBloc())?"bloc/":"")+"zoom")]).pipe(N(([i,o,r])=>f(o)&&f(r)&&f(i))).subscribe(([i,o,r])=>{e.setImageTable(i),e.setImage(o),e.setImageZoom(r),this.timbreService.addTimbre(e),t&&(this.load$.next(!0),this.close())})}close(){this.dialogRef.close()}static \u0275fac=function(t){return new(t||n)(T(A),T(qe),T(De))};static \u0275cmp=U({type:n,selectors:[["app-timbre-importer"]],decls:8,vars:4,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","start stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","column","fxLayoutGap","20px",1,"bloc-modal"],[3,"innerHTML",4,"ngIf"],[3,"timbres$","modif",4,"ngIf"],["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","file","accept",".xls, .xlsx, .csv","hidden","","required","",3,"change","id"],["type","button","mat-raised-button","","color","accent",1,"rounded","large","color-white",3,"click"],["type","submit","class","rounded large color-white","mat-raised-button","","color","accent",4,"ngIf"],[3,"innerHTML"],[3,"timbres$","modif"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"]],template:function(t,i){if(t&1&&(l(0,"div",2)(1,"div",3)(2,"span"),u(3,"TIMBRE IMPORTER"),a()(),g(4,en,2,3,"ng-template",4),M(5,"async"),g(6,rn,15,11,"ng-template",null,0,he),a()),t&2){let o=V(7);m(4),s("ngIf",v(5,2,i.load$)==!1)("ngIfElse",o)}},dependencies:[W,Ee,_e,H,P,k,B,ne,$,Ce,Se,Me,ve,oe,ae,te]})};var We=class n{constructor(e,t){this.timbreService=e;this.dialog=t}ngOnInit(){this.timbreService.getTimbres()}addTimbre(){let e=this.dialog.open(le,{maxHeight:"95vh",width:"30%"});e.afterClosed().subscribe(()=>{e.close()})}addTimbreBouchon(){this.timbreService.addTimbre(this.timbreService.getBouchon())}importer(){let e=this.dialog.open(me,{height:"90vh",width:"70%"});e.afterClosed().subscribe(()=>{e.close()})}static \u0275fac=function(t){return new(t||n)(T(A),T(Le))};static \u0275cmp=U({type:n,selectors:[["app-timbre-layout"]],decls:15,vars:2,consts:[["fxLayout","column","fxLayoutGap","20px"],[3,"titre"],["fxLayout","row","fxLayoutAlign","space-between stretch"],["fxFlex","5"],["fxFlex","","fxLayout","column","fxLayoutGap","20px"],["fxLayout","row","fxLayoutGap","20px"],["mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["mat-raised-button","","color","accent",1,"rounded","large","color-white",3,"click"],[3,"timbres$"]],template:function(t,i){t&1&&(p(0,"app-simple-notification"),l(1,"div",0),p(2,"app-header",1),l(3,"div",2),p(4,"div",3),l(5,"div",4)(6,"div",5)(7,"button",6),b("click",function(){return i.addTimbre()}),u(8," Ajouter "),a(),l(9,"button",7),b("click",function(){return i.addTimbreBouchon()}),u(10," Bouchon "),a(),l(11,"button",7),b("click",function(){return i.importer()}),u(12," Importer "),a()(),p(13,"app-timbre-resultat",8),a(),p(14,"div",3),a()()),t&2&&(m(2),s("titre",""),m(11),s("timbres$",i.timbreService.timbres$))},dependencies:[W,P,k,B,$,Bt,Kt,ae]})};var ln=[{path:"",component:We},{path:"importer",component:me}],ze=class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=ee({type:n});static \u0275inj=J({imports:[Qe.forChild(ln),Qe]})};var Ge=class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=ee({type:n});static \u0275inj=J({providers:[z],imports:[ye,xe,Ne,je,Re]})};var pi=class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=ee({type:n});static \u0275inj=J({providers:[z,A,qe,pt()],imports:[Ne,ze,ye,bt,xe,Mt,Ht,Re,ii,je,Vt,wt,Pt,Jt,ei,ti,Ge,ni]})};export{pi as TimbreModule};

import{a as Et}from"./chunk-67O6EI3Z.js";import{a as ei,b as ti}from"./chunk-ORWOFCUB.js";import{d as k,e as Wt,f as Yt,g as Zt,h as Xt,i as q,j as ci,l as qt,m as ke,n as ui,o as Kt,p as ii,q as ni}from"./chunk-ALL4ZA7H.js";import{B as Jt,e as Fe,f as Qt}from"./chunk-I7IONR3M.js";import{a as Ut,c as Re,d as Q,e as $t,f as Gt,g as je}from"./chunk-6K26VDAP.js";import{l as T,m as gt,n as Ce,o as yt,u as _t,v as ht}from"./chunk-WOTJWQDQ.js";import"./chunk-Z2WRGFA4.js";import{a as wt}from"./chunk-MJBYZQPI.js";import{$ as J,Aa as y,Ab as W,Ac as Ae,Ba as te,Bb as re,Bc as It,Ca as j,Cb as Y,Cc as Dt,Db as Z,Dc as At,Eb as Ct,Ec as Rt,Fa as N,Fb as vt,Ga as V,Gb as Te,Gc as Ot,H as st,Ha as B,Hc as jt,I as he,Ib as Pt,Jb as Me,Jc as Ft,K as Ge,Ka as ut,Kb as ae,Kc as kt,Lb as le,M as I,Mb as Se,Mc as Nt,N as xe,Na as C,Nb as me,Nc as Vt,O as pt,Oa as v,Ob as Le,Pa as ie,Pb as Tt,Pc as Bt,Qb as Mt,Qc as Ye,Rb as St,Rc as Ht,S as d,Sb as we,Sc as Oe,T as f,Tb as Ee,Tc as zt,Ub as Lt,Xa as ne,Za as R,aa as ee,ab as O,ba as m,bb as dt,c as S,ca as h,ha as u,i as mt,ia as s,ic as se,jc as X,k as ye,l as _e,ma as l,mb as We,mc as pe,na as a,nb as ft,oa as c,ob as b,oc as Ie,pa as D,qa as A,sa as L,ta as g,tb as bt,ua as p,ub as ve,va as ct,vb as Pe,wa as U,x as E,xa as $,xb as oe,xc as De,ya as z,yb as xt,za as F,zb as G}from"./chunk-XHCW746T.js";import{f as lt,g as P}from"./chunk-GOLCFQAC.js";var _=class extends gt{id;code;libelle;libelleLangue;imageLangue;imageLangueZoom;zone;classeur;page;total;map;mapZoom;drapeau;drapeauZoom;visible;constructor(t,e,n,o,r,x,w,K,ze,tt,it,nt,ot,rt,at){super(),this.id=t||null,this.code=e||null,this.libelle=n||null,this.libelleLangue=o||null,this.imageLangue=x||null,this.imageLangueZoom=r||null,this.zone=w||null,this.classeur=K||null,this.page=ze||null,this.total=tt||null,this.map=it||null,this.mapZoom=nt||null,this.drapeau=ot||null,this.drapeauZoom=rt||null,this.visible=at||!1}getId(){return this.id}setId(t){this.id=t}getCode(){return this.code}setCode(t){this.code=t}getLibelle(){return this.libelle}setLibelle(t){this.libelle=t}getLibelleLangue(){return this.libelleLangue}setLibelleLangue(t){this.libelleLangue=t}getImageLangue(){return this.imageLangue}setImageLangue(t){this.imageLangue=t}getImageLangueZoom(){return this.imageLangueZoom}setImageLangueZoom(t){this.imageLangueZoom=t}getZone(){return this.zone}setZone(t){this.zone=t}getClasseur(){return this.classeur}setClasseur(t){this.classeur=t}getPage(){return this.page}setPage(t){this.page=t}getTotal(){return this.total}setTotal(t){this.total=t}getMap(){return this.map}setMap(t){this.map=t}getMapZoom(){return this.mapZoom}setMapZoom(t){this.mapZoom=t}getDrapeau(){return this.drapeau}setDrapeau(t){this.drapeau=t}getDrapeauZoom(){return this.drapeauZoom}setDrapeauZoom(t){this.drapeauZoom=t}getVisible(){return this.visible}setVisible(t){this.visible=t}};P([T("Identifiant")],_.prototype,"id",2),P([T("Code")],_.prototype,"code",2),P([T("Libell\xE9")],_.prototype,"libelle",2),P([T("Libell\xE9 langue")],_.prototype,"libelleLangue",2),P([T("Image langue")],_.prototype,"imageLangue",2),P([T("Image langue")],_.prototype,"imageLangueZoom",2),P([T("Zone")],_.prototype,"zone",2),P([T("Classeur")],_.prototype,"classeur",2),P([T("Page")],_.prototype,"page",2),P([T("Total")],_.prototype,"total",2),P([T("Map")],_.prototype,"map",2),P([T("Map")],_.prototype,"mapZoom",2),P([T("Drapeau")],_.prototype,"drapeau",2),P([T("Drapeau")],_.prototype,"drapeauZoom",2),P([T("Visible")],_.prototype,"visible",2);var M=class i{constructor(t,e){this.firestore=t;this.uploadService=e}heigthTable=50;widthDrapeau=620;heightDrapeau=430;widthLangue=780;heightLangue=200;widthMap=220;heightMap=220;total$=new S(0);upload(t,e,n){let o,r,x;switch(e){case"drapeau":o=this.widthDrapeau,r=this.heightDrapeau,x=t.getDrapeau();break;case"langue":o=this.widthLangue,r=this.heightLangue,x=t.getImageLangue();break;case"map":o=this.widthMap,r=this.heightMap,x=t.getMap();break}return e=="zoom"&&(o=o*(r/r)),b(x)?this.uploadService.processAndUploadImage(x,o,r,t?.getId(),this.getDossier(e,n)):mt("nok")}getDossier(t,e){let n="pays//";return e==!0&&(n=n+"/"+"zoom"),b(t)&&(n=n+"/"+t),n}getTimbreByIdAsync(t){return this.firestore.collection("/timbres_pays",e=>e.where("id","==",t)).valueChanges().pipe(ye(e=>Ce(_,e[0])))}getByCodeAsync(t){return this.firestore.collection("/timbres_pays",e=>e.where("code","==",t)).valueChanges().pipe(ye(e=>Ce(_,e[0])))}getTimbres(){return this.firestore.collection("/timbres_pays").valueChanges().pipe(ye(t=>{let e=0,n=[];return t?.length>0&&t.forEach(o=>{let r=Ce(_,o);n.push(r),e+=+r.getTotal()}),this.total$.next(e),n}))}ajouter(t){return this.firestore.collection("/timbres_pays").add(Object.assign(new Object,t))}modifier(t){this.firestore.collection("/timbres_pays").ref.where("id","==",t.getId()).get().then(e=>{e.forEach(n=>{n.ref.update(Object.assign(new Object,t))})}).catch(e=>{console.error("Erreur de mise \xE0 jour:",e)})}supprimer(t){this.firestore.collection("/timbres_pays").ref.where("id","==",t.getId()).get().then(e=>{e.forEach(n=>{n.ref.delete()})}).catch(e=>{console.error("Erreur de mise \xE0 jour:",e)})}getBouchon(){let t=new _,e=bt.getRandom(1e4);return t.setCode("FR"),t.setLibelle("France "+e),t.setLibelleLangue("France "+e),t.setZone("FR"),t.setClasseur(1),t.setPage(1),t.setTotal(1),t.setVisible(!0),t}static \u0275fac=function(e){return new(e||i)(Ge(_t),Ge(q))};static \u0275prov=st({token:i,factory:i.\u0275fac})};var Ne=class i{constructor(t){this.control=t}KEY_CODE_ARROW_UP="ArrowUp";KEY_CODE_ARROW_DOWN="ArrowDown";set upperCase(t){t.toString()=="false"?this._upperCase=!1:this._upperCase=!0}_upperCase=!0;keyEvent(t){if(this._upperCase&&this.control.value&&t.code!=this.KEY_CODE_ARROW_UP&&t.code!=this.KEY_CODE_ARROW_DOWN)try{this.control.control.setValue(this.control.value.toUpperCase())}catch{}}static \u0275fac=function(e){return new(e||i)(h(Pt))};static \u0275dir=pt({type:i,selectors:[["","upperCase",""]],hostBindings:function(e,n){e&1&&g("paste",function(r){return n.keyEvent(r)})("focus",function(r){return n.keyEvent(r)})("blur",function(r){return n.keyEvent(r)})("keyup",function(r){return n.keyEvent(r)})},inputs:{upperCase:"upperCase"},exportAs:["upperCase"]})};var hi=["canvas"],xi=["formModif"];function Ci(i,t){i&1&&c(0,"lib-spinner",5),i&2&&s("textSpec","Chargement en cours ...")}function vi(i,t){if(i&1&&(c(0,"mat-error",23),C(1,"async")),i&2){let e=p(2);s("innerHTML",v(1,1,e.messageError$),J)}}function Pi(i,t){if(i&1){let e=L();l(0,"form",6,1),g("ngSubmit",function(){d(e);let o=p();return f(o.valider())}),l(2,"div",7),u(3,vi,2,3,"mat-error",8),C(4,"async"),l(5,"div",9)(6,"label"),c(7,"lib-libelle-model",10),a(),l(8,"input",11),B("ngModelChange",function(o){d(e);let r=p();return V(r.timbrePaysModel.code,o)||(r.timbrePaysModel.code=o),f(o)}),a()(),l(9,"div",9)(10,"label"),c(11,"lib-libelle-model",10),a(),l(12,"input",12),B("ngModelChange",function(o){d(e);let r=p();return V(r.timbrePaysModel.libelle,o)||(r.timbrePaysModel.libelle=o),f(o)}),a()(),l(13,"div",9)(14,"label"),c(15,"lib-libelle-model",10),a(),l(16,"input",13),B("ngModelChange",function(o){d(e);let r=p();return V(r.timbrePaysModel.libelleLangue,o)||(r.timbrePaysModel.libelleLangue=o),f(o)}),a()(),l(17,"lib-upload",14),g("outPutObject",function(o){d(e);let r=p();return f(r.timbrePaysModel=o)}),a(),l(18,"div",15)(19,"div",9)(20,"label"),c(21,"lib-libelle-model",10),a(),l(22,"input",16),B("ngModelChange",function(o){d(e);let r=p();return V(r.timbrePaysModel.classeur,o)||(r.timbrePaysModel.classeur=o),f(o)}),a()(),l(23,"div",9)(24,"label"),c(25,"lib-libelle-model",10),a(),l(26,"input",17),B("ngModelChange",function(o){d(e);let r=p();return V(r.timbrePaysModel.page,o)||(r.timbrePaysModel.page=o),f(o)}),a()(),l(27,"div",9)(28,"label"),c(29,"lib-libelle-model",10),a(),l(30,"input",18),B("ngModelChange",function(o){d(e);let r=p();return V(r.timbrePaysModel.total,o)||(r.timbrePaysModel.total=o),f(o)}),a()()(),l(31,"div",19)(32,"lib-upload",14),g("outPutObject",function(o){d(e);let r=p();return f(r.timbrePaysModel=o)}),a(),l(33,"lib-upload",14),g("outPutObject",function(o){d(e);let r=p();return f(r.timbrePaysModel=o)}),a()()(),l(34,"div",20)(35,"button",21),g("click",function(){d(e);let o=p();return f(o.close())}),y(36," Annuler "),a(),l(37,"button",22),y(38," Enregistrer "),a()()()}if(i&2){let e=F(1),n=p();s("ngClass",e!=null&&e.submitted?"red-color":"blue-color"),m(3),s("ngIf",v(4,36,n.messageError$)),m(4),s("object",n.timbrePaysModel)("key","code"),m(),N("ngModel",n.timbrePaysModel.code),m(3),s("object",n.timbrePaysModel)("key","libelle"),m(),N("ngModel",n.timbrePaysModel.libelle),m(3),s("object",n.timbrePaysModel)("key","libelleLangue"),m(),N("ngModel",n.timbrePaysModel.libelleLangue),m(),s("object",n.timbrePaysModel)("key","imageLangue")("maxWidth",n.timbrePaysService.widthLangue)("maxHeight",n.timbrePaysService.heightLangue),m(4),s("object",n.timbrePaysModel)("key","classeur"),m(),N("ngModel",n.timbrePaysModel.classeur),s("max",n.maxClasseur)("zMax",n.maxClasseur),m(3),s("object",n.timbrePaysModel)("key","page"),m(),N("ngModel",n.timbrePaysModel.page),s("max",n.maxPage)("zMax",n.maxPage),m(3),s("object",n.timbrePaysModel)("key","total"),m(),N("ngModel",n.timbrePaysModel.total),m(2),s("object",n.timbrePaysModel)("key","drapeau")("maxWidth",n.timbrePaysService.widthDrapeau)("maxHeight",n.timbrePaysService.heightDrapeau),m(),s("object",n.timbrePaysModel)("key","map")("maxWidth",n.timbrePaysService.widthMap)("maxHeight",n.timbrePaysService.heightMap)}}var ue=class i{constructor(t,e,n,o){this.httpResponseHandlerService=t;this.dialogRef=e;this.timbrePaysService=n;this.utilsService=o}canvas;formModif;messageError$=new S(null);load$=new S(null);id;code;timbrePaysModel=new _;maxClasseur=10;maxPage=64;ngOnInit(){this.load$.next(!1),b(this.code)?this.timbrePaysService.getByCodeAsync(this.code).subscribe(t=>{this.timbrePaysModel=t,this.load$.next(!0)}):b(this.id)?this.timbrePaysService.getTimbreByIdAsync(this.id).subscribe(t=>{this.timbrePaysModel=t,this.load$.next(!0)}):(this.timbrePaysModel=this.timbrePaysService.getBouchon(),this.load$.next(!0))}valider(){if(this.messageError$.next(null),this.formModif?.valid)if(b(this.timbrePaysModel.getDrapeau()))this.saveData();else{this.messageError$.next("Veuillez s\xE9lectionner une image");return}}saveData(){this.load$.next(!1),b(this.timbrePaysModel.getId())?this.save(!1):this.ajouterPays()}ajouterPays(){this.utilsService.getMaxIdentAsync("/timbres_pays").pipe(E()).subscribe(t=>{this.timbrePaysModel.setId(t),this.save(!0)})}save(t){try{_e([this.timbrePaysService.upload(this.timbrePaysModel,"drapeau",!1),this.timbrePaysService.upload(this.timbrePaysModel,"langue",!1),this.timbrePaysService.upload(this.timbrePaysModel,"map",!1),this.timbrePaysService.upload(this.timbrePaysModel,"drapeau",!0),this.timbrePaysService.upload(this.timbrePaysModel,"langue",!0),this.timbrePaysService.upload(this.timbrePaysModel,"map",!0)]).pipe(E(([e,n,o,r,x,w])=>b(e)&&b(e)&&b(n)&&b(o)&&b(r)&&b(x)&&b(w))).subscribe(([e,n,o,r,x,w])=>{b(e)&&e!="nok"&&this.timbrePaysModel.setDrapeau(e),b(n)&&n!="nok"&&this.timbrePaysModel.setImageLangue(n),b(o)&&o!="nok"&&this.timbrePaysModel.setMap(o),b(r)&&r!="nok"&&this.timbrePaysModel.setDrapeauZoom(r),b(x)&&x!="nok"&&this.timbrePaysModel.setImageLangueZoom(x),b(w)&&w!="nok"&&this.timbrePaysModel.setMapZoom(w),t?this.timbrePaysService.ajouter(this.timbrePaysModel):this.timbrePaysService.modifier(this.timbrePaysModel),this.httpResponseHandlerService.showNotificationSuccess("Transaction termin\xE9e","Votre timbre a bien \xE9t\xE9 modifi\xE9e."),this.load$.next(!0),this.dialogRef.close()})}catch{this.httpResponseHandlerService.showNotificationError("Transaction non aboutie","Votre timbre n'a pas pu \xEAtre modifi\xE9."),this.load$.next(!0)}}close(){this.dialogRef.close()}static \u0275fac=function(e){return new(e||i)(h(Fe),h(pe),h(M),h(k))};static \u0275cmp=I({type:i,selectors:[["app-timbre-pays-modifier"]],viewQuery:function(e,n){if(e&1&&(U(hi,5),U(xi,5)),e&2){let o;$(o=z())&&(n.canvas=o.first),$(o=z())&&(n.formModif=o.first)}},decls:10,vars:6,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","space-between stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","column","fxLayoutGap","20px",1,"bloc-modal"],[3,"innerHTML",4,"ngIf"],["fxLayout","column",1,"form-input"],[3,"object","key"],["name","code","type","text","trim","","upperCase","","noEspace","","required","","zControl","",3,"ngModelChange","ngModel"],["name","libelle","type","text","trim","","required","","zControl","",3,"ngModelChange","ngModel"],["name","libelleLangue","type","text","trim","","zControl","",3,"ngModelChange","ngModel"],[3,"outPutObject","object","key","maxWidth","maxHeight"],["fxLayout","row","fxLayoutGap","15px","fxLayoutAlign","space-between center"],["name","classeur","type","number","minlength","1","maxlength","2","min","0","zMin","0","zControl","",1,"numberOnly",3,"ngModelChange","ngModel","max","zMax"],["name","page","type","number","minlength","1","maxlength","2","min","0","zMin","0","zControl","",1,"numberOnly",3,"ngModelChange","ngModel","max","zMax"],["name","total","type","number","minlength","1","maxlength","5","min","0","zMin","0","zControl","",1,"numberOnly",3,"ngModelChange","ngModel"],["fxLayout","row","fxLayoutGap","25px","fxLayoutAlign","space-evenly center"],["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"],[3,"innerHTML"]],template:function(e,n){if(e&1&&(l(0,"div",2)(1,"div",3)(2,"span"),y(3),a(),l(4,"span"),y(5),a()(),u(6,Ci,1,1,"ng-template",4),C(7,"async"),u(8,Pi,39,38,"ng-template",null,0,ie),a()),e&2){let o=F(9);m(3),j("",n.timbrePaysModel!=null&&n.timbrePaysModel.getId()?"MODIFICATION":"AJOUT"," "),m(2),te(n.timbrePaysModel==null?null:n.timbrePaysModel.getLibelle()),m(),s("ngIf",v(7,4,n.load$)==!1)("ngIfElse",o)}},dependencies:[X,se,ne,R,G,W,Z,Y,re,oe,me,Te,Le,Me,ae,St,we,Ee,Mt,Tt,Se,le,Q,je,Et,Re,Wt,Yt,Zt,Ne,Xt,O],encapsulation:2})};var si=lt(ci());var li=lt(ui());var Ti=["formAjoutTimbre"];function Mi(i,t){if(i&1&&c(0,"img",6),i&2){let e=p();s("src",e.timbrePaysModel==null?null:e.timbrePaysModel.getDrapeau(),ee)}}function Si(i,t){i&1&&c(0,"lib-spinner",7),i&2&&s("textSpec","Chargement en cours ...")}function Li(i,t){if(i&1&&(c(0,"mat-error",18),C(1,"async")),i&2){let e=p(2);s("innerHTML",v(1,1,e.messageError$),J)}}function wi(i,t){if(i&1){let e=L();l(0,"form",8,1),g("ngSubmit",function(){d(e);let o=p();return f(o.valider())}),l(2,"div",9)(3,"div",10)(4,"div",11)(5,"label"),y(6," Nombre de timbres "),a(),l(7,"input",12),B("ngModelChange",function(o){d(e);let r=p();return V(r.nbTimbres,o)||(r.nbTimbres=o),f(o)}),g("ngModelChange",function(){d(e);let o=p();return f(o.setTotal())}),a()(),l(8,"div",11)(9,"label"),y(10," Total "),a(),l(11,"span",13),y(12),a()()(),u(13,Li,2,3,"mat-error",14),C(14,"async"),a(),l(15,"div",15)(16,"button",16),g("click",function(){d(e);let o=p();return f(o.close())}),y(17," Annuler "),a(),l(18,"button",17),y(19," Ajouter "),a()()()}if(i&2){let e=F(1),n=p();s("ngClass",e!=null&&e.submitted?"red-color":"blue-color"),m(7),N("ngModel",n.nbTimbres),m(5),te(n.timbrePaysModel.getTotal()),m(),s("ngIf",v(14,4,n.messageError$))}}var Be=class i{constructor(t,e,n){this.httpResponseHandlerService=t;this.dialogRef=e;this.timbrePaysService=n}formAjoutTimbre;messageError$=new S(null);load$=new S(null);id;timbrePaysModel=new _;totalOrigine;nbTimbres;ngOnInit(){this.load$.next(!1),this.timbrePaysService.getTimbreByIdAsync(this.id).subscribe(t=>{this.timbrePaysModel=t,this.totalOrigine=this.timbrePaysModel.getTotal(),this.load$.next(!0)})}setTotal(){this.timbrePaysModel.setTotal(this.nbTimbres+ +this.totalOrigine)}valider(){if(this.messageError$.next(null),this.formAjoutTimbre?.valid)if(this.timbrePaysModel.getTotal()>=0)this.saveData();else{this.messageError$.next("Le total doit \xEAtre positif");return}}saveData(){this.load$.next(!1),this.timbrePaysService.modifier(this.timbrePaysModel),this.httpResponseHandlerService.showNotificationSuccess("Transaction termin\xE9e","Votre timbre a bien \xE9t\xE9 modifi\xE9e."),this.load$.next(!0),this.dialogRef.close()}close(){this.dialogRef.close()}static \u0275fac=function(e){return new(e||i)(h(Fe),h(pe),h(M))};static \u0275cmp=I({type:i,selectors:[["app-timbre-pays-ajout-timbre"]],viewQuery:function(e,n){if(e&1&&U(Ti,5),e&2){let o;$(o=z())&&(n.formAjoutTimbre=o.first)}},decls:9,vars:6,consts:[["load",""],["formAjoutTimbre","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","space-between center",1,"titre-modal","bg-primary","color-white"],["fxLayoutAlign","end center",3,"src",4,"ngIf"],[3,"ngIf","ngIfElse"],["fxLayoutAlign","end center",3,"src"],["fxFlexFill","",3,"textSpec"],["ngForm","formAjoutTimbre","fxFlex","100","fxLayout","column","fxLayoutAlign","space-between stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","column",1,"bloc-modal"],["fxLayout","row","fxLayoutGap","15px","fxLayoutAlign","space-between center"],["fxLayout","column",1,"form-input","noError"],["name","nbTimbres","type","number","minlength","1","maxlength","5","zControl","",1,"numberOnly",3,"ngModelChange","ngModel"],["fxLayoutAlign","start center",1,"bold",2,"height","32px","font-size","1.2em"],[3,"innerHTML",4,"ngIf"],["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"],[3,"innerHTML"]],template:function(e,n){if(e&1&&(l(0,"div",2)(1,"div",3)(2,"span"),y(3),a(),u(4,Mi,1,1,"img",4),a(),u(5,Si,1,1,"ng-template",5),C(6,"async"),u(7,wi,20,6,"ng-template",null,0,ie),a()),e&2){let o=F(8);m(3),j("","AJOUT TIMBRES"," "),m(),s("ngIf",n.timbrePaysModel==null?null:n.timbrePaysModel.getDrapeau()),m(),s("ngIf",v(6,4,n.load$)==!1)("ngIfElse",o)}},dependencies:[X,se,ne,R,G,W,Z,Y,re,oe,me,Te,Le,Me,ae,we,Ee,Se,le,Q,Re,O],styles:[".dialog-modal[_ngcontent-%COMP%]   .titre-modal[_ngcontent-%COMP%]{padding-top:5px!important;padding-bottom:5px!important}.dialog-modal[_ngcontent-%COMP%]   .bloc-modal[_ngcontent-%COMP%]{padding-bottom:0!important}"]})};function Ei(i,t){if(i&1&&(l(0,"div",2)(1,"span",3),y(2,"Nombre de "),a(),l(3,"span"),y(4,"Timbres : "),a(),l(5,"span",4),y(6),C(7,"async"),a()()),i&2){let e=p();m(6),te(v(7,1,e.timbrePaysService.total$))}}var He=class i{constructor(t){this.timbrePaysService=t}static \u0275fac=function(e){return new(e||i)(h(M))};static \u0275cmp=I({type:i,selectors:[["app-timbre-pays-total"]],decls:3,vars:3,consts:[[1,"timbreTotal"],["class","nbTimbre",4,"ngIf"],[1,"nbTimbre"],[1,"hide-on-mobile"],[1,"bold"]],template:function(e,n){e&1&&(l(0,"div",0),u(1,Ei,8,3,"div",1),C(2,"async"),a()),e&2&&(m(),s("ngIf",v(2,1,n.timbrePaysService.total$)))},dependencies:[R,O],styles:[".timbreTotal[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:start;align-content:center;gap:10px}.timbreTotal[_ngcontent-%COMP%]   .nbTimbre[_ngcontent-%COMP%]{font-size:1.2em;justify-content:start;align-content:center}.timbreTotal[_ngcontent-%COMP%]   lib-icon[_ngcontent-%COMP%]{font-size:1.5em}@media screen and (max-width: 800px){.timbreTotal[_ngcontent-%COMP%]{height:25px;gap:5px}.timbreTotal[_ngcontent-%COMP%]   .nbTimbre[_ngcontent-%COMP%]{font-size:1em}.timbreTotal[_ngcontent-%COMP%]   lib-icon[_ngcontent-%COMP%]{font-size:1.2em}}"]})};var Ai=()=>[10,15,50,300];function Ri(i,t){if(i&1&&(l(0,"th",30),c(1,"lib-libelle-model",31),a()),i&2){let e=p();m(),s("object",e.timbre)("key","drapeau")}}function Oi(i,t){if(i&1){let e=L();l(0,"img",34),g("click",function(){d(e);let o=p().$implicit,r=p();return f(r.utilsService.zoom(o==null?null:o.getDrapeauZoom()))}),a()}if(i&2){let e=p().$implicit;s("src",e==null?null:e.getDrapeau(),ee)}}function ji(i,t){if(i&1&&(l(0,"td",32),u(1,Oi,1,1,"img",33),a()),i&2){let e=t.$implicit;m(),s("ngIf",e==null?null:e.getDrapeau())}}function Fi(i,t){if(i&1&&(l(0,"th",35),c(1,"lib-libelle-model",36),a()),i&2){let e=p();m(),s("object",e.timbre)("key","code")}}function ki(i,t){if(i&1&&(l(0,"td",37),y(1),a()),i&2){let e=t.$implicit;m(),j(" ",e==null?null:e.getCode()," ")}}function Ni(i,t){if(i&1&&(l(0,"th",38),c(1,"lib-libelle-model",36),a()),i&2){let e=p();m(),s("object",e.timbre)("key","libelle")}}function Vi(i,t){if(i&1&&(l(0,"td",39),y(1),a()),i&2){let e=t.$implicit;m(),j(" ",e==null?null:e.getLibelle()," ")}}function Bi(i,t){if(i&1&&(l(0,"th",40),c(1,"lib-libelle-model",36),a()),i&2){let e=p();m(),s("object",e.timbre)("key","libelleLangue")}}function Hi(i,t){if(i&1&&(l(0,"span"),y(1),a()),i&2){let e=p().$implicit;m(),j(" ",e==null?null:e.getLibelleLangue()," ")}}function Ui(i,t){if(i&1){let e=L();l(0,"img",43),g("click",function(){d(e);let o=p().$implicit,r=p();return f(r.utilsService.zoom(o==null?null:o.getImageLangueZoom()))}),a()}if(i&2){let e=p().$implicit;s("src",e==null?null:e.getImageLangue(),ee)}}function $i(i,t){if(i&1&&(l(0,"td",37),u(1,Hi,2,1,"span",41)(2,Ui,1,1,"img",42),a()),i&2){let e=t.$implicit;m(),s("ngIf",e==null?null:e.getLibelleLangue()),m(),s("ngIf",e==null?null:e.getImageLangue())}}function zi(i,t){if(i&1&&(l(0,"th",44),c(1,"lib-libelle-model",36),a()),i&2){let e=p();m(),s("object",e.timbre)("key","classeur")}}function Gi(i,t){if(i&1&&(l(0,"td",32),y(1),a()),i&2){let e=t.$implicit;m(),j(" ",e==null?null:e.getClasseur()," ")}}function Wi(i,t){if(i&1&&(l(0,"th",44),c(1,"lib-libelle-model",36),a()),i&2){let e=p();m(),s("object",e.timbre)("key","page")}}function Yi(i,t){if(i&1&&(l(0,"td",32),y(1),a()),i&2){let e=t.$implicit;m(),j(" ",e==null?null:e.getPage()," ")}}function Zi(i,t){if(i&1&&(l(0,"th",44),c(1,"lib-libelle-model",36),a()),i&2){let e=p();m(),s("object",e.timbre)("key","total")}}function Xi(i,t){if(i&1&&(l(0,"td",32),y(1),a()),i&2){let e=t.$implicit;m(),j(" ",e==null?null:e.getTotal()," ")}}function Qi(i,t){if(i&1&&(l(0,"th",40),c(1,"lib-libelle-model",36),a()),i&2){let e=p();m(),s("object",e.timbre)("key","map")}}function qi(i,t){if(i&1){let e=L();l(0,"img",46),g("click",function(){d(e);let o=p().$implicit,r=p();return f(r.utilsService.zoom(o==null?null:o.getMapZoom()))}),a()}if(i&2){let e=p().$implicit;s("src",e==null?null:e.getMap(),ee)}}function Ki(i,t){if(i&1&&(l(0,"td",37),u(1,qi,1,1,"img",45),a()),i&2){let e=t.$implicit;m(),s("ngIf",e==null?null:e.getMap())}}function Ji(i,t){if(i&1&&(l(0,"th",47),c(1,"lib-icon",48),a()),i&2){let e=p();m(),s("type",e.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",e.FontAwesomeEnum.CIRCLE_PLUS)("info","Ajouter timbre")}}function en(i,t){if(i&1){let e=L();l(0,"td",32)(1,"lib-icon",49),g("click",function(){let o=d(e).$implicit,r=p();return f(r.ajouterTimbre(o))}),a()()}if(i&2){let e=p();m(),s("type",e.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",e.FontAwesomeEnum.CIRCLE_PLUS)("info","Ajouter timbre")}}function tn(i,t){if(i&1&&(l(0,"th",47),c(1,"lib-icon",48),a()),i&2){let e=p();m(),s("type",e.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",e.FontAwesomeEnum.PENCIL)("info","Modifier")}}function nn(i,t){if(i&1){let e=L();l(0,"td",32)(1,"lib-icon",49),g("click",function(){let o=d(e).$implicit,r=p();return f(r.modifier(o))}),a()()}if(i&2){let e=p();m(),s("type",e.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",e.FontAwesomeEnum.PENCIL)("info","Modifier")}}function on(i,t){if(i&1&&(l(0,"th",47),c(1,"lib-icon",48),a()),i&2){let e=p();m(),s("type",e.FontAwesomeTypeEnum.TYPE_SOLID)("icone",e.FontAwesomeEnum.TRASH)("info","Modifier")}}function rn(i,t){if(i&1){let e=L();l(0,"td",32)(1,"lib-icon",49),g("click",function(){let o=d(e).$implicit,r=p();return f(r.supprimer(o))}),a()()}if(i&2){let e=p();m(),s("type",e.FontAwesomeTypeEnum.TYPE_SOLID)("icone",e.FontAwesomeEnum.TRASH)("info","Supprimer")}}function an(i,t){i&1&&c(0,"tr",50)}function ln(i,t){i&1&&c(0,"tr",51)}var de=class i{constructor(t,e,n,o){this.timbrePaysService=t;this.dialog=e;this.utilsService=n;this.uploadService=o;this.dataSource=new Ye([])}paginator;sort;timbres$;modif=!0;load$=new S(!1);dataSource=new Ye;displayedColumns;timbre=new _;FontAwesomeEnum=Pe;FontAwesomeTypeEnum=ve;ngOnInit(){this.displayedColumns=["drapeau","code","libelle","libelleLangue","classeur","page","total","image"],this.modif&&this.displayedColumns.push("ajouter","modifier","supprimer"),this.load$.next(!1),this.timbres$.subscribe(t=>{this.dataSource.data=t,this.load$.next(!0)})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.sort.active="libelle",this.sort.direction="asc",this.dataSource.sort=this.sort}sortData(t){b(t)&&(this.dataSource.sort=this.sort)}applyFilter(t){let e=t.target.value;this.dataSource.filter=e.trim().toLowerCase()}ajouterTimbre(t){let e=this.dialog.open(Be,{height:"200px",width:"300px"});e.componentInstance.id=t.id,e.afterClosed().subscribe(()=>{e.close()})}modifier(t){let e=this.dialog.open(ue,{height:"75vh",maxHeight:"800px",width:"30%",minWidth:"300px"});e.componentInstance.id=t.id,e.afterClosed().subscribe(()=>{e.close()})}supprimer(t){let e=this.dialog.open(Qt,{maxHeight:"95vh",data:{titre:"Confirmation",message:"Souhaitez-vous supprimer le pays <b>"+t?.getLibelle()+"</b> ?",btnDroite:"Oui",btnGauche:"Non"}});e.afterClosed().subscribe(()=>{e.componentInstance.data.resultat==="valider"&&this.timbrePaysService.supprimer(t)})}exportTable(){let t=ke.json_to_sheet(this.dataSource.data),e=ke.book_new();ke.book_append_sheet(e,t,"Donn\xE9es");let n=qt(e,{bookType:"xlsx",type:"array"}),o=new Blob([n],{type:"application/octet-stream"});(0,li.saveAs)(o,"export_pays.xlsx")}static \u0275fac=function(e){return new(e||i)(h(M),h(Ie),h(k),h(q))};static \u0275cmp=I({type:i,selectors:[["app-timbre-pays-resultat"]],viewQuery:function(e,n){if(e&1&&(U(De,5),U(Ae,5)),e&2){let o;$(o=z())&&(n.paginator=o.first),$(o=z())&&(n.sort=o.first)}},inputs:{timbres$:"timbres$",modif:"modif"},decls:46,vars:16,consts:[["fxFlexFill","",3,"fxHide","textSpec"],[3,"fxHide"],["fxLayout","row","fxLayoutAlign","space-between center","fxLayoutGap","15px"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input",2,"width","200px","min-height","55px","height","55px"],["placeholder","Filtrer les donn\xE9es","type","text",3,"input"],[1,"exportTable","primary","click","hide-on-mobile",3,"click","type","icone","info"],["id","pdf-content","mat-table","","matSort","",3,"matSortChange","dataSource"],["matColumnDef","drapeau"],["mat-header-cell","","class","drapeau",4,"matHeaderCellDef"],["mat-cell","","class","alignCenter",4,"matCellDef"],["matColumnDef","code"],["mat-header-cell","","matSort","","mat-sort-header","","class","hide-on-mobile",4,"matHeaderCellDef"],["mat-cell","","class","hide-on-mobile",4,"matCellDef"],["matColumnDef","libelle"],["mat-header-cell","","matSort","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","libelleLangue"],["mat-header-cell","","class","hide-on-mobile",4,"matHeaderCellDef"],["matColumnDef","classeur"],["mat-header-cell","","matSort","","mat-sort-header","","class","alignCenter",4,"matHeaderCellDef"],["matColumnDef","page"],["matColumnDef","total"],["matColumnDef","image"],["matColumnDef","ajouter"],["mat-header-cell","","class","alignCenter",4,"matHeaderCellDef"],["matColumnDef","modifier"],["matColumnDef","supprimer"],["mat-header-row","","class","bg-primary color-white",4,"matHeaderRowDef"],["mat-row","","class","mat-row",4,"matRowDef","matRowDefColumns"],[3,"pageSize","pageSizeOptions"],["mat-header-cell","",1,"drapeau"],[1,"hide-on-mobile",3,"object","key"],["mat-cell","",1,"alignCenter"],["class","imgPays click",3,"src","click",4,"ngIf"],[1,"imgPays","click",3,"click","src"],["mat-header-cell","","matSort","","mat-sort-header","",1,"hide-on-mobile"],[3,"object","key"],["mat-cell","",1,"hide-on-mobile"],["mat-header-cell","","matSort","","mat-sort-header",""],["mat-cell",""],["mat-header-cell","",1,"hide-on-mobile"],[4,"ngIf"],["class","imgLangue click",3,"src","click",4,"ngIf"],[1,"imgLangue","click",3,"click","src"],["mat-header-cell","","matSort","","mat-sort-header","",1,"alignCenter"],["class","imgMap click",3,"src","click",4,"ngIf"],[1,"imgMap","click",3,"click","src"],["mat-header-cell","",1,"alignCenter"],[2,"font-size","1.2em",3,"type","icone","info"],[1,"primary","click",2,"font-size","1.2em",3,"click","type","icone","info"],["mat-header-row","",1,"bg-primary","color-white"],["mat-row","",1,"mat-row"]],template:function(e,n){e&1&&(c(0,"lib-spinner",0),C(1,"async"),l(2,"section",1),C(3,"async"),l(4,"div",2),c(5,"app-timbre-pays-total"),l(6,"div",3)(7,"input",4),g("input",function(r){return n.applyFilter(r)}),a()(),l(8,"lib-icon",5),g("click",function(){return n.exportTable()}),a()(),l(9,"table",6),g("matSortChange",function(r){return n.sortData(r)}),D(10,7),u(11,Ri,2,2,"th",8)(12,ji,2,1,"td",9),A(),D(13,10),u(14,Fi,2,2,"th",11)(15,ki,2,1,"td",12),A(),D(16,13),u(17,Ni,2,2,"th",14)(18,Vi,2,1,"td",15),A(),D(19,16),u(20,Bi,2,2,"th",17)(21,$i,3,2,"td",12),A(),D(22,18),u(23,zi,2,2,"th",19)(24,Gi,2,1,"td",9),A(),D(25,20),u(26,Wi,2,2,"th",19)(27,Yi,2,1,"td",9),A(),D(28,21),u(29,Zi,2,2,"th",19)(30,Xi,2,1,"td",9),A(),D(31,22),u(32,Qi,2,2,"th",17)(33,Ki,2,1,"td",12),A(),D(34,23),u(35,Ji,2,3,"th",24)(36,en,2,3,"td",9),A(),D(37,25),u(38,tn,2,3,"th",24)(39,nn,2,3,"td",9),A(),D(40,26),u(41,on,2,3,"th",24)(42,rn,2,3,"td",9),A(),u(43,an,1,0,"tr",27)(44,ln,1,0,"tr",28),a(),c(45,"mat-paginator",29),a()),e&2&&(s("fxHide",v(1,11,n.load$)==!0)("textSpec","Chargement en cours ..."),m(2),s("fxHide",v(3,13,n.load$)==!1),m(6),s("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.FILE_EXEL)("info","Exporter tableau"),m(),s("dataSource",n.dataSource),m(34),s("matHeaderRowDef",n.displayedColumns),m(),s("matRowDefColumns",n.displayedColumns),m(),s("pageSize",15)("pageSizeOptions",ut(15,Ai)))},dependencies:[Dt,Rt,kt,Ot,At,Nt,jt,Ft,Vt,Bt,De,Ae,It,R,G,W,Z,Y,xt,Q,Oe,je,He,O],styles:[".mat-row[_ngcontent-%COMP%]{height:35px}.imgPays[_ngcontent-%COMP%], .imgLangue[_ngcontent-%COMP%]{max-height:30px!important}.imgMap[_ngcontent-%COMP%]{max-height:25px!important}.mat-column-ajouter[_ngcontent-%COMP%], .mat-column-modifier[_ngcontent-%COMP%], .mat-column-supprimer[_ngcontent-%COMP%]{width:35px!important;max-width:35px!important;padding:0!important}.exportTable[_ngcontent-%COMP%]{font-size:1.7em}@media screen and (max-width: 800px){.mat-row[_ngcontent-%COMP%]{height:25px}.imgPays[_ngcontent-%COMP%], .imgLangue[_ngcontent-%COMP%]{max-height:20px!important}.imgMap[_ngcontent-%COMP%]{max-height:15px!important}.mat-column-ajouter[_ngcontent-%COMP%], .mat-column-modifier[_ngcontent-%COMP%], .mat-column-supprimer[_ngcontent-%COMP%]{width:10px!important;max-width:10px!important;padding:0!important}.exportTable[_ngcontent-%COMP%]{font-size:1.7em}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:0 5px!important}th[_ngcontent-%COMP%], .mat-row[_ngcontent-%COMP%]{font-size:.8em}.mat-column-libelle[_ngcontent-%COMP%],   .mat-column-libelle .mat-sort-header-container{width:40px!important;max-width:40px!important}.mat-column-drapeau[_ngcontent-%COMP%],   .mat-column-drapeau span{width:15px!important;max-width:15px!important}.mat-column-classeur[_ngcontent-%COMP%],   .mat-column-classeur .mat-sort-header-container, .mat-column-page[_ngcontent-%COMP%],   .mat-column-page .mat-sort-header-container{width:15px!important;max-width:15px!important}.mat-column-total[_ngcontent-%COMP%],   .mat-column-total .mat-sort-header-container{width:25px!important;max-width:25px!important}}"]})};function mn(i,t){if(i&1&&(c(0,"lib-spinner",5),C(1,"async")),i&2){let e=p();s("textSpec",v(1,1,e.messageLoad$))}}function sn(i,t){if(i&1&&(c(0,"mat-error",15),C(1,"async")),i&2){let e=p(2);s("innerHTML",v(1,1,e.messageError$),J)}}function pn(i,t){if(i&1&&c(0,"app-timbre-pays-resultat",16),i&2){let e=p(2);s("timbres$",e.timbres$)("modif",!1)}}function cn(i,t){i&1&&(l(0,"button",17),y(1," Enregistrer "),a())}function un(i,t){if(i&1){let e=L();l(0,"form",6,1),g("ngSubmit",function(){d(e);let o=F(1),r=p();return f(r.valider(o))}),l(2,"div",7),u(3,sn,2,3,"mat-error",8),C(4,"async"),u(5,pn,1,2,"app-timbre-pays-resultat",9),C(6,"async"),a(),l(7,"div",10)(8,"button",11),g("click",function(){d(e);let o=p();return f(o.close())}),y(9," Annuler "),a(),l(10,"input",12),g("change",function(o){d(e);let r=p();return f(r.onFileChange(o))}),a(),l(11,"button",13),g("click",function(){d(e);let o=p();return f(o.triggerFileInput())}),y(12," Choisir un fichier "),a(),u(13,cn,2,0,"button",14),C(14,"async"),a()()}if(i&2){let e,n,o=F(1),r=p();s("ngClass",o!=null&&o.submitted?"red-color":"blue-color"),m(3),s("ngIf",v(4,5,r.messageError$)),m(2),s("ngIf",((e=v(6,7,r.timbres$))==null?null:e.length)>0),m(5),ct("id",r.idFile),m(3),s("ngIf",((n=v(14,9,r.timbres$))==null?null:n.length)>0)}}var fe=class i{constructor(t,e,n,o){this.timbrePaysService=t;this.uploadService=e;this.utilsService=n;this.dialogRef=o}timbres$=new S(null);messageError$=new S(null);messageLoad$=new S("Chargement en cours ...");load$=new S(null);idFile="fileImport";ngOnInit(){}triggerFileInput(){document.getElementById(this.idFile).click()}onFileChange(t){let e=t.target.files[0];if(e){this.load$.next(!1),this.messageLoad$.next("Chargement en cours ...");let n=new FileReader;this.saveCsv(e,n)}}saveCsv(t,e){e.onload=()=>{let n=e.result;this.parseCsv(n)},e.readAsText(t)}parseCsv(t){let e=[];this.timbres$.next(null),si.parse(t,{header:!0,skipEmptyLines:!0,complete:n=>{b(n.data)&&n.data?.length>0&&n.data.forEach(o=>{e.push(this.setTimbre(o))}),this.timbres$.next(e),this.load$.next(!0)},error:n=>{console.error("Erreur lors du parsing du CSV :",n)}})}setTimbre(t){let e=new _;e.setId(t.ID!="NULL"?t.ID:""),e.setCode(t.CODE!="NULL"?t.CODE:""),e.setLibelle(t.LIBELLE_FR!="NULL"?t.LIBELLE_FR:""),e.setZone(t.ZONE!="NULL"?t.ZONE:""),e.setClasseur(t.CLASSEUR!="NULL"?t.CLASSEUR:""),e.setPage(t.PAGE!="NULL"?t.PAGE:""),e.setTotal(t.TOTAL!="NULL"?t.TOTAL:""),e.setVisible(t.VISIBLE!="NULL"?t.VISIBLE:"");let n="/assets/images/drapeau/"+e.getCode()+".png";this.uploadService.checkIfImageExists(n).pipe(E()).subscribe(x=>{x&&e.setDrapeau(n)});let o="/assets/images/langue/"+e.getCode()+".png";this.uploadService.checkIfImageExists(o).pipe(E()).subscribe(x=>{x?e.setImageLangue(o):e.setLibelleLangue(t.LIBELLE_LANGUE!="NULL"?t.LIBELLE_LANGUE:"")});let r="/assets/images/map/"+e.getCode()+".png";return this.uploadService.checkIfImageExists(r).pipe(E()).subscribe(x=>{x?e.setMap(r):e.setMap(t.MAP!="NULL"?t.MAP:"")}),e}valider(t){this.messageError$.next(null),t?.valid&&(this.load$.next(!1),this.messageLoad$.next("Import en cours ..."),this.timbres$.pipe(E()).subscribe(e=>{if(b(e)&&e?.length>0)e.forEach((n,o)=>{this.saveTimbre(n,o==e.length-1)});else{this.messageError$.next("Donn\xE9es incorrectes");return}}))}saveTimbre(t,e){_e([this.timbrePaysService.upload(t,"drapeau",!1),this.timbrePaysService.upload(t,"langue",!1),this.timbrePaysService.upload(t,"map",!1),this.timbrePaysService.upload(t,"drapeau",!0),this.timbrePaysService.upload(t,"langue",!0),this.timbrePaysService.upload(t,"map",!0)]).pipe(E()).subscribe(([n,o,r,x,w,K])=>{b(n)&&n!="nok"&&t.setDrapeau(n),b(o)&&o!="nok"&&t.setImageLangue(o),b(r)&&r!="nok"&&t.setMap(r),b(x)&&x!="nok"&&t.setDrapeauZoom(x),b(w)&&w!="nok"&&t.setImageLangueZoom(w),b(K)&&K!="nok"&&t.setMapZoom(K),this.utilsService.getMaxIdentAsync("/timbres_pays").pipe(E()).subscribe(ze=>{this.timbrePaysService.ajouter(t),e&&(this.load$.next(!0),this.close())})})}close(){this.dialogRef.close()}static \u0275fac=function(e){return new(e||i)(h(M),h(q),h(k),h(pe))};static \u0275cmp=I({type:i,selectors:[["app-timbre-pays-importer"]],decls:8,vars:4,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","start stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","column","fxLayoutGap","20px",1,"bloc-modal"],[3,"innerHTML",4,"ngIf"],[3,"timbres$","modif",4,"ngIf"],["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","file","accept",".xls, .xlsx, .csv","hidden","","required","",3,"change","id"],["type","button","mat-raised-button","","color","accent",1,"rounded","large","color-white",3,"click"],["type","submit","class","rounded large color-white","mat-raised-button","","color","accent",4,"ngIf"],[3,"innerHTML"],[3,"timbres$","modif"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"]],template:function(e,n){if(e&1&&(l(0,"div",2)(1,"div",3)(2,"span"),y(3,"TIMBRE PAYS IMPORTER"),a()(),u(4,mn,2,3,"ng-template",4),C(5,"async"),u(6,un,15,11,"ng-template",null,0,ie),a()),e&2){let o=F(7);m(4),s("ngIf",v(5,2,n.load$)==!1)("ngIfElse",o)}},dependencies:[X,se,ne,R,G,W,Z,Y,re,oe,me,ae,le,Q,de,O]})};function dn(i,t){if(i&1){let e=L();l(0,"div")(1,"button",4),g("click",function(){d(e);let o=p();return f(o.ajouter())}),y(2," Ajouter "),a(),l(3,"button",5),g("click",function(){d(e);let o=p();return f(o.ajouterBouchon())}),y(4," Bouchon "),a(),l(5,"lib-icon",6),g("click",function(){d(e);let o=p();return f(o.importer())}),a()()}if(i&2){let e=p();m(5),s("icone",e.FontAwesomeEnum.UPLOAD)("type",e.FontAwesomeTypeEnum.TYPE_SOLID)("info","Importer les timbres")}}var Ue=class i{constructor(t,e,n,o){this.timbrePaysService=t;this.dialog=e;this.utilsService=n;this.authService=o}ngOnInit(){}ajouter(){let t=this.dialog.open(ue,{maxHeight:"95vh",width:"30%",minWidth:"300px"});t.afterClosed().subscribe(()=>{t.close()})}ajouterBouchon(){this.utilsService.getMaxIdentAsync("/timbres_pays").pipe(E()).subscribe(t=>{let e=this.timbrePaysService.getBouchon();e.setId(t),this.timbrePaysService.ajouter(e)})}importer(){let t=this.dialog.open(fe,{height:"90vh",width:"70%",minWidth:"300px"});t.afterClosed().subscribe(()=>{t.close()})}DroitEnum=yt;RouteEnum=ft;FontAwesomeEnum=Pe;FontAwesomeTypeEnum=ve;static \u0275fac=function(e){return new(e||i)(h(M),h(Ie),h(k),h(ht))};static \u0275cmp=I({type:i,selectors:[["app-timbre-pays-layout"]],decls:5,vars:4,consts:[[1,"timbrePaysLayout"],[1,"timbreBody"],[4,"ngIf"],[3,"timbres$"],["mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["mat-raised-button","","color","accent",1,"rounded","large","color-white","hide-on-mobile",3,"click"],[1,"accent","click","hide-on-mobile",2,"font-size","2em",3,"click","icone","type","info"]],template:function(e,n){if(e&1&&(l(0,"div",0)(1,"div",1),u(2,dn,6,3,"div",2),C(3,"async"),c(4,"app-timbre-pays-resultat",3),a()()),e&2){let o;m(2),s("ngIf",((o=v(3,2,n.authService.user$))==null?null:o.getDroit())==n.DroitEnum.TOTAL),m(2),s("timbres$",n.timbrePaysService.getTimbres())}},dependencies:[X,R,Oe,de,O],styles:[".timbrePaysLayout[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-content:stretch;padding:0 2%;width:96%;height:97%;margin-top:20px}.timbrePaysLayout[_ngcontent-%COMP%]   .timbreBody[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;gap:20px}@media screen and (max-width: 800px){.timbrePaysLayout[_ngcontent-%COMP%]{margin-top:15px}.timbrePaysLayout[_ngcontent-%COMP%]   .timbreBody[_ngcontent-%COMP%]{gap:5px}}"]})};var fn=[{path:"",component:Ue},{path:"importer",component:fe}],$e=class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=xe({type:i});static \u0275inj=he({imports:[We.forChild(fn),We]})};var pi=class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=xe({type:i});static \u0275inj=he({providers:[k,M,q],imports:[Ht,$e,dt,Ct,vt,Lt,$t,zt,ei,Gt,wt,Ut,Kt,Jt,ti,ii,ni]})};export{pi as TimbrePaysModule};

import{a as De,b as P,c as ot,d as rt,e as lt,f as mt,g as ti,h as bi,i as ii,j as at,k as fi,l as ni}from"./chunk-KN4H3D4B.js";import{B as nt}from"./chunk-6OXUUNNO.js";import{a as Vt,d as tt,e as ae,h as Ee}from"./chunk-4Z67JGV7.js";import{a as Me}from"./chunk-UL4MOOK7.js";import{A as b,Aa as _e,Ab as le,Ac as Wt,Ba as Te,Bb as me,Bc as zt,Ca as Y,Cc as Zt,Db as Rt,Dc as Gt,Eb as Pe,Ec as Qt,Fa as X,Fc as Yt,Ga as Dt,Gc as Xt,Hb as Ce,Hc as Kt,I as he,Ib as ye,Ic as Jt,J as qe,Jb as Se,Jc as Tt,K as m,Kb as Be,L as y,Lb as Ie,Lc as it,Mb as He,Mc as ei,Nb as We,Ob as ze,Pb as Ze,Q as f,Qb as Ge,R as l,Rb as Qe,Sb as Ut,Tb as qt,Ub as Ye,Vb as Ft,W as a,Wb as Nt,X as s,Xb as jt,Y as T,Z as L,_ as O,aa as I,ab as Lt,ba as x,bb as c,c as w,ca as p,cb as oe,da as wt,ea as ue,f as Z,fa as de,g as k,ga as be,gb as _,ha as R,hb as K,hc as we,ia as g,ib as fe,ic as te,ja as je,jc as kt,ka as F,kc as Ae,l as M,la as At,m as Ne,ma as N,mc as Xe,na as j,oa as V,p as ge,pb as xe,q as Bt,qb as Ve,ra as Et,rb as ke,rc as $t,s as U,sb as Ot,sc as Ke,tb as ve,u as G,ua as v,ub as $e,v as It,va as C,vc as Je,wa as Q,wb as J,xb as ee,xc as et,yb as re,yc as Pt,z as d,zc as Ht}from"./chunk-MKHZGOTV.js";import{g as St,i as h}from"./chunk-GV7GV3NK.js";var S=class extends K{id;idBloc;annee;monnaie;type;yt;image;imageTable;imageZoom;timbreAcquisModel;timbreBlocModel;constructor(e,t,i,n,r,u,B,D,z,ne,A){super(),this.id=e||null,this.idBloc=t||null,this.annee=i||null,this.monnaie=n||null,this.type=r||null,this.yt=u||null,this.image=B||null,this.imageTable=D||null,this.imageZoom=z||null,this.timbreAcquisModel=ne||null,this.timbreBlocModel=A||null}getId(){return this.id}setId(e){this.id=e}getIdBloc(){return this.idBloc}setIdBloc(e){this.idBloc=e}getAnnee(){return this.annee}setAnnee(e){this.annee=e}getMonnaie(){return this.monnaie}setMonnaie(e){this.monnaie=e}getType(){return this.type}setType(e){this.type=e}getYt(){return this.yt}setYt(e){this.yt=e}getImage(){return this.image}setImage(e){this.image=e}getImageTable(){return this.imageTable}setImageTable(e){this.imageTable=e}getImageZoom(){return this.imageZoom}setImageZoom(e){this.imageZoom=e}getTimbreAcquisModel(){return this.timbreAcquisModel}setTimbreAcquisModel(e){this.timbreAcquisModel=e}getTimbreBlocModel(){return this.timbreBlocModel}setTimbreBlocModel(e){this.timbreBlocModel=e}};h([_("Identifiant")],S.prototype,"id",2),h([_("Identifiant bloc")],S.prototype,"idBloc",2),h([_("Ann\xE9e")],S.prototype,"annee",2),h([_("Monnaie")],S.prototype,"monnaie",2),h([_("Type")],S.prototype,"type",2),h([_("R\xE9ference Yvert Tellier")],S.prototype,"yt",2),h([_("Image")],S.prototype,"image",2),h([_("Image tableau")],S.prototype,"imageTable",2),h([_("Image zoom")],S.prototype,"imageZoom",2),h([_("v\xE9rif")],S.prototype,"timbreAcquisModel",2),h([_("Bloc")],S.prototype,"timbreBlocModel",2);var q=class extends K{idUser;idTimbre;acquis;doublon;constructor(e,t,i,n){super(),this.idUser=e||null,this.idTimbre=t||null,this.acquis=i||!1,this.doublon=n||!1}getIdUser(){return this.idUser}setIdUser(e){this.idUser=e}getIdTimbre(){return this.idTimbre}setIdTimbre(e){this.idTimbre=e}isAcquis(){return this.acquis}setAcquis(e){this.acquis=e}isDoublon(){return this.doublon}setDoublon(e){this.doublon=e}};h([_("Identifiant Utilisateur")],q.prototype,"idUser",2),h([_("Identifiant timbre")],q.prototype,"idTimbre",2),h([_("Acquis")],q.prototype,"acquis",2),h([_("Doublon")],q.prototype,"doublon",2);var se=class o{constructor(e){this.firestore=e}getAnneesAsync(e){return this.firestore.collection(e,t=>{let i=t;return i=i.orderBy("annee","desc"),i}).valueChanges().pipe(Z(t=>{let i=t.map(n=>Number(n.annee)).filter(n=>c(n)&&n!=0);return Array.from(new Set(i))}))}getTimbresByCritereAsync(e){return this.getAllTimbres(e).pipe(Z(t=>this.constructTimbres(t,null,null)))}getAllTimbres(e){return this.firestore.collection("/timbres",t=>{let i=t;return c(e)&&(c(e.getAnnees())&&e.getAnnees()?.length>0&&(i=i.where("annee","in",e.getAnnees())),c(e.getBloc())&&e.getBloc()!="TOUS"?i=i.where("idBloc",e.getBloc()!="NON"?"!=":"==",null):c(e.getIdBloc())&&(i=i.where("idBloc","==",e.getIdBloc()))),i=i.orderBy("id","asc"),i}).valueChanges()}constructTimbres(e,t,i,n){let r=[];return e?.length>0&&e.forEach(u=>{let B=this.constructTimbre(u,t,i),D=!0;c(n)&&c(B.getTimbreAcquisModel())&&(c(n.getAcquis())&&!(n.getAcquis()=="TOUS"||n.getAcquis()=="OUI"&&B.getTimbreAcquisModel().isAcquis()||n.getAcquis()=="NON"&&!B.getTimbreAcquisModel().isAcquis())&&(D=!1),c(n.getDoublon())&&!(n.getDoublon()=="TOUS"||n.getDoublon()=="OUI"&&B.getTimbreAcquisModel().isDoublon()||n.getDoublon()=="NON"&&!B.getTimbreAcquisModel().isDoublon())&&(D=!1)),D==!0&&r.push(B)}),r}constructTimbre(e,t,i){let n=fe(S,e);if(c(i)){let r=i.find(u=>u.getId()==n?.getIdBloc());c(r)&&n.setTimbreBlocModel(r)}if(c(t)){let r=t.find(u=>u.idTimbre==n.getId());c(r)?n.setTimbreAcquisModel(fe(q,r)):n.setTimbreAcquisModel(new q)}return n}supprimerTimbreAcquis(e,t){c(e?.getTimbreAcquisModel()?.getIdUser())&&this.firestore.collection("/timbres_acquis").ref.where("idTimbre","==",e.getId()).where("idUser","==",t).get().then(i=>{i.forEach(n=>{n.ref.delete()})})}supprimerTimbre(e){this.firestore.collection("/timbres").ref.where("id","==",e.getId()).get().then(t=>{t.forEach(i=>{i.ref.delete()})}).catch(t=>{console.error("Erreur de suppression :",t)})}static \u0275fac=function(t){return new(t||o)(U(xe))};static \u0275prov=ge({token:o,factory:o.\u0275fac})};var $=class extends K{annees;acquis;doublon;idBloc;bloc;getAnnees(){return this.annees}setAnnees(e){this.annees=e}getAcquis(){return this.acquis}setAcquis(e){this.acquis=e}getDoublon(){return this.doublon}setDoublon(e){this.doublon=e}getIdBloc(){return this.idBloc}setIdBloc(e){this.idBloc=e}getBloc(){return this.bloc}setBloc(e){this.bloc=e}};h([_("Ann\xE9e")],$.prototype,"annees",2),h([_("Acquis")],$.prototype,"acquis",2),h([_("Doublon")],$.prototype,"doublon",2),h([_("Ident bloc")],$.prototype,"idBloc",2),h([_("Bloc")],$.prototype,"bloc",2);var E=class extends K{id;annee;monnaie;image;imageTable;imageZoom;timbreBlocAcquisModel;nbTimbres;idOrigine;constructor(e,t,i,n,r,u,B,D){super(),this.id=e||null,this.annee=t||null,this.monnaie=i||null,this.image=n||null,this.imageTable=r||null,this.imageZoom=u||null,this.timbreBlocAcquisModel=B||null,this.nbTimbres=D||null}getId(){return this.id}setId(e){this.id=e}getAnnee(){return this.annee}setAnnee(e){this.annee=e}getMonnaie(){return this.monnaie}setMonnaie(e){this.monnaie=e}getImage(){return this.image}setImage(e){this.image=e}getImageTable(){return this.imageTable}setImageTable(e){this.imageTable=e}getImageZoom(){return this.imageZoom}setImageZoom(e){this.imageZoom=e}getTimbreBlocAcquisModel(){return this.timbreBlocAcquisModel}setTimbreBlocAcquisModel(e){this.timbreBlocAcquisModel=e}getNbTimbres(){return this.nbTimbres}setNbTimbres(e){this.nbTimbres=e}};h([_("Identifiant")],E.prototype,"id",2),h([_("Ann\xE9e")],E.prototype,"annee",2),h([_("Monnaie")],E.prototype,"monnaie",2),h([_("Image")],E.prototype,"image",2),h([_("Image tableau")],E.prototype,"imageTable",2),h([_("Image zoom")],E.prototype,"imageZoom",2),h([_("v\xE9rif")],E.prototype,"timbreBlocAcquisModel",2),h([_("Nombre de timbres")],E.prototype,"nbTimbres",2);var H=class extends K{idUser;idBloc;acquis;doublon;constructor(e,t,i,n){super(),this.idUser=e||null,this.idBloc=t||null,this.acquis=i||!1,this.doublon=n||!1}getIdUser(){return this.idUser}setIdUser(e){this.idUser=e}getIdBloc(){return this.idBloc}setIdBloc(e){this.idBloc=e}isAcquis(){return this.acquis}setAcquis(e){this.acquis=e}isDoublon(){return this.doublon}setDoublon(e){this.doublon=e}};h([_("Identifiant Utilisateur")],H.prototype,"idUser",2),h([_("Identifiant bloc")],H.prototype,"idBloc",2),h([_("Acquis")],H.prototype,"acquis",2),h([_("Doublon")],H.prototype,"doublon",2);var ie=class o{constructor(e,t,i,n,r){this.firestore=e;this.authService=t;this.uploadService=i;this.utilsService=n;this.timbreUtilsService=r}heigthTable=50;widthTimbre=100;heightTimbre=100;widthTimbreZoom=500;heightTimbreZoom=500;total$=new w(0);timbresBlocModel$=new w(null);upload(e,t){let i=this.widthTimbre,n=this.heightTimbre;return t=="table"?(i=i*(this.heigthTable/n),n=this.heigthTable):t=="zoom"&&(i=i*(this.heightTimbreZoom/n),n=this.heightTimbreZoom),this.uploadService.processAndUploadImage(e?.getImage(),i,n,"bloc",this.getDossier(e,t))}getTotal(e){this.total$.next(null),this.getAllBlocs(e).pipe(M()).subscribe(t=>{this.total$.next(t?.length)})}getBloc(e){return this.firestore.collection("/timbres_bloc",t=>t.where("id","==",e)).valueChanges()}getBlocByIdAsync(e){return this.getBloc(e).pipe(Z(t=>fe(E,t[0])))}getAllBlocs(e){return this.firestore.collection("/timbres_bloc",t=>{let i=t;return c(e)&&c(e.getAnnees())&&e.getAnnees()?.length>0&&(i=i.where("annee","in",e.getAnnees())),i}).valueChanges()}getTimbreBlocAcquis(){return this.authService.getUser().pipe(M(),Ne(e=>c(e)?this.getTimbreBlocAcquisByUser(e.getId()).pipe(M(),Z(t=>t)):null))}getTimbreBlocAcquisByUser(e){return this.firestore.collection("/timbres_bloc_acquis",t=>t.where("idUser","==",e)).valueChanges()}getBlocs(e){this.getTotal(),this.timbresBlocModel$.next(null),k([this.getAllBlocs(e),this.getTimbreBlocAcquis()]).pipe(M()).subscribe(([t,i])=>{this.constructBlocs(t,i,e)})}getBlocsAsync(e){return this.timbresBlocModel$.next(null),this.getAllBlocs(e).pipe(M(),Z(t=>this.constructBlocs(t,null,e)))}constructBloc(e,t){let i=fe(E,e);if(c(t)){let n=t.find(r=>r.idBloc==i.getId());c(n)?i.setTimbreBlocAcquisModel(fe(H,n)):i.setTimbreBlocAcquisModel(new H)}return i}constructBlocs(e,t,i){let n=[];return e?.length>0&&e.forEach(r=>{let u=this.constructBloc(r,t);this.getTimbresByBlocAsync(u.getId()).subscribe(D=>{u.setNbTimbres(D?.length)});let B=!0;c(i)&&c(u.getTimbreBlocAcquisModel())&&(c(i.getAcquis())&&!(i.getAcquis()=="TOUS"||i.getAcquis()=="OUI"&&u.getTimbreBlocAcquisModel().isAcquis()||i.getAcquis()=="NON"&&!u.getTimbreBlocAcquisModel().isAcquis())&&(B=!1),c(i.getDoublon())&&!(i.getDoublon()=="TOUS"||i.getDoublon()=="OUI"&&u.getTimbreBlocAcquisModel().isDoublon()||i.getDoublon()=="NON"&&!u.getTimbreBlocAcquisModel().isDoublon())&&(B=!1)),B==!0&&n.push(u)}),this.timbresBlocModel$.next(n),n}acquis(e,t){return this.authService.getUser().pipe(M(i=>c(i))).subscribe(i=>{c(e?.getTimbreBlocAcquisModel()?.getIdUser())?this.firestore.collection("/timbres_bloc_acquis").ref.where("idTimbre","==",e.getId()).where("idUser","==",i.getId()).get().then(n=>{n.forEach(r=>{let u=e.getTimbreBlocAcquisModel();t?(u.setAcquis(!0),u.setDoublon(!u.isDoublon())):(u.setAcquis(!u.isAcquis()),u.isAcquis()||u.setDoublon(!1)),r.ref.update(Object.assign(new Object,u))})}).catch(n=>{console.error("Erreur de mise \xE0 jour:",n)}):this.addAcquis(i?.getId(),e,t)})}addAcquis(e,t,i){let n=new H;n.setIdUser(e),n.setIdBloc(t.getId()),n.setAcquis(!0),n.setDoublon(i),t.setTimbreBlocAcquisModel(n),this.firestore.collection("/timbres_bloc_acquis").add(Object.assign(new Object,n))}ajouterSansId(e){this.utilsService.getMaxIdentAsync("/timbres_bloc").pipe(M()).subscribe(t=>{e.setId(t),this.ajouter(e,!0)})}ajouter(e,t){this.getBloc(e.getId()).pipe(M()).subscribe(i=>{oe(i)||oe(i[0])||c(i[0])&&i[0]?.length==0?(e.setTimbreBlocAcquisModel(null),this.firestore.collection("/timbres_bloc").add(Object.assign(new Object,e)),t&&this.getBlocs()):console.error("bloc d\xE9j\xE0 existant")})}modifier(e){this.firestore.collection("/timbres_bloc").ref.where("id","==",e.getId()).get().then(t=>{t.forEach(i=>{i.ref.update(Object.assign(new Object,e)),this.getBlocs()})}).catch(t=>{console.error("Erreur de mise \xE0 jour:",t)})}getTimbresByBlocAsync(e){let t=new $;return t.setIdBloc(e),this.timbreUtilsService.getTimbresByCritereAsync(t)}supprimer(e){this.authService.getUser().pipe(M(t=>c(t))).subscribe(t=>{this.getTimbresByBlocAsync(e.getId()).pipe(M()).subscribe(i=>{i.forEach(n=>{this.timbreUtilsService.supprimerTimbreAcquis(n,t.getId()),this.timbreUtilsService.supprimerTimbre(n)})}),c(e?.getTimbreBlocAcquisModel()?.getIdUser())&&this.firestore.collection("/timbres_bloc_acquis").ref.where("idBloc","==",e.getId()).where("idUser","==",t.getId()).get().then(i=>{i.forEach(n=>{n.ref.delete()})}),this.firestore.collection("/timbres_bloc").ref.where("id","==",e.getId()).get().then(i=>{i.forEach(n=>{n.ref.delete(),this.getBlocs()})}).catch(i=>{console.error("Erreur de suppression :",i)})})}getDossier(e,t){let i="timbre//"+e.getAnnee();return c(t)&&(i=i+"/"+t),i=i+"/bloc/"+e.getId(),i}getBouchon(){let e=new E;return e.setAnnee(new Date().getFullYear()),e.setMonnaie("E"),e}static \u0275fac=function(t){return new(t||o)(U(xe),U(Me),U(De),U(P),U(se))};static \u0275prov=ge({token:o,factory:o.\u0275fac})};var W=class o{constructor(e,t,i,n,r,u){this.firestore=e;this.authService=t;this.timbreBlocService=i;this.uploadService=n;this.utilsService=r;this.timbreUtilsService=u}heigthTable=50;widthTimbre=100;heightTimbre=100;widthTimbreZoom=500;heightTimbreZoom=500;total$=new w(0);timbres$=new w(null);getTimbre(e){return this.firestore.collection("/timbres",t=>t.where("id","==",e)).valueChanges()}getTimbreByIdAsync(e){return k([this.getTimbre(e),this.timbreBlocService.getBlocsAsync()]).pipe(Z(([t,i])=>this.timbreUtilsService.constructTimbre(t[0],null,i)))}getTotal(e){this.total$.next(null),this.timbreUtilsService.getAllTimbres(e).pipe(M()).subscribe(t=>{this.total$.next(t?.length)})}getTimbres(e){this.getTotal(),this.timbres$.next(null),k([this.timbreUtilsService.getAllTimbres(e),this.getTimbreAcquis(),this.timbreBlocService.getBlocsAsync(e)]).pipe(M()).subscribe(([t,i,n])=>{this.timbres$.next(this.timbreUtilsService.constructTimbres(t,i,n,e))})}getTimbreAcquis(){return this.authService.getUser().pipe(M(),Ne(e=>c(e)?this.getTimbreAcquisByUser(e.getId()).pipe(M(),Z(t=>t)):null))}getTimbreAcquisByUser(e){return this.firestore.collection("/timbres_acquis",t=>t.where("idUser","==",e)).valueChanges()}acquis(e,t){return this.authService.getUser().pipe(M(i=>c(i))).subscribe(i=>{c(e?.getTimbreAcquisModel()?.getIdUser())?this.firestore.collection("/timbres_acquis").ref.where("idTimbre","==",e.getId()).where("idUser","==",i.getId()).get().then(n=>{n.forEach(r=>{let u=e.getTimbreAcquisModel();t?(u.setAcquis(!0),u.setDoublon(!u.isDoublon())):(u.setAcquis(!u.isAcquis()),u.isAcquis()||u.setDoublon(!1)),r.ref.update(Object.assign(new Object,u))})}).catch(n=>{console.error("Erreur de mise \xE0 jour:",n)}):this.addAcquis(i?.getId(),e,t)})}addAcquis(e,t,i){let n=new q;n.setIdUser(e),n.setIdTimbre(t.getId()),n.setAcquis(!0),n.setDoublon(i),t.setTimbreAcquisModel(n),this.firestore.collection("/timbres_acquis").add(Object.assign(new Object,n))}ajouterSansId(e){this.utilsService.getMaxIdentAsync("/timbres").pipe(M()).subscribe(t=>{e.setId(t),c(e.getIdBloc())&&(e.setAnnee(null),e.setMonnaie(null)),this.ajouter(e,!0)})}ajouter(e,t){this.getTimbre(e.getId()).pipe(M()).subscribe(i=>{oe(i)||oe(i[0])||c(i[0])&&i[0]?.length==0?(e.setTimbreAcquisModel(null),e.setTimbreBlocModel(null),this.firestore.collection("/timbres").add(Object.assign(new Object,e)),t&&this.getTimbres()):console.error("timbre d\xE9j\xE0 existant")})}modifier(e){e.setTimbreBlocModel(null),e.setTimbreAcquisModel(null),this.firestore.collection("/timbres").ref.where("id","==",e.getId()).get().then(t=>{t.forEach(i=>{i.ref.update(Object.assign(new Object,e)),this.getTimbres()})}).catch(t=>{console.error("Erreur de mise \xE0 jour:",t)})}supprimerTimbre(e){this.firestore.collection("/timbres").ref.where("id","==",e.getId()).get().then(t=>{t.forEach(i=>{i.ref.delete(),this.getTimbres()})}).catch(t=>{console.error("Erreur de suppression :",t)})}supprimer(e){this.authService.getUser().pipe(M(t=>c(t))).subscribe(t=>{this.timbreUtilsService.supprimerTimbreAcquis(e,t.getId()),this.supprimerTimbre(e)})}getBouchon(){let e=new S;return e.setAnnee(new Date().getFullYear()),e.setMonnaie("E"),e.setType(""),e.setYt(""),e}upload(e,t){let i=this.widthTimbre,n=this.heightTimbre;return t=="table"?(i=i*(this.heigthTable/n),n=this.heigthTable):t=="zoom"&&(i=i*(this.heightTimbreZoom/n),n=this.heightTimbreZoom),this.uploadService.processAndUploadImage(e?.getImage(),i,n,e?.getId(),this.getDossier(e,t))}getDossier(e,t){let i="timbre//";return c(e.getIdBloc())?i=i+e.getTimbreBlocModel().getAnnee():i=i+e.getAnnee(),c(t)&&(i=i+"/"+t),c(e.getIdBloc())&&(i=i+"/bloc/"+e.getIdBloc()),i}static \u0275fac=function(t){return new(t||o)(U(xe),U(Me),U(ie),U(De),U(P),U(se))};static \u0275prov=ge({token:o,factory:o.\u0275fac})};var mi=class o{static \u0275fac=function(t){return new(t||o)};static \u0275mod=It({type:o});static \u0275inj=Bt({providers:[W],imports:[Dt,Rt,Ut,Ft,Nt,jt,qt,$t,kt,ei,te]})};var pi=St(bi());var Oe=class{dossier;nom;alignLabel;detail;file;getDossier(){return this.dossier}setDossier(e){this.dossier=e}getNom(){return this.nom}setNom(e){this.nom=e}getAlignLabel(){return this.alignLabel}setAlignLabel(e){this.alignLabel=e}getDetail(){return this.detail}setDetail(e){this.detail=e}getFile(){return this.file}setFile(e){this.file=e}};var pe=class{key;dossier;maxWidth;maxHeight;getKey(){return this.key}setKey(e){this.key=e}getDossier(){return this.dossier}setDossier(e){this.dossier=e}getMaxWidth(){return this.maxWidth}setMaxWidth(e){this.maxWidth=e}getMaxHeight(){return this.maxHeight}setMaxHeight(e){this.maxHeight=e}};var Bi=["canvas"];function Ii(o,e){if(o&1&&(a(0,"span",6)(1,"b"),g(2),s()()),o&2){let t=p();m(2),F("N\xB0",t.timbreModel==null?null:t.timbreModel.getId(),"")}}function wi(o,e){o&1&&T(0,"lib-spinner",7),o&2&&l("textSpec","Chargement en cours ...")}function Ai(o,e){if(o&1&&(T(0,"mat-error",29),v(1,"async")),o&2){let t=p(2);l("innerHTML",C(1,1,t.messageError$),he)}}function Ei(o,e){if(o&1&&(a(0,"mat-option",18),g(1),s()),o&2){let t=e.$implicit;l("value",t),m(),At(" ",t.getAnnee()," - ",t.getId()," ")}}function Di(o,e){if(o&1){let t=I();a(0,"img",30),x("click",function(){let n;d(t);let r=p(2);return b(r.utilsService.zoom(r.timbreModel==null||(n=r.timbreModel.getTimbreBlocModel())==null?null:n.getImageZoom()))}),s()}if(o&2){let t,i=p(2);l("src",i.timbreModel==null||(t=i.timbreModel.getTimbreBlocModel())==null?null:t.getImage(),qe)}}function Li(o,e){if(o&1){let t=I();a(0,"form",8,1),x("ngSubmit",function(){d(t);let n=R(1),r=p();return b(r.valider(n))}),a(2,"div",9),f(3,Ai,2,3,"mat-error",10),v(4,"async"),a(5,"div",11)(6,"div",12)(7,"label"),T(8,"lib-libelle-model",13),s(),a(9,"input",14),V("ngModelChange",function(n){d(t);let r=p();return j(r.timbreModel.annee,n)||(r.timbreModel.annee=n),b(n)}),x("ngModelChange",function(n){d(t);let r=p();return b(r.changeAnnee(n))}),s()(),a(10,"div",15)(11,"label"),T(12,"lib-libelle-model",13),s(),a(13,"div",16)(14,"mat-select",17),v(15,"async"),x("ngModelChange",function(n){d(t);let r=p();return b(r.changeBloc(n))}),T(16,"mat-option",18),f(17,Ei,2,3,"mat-option",19),v(18,"async"),s(),f(19,Di,1,1,"img",20),s()()(),a(20,"div",11)(21,"div",12)(22,"label"),T(23,"lib-libelle-model",13),s(),a(24,"input",21),V("ngModelChange",function(n){d(t);let r=p();return j(r.timbreModel.type,n)||(r.timbreModel.type=n),b(n)}),s()(),a(25,"div",12)(26,"label"),T(27,"lib-libelle-model",13),s(),a(28,"input",22),V("ngModelChange",function(n){d(t);let r=p();return j(r.timbreModel.monnaie,n)||(r.timbreModel.monnaie=n),b(n)}),s()()(),a(29,"div",11)(30,"div",12)(31,"label"),T(32,"lib-libelle-model",13),s(),a(33,"input",23),V("ngModelChange",function(n){d(t);let r=p();return j(r.timbreModel.yt,n)||(r.timbreModel.yt=n),b(n)}),s()(),T(34,"div",24),s(),a(35,"lib-upload",25),x("outPutObject",function(n){d(t);let r=p();return b(r.timbreModel=n)}),s()(),a(36,"div",26)(37,"button",27),x("click",function(){d(t);let n=p();return b(n.close())}),g(38," Annuler "),s(),a(39,"button",28),g(40," Enregistrer "),s()()()}if(o&2){let t,i,n=R(1),r=p();l("ngClass",n!=null&&n.submitted?"red-color":"blue-color"),m(3),l("ngIf",C(4,31,r.messageError$)),m(5),l("object",r.timbreModel)("key","annee"),m(),N("ngModel",r.timbreModel.annee),l("max",r.maxAnnee)("zMax",r.maxAnnee)("disabled",!!(r.timbreModel!=null&&r.timbreModel.getId())),m(3),l("object",r.timbreModel)("key","timbreBlocModel"),m(2),l("ngModel",r.timbreModel.getTimbreBlocModel())("placeholder","Choix bloc")("disabled",!!(r.timbreModel!=null&&r.timbreModel.getId())||((t=C(15,33,r.timbreBlocService.timbresBlocModel$))==null?null:t.length)<=0),m(2),l("value",null),m(),l("ngForOf",C(18,35,r.timbreBlocService.timbresBlocModel$)),m(2),l("ngIf",r.timbreModel==null||(i=r.timbreModel.getTimbreBlocModel())==null?null:i.getImage()),m(4),l("object",r.timbreModel)("key","type"),m(),N("ngModel",r.timbreModel.type),m(3),l("object",r.timbreModel)("key","monnaie"),m(),N("ngModel",r.timbreModel.monnaie),l("disabled",!!r.timbreModel.getTimbreBlocModel()),m(4),l("object",r.timbreModel)("key","yt"),m(),N("ngModel",r.timbreModel.yt),m(2),l("object",r.timbreModel)("key","image")("zoom",r.timbreModel.getImageZoom())("maxWidth",r.timbreService.widthTimbre)("maxHeight",r.timbreService.heightTimbre)}}var Re=class o{constructor(e,t,i,n,r){this.httpResponseHandlerService=e;this.dialogRef=t;this.timbreService=i;this.timbreBlocService=n;this.utilsService=r}canvas;messageError$=new w(null);load$=new w(null);id;maxAnnee=new Date().getFullYear();timbreModel=new S;fileUploadModel=new Oe;ngOnInit(){this.initUpload(),this.load$.next(!1),c(this.id)?this.timbreService.getTimbreByIdAsync(this.id).subscribe(e=>{this.timbreModel=e,c(e.getTimbreBlocModel())&&(this.timbreModel.setAnnee(e.getTimbreBlocModel().getAnnee()),this.timbreModel.setMonnaie(e.getTimbreBlocModel().getMonnaie())),this.load$.next(!0)}):(this.timbreModel.setAnnee(new Date().getFullYear()),this.timbreModel.setMonnaie("E"),this.load$.next(!0)),this.changeAnnee(this.timbreModel.getAnnee())}initUpload(){this.fileUploadModel.setDossier("test"),this.fileUploadModel.setNom(new Date().getTime()?.toString());let e=new pe;e.setMaxWidth(this.timbreService.widthTimbre),e.setMaxHeight(this.timbreService.heightTimbre),e.setDossier("autre");let t=new pe;t.setMaxWidth(this.timbreService.widthTimbreZoom),t.setMaxHeight(this.timbreService.heightTimbreZoom),t.setDossier("zoom"),this.fileUploadModel.setDetail([e,t])}valider(e){if(this.messageError$.next(null),e?.valid)if(c(this.timbreModel.getImage()))this.saveData();else{this.messageError$.next("Veuillez s\xE9lectionner une image");return}}saveData(){this.load$.next(!1),c(this.timbreModel.getId())?this.save():this.ajouter()}ajouter(){this.utilsService.getMaxIdentAsync("/timbres").pipe(M()).subscribe(e=>{this.timbreModel.setId(e),this.save(!0)})}save(e){try{k([this.timbreService.upload(this.timbreModel,"autre"),this.timbreService.upload(this.timbreModel,"table"),this.timbreService.upload(this.timbreModel,"zoom")]).pipe(M(([t,i,n])=>c(t)&&c(n)&&c(i))).subscribe(([t,i,n])=>{c(i)&&i!="nok"&&this.timbreModel.setImage(i),c(t)&&t!="nok"&&this.timbreModel.setImageTable(t),c(n)&&n!="nok"&&this.timbreModel.setImageZoom(n),e?this.timbreService.ajouter(this.timbreModel,!0):this.timbreService.modifier(this.timbreModel),this.httpResponseHandlerService.showNotificationSuccess("Transaction termin\xE9e","Votre timbre a bien \xE9t\xE9 modifi\xE9e."),this.load$.next(!0),this.dialogRef.close()})}catch{this.httpResponseHandlerService.showNotificationError("Transaction non aboutie","Votre timbre n'a pas pu \xEAtre modifi\xE9."),this.load$.next(!0)}}close(){this.dialogRef.close()}changeAnnee(e){if(this.timbreModel.setTimbreBlocModel(null),c(e)){let t=new $;t.setAnnees([e]),this.timbreBlocService.getBlocs(t)}}changeBloc(e){c(e)?(this.timbreModel.setIdBloc(e.getId()),this.timbreModel.setTimbreBlocModel(e),this.timbreModel.setMonnaie(e.getMonnaie())):(this.timbreModel.setIdBloc(null),this.timbreModel.setTimbreBlocModel(null),this.timbreModel.setMonnaie("E"))}static \u0275fac=function(t){return new(t||o)(y(nt),y(Ae),y(W),y(ie),y(P))};static \u0275cmp=G({type:o,selectors:[["app-timbre-modifier"]],viewQuery:function(t,i){if(t&1&&ue(Bi,5),t&2){let n;de(n=be())&&(i.canvas=n.first)}},decls:9,vars:6,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],["class","accent",4,"ngIf"],[3,"ngIf","ngIfElse"],[1,"accent"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","space-between stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","column","fxLayoutGap","20px",1,"bloc-modal"],[3,"innerHTML",4,"ngIf"],["fxLayout","row","fxLayout.lt-lg","column","fxLayoutGap","30px","fxLayoutGap.lt-lg","5px"],["fxLayout","column",1,"form-input"],[3,"object","key"],["name","page","type","number","minlength","4","maxlength","4","min","1900","zMin","1900","required","","zControl","",1,"annee",2,"width","60px !important",3,"ngModelChange","ngModel","max","zMax","disabled"],["fxLayout","column",1,"form-input","select"],["fxLayout","row","fxLayoutGap","15px"],["name","bloc",2,"width","120px !important",3,"ngModelChange","ngModel","placeholder","disabled"],[1,"selectMin",3,"value"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],["style","max-height: 40px","class","click",3,"src","click",4,"ngIf"],["name","type","type","text","trim","","zControl","",3,"ngModelChange","ngModel"],["name","monnaie","type","text","trim","","minlength","1","maxlength","2","required","","zControl","",2,"width","25px !important",3,"ngModelChange","ngModel","disabled"],["name","yt","type","text","trim","","zControl","",3,"ngModelChange","ngModel"],["fxHide.lt-lg","","fxLayout","column",1,"form-input"],[3,"outPutObject","object","key","zoom","maxWidth","maxHeight"],["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"],[3,"innerHTML"],[1,"click",2,"max-height","40px",3,"click","src"]],template:function(t,i){if(t&1&&(a(0,"div",2)(1,"div",3)(2,"span"),g(3),s(),f(4,Ii,3,1,"span",4),s(),f(5,wi,1,1,"ng-template",5),v(6,"async"),f(7,Li,41,37,"ng-template",null,0,Q),s()),t&2){let n=R(8);m(3),F("",i.timbreModel!=null&&i.timbreModel.getId()?"MODIFICATION":"AJOUT"," "),m(),l("ngIf",i.timbreModel==null?null:i.timbreModel.getId()),m(),l("ngIf",C(6,4,i.load$)==!1)("ngIfElse",n)}},dependencies:[te,we,Ke,Ye,_e,Te,Y,J,ee,me,le,re,$e,ve,Ie,Pe,He,Ce,ye,Ze,Ge,Qe,ze,We,Be,Se,ae,Ee,tt,ot,rt,lt,mt,X],encapsulation:2})};var ci=St(fi());var Ri=()=>[10,20,50,100];function Ui(o,e){if(o&1&&(a(0,"mat-option",32),g(1),s()),o&2){let t=e.$implicit;l("value",t),m(),F(" ",t," ")}}function qi(o,e){if(o&1){let t=I();L(0),a(1,"div",30)(2,"mat-select",31),V("ngModelChange",function(n){d(t);let r=p();return j(r.timbreCritereModel.acquis,n)||(r.timbreCritereModel.acquis=n),b(n)}),x("ngModelChange",function(){d(t);let n=p();return b(n.filtreByCritere())}),a(3,"mat-option",32),g(4," Oui"),s(),a(5,"mat-option",32),g(6," Non"),s(),a(7,"mat-option",32),g(8," Tous"),s()()(),a(9,"div",30)(10,"mat-select",33),V("ngModelChange",function(n){d(t);let r=p();return j(r.timbreCritereModel.doublon,n)||(r.timbreCritereModel.doublon=n),b(n)}),x("ngModelChange",function(){d(t);let n=p();return b(n.filtreByCritere())}),a(11,"mat-option",32),g(12," Oui"),s(),a(13,"mat-option",32),g(14," Non"),s(),a(15,"mat-option",32),g(16," Tous"),s()()(),a(17,"div",30)(18,"mat-select",34),V("ngModelChange",function(n){d(t);let r=p();return j(r.timbreCritereModel.bloc,n)||(r.timbreCritereModel.bloc=n),b(n)}),x("ngModelChange",function(){d(t);let n=p();return b(n.filtreByCritere())}),a(19,"mat-option",32),g(20," Oui"),s(),a(21,"mat-option",32),g(22," Non"),s(),a(23,"mat-option",32),g(24," Tous"),s()()(),a(25,"div",35)(26,"mat-select",36),V("ngModelChange",function(n){d(t);let r=p();return j(r.timbreCritereModel.annees,n)||(r.timbreCritereModel.annees=n),b(n)}),x("ngModelChange",function(){d(t);let n=p();return b(n.filtreByCritere())}),f(27,Ui,2,2,"mat-option",37),v(28,"async"),s()(),a(29,"div",38)(30,"input",39),x("input",function(n){d(t);let r=p();return b(r.applyFilter(n))}),s()(),a(31,"lib-icon",40),x("click",function(){d(t);let n=p();return b(n.exportTable())}),s(),O()}if(o&2){let t=p();m(2),N("ngModel",t.timbreCritereModel.acquis),l("placeholder","Acquis"),m(),l("value","OUI"),m(2),l("value","NON"),m(2),l("value","TOUS"),m(3),N("ngModel",t.timbreCritereModel.doublon),l("placeholder","Doublon"),m(),l("value","OUI"),m(2),l("value","NON"),m(2),l("value","TOUS"),m(3),N("ngModel",t.timbreCritereModel.bloc),l("placeholder","Bloc"),m(),l("value","OUI"),m(2),l("value","NON"),m(2),l("value","TOUS"),m(3),N("ngModel",t.timbreCritereModel.annees),l("placeholder","Ann\xE9es"),m(),l("ngForOf",C(28,21,t.annees$)),m(4),l("type",t.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",t.FontAwesomeEnum.FILE_EXEL)("info","Exporter tableau")}}function Fi(o,e){if(o&1&&(a(0,"th",41),T(1,"lib-libelle-model",42),s()),o&2){let t=p();m(),l("object",t.timbre)("key","image")}}function Ni(o,e){if(o&1){let t=I();a(0,"img",45),x("click",function(){d(t);let n=p().$implicit,r=p();return b(r.utilsService.zoom(n==null?null:n.getImageZoom()))}),s()}if(o&2){let t=p().$implicit;l("src",t==null?null:t.getImageTable(),qe)}}function ji(o,e){if(o&1&&(a(0,"td",43),f(1,Ni,1,1,"img",44),s()),o&2){let t=e.$implicit;m(),l("ngIf",t==null?null:t.getImageTable())}}function Vi(o,e){if(o&1&&(a(0,"th",46),T(1,"lib-libelle-model",47),s()),o&2){let t=p();m(),l("object",t.timbre)("key","id")}}function ki(o,e){if(o&1&&(a(0,"td",48),g(1),s()),o&2){let t=e.$implicit;m(),F(" ",t==null?null:t.getId()," ")}}function $i(o,e){if(o&1&&(a(0,"th",46),T(1,"lib-libelle-model",47),s()),o&2){let t=p();m(),l("object",t.timbre)("key","annee")}}function Pi(o,e){if(o&1&&g(0),o&2){let t,i=p().$implicit;F(" ",i==null||(t=i.getTimbreBlocModel())==null?null:t.getAnnee()," ")}}function Hi(o,e){if(o&1&&g(0),o&2){let t=p().$implicit;F(" ",t==null?null:t.getAnnee()," ")}}function Wi(o,e){if(o&1&&(a(0,"td",48),f(1,Pi,1,1,"ng-template",49)(2,Hi,1,1,"ng-template",null,0,Q),s()),o&2){let t=e.$implicit,i=R(3);m(),l("ngIf",t==null?null:t.getIdBloc())("ngIfElse",i)}}function zi(o,e){if(o&1&&(a(0,"th",50),T(1,"lib-libelle-model",47),s()),o&2){let t=p();m(),l("object",t.timbre)("key","idBloc")}}function Zi(o,e){if(o&1){let t=I();a(0,"img",45),x("click",function(){let n;d(t);let r=p(2).$implicit,u=p();return b(u.utilsService.zoom(r==null||(n=r.getTimbreBlocModel())==null?null:n.getImageZoom()))}),s()}if(o&2){let t,i=p(2).$implicit;l("src",i==null||(t=i.getTimbreBlocModel())==null?null:t.getImageTable(),qe)}}function Gi(o,e){if(o&1&&f(0,Zi,1,1,"img",44),o&2){let t,i=p().$implicit;l("ngIf",i==null||(t=i.getTimbreBlocModel())==null?null:t.getImage())}}function Qi(o,e){o&1&&g(0," Non ")}function Yi(o,e){if(o&1&&(a(0,"td",48),f(1,Gi,1,1,"ng-template",49)(2,Qi,1,0,"ng-template",null,0,Q),s()),o&2){let t=e.$implicit,i=R(3);m(),l("ngIf",t==null?null:t.getIdBloc())("ngIfElse",i)}}function Xi(o,e){if(o&1&&(a(0,"th",51),T(1,"lib-libelle-model",47),s()),o&2){let t=p();m(),l("object",t.timbre)("key","monnaie")}}function Ki(o,e){if(o&1&&g(0),o&2){let t,i=p().$implicit;F(" ",(i==null||(t=i.getTimbreBlocModel())==null?null:t.getMonnaie())=="E"?"\u20AC":"Francs"," ")}}function Ji(o,e){if(o&1&&g(0),o&2){let t=p().$implicit;F(" ",(t==null?null:t.getMonnaie())=="E"?"\u20AC":"Francs"," ")}}function en(o,e){if(o&1&&(a(0,"td",52),f(1,Ki,1,1,"ng-template",49)(2,Ji,1,1,"ng-template",null,0,Q),s()),o&2){let t=e.$implicit,i=R(3);m(),l("ngIf",t==null?null:t.getIdBloc())("ngIfElse",i)}}function tn(o,e){if(o&1&&(a(0,"th",51),T(1,"lib-libelle-model",47),s()),o&2){let t=p();m(),l("object",t.timbre)("key","type")}}function nn(o,e){if(o&1&&(a(0,"td",52),g(1),s()),o&2){let t=e.$implicit;m(),F(" ",t==null?null:t.getType()," ")}}function on(o,e){if(o&1&&(a(0,"th",51),T(1,"lib-libelle-model",47),s()),o&2){let t=p();m(),l("object",t.timbre)("key","yt")}}function rn(o,e){if(o&1&&(a(0,"td",52),g(1),s()),o&2){let t=e.$implicit;m(),F(" ",t==null?null:t.getYt()," ")}}function ln(o,e){if(o&1&&(a(0,"th",46),T(1,"lib-libelle-model",47),s()),o&2){let t=p();m(),l("object",t.timbre==null?null:t.timbre.getTimbreAcquisModel())("key","acquis")}}function mn(o,e){if(o&1){let t=I();a(0,"td",43)(1,"lib-icon",53),x("click",function(){let n=d(t).$implicit,r=p();return b(r.acquis(n))}),s()()}if(o&2){let t,i,n,r=e.$implicit,u=p();m(),l("classIcone",!(r==null||(t=r.getTimbreAcquisModel())==null)&&t.isAcquis()?"accent":"primary")("type",u.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",!(r==null||(i=r.getTimbreAcquisModel())==null)&&i.isAcquis()?u.FontAwesomeEnum.CIRCLE_MINUS:u.FontAwesomeEnum.CIRCLE_PLUS)("info",!(r==null||(n=r.getTimbreAcquisModel())==null)&&n.isAcquis()?"pas acquis":"acquis")}}function an(o,e){if(o&1&&(a(0,"th",46),T(1,"lib-libelle-model",47),s()),o&2){let t=p();m(),l("object",t.timbre==null?null:t.timbre.getTimbreAcquisModel())("key","doublon")}}function sn(o,e){if(o&1){let t=I();a(0,"td",43)(1,"lib-icon",53),x("click",function(){let n=d(t).$implicit,r=p();return b(r.doublon(n))}),s()()}if(o&2){let t,i,n,r=e.$implicit,u=p();m(),l("classIcone",!(r==null||(t=r.getTimbreAcquisModel())==null)&&t.isDoublon()?"accent":"primary")("type",u.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",!(r==null||(i=r.getTimbreAcquisModel())==null)&&i.isDoublon()?u.FontAwesomeEnum.CIRCLE_MINUS:u.FontAwesomeEnum.CIRCLE_PLUS)("info",!(r==null||(n=r.getTimbreAcquisModel())==null)&&n.isDoublon()?"pas en double":"en double")}}function cn(o,e){if(o&1&&(a(0,"th",54),T(1,"lib-icon",55),s()),o&2){let t=p();m(),l("type",t.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",t.FontAwesomeEnum.PENCIL)("info","Modifier")}}function pn(o,e){if(o&1){let t=I();a(0,"td",43)(1,"lib-icon",56),x("click",function(){let n=d(t).$implicit,r=p();return b(r.modifier(n))}),s()()}if(o&2){let t=p();m(),l("type",t.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",t.FontAwesomeEnum.PENCIL)("info","Modifier")}}function un(o,e){if(o&1&&(a(0,"th",54),T(1,"lib-icon",55),s()),o&2){let t=p();m(),l("type",t.FontAwesomeTypeEnum.TYPE_SOLID)("icone",t.FontAwesomeEnum.TRASH)("info","Supprimer")}}function dn(o,e){if(o&1){let t=I();a(0,"td",43)(1,"lib-icon",56),x("click",function(){let n=d(t).$implicit,r=p();return b(r.supprimer(n))}),s()()}if(o&2){let t=p();m(),l("type",t.FontAwesomeTypeEnum.TYPE_SOLID)("icone",t.FontAwesomeEnum.TRASH)("info","Supprimer")}}function bn(o,e){o&1&&T(0,"tr",57)}function fn(o,e){o&1&&T(0,"tr",58)}var gt=class o{constructor(e,t,i,n){this.timbreService=e;this.timbreUtilsService=t;this.dialog=i;this.utilsService=n;this.dataSource=new Tt([])}paginator;sort;timbres$;total$;modif=!0;load$=new w(!1);dataSource=new Tt;displayedColumns;timbreCritereModel=new $;timbre=new S;annees$;FontAwesomeEnum=ke;FontAwesomeTypeEnum=Ve;ngOnInit(){this.annees$=this.timbreUtilsService.getAnneesAsync("/timbres"),this.timbre.setTimbreAcquisModel(new q),this.displayedColumns=["image","id","annee","idBloc","monnaie","type","yt","acquis","doublon"],this.modif&&this.displayedColumns.push("modifier","supprimer"),this.load$.next(!1),this.timbres$.subscribe(e=>{this.dataSource.data=e,this.load$.next(!0)})}ngAfterViewInit(){this.dataSource.paginator=this.paginator}sortData(e){c(e)&&(console.log(e),this.dataSource.sort=this.sort)}filtreByCritere(){this.timbreCritereModel.getAcquis()=="NON"&&this.timbreCritereModel.setDoublon("TOUS"),this.timbreService.getTimbres(this.timbreCritereModel)}applyFilter(e){let t=e.target.value;this.dataSource.filter=t.trim().toLowerCase()}acquis(e){this.timbreService.acquis(e,!1)}doublon(e){this.timbreService.acquis(e,!0)}modifier(e){let t=this.dialog.open(Re,{height:"75vh",maxHeight:"750px",width:"30%"});t.componentInstance.id=e.getId(),t.afterClosed().subscribe(()=>{t.close()})}supprimer(e){let t=this.dialog.open(ni,{maxHeight:"95vh",data:{titre:"Confirmation",message:"Souhaitez-vous supprimer le timbre <b>n\xB0 "+e?.getId()+"</b> ?",btnDroite:"Oui",btnGauche:"Non"}});t.afterClosed().subscribe(()=>{t.componentInstance.data.resultat==="valider"&&this.timbreService.supprimer(e)})}exportTable(){let e=at.json_to_sheet(this.dataSource.data),t=at.book_new();at.book_append_sheet(t,e,"Donn\xE9es");let i=ii(t,{bookType:"xlsx",type:"array"}),n=new Blob([i],{type:"application/octet-stream"});(0,ci.saveAs)(n,"export_timbres.xlsx")}generatePDFByImage(){let e="https://firebasestorage.googleapis.com/v0/b/book-f941b.appspot.com/o/AF.png?alt=media&token=a1039f78-3cff-41ab-8569-ea1b2cefe2c1";this.generatePDF(null)}generatePDF(e){}static \u0275fac=function(t){return new(t||o)(y(W),y(se),y(Xe),y(P))};static \u0275cmp=G({type:o,selectors:[["app-timbre-resultat"]],viewQuery:function(t,i){if(t&1&&(ue(Je,5),ue(et,5)),t&2){let n;de(n=be())&&(i.paginator=n.first),de(n=be())&&(i.sort=n.first)}},inputs:{timbres$:"timbres$",total$:"total$",modif:"modif"},decls:50,vars:19,consts:[["noBloc",""],["fxFlexFill","",3,"fxHide","textSpec"],[3,"fxHide"],["fxLayout","row","fxLayoutAlign","space-between center","fxLayoutGap","15px",2,"height","50px"],["fxFlex","",2,"font-size","1.2em"],[1,"bold"],[4,"ngIf"],["id","pdf-content","mat-table","","matSort","",3,"matSortChange","dataSource"],["matColumnDef","image"],["mat-header-cell","","class","image",4,"matHeaderCellDef"],["mat-cell","","class","alignCenter",4,"matCellDef"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","annee"],["matColumnDef","idBloc"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","monnaie"],["mat-header-cell","","mat-sort-header","","class","hide-on-mobile",4,"matHeaderCellDef"],["mat-cell","","class","hide-on-mobile",4,"matCellDef"],["matColumnDef","type"],["matColumnDef","yt"],["matColumnDef","acquis"],["matColumnDef","doublon"],["matColumnDef","modifier"],["mat-header-cell","","class","alignCenter",4,"matHeaderCellDef"],["matColumnDef","supprimer"],["mat-header-row","","class","bg-primary color-white",4,"matHeaderRowDef"],["mat-row","","class","mat-row",4,"matRowDef","matRowDefColumns"],[3,"pageSize","pageSizeOptions"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input","select",2,"width","100px"],["name","acquis",3,"ngModelChange","ngModel","placeholder"],[1,"selectMin",3,"value"],["name","doublon",1,"scrollBarAccent",3,"ngModelChange","ngModel","placeholder"],["name","bloc",1,"scrollBarAccent",3,"ngModelChange","ngModel","placeholder"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input","select",2,"width","150px"],["name","anneeSelect","multiple","",3,"ngModelChange","ngModel","placeholder"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input",2,"width","200px","min-height","55px","height","55px"],["placeholder","Filtrer les donn\xE9es","type","text",3,"input"],[1,"primary","click",2,"font-size","1.7em",3,"click","type","icone","info"],["mat-header-cell","",1,"image"],[1,"hide-on-mobile",3,"object","key"],["mat-cell","",1,"alignCenter"],["class","image click",3,"src","click",4,"ngIf"],[1,"image","click",3,"click","src"],["mat-header-cell","","mat-sort-header",""],[3,"object","key"],["mat-cell",""],[3,"ngIf","ngIfElse"],["mat-header-cell",""],["mat-header-cell","","mat-sort-header","",1,"hide-on-mobile"],["mat-cell","",1,"hide-on-mobile"],[1,"click",2,"font-size","1.2em",3,"click","classIcone","type","icone","info"],["mat-header-cell","",1,"alignCenter"],[2,"font-size","1.2em",3,"type","icone","info"],[1,"primary","click",2,"font-size","1.2em",3,"click","type","icone","info"],["mat-header-row","",1,"bg-primary","color-white"],["mat-row","",1,"mat-row"]],template:function(t,i){t&1&&(T(0,"lib-spinner",1),v(1,"async"),a(2,"section",2),v(3,"async"),a(4,"div",3)(5,"div",4)(6,"span"),g(7,"Nombre de timbres : "),s(),a(8,"span",5),g(9),v(10,"async"),v(11,"async"),s()(),f(12,qi,32,23,"ng-container",6),s(),a(13,"table",7),x("matSortChange",function(r){return i.sortData(r)}),L(14,8),f(15,Fi,2,2,"th",9)(16,ji,2,1,"td",10),O(),L(17,11),f(18,Vi,2,2,"th",12)(19,ki,2,1,"td",13),O(),L(20,14),f(21,$i,2,2,"th",12)(22,Wi,4,2,"td",13),O(),L(23,15),f(24,zi,2,2,"th",16)(25,Yi,4,2,"td",13),O(),L(26,17),f(27,Xi,2,2,"th",18)(28,en,4,2,"td",19),O(),L(29,20),f(30,tn,2,2,"th",18)(31,nn,2,1,"td",19),O(),L(32,21),f(33,on,2,2,"th",18)(34,rn,2,1,"td",19),O(),L(35,22),f(36,ln,2,2,"th",12)(37,mn,2,4,"td",10),O(),L(38,23),f(39,an,2,2,"th",12)(40,sn,2,4,"td",10),O(),L(41,24),f(42,cn,2,3,"th",25)(43,pn,2,3,"td",10),O(),L(44,26),f(45,un,2,3,"th",25)(46,dn,2,3,"td",10),O(),f(47,bn,1,0,"tr",27)(48,fn,1,0,"tr",28),s(),T(49,"mat-paginator",29),s()),t&2&&(l("fxHide",C(1,10,i.load$)==!0)("textSpec","Chargement en cours ..."),m(2),l("fxHide",C(3,12,i.load$)==!1),m(7),je(C(10,14,i.total$)?C(11,16,i.total$):i.dataSource==null||i.dataSource.data==null?null:i.dataSource.data.length),m(3),l("ngIf",i.modif),m(),l("dataSource",i.dataSource),m(34),l("matHeaderRowDef",i.displayedColumns),m(),l("matRowDefColumns",i.displayedColumns),m(),l("pageSize",15)("pageSizeOptions",Et(18,Ri)))},dependencies:[Ke,Ye,Ht,zt,Yt,Zt,Wt,Xt,Gt,Qt,Kt,Jt,Je,et,Pt,Te,Y,J,ee,me,le,re,$e,Ce,Be,ae,it,Ee,X],styles:[".mat-row[_ngcontent-%COMP%]{height:35px}.image[_ngcontent-%COMP%]{max-height:30px!important}.mat-column-acquis[_ngcontent-%COMP%], .mat-column-doublon[_ngcontent-%COMP%]{width:60px!important;max-width:60px!important;padding:0!important}.mat-column-ajouter[_ngcontent-%COMP%], .mat-column-modifier[_ngcontent-%COMP%], .mat-column-supprimer[_ngcontent-%COMP%]{width:35px!important;max-width:35px!important;padding:0!important}@media screen and (max-width: 800px){.mat-row[_ngcontent-%COMP%]{height:25px}.image[_ngcontent-%COMP%]{max-height:20px!important}.mat-column-acquis[_ngcontent-%COMP%], .mat-column-doublon[_ngcontent-%COMP%]{width:50px!important;max-width:50px!important;padding:0!important}.mat-column-ajouter[_ngcontent-%COMP%], .mat-column-modifier[_ngcontent-%COMP%], .mat-column-supprimer[_ngcontent-%COMP%]{width:20px!important;max-width:20px!important;padding:0!important}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:0 5px!important}th[_ngcontent-%COMP%], .mat-row[_ngcontent-%COMP%]{font-size:.8em}.mat-column-libelle[_ngcontent-%COMP%],   .mat-column-libelle .mat-sort-header-container{width:40px!important;max-width:40px!important}.mat-column-drapeau[_ngcontent-%COMP%],   .mat-column-drapeau span{width:15px!important;max-width:15px!important}.mat-column-classeur[_ngcontent-%COMP%],   .mat-column-classeur .mat-sort-header-container, .mat-column-page[_ngcontent-%COMP%],   .mat-column-page .mat-sort-header-container{width:15px!important;max-width:15px!important}.mat-column-total[_ngcontent-%COMP%],   .mat-column-total .mat-sort-header-container{width:25px!important;max-width:25px!important}.hide-on-mobile[_ngcontent-%COMP%]{display:none}}"]})};function hn(o,e){if(o&1&&(T(0,"lib-spinner",5),v(1,"async")),o&2){let t=p();l("textSpec",C(1,1,t.messageLoad$))}}function _n(o,e){if(o&1&&(T(0,"mat-error",15),v(1,"async")),o&2){let t=p(2);l("innerHTML",C(1,1,t.messageError$),he)}}function Tn(o,e){if(o&1&&T(0,"app-timbre-resultat",16),o&2){let t=p(2);l("timbres$",t.timbres$)("modif",!1)}}function xn(o,e){o&1&&(a(0,"button",17),g(1," Enregistrer "),s())}function Mn(o,e){if(o&1){let t=I();a(0,"form",6,1),x("ngSubmit",function(){d(t);let n=R(1),r=p();return b(r.valider(n))}),a(2,"div",7),f(3,_n,2,3,"mat-error",8),v(4,"async"),f(5,Tn,1,2,"app-timbre-resultat",9),v(6,"async"),s(),a(7,"div",10)(8,"button",11),x("click",function(){d(t);let n=p();return b(n.close())}),g(9," Annuler "),s(),a(10,"input",12),x("change",function(n){d(t);let r=p();return b(r.onFileChange(n))}),s(),a(11,"button",13),x("click",function(){d(t);let n=p();return b(n.triggerFileInput())}),g(12," Choisir un fichier "),s(),f(13,xn,2,0,"button",14),v(14,"async"),s()()}if(o&2){let t,i,n=R(1),r=p();l("ngClass",n!=null&&n.submitted?"red-color":"blue-color"),m(3),l("ngIf",C(4,5,r.messageError$)),m(2),l("ngIf",((t=C(6,7,r.timbres$))==null?null:t.length)>0),m(5),wt("id",r.idFile),m(3),l("ngIf",((i=C(14,9,r.timbres$))==null?null:i.length)>0)}}var ht=class o{constructor(e,t,i,n,r,u){this.authService=e;this.timbreService=t;this.timbreBlocService=i;this.uploadService=n;this.utilsService=r;this.dialogRef=u}dossier="/assets/images/timbres/";timbres$=new w(null);messageError$=new w(null);messageLoad$=new w("Chargement en cours ...");load$=new w(null);idFile="fileImport";identTimbre=1;identBloc=1;timbresModel=[];timbresBlocsModel=[];triggerFileInput(){document.getElementById(this.idFile).click()}onFileChange(e){let t=e.target.files[0];t&&(this.load$.next(!1),this.messageLoad$.next("Chargement en cours ..."),this.saveCsv(t))}saveCsv(e){let t=new FileReader;t.onload=()=>{let i=t.result;this.parseCsv(i)},t.readAsText(e)}parseCsv(e){k([this.utilsService.getMaxIdentAsync("/timbres"),this.utilsService.getMaxIdentAsync("/timbres_bloc"),this.authService.getUser()]).pipe(M(([t,i,n])=>c(n))).subscribe(([t,i,n])=>{c(t)&&t>1&&(this.identTimbre=t+1),c(i)&&i>1&&(this.identBloc=i+1),this.timbresModel=[],this.timbres$.next(null),pi.parse(e,{header:!0,skipEmptyLines:!0,complete:r=>{c(r.data)&&r.data?.length>0&&(this.timbresBlocsModel=[],r.data.forEach((u,B)=>{this.timbresModel.push(this.setTimbre(u,n)),this.identTimbre++,B==r.data.length-1&&(this.timbres$.next(this.timbresModel),this.load$.next(!0))}))},error:r=>{console.error("Erreur lors du parsing du CSV :",r)}})})}setTimbre(e,t){let i=new S,n=e.CODE!="NULL"&&e.CODE!=""?Number(e.CODE):null,r=e.IDENT_BLOC!="NULL"&&e.IDENT_BLOC!=""?Number(e.IDENT_BLOC):null,u=e.ANNEE!="NULL"&&e.ANNEE!=""?Number(e.ANNEE):null,B=e.MONNAIE!="NULL"&&e.MONNAIE!=""?e.MONNAIE:null;i.setId(this.identTimbre),i.setType(e.TYPE!="NULL"&&e.TYPE!=""?e.TYPE:null),i.setYt(e.YT!="NULL"&&e.YT!=""?e.YT:null);let D=new q;D.setIdTimbre(i.getId()),D.setIdUser(t.getId()),D.setAcquis(e.ACQUIS=="1"),D.setDoublon(e.DOUBLON=="1"),i.setTimbreAcquisModel(D);let z=this.dossier+u+"/",ne="";if(c(r)){if(z+="bloc/"+r,ne=z+".png",z+="-",i.setTimbreBlocModel(this.timbresBlocsModel.find(A=>A.getAnnee()==u&&A.idOrigine==r)),oe(i.getTimbreBlocModel())){let A=new E;A.setId(this.identBloc),A.setAnnee(u),A.setMonnaie(B),A.idOrigine=r;let Ue=new H;Ue.setIdBloc(this.identBloc),Ue.setIdUser(t.getId()),Ue.setAcquis(e.ACQUIS_BLOC=="1"),Ue.setDoublon(e.DOUBLON_BLOC=="1"),A.setTimbreBlocAcquisModel(Ue),this.uploadService.checkIfImageExists(ne).pipe(M()).subscribe(di=>{di&&(A.setImage(ne),A.setImageTable(ne),A.setImageZoom(ne))}),this.timbresBlocsModel.push(A),i.setTimbreBlocModel(A),this.identBloc++}i.setIdBloc(i.getTimbreBlocModel()?.getId())}else i.setAnnee(u),i.setMonnaie(B);return z+=n+".png",this.uploadService.checkIfImageExists(z).pipe(M()).subscribe(A=>{A&&(i.setImage(z),i.setImageTable(z),i.setImageZoom(z))}),i}valider(e){this.messageError$.next(null),e?.valid&&(this.load$.next(!1),this.messageLoad$.next("Import en cours ..."),c(this.timbresBlocsModel)&&this.timbresBlocsModel?.length>0&&this.timbresBlocsModel.forEach((t,i)=>{this.saveBloc(t)}),this.timbres$.pipe(M()).subscribe(t=>{if(c(t)&&t?.length>0)t.forEach((i,n)=>{this.saveTimbre(i,n==t.length-1)});else{this.messageError$.next("Donn\xE9es incorrectes");return}}))}saveBloc(e){k([this.timbreBlocService.upload(e,"autre"),this.timbreBlocService.upload(e,"table"),this.timbreBlocService.upload(e,"zoom")]).pipe(M(([t,i,n])=>c(t)&&c(n)&&c(i))).subscribe(([t,i,n])=>{c(i)&&i!="nok"&&e.setImage(i),c(t)&&t!="nok"&&e.setImageTable(t),c(n)&&n!="nok"&&e.setImageZoom(n),e?.getTimbreBlocAcquisModel()?.isAcquis()&&this.timbreBlocService.addAcquis(e?.getTimbreBlocAcquisModel()?.getIdUser(),e,e?.getTimbreBlocAcquisModel()?.isDoublon()),this.timbreBlocService.ajouter(e,!1)})}saveTimbre(e,t){k([this.timbreService.upload(e,"autre"),this.timbreService.upload(e,"table"),this.timbreService.upload(e,"zoom")]).pipe(M(([i,n,r])=>c(i)&&c(r)&&c(n))).subscribe(([i,n,r])=>{c(n)&&n!="nok"&&e.setImage(n),c(i)&&i!="nok"&&e.setImageTable(i),c(r)&&r!="nok"&&e.setImageZoom(r),e?.getTimbreAcquisModel()?.isAcquis()&&this.timbreService.addAcquis(e?.getTimbreAcquisModel()?.getIdUser(),e,e?.getTimbreAcquisModel()?.isDoublon()),this.timbreService.ajouter(e,t),t&&(this.load$.next(!0),this.close())})}close(){this.dialogRef.close()}static \u0275fac=function(t){return new(t||o)(y(Me),y(W),y(ie),y(De),y(P),y(Ae))};static \u0275cmp=G({type:o,selectors:[["app-timbre-importer"]],decls:8,vars:4,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","start stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","column","fxLayoutGap","20px",1,"bloc-modal"],[3,"innerHTML",4,"ngIf"],[3,"timbres$","modif",4,"ngIf"],["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","file","accept",".xls, .xlsx, .csv","hidden","","required","",3,"change","id"],["type","button","mat-raised-button","","color","accent",1,"rounded","large","color-white",3,"click"],["type","submit","class","rounded large color-white","mat-raised-button","","color","accent",4,"ngIf"],[3,"innerHTML"],[3,"timbres$","modif"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"]],template:function(t,i){if(t&1&&(a(0,"div",2)(1,"div",3)(2,"span"),g(3,"TIMBRE IMPORTER"),s()(),f(4,hn,2,3,"ng-template",4),v(5,"async"),f(6,Mn,15,11,"ng-template",null,0,Q),s()),t&2){let n=R(7);m(4),l("ngIf",C(5,2,i.load$)==!1)("ngIfElse",n)}},dependencies:[te,we,_e,Y,J,ee,me,le,re,ve,Ie,ye,Se,ae,gt,X]})};var vn=["canvas"];function Cn(o,e){o&1&&T(0,"lib-spinner",5),o&2&&l("textSpec","Chargement en cours ...")}function yn(o,e){if(o&1&&(T(0,"mat-error",18),v(1,"async")),o&2){let t=p(2);l("innerHTML",C(1,1,t.messageError$),he)}}function Sn(o,e){if(o&1){let t=I();a(0,"div",10)(1,"label"),T(2,"lib-libelle-model",11),s(),a(3,"input",19),V("ngModelChange",function(n){d(t);let r=p(2);return j(r.timbreBlocModel.id,n)||(r.timbreBlocModel.id=n),b(n)}),s()()}if(o&2){let t=p(2);m(2),l("object",t.timbreBlocModel)("key","id"),m(),N("ngModel",t.timbreBlocModel.id),l("disabled",!!(t.timbreBlocModel!=null&&t.timbreBlocModel.getId()))}}function Bn(o,e){if(o&1){let t=I();a(0,"form",6,1),x("ngSubmit",function(){d(t);let n=R(1),r=p();return b(r.valider(n))}),a(2,"div",7),f(3,yn,2,3,"mat-error",8),v(4,"async"),f(5,Sn,4,4,"div",9),a(6,"div",10)(7,"label"),T(8,"lib-libelle-model",11),s(),a(9,"input",12),V("ngModelChange",function(n){d(t);let r=p();return j(r.timbreBlocModel.annee,n)||(r.timbreBlocModel.annee=n),b(n)}),s()(),a(10,"div",10)(11,"label"),T(12,"lib-libelle-model",11),s(),a(13,"input",13),V("ngModelChange",function(n){d(t);let r=p();return j(r.timbreBlocModel.monnaie,n)||(r.timbreBlocModel.monnaie=n),b(n)}),s()(),a(14,"lib-upload",14),x("outPutObject",function(n){d(t);let r=p();return b(r.timbreBlocModel=n)}),s()(),a(15,"div",15)(16,"button",16),x("click",function(){d(t);let n=p();return b(n.close())}),g(17," Annuler "),s(),a(18,"button",17),g(19," Enregistrer "),s()()()}if(o&2){let t=R(1),i=p();l("ngClass",t!=null&&t.submitted?"red-color":"blue-color"),m(3),l("ngIf",C(4,15,i.messageError$)),m(2),l("ngIf",i.timbreBlocModel==null?null:i.timbreBlocModel.getId()),m(3),l("object",i.timbreBlocModel)("key","annee"),m(),N("ngModel",i.timbreBlocModel.annee),l("max",i.maxAnnee)("zMax",i.maxAnnee),m(3),l("object",i.timbreBlocModel)("key","monnaie"),m(),N("ngModel",i.timbreBlocModel.monnaie),m(),l("object",i.timbreBlocModel)("key","image")("maxWidth",i.timbreBlocService.widthTimbre)("maxHeight",i.timbreBlocService.heightTimbre)}}var _t=class o{constructor(e,t,i,n){this.httpResponseHandlerService=e;this.dialogRef=t;this.utilsService=i;this.timbreBlocService=n}canvas;messageError$=new w(null);load$=new w(null);id;maxAnnee=new Date().getFullYear();timbreBlocModel=new E;fileUploadModel=new Oe;ngOnInit(){this.initUpload(),this.load$.next(!1),c(this.id)?this.timbreBlocService.getBlocByIdAsync(this.id).subscribe(e=>{this.timbreBlocModel=e,this.load$.next(!0)}):(this.timbreBlocModel.setAnnee(new Date().getFullYear()),this.timbreBlocModel.setMonnaie("E"),this.load$.next(!0))}initUpload(){this.fileUploadModel.setDossier("test"),this.fileUploadModel.setNom(new Date().getTime()?.toString());let e=new pe;e.setMaxWidth(this.timbreBlocService.widthTimbre),e.setMaxHeight(this.timbreBlocService.heightTimbre),e.setDossier("autre");let t=new pe;t.setMaxWidth(this.timbreBlocService.widthTimbreZoom),t.setMaxHeight(this.timbreBlocService.heightTimbreZoom),t.setDossier("zoom"),this.fileUploadModel.setDetail([e,t])}valider(e){if(this.messageError$.next(null),e?.valid)if(c(this.timbreBlocModel.getImage()))this.saveData();else{this.messageError$.next("Veuillez s\xE9lectionner une image");return}}saveData(){this.load$.next(!1),c(this.timbreBlocModel.getId())?this.save():this.ajouter()}ajouter(){this.utilsService.getMaxIdentAsync("/timbres_bloc").pipe(M()).subscribe(e=>{this.timbreBlocModel.setId(e),this.save(!0)})}save(e){try{k([this.timbreBlocService.upload(this.timbreBlocModel,"autre"),this.timbreBlocService.upload(this.timbreBlocModel,"table"),this.timbreBlocService.upload(this.timbreBlocModel,"zoom")]).pipe(M(([t,i,n])=>c(t)&&c(n)&&c(i))).subscribe(([t,i,n])=>{c(i)&&i!="nok"&&this.timbreBlocModel.setImage(i),c(t)&&t!="nok"&&this.timbreBlocModel.setImageTable(t),c(n)&&n!="nok"&&this.timbreBlocModel.setImageZoom(n),e?this.timbreBlocService.ajouter(this.timbreBlocModel,!0):this.timbreBlocService.modifier(this.timbreBlocModel),this.httpResponseHandlerService.showNotificationSuccess("Transaction termin\xE9e","Votre timbre a bien \xE9t\xE9 modifi\xE9e."),this.load$.next(!0),this.dialogRef.close()})}catch{this.httpResponseHandlerService.showNotificationError("Transaction non aboutie","Votre timbre n'a pas pu \xEAtre modifi\xE9."),this.load$.next(!0)}}close(){this.dialogRef.close()}static \u0275fac=function(t){return new(t||o)(y(nt),y(Ae),y(P),y(ie))};static \u0275cmp=G({type:o,selectors:[["app-timbre-modifier-bloc"]],viewQuery:function(t,i){if(t&1&&ue(vn,5),t&2){let n;de(n=be())&&(i.canvas=n.first)}},decls:10,vars:6,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","space-between stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","column","fxLayoutGap","20px",1,"bloc-modal"],[3,"innerHTML",4,"ngIf"],["fxLayout","column","class","form-input",4,"ngIf"],["fxLayout","column",1,"form-input"],[3,"object","key"],["name","page","type","number","minlength","4","maxlength","4","min","1900","zMin","1900","required","","zControl","",1,"annee",2,"width","60px !important",3,"ngModelChange","ngModel","max","zMax"],["name","monnaie","type","text","trim","","minlength","1","maxlength","2","required","","zControl","",2,"width","25px !important",3,"ngModelChange","ngModel"],[3,"outPutObject","object","key","maxWidth","maxHeight"],["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"],[3,"innerHTML"],["name","code","type","text","trim","","upperCase","","noEspace","","required","","zControl","",3,"ngModelChange","ngModel","disabled"]],template:function(t,i){if(t&1&&(a(0,"div",2)(1,"div",3)(2,"span"),g(3),s(),a(4,"span"),g(5),s()(),f(6,Cn,1,1,"ng-template",4),v(7,"async"),f(8,Bn,20,17,"ng-template",null,0,Q),s()),t&2){let n=R(9);m(3),F("",i.timbreBlocModel!=null&&i.timbreBlocModel.getId()?"MODIFICATION":"AJOUT"," BLOC "),m(2),je(i.timbreBlocModel==null?null:i.timbreBlocModel.getId()),m(),l("ngIf",C(7,4,i.load$)==!1)("ngIfElse",n)}},dependencies:[te,we,_e,Y,J,ee,me,le,re,ve,Ie,Pe,He,Ce,ye,Ze,Ge,Qe,ze,We,Be,Se,Ee,ae,Vt,tt,ot,rt,lt,ti,mt,X],encapsulation:2})};function In(o,e){if(o&1){let t=I();L(0),a(1,"lib-icon",6),x("click",function(){let n=d(t).$implicit,r=p(2);return b(r.headerService.setRoute(n.getRoute()))}),s(),O()}if(o&2){let t=e.$implicit;m(),l("icone",t==null?null:t.getIcone())("type",t==null?null:t.getType())("info",t==null?null:t.getInfo())("classInfo","tooltiptextDescription tooltiptextBgWhite widthAuto")}}function wn(o,e){if(o&1&&(L(0),f(1,In,2,4,"ng-container",5),v(2,"async"),O()),o&2){let t=p();m(),l("ngForOf",C(2,1,t.headerService.choixRoutesTimbre$))}}function An(o,e){if(o&1){let t=I();a(0,"button",3),x("click",function(){d(t);let n=p();return b(n.ajouter())}),g(1," Ajouter "),s()}}function En(o,e){o&1&&(L(0),g(1,"\xA0Bloc"),O())}function Dn(o,e){if(o&1){let t=I();a(0,"lib-icon",7),x("click",function(){d(t);let n=p();return b(n.importer())}),s()}if(o&2){let t=p();l("icone",t.FontAwesomeEnum.UPLOAD)("type",t.FontAwesomeTypeEnum.TYPE_SOLID)("info","Importer les timbres")("classInfo","tooltiptextDescription tooltiptextBgWhite widthAuto")}}var ui=class o{constructor(e,t,i){this.headerService=e;this.timbreService=t;this.dialog=i}FontAwesomeEnum=ke;ajouter(){let e=this.dialog.open(Re,{maxHeight:"95vh",width:"30%"});e.afterClosed().subscribe(()=>{e.close()})}ajouterBloc(){let e=this.dialog.open(_t,{maxHeight:"95vh",width:"30%"});e.afterClosed().subscribe(()=>{e.close()})}ajouterBouchon(){this.timbreService.ajouterSansId(this.timbreService.getBouchon())}importer(){let e=this.dialog.open(ht,{height:"90vh",width:"70%"});e.afterClosed().subscribe(()=>{e.close()})}RouteEnum=Lt;FontAwesomeTypeEnum=Ve;static \u0275fac=function(t){return new(t||o)(y(Ot),y(W),y(Xe))};static \u0275cmp=G({type:o,selectors:[["app-menu"]],decls:11,vars:12,consts:[["fxLayout","row","fxLayoutGap","20px"],[4,"ngIf"],["class","rounded large color-white","mat-raised-button","","color","primary",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["class","accent click","style","font-size: 2em",3,"icone","type","info","classInfo","click",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"primary","click",2,"font-size","2em",3,"click","icone","type","info","classInfo"],[1,"accent","click",2,"font-size","2em",3,"click","icone","type","info","classInfo"]],template:function(t,i){if(t&1&&(a(0,"div",0),f(1,wn,3,3,"ng-container",1),v(2,"async"),f(3,An,2,0,"button",2),v(4,"async"),a(5,"button",3),x("click",function(){return i.ajouterBloc()}),g(6," Ajouter "),f(7,En,2,0,"ng-container",1),v(8,"async"),s(),f(9,Dn,1,4,"lib-icon",4),v(10,"async"),s()),t&2){let n;m(),l("ngIf",((n=C(2,4,i.headerService.choixRoutesTimbre$))==null?null:n.length)>0),m(2),l("ngIf",C(4,6,i.headerService.route$)==i.RouteEnum.TIMBRE),m(4),l("ngIf",C(8,8,i.headerService.route$)==i.RouteEnum.TIMBRE),m(2),l("ngIf",C(10,10,i.headerService.route$)==i.RouteEnum.TIMBRE)}},dependencies:[Te,Y,J,ee,it,te,X],encapsulation:2})};export{$ as a,E as b,H as c,se as d,ie as e,W as f,_t as g,gt as h,ht as i,ui as j,mi as k};

import{a as ke,b as Ne,c as qe,d as j,e as v,g as Ue,l as Xe,m as Ge}from"./chunk-7KDDDZAQ.js";import{a as He,b as je,i as Ve,j as U,k as Ze,l as $e,m as We}from"./chunk-3FCJ5YWV.js";import{A as ze}from"./chunk-QT6IHMGS.js";import{e as Re,f as Ie,g as Fe,h as Pe}from"./chunk-Z7E3CHHZ.js";import"./chunk-HQOHRCUN.js";import{A as M,Ab as ce,Ac as Te,Ba as ie,Bb as N,Bc as xe,Ca as ne,Cb as pe,Db as se,Dc as Me,Ec as Se,Fa as oe,Ga as le,Gc as ve,Hb as de,Hc as Be,Ia as re,J as ee,Jc as we,K as a,Kb as ue,Kc as Ee,L as C,Mc as De,Nc as Q,Oc as Le,Pa as Y,Pc as Ae,Q as u,Qc as Oe,R as c,Sb as fe,Ub as be,W as o,X as r,Xb as _e,Y as d,Z as b,_,aa as S,ab as A,ba as f,c as Z,ca as p,ea as z,fa as W,ga as G,ia as s,ka as g,l as J,ma as B,mc as Ce,na as w,oa as E,pb as I,q as D,qb as O,ra as te,sb as ae,sc as ge,u as L,ua as h,ub as me,v as R,va as y,vc as q,wb as F,xb as P,xc as H,yb as k,yc as he,z as x,zc as ye}from"./chunk-3WA7KK2Z.js";import"./chunk-65CH3ZW6.js";import{g as Ke}from"./chunk-GV7GV3NK.js";var Ye=Ke(Ze());var it=()=>[10,20,50,100];function nt(t,n){if(t&1&&(o(0,"mat-option",7),s(1),r()),t&2){let e=n.$implicit;c("value",e),a(),g(" ",e," ")}}function ot(t,n){if(t&1&&(o(0,"th",38),d(1,"lib-libelle-model",39),r()),t&2){let e=p();a(),c("object",e.timbreBlocModel)("key","image")}}function lt(t,n){if(t&1){let e=S();o(0,"img",42),f("click",function(){x(e);let m=p().$implicit,l=p();return M(l.utilsService.zoom(m==null?null:m.getImageZoom()))}),r()}if(t&2){let e=p().$implicit;c("src",e==null?null:e.getImageTable(),ee)}}function rt(t,n){if(t&1&&(o(0,"td",40),u(1,lt,1,1,"img",41),r()),t&2){let e=n.$implicit;a(),c("ngIf",e==null?null:e.getImageTable())}}function at(t,n){if(t&1&&(o(0,"th",43),d(1,"lib-libelle-model",44),r()),t&2){let e=p();a(),c("object",e.timbreBlocModel)("key","id")}}function mt(t,n){if(t&1&&(o(0,"td",45),s(1),r()),t&2){let e=n.$implicit;a(),g(" ",e==null?null:e.getId()," ")}}function ct(t,n){if(t&1&&(o(0,"th",43),d(1,"lib-libelle-model",44),r()),t&2){let e=p();a(),c("object",e.timbreBlocModel)("key","annee")}}function pt(t,n){if(t&1&&(o(0,"td",45),s(1),r()),t&2){let e=n.$implicit;a(),g(" ",e==null?null:e.getAnnee()," ")}}function st(t,n){if(t&1&&(o(0,"th",46),d(1,"lib-libelle-model",47),r()),t&2){let e=p();a(),c("object",e.timbreBlocModel)("key","carnet")("align","center center")}}function dt(t,n){if(t&1){let e=S();o(0,"td",40)(1,"lib-icon",48),f("click",function(){let m=x(e).$implicit,l=p();return M(l.acquis(m))}),r()()}if(t&2){let e=n.$implicit,i=p();a(),c("type",i.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",e!=null&&e.isCarnet()?i.FontAwesomeEnum.CHECK:i.FontAwesomeEnum.XMARK)}}function ut(t,n){if(t&1&&(o(0,"th",49),d(1,"lib-libelle-model",44),r()),t&2){let e=p();a(),c("object",e.timbreBlocModel)("key","nbTimbres")}}function ft(t,n){if(t&1&&(o(0,"td",50),s(1),r()),t&2){let e=n.$implicit;a(),g(" ",e==null?null:e.getNbTimbres()," ")}}function bt(t,n){if(t&1&&(o(0,"th",49),d(1,"lib-libelle-model",44),r()),t&2){let e=p();a(),c("object",e.timbreBlocModel)("key","monnaie")}}function _t(t,n){if(t&1&&(o(0,"td",50),s(1),r()),t&2){let e=n.$implicit;a(),g(" ",(e==null?null:e.getMonnaie())=="E"?"\u20AC":"Francs"," ")}}function Ct(t,n){if(t&1&&(o(0,"th",46),d(1,"lib-libelle-model",47),r()),t&2){let e=p();a(),c("object",e.timbreBlocModel==null?null:e.timbreBlocModel.getTimbreBlocAcquisModel())("key","acquis")("align","center center")}}function gt(t,n){if(t&1){let e=S();o(0,"td",40)(1,"lib-icon",51),f("click",function(){let m=x(e).$implicit,l=p();return M(l.acquis(m))}),r()()}if(t&2){let e,i,m,l=n.$implicit,T=p();a(),c("classIcone",!(l==null||(e=l.getTimbreBlocAcquisModel())==null)&&e.isAcquis()?"accent":"primary")("type",T.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",!(l==null||(i=l.getTimbreBlocAcquisModel())==null)&&i.isAcquis()?T.FontAwesomeEnum.CIRCLE_MINUS:T.FontAwesomeEnum.CIRCLE_PLUS)("info",!(l==null||(m=l.getTimbreBlocAcquisModel())==null)&&m.isAcquis()?"pas acquis":"acquis")}}function ht(t,n){if(t&1&&(o(0,"th",46),d(1,"lib-libelle-model",47),r()),t&2){let e=p();a(),c("object",e.timbreBlocModel==null?null:e.timbreBlocModel.getTimbreBlocAcquisModel())("key","doublon")("align","center center")}}function yt(t,n){if(t&1){let e=S();o(0,"td",40)(1,"lib-icon",51),f("click",function(){let m=x(e).$implicit,l=p();return M(l.doublon(m))}),r()()}if(t&2){let e,i,m,l=n.$implicit,T=p();a(),c("classIcone",!(l==null||(e=l.getTimbreBlocAcquisModel())==null)&&e.isDoublon()?"accent":"primary")("type",T.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",!(l==null||(i=l.getTimbreBlocAcquisModel())==null)&&i.isDoublon()?T.FontAwesomeEnum.CIRCLE_MINUS:T.FontAwesomeEnum.CIRCLE_PLUS)("info",!(l==null||(m=l.getTimbreBlocAcquisModel())==null)&&m.isDoublon()?"pas en double":"en double")}}function Tt(t,n){if(t&1&&(o(0,"th",52),d(1,"lib-icon",53),r()),t&2){let e=p();a(),c("type",e.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",e.FontAwesomeEnum.PENCIL)("info","Modifier")}}function xt(t,n){if(t&1){let e=S();o(0,"td",40)(1,"lib-icon",54),f("click",function(){let m=x(e).$implicit,l=p();return M(l.modifier(m))}),r()()}if(t&2){let e=p();a(),c("type",e.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",e.FontAwesomeEnum.PENCIL)("info","Modifier")}}function Mt(t,n){if(t&1&&(o(0,"th",52),d(1,"lib-icon",53),r()),t&2){let e=p();a(),c("type",e.FontAwesomeTypeEnum.TYPE_SOLID)("icone",e.FontAwesomeEnum.TRASH)("info","Modifier")}}function St(t,n){if(t&1){let e=S();o(0,"td",40)(1,"lib-icon",54),f("click",function(){let m=x(e).$implicit,l=p();return M(l.supprimer(m))}),r()()}if(t&2){let e=p();a(),c("type",e.FontAwesomeTypeEnum.TYPE_SOLID)("icone",e.FontAwesomeEnum.TRASH)("info","Supprimer")}}function vt(t,n){t&1&&d(0,"tr",55)}function Bt(t,n){t&1&&d(0,"tr",56)}var V=class t{constructor(n,e,i,m){this.timbreBlocService=n;this.timbreUtilsService=e;this.dialog=i;this.utilsService=m;this.dataSource=new Q([])}paginator;sort;load$=new Z(!1);dataSource=new Q;displayedColumns;timbreCritereModel=new ke;timbreBlocModel=new Ne;annees$;modif=!0;FontAwesomeEnum=O;FontAwesomeTypeEnum=I;ngOnInit(){this.annees$=this.timbreUtilsService.getAnneesAsync("/timbres_bloc"),this.timbreBlocModel.setTimbreBlocAcquisModel(new qe),this.displayedColumns=["image","id","annee","carnet","monnaie","nbTimbres","acquis","doublon"],this.modif&&this.displayedColumns.push("modifier","supprimer"),this.load$.next(!1),this.timbreBlocService.timbresBlocModel$.subscribe(n=>{this.dataSource.data=n,this.load$.next(!0)})}ngAfterViewInit(){this.dataSource.paginator=this.paginator}sortData(n){A(n)&&(this.dataSource.sort=this.sort)}filtreByCritere(){this.timbreCritereModel.getAcquis()=="NON"&&this.timbreCritereModel.setDoublon("TOUS"),A(this.timbreCritereModel.getAnnees())&&this.timbreCritereModel.getAnnees().length>0&&this.timbreBlocService.getBlocs(this.timbreCritereModel)}applyFilter(n){let e=n.target.value;this.dataSource.filter=e.trim().toLowerCase()}acquis(n){this.timbreBlocService.acquis(n,!1)}doublon(n){this.timbreBlocService.acquis(n,!0)}modifier(n){let e=this.dialog.open(Ue,{height:"75vh",maxHeight:"750px",width:"30%"});e.componentInstance.id=n.getId(),e.afterClosed().subscribe(()=>{e.close()})}supprimer(n){this.timbreBlocService.getTimbresByBlocAsync(n.getId()).pipe(J()).subscribe(e=>{let i="";A(e)&&e?.length>0&&(i="<span class='warn'>Attention <b>"+e.length+"</b> timbre",e?.length>1?i+="s sont reli\xE9s":i+=" est reli\xE9",i+=" \xE0 ce bloc.</span></br></br>"),i+="Souhaitez-vous supprimer le bloc <b>n\xB0 "+n?.getId()+"</b> ?";let m=this.dialog.open($e,{maxHeight:"95vh",data:{titre:"Confirmation",message:i,btnDroite:"Oui",btnGauche:"Non"}});m.afterClosed().subscribe(()=>{m.componentInstance.data.resultat==="valider"&&this.timbreBlocService.supprimer(n)})})}exportTable(){let n=U.json_to_sheet(this.dataSource.data),e=U.book_new();U.book_append_sheet(e,n,"Donn\xE9es");let i=Ve(e,{bookType:"xlsx",type:"array"}),m=new Blob([i],{type:"application/octet-stream"});(0,Ye.saveAs)(m,"export_timbres.xlsx")}static \u0275fac=function(e){return new(e||t)(C(v),C(j),C(Ce),C(je))};static \u0275cmp=L({type:t,selectors:[["app-timbre-bloc-resultat"]],viewQuery:function(e,i){if(e&1&&(z(q,5),z(H,5)),e&2){let m;W(m=G())&&(i.paginator=m.first),W(m=G())&&(i.sort=m.first)}},decls:87,vars:46,consts:[["fxFlexFill","",3,"fxHide","textSpec"],[3,"fxHide"],["fxLayout","row","fxLayoutAlign","space-between center","fxLayoutGap","15px"],["fxFlex","","fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","10px",2,"font-size","1.2em"],[1,"bold"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input","select",2,"width","100px"],["name","carnet",1,"scrollBarAccent",3,"ngModelChange","ngModel","placeholder"],[1,"selectMin",3,"value"],["name","acquis",3,"ngModelChange","ngModel","placeholder"],["name","doublon",1,"scrollBarAccent",3,"ngModelChange","ngModel","placeholder"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input","select",2,"width","150px"],["name","anneeSelect","multiple","",3,"ngModelChange","ngModel","placeholder"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input",2,"width","200px","min-height","55px","height","55px"],["placeholder","Filtrer les donn\xE9es","type","text",3,"input"],[1,"primary","click",2,"font-size","1.7em",3,"click","type","icone","info"],["id","pdf-content","mat-table","","matSort","",3,"matSortChange","dataSource"],["matColumnDef","image"],["mat-header-cell","","class","image",4,"matHeaderCellDef"],["mat-cell","","class","alignCenter",4,"matCellDef"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","annee"],["matColumnDef","carnet"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","nbTimbres"],["mat-header-cell","","mat-sort-header","","class","hide-on-mobile",4,"matHeaderCellDef"],["mat-cell","","class","hide-on-mobile",4,"matCellDef"],["matColumnDef","monnaie"],["matColumnDef","acquis"],["matColumnDef","doublon"],["matColumnDef","modifier"],["mat-header-cell","","class","alignCenter",4,"matHeaderCellDef"],["matColumnDef","supprimer"],["mat-header-row","","class","bg-primary color-white",4,"matHeaderRowDef"],["mat-row","","class","mat-row",4,"matRowDef","matRowDefColumns"],[3,"pageSize","pageSizeOptions"],["mat-header-cell","",1,"image"],[1,"hide-on-mobile",3,"object","key"],["mat-cell","",1,"alignCenter"],["class","image click",3,"src","click",4,"ngIf"],[1,"image","click",3,"click","src"],["mat-header-cell","","mat-sort-header",""],[3,"object","key"],["mat-cell",""],["mat-header-cell",""],[3,"object","key","align"],[1,"click",2,"font-size","1.2em",3,"click","type","icone"],["mat-header-cell","","mat-sort-header","",1,"hide-on-mobile"],["mat-cell","",1,"hide-on-mobile"],[1,"click",2,"font-size","1.2em",3,"click","classIcone","type","icone","info"],["mat-header-cell","",1,"alignCenter"],[2,"font-size","1.2em",3,"type","icone","info"],[1,"primary","click",2,"font-size","1.2em",3,"click","type","icone","info"],["mat-header-row","",1,"bg-primary","color-white"],["mat-row","",1,"mat-row"]],template:function(e,i){e&1&&(d(0,"lib-spinner",0),h(1,"async"),o(2,"section",1),h(3,"async"),o(4,"div",2)(5,"div",3)(6,"div")(7,"span"),s(8,"Nombre de blocs : "),r(),o(9,"span",4),s(10),h(11,"async"),h(12,"async"),r()(),o(13,"span"),s(14,"/"),r(),o(15,"div")(16,"span"),s(17,"Nombre de carnets : "),r(),o(18,"span",4),s(19),h(20,"async"),h(21,"async"),r()()(),o(22,"div",5)(23,"mat-select",6),E("ngModelChange",function(l){return w(i.timbreCritereModel.carnet,l)||(i.timbreCritereModel.carnet=l),l}),f("ngModelChange",function(){return i.filtreByCritere()}),o(24,"mat-option",7),s(25," Oui"),r(),o(26,"mat-option",7),s(27," Non"),r(),o(28,"mat-option",7),s(29," Tous"),r()()(),o(30,"div",5)(31,"mat-select",8),E("ngModelChange",function(l){return w(i.timbreCritereModel.acquis,l)||(i.timbreCritereModel.acquis=l),l}),f("ngModelChange",function(){return i.filtreByCritere()}),o(32,"mat-option",7),s(33," Oui"),r(),o(34,"mat-option",7),s(35," Non"),r(),o(36,"mat-option",7),s(37," Tous"),r()()(),o(38,"div",5)(39,"mat-select",9),E("ngModelChange",function(l){return w(i.timbreCritereModel.doublon,l)||(i.timbreCritereModel.doublon=l),l}),f("ngModelChange",function(){return i.filtreByCritere()}),o(40,"mat-option",7),s(41," Oui"),r(),o(42,"mat-option",7),s(43," Non"),r(),o(44,"mat-option",7),s(45," Tous"),r()()(),o(46,"div",10)(47,"mat-select",11),E("ngModelChange",function(l){return w(i.timbreCritereModel.annees,l)||(i.timbreCritereModel.annees=l),l}),f("ngModelChange",function(){return i.filtreByCritere()}),u(48,nt,2,2,"mat-option",12),h(49,"async"),r()(),o(50,"div",13)(51,"input",14),f("input",function(l){return i.applyFilter(l)}),r()(),o(52,"lib-icon",15),f("click",function(){return i.exportTable()}),r()(),o(53,"table",16),f("matSortChange",function(l){return i.sortData(l)}),b(54,17),u(55,ot,2,2,"th",18)(56,rt,2,1,"td",19),_(),b(57,20),u(58,at,2,2,"th",21)(59,mt,2,1,"td",22),_(),b(60,23),u(61,ct,2,2,"th",21)(62,pt,2,1,"td",22),_(),b(63,24),u(64,st,2,3,"th",25)(65,dt,2,2,"td",19),_(),b(66,26),u(67,ut,2,2,"th",27)(68,ft,2,1,"td",28),_(),b(69,29),u(70,bt,2,2,"th",27)(71,_t,2,1,"td",28),_(),b(72,30),u(73,Ct,2,3,"th",25)(74,gt,2,4,"td",19),_(),b(75,31),u(76,ht,2,3,"th",25)(77,yt,2,4,"td",19),_(),b(78,32),u(79,Tt,2,3,"th",33)(80,xt,2,3,"td",19),_(),b(81,34),u(82,Mt,2,3,"th",33)(83,St,2,3,"td",19),_(),u(84,vt,1,0,"tr",35)(85,Bt,1,0,"tr",36),r(),d(86,"mat-paginator",37),r()),e&2&&(c("fxHide",y(1,31,i.load$)==!0)("textSpec","Chargement en cours ..."),a(2),c("fxHide",y(3,33,i.load$)==!1),a(8),g("",y(11,35,i.timbreBlocService.total$)?y(12,37,i.timbreBlocService.total$):0," "),a(9),g("",y(20,39,i.timbreBlocService.totalCarnet$)?y(21,41,i.timbreBlocService.totalCarnet$):0," "),a(4),B("ngModel",i.timbreCritereModel.carnet),c("placeholder","Carnet"),a(),c("value","OUI"),a(2),c("value","NON"),a(2),c("value","TOUS"),a(3),B("ngModel",i.timbreCritereModel.acquis),c("placeholder","Acquis"),a(),c("value","OUI"),a(2),c("value","NON"),a(2),c("value","TOUS"),a(3),B("ngModel",i.timbreCritereModel.doublon),c("placeholder","Doublon"),a(),c("value","OUI"),a(2),c("value","NON"),a(2),c("value","TOUS"),a(3),B("ngModel",i.timbreCritereModel.annees),c("placeholder","Ann\xE9es"),a(),c("ngForOf",y(49,43,i.annees$)),a(4),c("type",i.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",i.FontAwesomeEnum.FILE_EXEL)("info","Exporter tableau"),a(),c("dataSource",i.dataSource),a(31),c("matHeaderRowDef",i.displayedColumns),a(),c("matRowDefColumns",i.displayedColumns),a(),c("pageSize",15)("pageSizeOptions",te(45,it)))},dependencies:[ge,be,ye,xe,Be,Me,Te,we,Se,ve,Ee,De,q,H,he,ie,ne,F,P,N,ce,k,me,de,ue,Ae,Pe,Re,oe],styles:[".mat-row[_ngcontent-%COMP%]{height:35px}.image[_ngcontent-%COMP%]{max-height:30px!important}.mat-column-acquis[_ngcontent-%COMP%], .mat-column-doublon[_ngcontent-%COMP%]{width:60px!important;max-width:60px!important;padding:0!important}.mat-column-ajouter[_ngcontent-%COMP%], .mat-column-modifier[_ngcontent-%COMP%], .mat-column-supprimer[_ngcontent-%COMP%]{width:35px!important;max-width:35px!important;padding:0!important}@media screen and (max-width: 800px){.mat-row[_ngcontent-%COMP%]{height:25px}.image[_ngcontent-%COMP%]{max-height:20px!important}.mat-column-acquis[_ngcontent-%COMP%], .mat-column-doublon[_ngcontent-%COMP%]{width:50px!important;max-width:50px!important;padding:0!important}.mat-column-ajouter[_ngcontent-%COMP%], .mat-column-modifier[_ngcontent-%COMP%], .mat-column-supprimer[_ngcontent-%COMP%]{width:20px!important;max-width:20px!important;padding:0!important}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:0 5px!important}th[_ngcontent-%COMP%], .mat-row[_ngcontent-%COMP%]{font-size:.8em}.mat-column-libelle[_ngcontent-%COMP%],   .mat-column-libelle .mat-sort-header-container{width:40px!important;max-width:40px!important}.mat-column-drapeau[_ngcontent-%COMP%],   .mat-column-drapeau span{width:15px!important;max-width:15px!important}.mat-column-classeur[_ngcontent-%COMP%],   .mat-column-classeur .mat-sort-header-container, .mat-column-page[_ngcontent-%COMP%],   .mat-column-page .mat-sort-header-container{width:15px!important;max-width:15px!important}.mat-column-total[_ngcontent-%COMP%],   .mat-column-total .mat-sort-header-container{width:25px!important;max-width:25px!important}.hide-on-mobile[_ngcontent-%COMP%]{display:none}}"]})};var $=class t{constructor(n,e){this.headerService=n;this.timbreBlocService=e}FontAwesomeTypeEnum=I;FontAwesomeEnum=O;ngOnInit(){this.headerService.titre$.next("TIMBRES - BLOC"),this.timbreBlocService.getBlocs()}static \u0275fac=function(e){return new(e||t)(C(ae),C(v))};static \u0275cmp=L({type:t,selectors:[["app-timbre-bloc-layout"]],decls:6,vars:0,consts:[["fxLayout","row","fxLayoutAlign","space-between stretch"],["fxFlex","5"],["fxFlex","","fxLayout","column","fxLayoutGap","20px"]],template:function(e,i){e&1&&(o(0,"div",0),d(1,"div",1),o(2,"div",2),d(3,"app-menu")(4,"app-timbre-bloc-resultat"),r(),d(5,"div",1),r())},dependencies:[F,P,N,k,Xe,V],encapsulation:2})};var Et=[{path:"",component:$}],X=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=R({type:t});static \u0275inj=D({imports:[Y.forChild(Et),Y]})};var Qe=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=R({type:t});static \u0275inj=D({providers:[v,j,He,re()],imports:[X,Le,le,pe,se,fe,Oe,Fe,Ie,_e,We,ze,Ge]})};export{Qe as TimbreBlocModule};

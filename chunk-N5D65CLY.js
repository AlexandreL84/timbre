import{a as $t,b as pr,c as Xt}from"./chunk-TKPOVYQD.js";import{a as Xc,b as Jc}from"./chunk-O4K5XKVZ.js";import{a as Dt,b as Xi,c as Pi,d as nt,e as yo,f as Rn,g as Dn,h as So,i as On,j as F_,k as Mo,q as Su}from"./chunk-ALL4ZA7H.js";import{e as Co,f as Ji}from"./chunk-I7IONR3M.js";import{c as An,d as Rt,g as Bn}from"./chunk-6K26VDAP.js";import{l as oe,m as Ri,n as Di,o as ho,u as vn,v as tt}from"./chunk-WOTJWQDQ.js";import{a as ou}from"./chunk-MJBYZQPI.js";import{$ as hn,Aa as B,Ab as Oi,Ac as vo,Ba as _o,Bb as Li,Bc as xo,Ca as $,Cb as Yt,Cc as cu,D as fo,Db as Kt,Dc as uu,Ea as Yc,Ec as mu,Fa as Fe,Fb as eu,Fc as pu,Ga as Ue,Gb as xn,Gc as fu,H as Bi,Ha as Pe,Hc as du,I as kc,Ic as gu,Jb as Et,Jc as bu,K as Te,Kb as Ni,Kc as _u,La as mr,Lb as Fi,Lc as hu,M as Ce,Mb as It,Mc as Tu,N as jc,Na as O,Nb as Ui,Nc as vu,Oa as L,Ob as Cn,Oc as xu,P as go,Pa as Je,Pb as yn,Pc as Cu,Qb as Sn,Qc as cs,Rb as Mn,S as H,Sb as En,Sc as Zt,T as W,Tb as In,Tc as yu,Ub as tu,Vb as iu,W as zc,Wb as wt,Xa as Ct,Xb as nu,Ya as et,Yb as ru,Za as Se,aa as Tn,ab as we,ba as h,bb as Kc,c as _e,ca as V,ha as D,ia as v,ic as wn,jc as it,k as jt,kc as lu,l as We,ma as T,mc as Qt,na as x,nb as Qc,oa as G,ob as S,oc as At,pa as le,pb as Oe,qa as se,sa as ue,ta as j,tc as su,ua as y,ub as yt,uc as Bt,va as bo,vb as St,wa as gi,wb as Zc,x as P,xa as bi,xb as Mt,xc as au,ya as _i,yb as To,za as ye,zb as zt}from"./chunk-XHCW746T.js";import{d as N_,f as Gc,g as re}from"./chunk-GOLCFQAC.js";var Lu=N_(($n,Tr)=>{(function(){var o,r="4.17.21",n=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",c="Expected a function",f="Invalid `variable` option passed into `_.template`",b="__lodash_hash_undefined__",E=500,R="__lodash_placeholder__",F=1,de=2,Z=4,rt=1,ii=2,Ge=1,Ht=2,Hn=4,ot=8,ni=16,lt=32,ri=64,ft=128,Wn=256,Ho=512,qu=30,$u="...",Hu=800,Wu=16,ps=1,Vu=2,Gu=3,Wi=1/0,Ti=9007199254740991,ku=17976931348623157e292,vr=NaN,Wt=4294967295,ju=Wt-1,zu=Wt>>>1,Yu=[["ary",ft],["bind",Ge],["bindKey",Ht],["curry",ot],["curryRight",ni],["flip",Ho],["partial",lt],["partialRight",ri],["rearg",Wn]],nn="[object Arguments]",xr="[object Array]",Ku="[object AsyncFunction]",Vn="[object Boolean]",Gn="[object Date]",Qu="[object DOMException]",Cr="[object Error]",yr="[object Function]",fs="[object GeneratorFunction]",Lt="[object Map]",kn="[object Number]",Zu="[object Null]",oi="[object Object]",ds="[object Promise]",Xu="[object Proxy]",jn="[object RegExp]",Nt="[object Set]",zn="[object String]",Sr="[object Symbol]",Ju="[object Undefined]",Yn="[object WeakMap]",em="[object WeakSet]",Kn="[object ArrayBuffer]",rn="[object DataView]",Wo="[object Float32Array]",Vo="[object Float64Array]",Go="[object Int8Array]",ko="[object Int16Array]",jo="[object Int32Array]",zo="[object Uint8Array]",Yo="[object Uint8ClampedArray]",Ko="[object Uint16Array]",Qo="[object Uint32Array]",tm=/\b__p \+= '';/g,im=/\b(__p \+=) '' \+/g,nm=/(__e\(.*?\)|\b__t\)) \+\n'';/g,gs=/&(?:amp|lt|gt|quot|#39);/g,bs=/[&<>"']/g,rm=RegExp(gs.source),om=RegExp(bs.source),lm=/<%-([\s\S]+?)%>/g,sm=/<%([\s\S]+?)%>/g,_s=/<%=([\s\S]+?)%>/g,am=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,cm=/^\w*$/,um=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Zo=/[\\^$.*+?()[\]{}|]/g,mm=RegExp(Zo.source),Xo=/^\s+/,pm=/\s/,fm=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,dm=/\{\n\/\* \[wrapped with (.+)\] \*/,gm=/,? & /,bm=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,_m=/[()=,{}\[\]\/\s]/,hm=/\\(\\)?/g,Tm=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,hs=/\w*$/,vm=/^[-+]0x[0-9a-f]+$/i,xm=/^0b[01]+$/i,Cm=/^\[object .+?Constructor\]$/,ym=/^0o[0-7]+$/i,Sm=/^(?:0|[1-9]\d*)$/,Mm=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Mr=/($^)/,Em=/['\n\r\u2028\u2029\\]/g,Er="\\ud800-\\udfff",Im="\\u0300-\\u036f",wm="\\ufe20-\\ufe2f",Am="\\u20d0-\\u20ff",Ts=Im+wm+Am,vs="\\u2700-\\u27bf",xs="a-z\\xdf-\\xf6\\xf8-\\xff",Bm="\\xac\\xb1\\xd7\\xf7",Rm="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Dm="\\u2000-\\u206f",Om=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Cs="A-Z\\xc0-\\xd6\\xd8-\\xde",ys="\\ufe0e\\ufe0f",Ss=Bm+Rm+Dm+Om,Jo="['\u2019]",Lm="["+Er+"]",Ms="["+Ss+"]",Ir="["+Ts+"]",Es="\\d+",Nm="["+vs+"]",Is="["+xs+"]",ws="[^"+Er+Ss+Es+vs+xs+Cs+"]",el="\\ud83c[\\udffb-\\udfff]",Fm="(?:"+Ir+"|"+el+")",As="[^"+Er+"]",tl="(?:\\ud83c[\\udde6-\\uddff]){2}",il="[\\ud800-\\udbff][\\udc00-\\udfff]",on="["+Cs+"]",Bs="\\u200d",Rs="(?:"+Is+"|"+ws+")",Um="(?:"+on+"|"+ws+")",Ds="(?:"+Jo+"(?:d|ll|m|re|s|t|ve))?",Os="(?:"+Jo+"(?:D|LL|M|RE|S|T|VE))?",Ls=Fm+"?",Ns="["+ys+"]?",Pm="(?:"+Bs+"(?:"+[As,tl,il].join("|")+")"+Ns+Ls+")*",qm="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",$m="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Fs=Ns+Ls+Pm,Hm="(?:"+[Nm,tl,il].join("|")+")"+Fs,Wm="(?:"+[As+Ir+"?",Ir,tl,il,Lm].join("|")+")",Vm=RegExp(Jo,"g"),Gm=RegExp(Ir,"g"),nl=RegExp(el+"(?="+el+")|"+Wm+Fs,"g"),km=RegExp([on+"?"+Is+"+"+Ds+"(?="+[Ms,on,"$"].join("|")+")",Um+"+"+Os+"(?="+[Ms,on+Rs,"$"].join("|")+")",on+"?"+Rs+"+"+Ds,on+"+"+Os,$m,qm,Es,Hm].join("|"),"g"),jm=RegExp("["+Bs+Er+Ts+ys+"]"),zm=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ym=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Km=-1,be={};be[Wo]=be[Vo]=be[Go]=be[ko]=be[jo]=be[zo]=be[Yo]=be[Ko]=be[Qo]=!0,be[nn]=be[xr]=be[Kn]=be[Vn]=be[rn]=be[Gn]=be[Cr]=be[yr]=be[Lt]=be[kn]=be[oi]=be[jn]=be[Nt]=be[zn]=be[Yn]=!1;var ge={};ge[nn]=ge[xr]=ge[Kn]=ge[rn]=ge[Vn]=ge[Gn]=ge[Wo]=ge[Vo]=ge[Go]=ge[ko]=ge[jo]=ge[Lt]=ge[kn]=ge[oi]=ge[jn]=ge[Nt]=ge[zn]=ge[Sr]=ge[zo]=ge[Yo]=ge[Ko]=ge[Qo]=!0,ge[Cr]=ge[yr]=ge[Yn]=!1;var Qm={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Zm={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Xm={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Jm={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ep=parseFloat,tp=parseInt,Us=typeof global=="object"&&global&&global.Object===Object&&global,ip=typeof self=="object"&&self&&self.Object===Object&&self,Re=Us||ip||Function("return this")(),rl=typeof $n=="object"&&$n&&!$n.nodeType&&$n,Vi=rl&&typeof Tr=="object"&&Tr&&!Tr.nodeType&&Tr,Ps=Vi&&Vi.exports===rl,ol=Ps&&Us.process,dt=function(){try{var g=Vi&&Vi.require&&Vi.require("util").types;return g||ol&&ol.binding&&ol.binding("util")}catch{}}(),qs=dt&&dt.isArrayBuffer,$s=dt&&dt.isDate,Hs=dt&&dt.isMap,Ws=dt&&dt.isRegExp,Vs=dt&&dt.isSet,Gs=dt&&dt.isTypedArray;function st(g,M,C){switch(C.length){case 0:return g.call(M);case 1:return g.call(M,C[0]);case 2:return g.call(M,C[0],C[1]);case 3:return g.call(M,C[0],C[1],C[2])}return g.apply(M,C)}function np(g,M,C,U){for(var K=-1,ae=g==null?0:g.length;++K<ae;){var Ae=g[K];M(U,Ae,C(Ae),g)}return U}function gt(g,M){for(var C=-1,U=g==null?0:g.length;++C<U&&M(g[C],C,g)!==!1;);return g}function rp(g,M){for(var C=g==null?0:g.length;C--&&M(g[C],C,g)!==!1;);return g}function ks(g,M){for(var C=-1,U=g==null?0:g.length;++C<U;)if(!M(g[C],C,g))return!1;return!0}function vi(g,M){for(var C=-1,U=g==null?0:g.length,K=0,ae=[];++C<U;){var Ae=g[C];M(Ae,C,g)&&(ae[K++]=Ae)}return ae}function wr(g,M){var C=g==null?0:g.length;return!!C&&ln(g,M,0)>-1}function ll(g,M,C){for(var U=-1,K=g==null?0:g.length;++U<K;)if(C(M,g[U]))return!0;return!1}function he(g,M){for(var C=-1,U=g==null?0:g.length,K=Array(U);++C<U;)K[C]=M(g[C],C,g);return K}function xi(g,M){for(var C=-1,U=M.length,K=g.length;++C<U;)g[K+C]=M[C];return g}function sl(g,M,C,U){var K=-1,ae=g==null?0:g.length;for(U&&ae&&(C=g[++K]);++K<ae;)C=M(C,g[K],K,g);return C}function op(g,M,C,U){var K=g==null?0:g.length;for(U&&K&&(C=g[--K]);K--;)C=M(C,g[K],K,g);return C}function al(g,M){for(var C=-1,U=g==null?0:g.length;++C<U;)if(M(g[C],C,g))return!0;return!1}var lp=cl("length");function sp(g){return g.split("")}function ap(g){return g.match(bm)||[]}function js(g,M,C){var U;return C(g,function(K,ae,Ae){if(M(K,ae,Ae))return U=ae,!1}),U}function Ar(g,M,C,U){for(var K=g.length,ae=C+(U?1:-1);U?ae--:++ae<K;)if(M(g[ae],ae,g))return ae;return-1}function ln(g,M,C){return M===M?vp(g,M,C):Ar(g,zs,C)}function cp(g,M,C,U){for(var K=C-1,ae=g.length;++K<ae;)if(U(g[K],M))return K;return-1}function zs(g){return g!==g}function Ys(g,M){var C=g==null?0:g.length;return C?ml(g,M)/C:vr}function cl(g){return function(M){return M==null?o:M[g]}}function ul(g){return function(M){return g==null?o:g[M]}}function Ks(g,M,C,U,K){return K(g,function(ae,Ae,fe){C=U?(U=!1,ae):M(C,ae,Ae,fe)}),C}function up(g,M){var C=g.length;for(g.sort(M);C--;)g[C]=g[C].value;return g}function ml(g,M){for(var C,U=-1,K=g.length;++U<K;){var ae=M(g[U]);ae!==o&&(C=C===o?ae:C+ae)}return C}function pl(g,M){for(var C=-1,U=Array(g);++C<g;)U[C]=M(C);return U}function mp(g,M){return he(M,function(C){return[C,g[C]]})}function Qs(g){return g&&g.slice(0,ea(g)+1).replace(Xo,"")}function at(g){return function(M){return g(M)}}function fl(g,M){return he(M,function(C){return g[C]})}function Qn(g,M){return g.has(M)}function Zs(g,M){for(var C=-1,U=g.length;++C<U&&ln(M,g[C],0)>-1;);return C}function Xs(g,M){for(var C=g.length;C--&&ln(M,g[C],0)>-1;);return C}function pp(g,M){for(var C=g.length,U=0;C--;)g[C]===M&&++U;return U}var fp=ul(Qm),dp=ul(Zm);function gp(g){return"\\"+Jm[g]}function bp(g,M){return g==null?o:g[M]}function sn(g){return jm.test(g)}function _p(g){return zm.test(g)}function hp(g){for(var M,C=[];!(M=g.next()).done;)C.push(M.value);return C}function dl(g){var M=-1,C=Array(g.size);return g.forEach(function(U,K){C[++M]=[K,U]}),C}function Js(g,M){return function(C){return g(M(C))}}function Ci(g,M){for(var C=-1,U=g.length,K=0,ae=[];++C<U;){var Ae=g[C];(Ae===M||Ae===R)&&(g[C]=R,ae[K++]=C)}return ae}function Br(g){var M=-1,C=Array(g.size);return g.forEach(function(U){C[++M]=U}),C}function Tp(g){var M=-1,C=Array(g.size);return g.forEach(function(U){C[++M]=[U,U]}),C}function vp(g,M,C){for(var U=C-1,K=g.length;++U<K;)if(g[U]===M)return U;return-1}function xp(g,M,C){for(var U=C+1;U--;)if(g[U]===M)return U;return U}function an(g){return sn(g)?yp(g):lp(g)}function Ft(g){return sn(g)?Sp(g):sp(g)}function ea(g){for(var M=g.length;M--&&pm.test(g.charAt(M)););return M}var Cp=ul(Xm);function yp(g){for(var M=nl.lastIndex=0;nl.test(g);)++M;return M}function Sp(g){return g.match(nl)||[]}function Mp(g){return g.match(km)||[]}var Ep=function g(M){M=M==null?Re:yi.defaults(Re.Object(),M,yi.pick(Re,Ym));var C=M.Array,U=M.Date,K=M.Error,ae=M.Function,Ae=M.Math,fe=M.Object,gl=M.RegExp,Ip=M.String,bt=M.TypeError,Rr=C.prototype,wp=ae.prototype,cn=fe.prototype,Dr=M["__core-js_shared__"],Or=wp.toString,me=cn.hasOwnProperty,Ap=0,ta=function(){var e=/[^.]+$/.exec(Dr&&Dr.keys&&Dr.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Lr=cn.toString,Bp=Or.call(fe),Rp=Re._,Dp=gl("^"+Or.call(me).replace(Zo,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Nr=Ps?M.Buffer:o,Si=M.Symbol,Fr=M.Uint8Array,ia=Nr?Nr.allocUnsafe:o,Ur=Js(fe.getPrototypeOf,fe),na=fe.create,ra=cn.propertyIsEnumerable,Pr=Rr.splice,oa=Si?Si.isConcatSpreadable:o,Zn=Si?Si.iterator:o,Gi=Si?Si.toStringTag:o,qr=function(){try{var e=Ki(fe,"defineProperty");return e({},"",{}),e}catch{}}(),Op=M.clearTimeout!==Re.clearTimeout&&M.clearTimeout,Lp=U&&U.now!==Re.Date.now&&U.now,Np=M.setTimeout!==Re.setTimeout&&M.setTimeout,$r=Ae.ceil,Hr=Ae.floor,bl=fe.getOwnPropertySymbols,Fp=Nr?Nr.isBuffer:o,la=M.isFinite,Up=Rr.join,Pp=Js(fe.keys,fe),Be=Ae.max,$e=Ae.min,qp=U.now,$p=M.parseInt,sa=Ae.random,Hp=Rr.reverse,_l=Ki(M,"DataView"),Xn=Ki(M,"Map"),hl=Ki(M,"Promise"),un=Ki(M,"Set"),Jn=Ki(M,"WeakMap"),er=Ki(fe,"create"),Wr=Jn&&new Jn,mn={},Wp=Qi(_l),Vp=Qi(Xn),Gp=Qi(hl),kp=Qi(un),jp=Qi(Jn),Vr=Si?Si.prototype:o,tr=Vr?Vr.valueOf:o,aa=Vr?Vr.toString:o;function u(e){if(xe(e)&&!Q(e)&&!(e instanceof ie)){if(e instanceof _t)return e;if(me.call(e,"__wrapped__"))return cc(e)}return new _t(e)}var pn=function(){function e(){}return function(t){if(!ve(t))return{};if(na)return na(t);e.prototype=t;var i=new e;return e.prototype=o,i}}();function Gr(){}function _t(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=o}u.templateSettings={escape:lm,evaluate:sm,interpolate:_s,variable:"",imports:{_:u}},u.prototype=Gr.prototype,u.prototype.constructor=u,_t.prototype=pn(Gr.prototype),_t.prototype.constructor=_t;function ie(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Wt,this.__views__=[]}function zp(){var e=new ie(this.__wrapped__);return e.__actions__=Ke(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Ke(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Ke(this.__views__),e}function Yp(){if(this.__filtered__){var e=new ie(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Kp(){var e=this.__wrapped__.value(),t=this.__dir__,i=Q(e),l=t<0,a=i?e.length:0,m=a0(0,a,this.__views__),p=m.start,d=m.end,_=d-p,I=l?d:p-1,w=this.__iteratees__,A=w.length,N=0,q=$e(_,this.__takeCount__);if(!i||!l&&a==_&&q==_)return Da(e,this.__actions__);var z=[];e:for(;_--&&N<q;){I+=t;for(var J=-1,Y=e[I];++J<A;){var te=w[J],ne=te.iteratee,mt=te.type,ze=ne(Y);if(mt==Vu)Y=ze;else if(!ze){if(mt==ps)continue e;break e}}z[N++]=Y}return z}ie.prototype=pn(Gr.prototype),ie.prototype.constructor=ie;function ki(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var l=e[t];this.set(l[0],l[1])}}function Qp(){this.__data__=er?er(null):{},this.size=0}function Zp(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Xp(e){var t=this.__data__;if(er){var i=t[e];return i===b?o:i}return me.call(t,e)?t[e]:o}function Jp(e){var t=this.__data__;return er?t[e]!==o:me.call(t,e)}function ef(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=er&&t===o?b:t,this}ki.prototype.clear=Qp,ki.prototype.delete=Zp,ki.prototype.get=Xp,ki.prototype.has=Jp,ki.prototype.set=ef;function li(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var l=e[t];this.set(l[0],l[1])}}function tf(){this.__data__=[],this.size=0}function nf(e){var t=this.__data__,i=kr(t,e);if(i<0)return!1;var l=t.length-1;return i==l?t.pop():Pr.call(t,i,1),--this.size,!0}function rf(e){var t=this.__data__,i=kr(t,e);return i<0?o:t[i][1]}function of(e){return kr(this.__data__,e)>-1}function lf(e,t){var i=this.__data__,l=kr(i,e);return l<0?(++this.size,i.push([e,t])):i[l][1]=t,this}li.prototype.clear=tf,li.prototype.delete=nf,li.prototype.get=rf,li.prototype.has=of,li.prototype.set=lf;function si(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var l=e[t];this.set(l[0],l[1])}}function sf(){this.size=0,this.__data__={hash:new ki,map:new(Xn||li),string:new ki}}function af(e){var t=no(this,e).delete(e);return this.size-=t?1:0,t}function cf(e){return no(this,e).get(e)}function uf(e){return no(this,e).has(e)}function mf(e,t){var i=no(this,e),l=i.size;return i.set(e,t),this.size+=i.size==l?0:1,this}si.prototype.clear=sf,si.prototype.delete=af,si.prototype.get=cf,si.prototype.has=uf,si.prototype.set=mf;function ji(e){var t=-1,i=e==null?0:e.length;for(this.__data__=new si;++t<i;)this.add(e[t])}function pf(e){return this.__data__.set(e,b),this}function ff(e){return this.__data__.has(e)}ji.prototype.add=ji.prototype.push=pf,ji.prototype.has=ff;function Ut(e){var t=this.__data__=new li(e);this.size=t.size}function df(){this.__data__=new li,this.size=0}function gf(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i}function bf(e){return this.__data__.get(e)}function _f(e){return this.__data__.has(e)}function hf(e,t){var i=this.__data__;if(i instanceof li){var l=i.__data__;if(!Xn||l.length<n-1)return l.push([e,t]),this.size=++i.size,this;i=this.__data__=new si(l)}return i.set(e,t),this.size=i.size,this}Ut.prototype.clear=df,Ut.prototype.delete=gf,Ut.prototype.get=bf,Ut.prototype.has=_f,Ut.prototype.set=hf;function ca(e,t){var i=Q(e),l=!i&&Zi(e),a=!i&&!l&&Ai(e),m=!i&&!l&&!a&&bn(e),p=i||l||a||m,d=p?pl(e.length,Ip):[],_=d.length;for(var I in e)(t||me.call(e,I))&&!(p&&(I=="length"||a&&(I=="offset"||I=="parent")||m&&(I=="buffer"||I=="byteLength"||I=="byteOffset")||mi(I,_)))&&d.push(I);return d}function ua(e){var t=e.length;return t?e[Al(0,t-1)]:o}function Tf(e,t){return ro(Ke(e),zi(t,0,e.length))}function vf(e){return ro(Ke(e))}function Tl(e,t,i){(i!==o&&!Pt(e[t],i)||i===o&&!(t in e))&&ai(e,t,i)}function ir(e,t,i){var l=e[t];(!(me.call(e,t)&&Pt(l,i))||i===o&&!(t in e))&&ai(e,t,i)}function kr(e,t){for(var i=e.length;i--;)if(Pt(e[i][0],t))return i;return-1}function xf(e,t,i,l){return Mi(e,function(a,m,p){t(l,a,i(a),p)}),l}function ma(e,t){return e&&Gt(t,De(t),e)}function Cf(e,t){return e&&Gt(t,Ze(t),e)}function ai(e,t,i){t=="__proto__"&&qr?qr(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}function vl(e,t){for(var i=-1,l=t.length,a=C(l),m=e==null;++i<l;)a[i]=m?o:es(e,t[i]);return a}function zi(e,t,i){return e===e&&(i!==o&&(e=e<=i?e:i),t!==o&&(e=e>=t?e:t)),e}function ht(e,t,i,l,a,m){var p,d=t&F,_=t&de,I=t&Z;if(i&&(p=a?i(e,l,a,m):i(e)),p!==o)return p;if(!ve(e))return e;var w=Q(e);if(w){if(p=u0(e),!d)return Ke(e,p)}else{var A=He(e),N=A==yr||A==fs;if(Ai(e))return Na(e,d);if(A==oi||A==nn||N&&!a){if(p=_||N?{}:ec(e),!d)return _?Jf(e,Cf(p,e)):Xf(e,ma(p,e))}else{if(!ge[A])return a?e:{};p=m0(e,A,d)}}m||(m=new Ut);var q=m.get(e);if(q)return q;m.set(e,p),Ac(e)?e.forEach(function(Y){p.add(ht(Y,t,i,Y,e,m))}):Ic(e)&&e.forEach(function(Y,te){p.set(te,ht(Y,t,i,te,e,m))});var z=I?_?$l:ql:_?Ze:De,J=w?o:z(e);return gt(J||e,function(Y,te){J&&(te=Y,Y=e[te]),ir(p,te,ht(Y,t,i,te,e,m))}),p}function yf(e){var t=De(e);return function(i){return pa(i,e,t)}}function pa(e,t,i){var l=i.length;if(e==null)return!l;for(e=fe(e);l--;){var a=i[l],m=t[a],p=e[a];if(p===o&&!(a in e)||!m(p))return!1}return!0}function fa(e,t,i){if(typeof e!="function")throw new bt(c);return cr(function(){e.apply(o,i)},t)}function nr(e,t,i,l){var a=-1,m=wr,p=!0,d=e.length,_=[],I=t.length;if(!d)return _;i&&(t=he(t,at(i))),l?(m=ll,p=!1):t.length>=n&&(m=Qn,p=!1,t=new ji(t));e:for(;++a<d;){var w=e[a],A=i==null?w:i(w);if(w=l||w!==0?w:0,p&&A===A){for(var N=I;N--;)if(t[N]===A)continue e;_.push(w)}else m(t,A,l)||_.push(w)}return _}var Mi=$a(Vt),da=$a(Cl,!0);function Sf(e,t){var i=!0;return Mi(e,function(l,a,m){return i=!!t(l,a,m),i}),i}function jr(e,t,i){for(var l=-1,a=e.length;++l<a;){var m=e[l],p=t(m);if(p!=null&&(d===o?p===p&&!ut(p):i(p,d)))var d=p,_=m}return _}function Mf(e,t,i,l){var a=e.length;for(i=X(i),i<0&&(i=-i>a?0:a+i),l=l===o||l>a?a:X(l),l<0&&(l+=a),l=i>l?0:Rc(l);i<l;)e[i++]=t;return e}function ga(e,t){var i=[];return Mi(e,function(l,a,m){t(l,a,m)&&i.push(l)}),i}function Ne(e,t,i,l,a){var m=-1,p=e.length;for(i||(i=f0),a||(a=[]);++m<p;){var d=e[m];t>0&&i(d)?t>1?Ne(d,t-1,i,l,a):xi(a,d):l||(a[a.length]=d)}return a}var xl=Ha(),ba=Ha(!0);function Vt(e,t){return e&&xl(e,t,De)}function Cl(e,t){return e&&ba(e,t,De)}function zr(e,t){return vi(t,function(i){return pi(e[i])})}function Yi(e,t){t=Ii(t,e);for(var i=0,l=t.length;e!=null&&i<l;)e=e[kt(t[i++])];return i&&i==l?e:o}function _a(e,t,i){var l=t(e);return Q(e)?l:xi(l,i(e))}function ke(e){return e==null?e===o?Ju:Zu:Gi&&Gi in fe(e)?s0(e):v0(e)}function yl(e,t){return e>t}function Ef(e,t){return e!=null&&me.call(e,t)}function If(e,t){return e!=null&&t in fe(e)}function wf(e,t,i){return e>=$e(t,i)&&e<Be(t,i)}function Sl(e,t,i){for(var l=i?ll:wr,a=e[0].length,m=e.length,p=m,d=C(m),_=1/0,I=[];p--;){var w=e[p];p&&t&&(w=he(w,at(t))),_=$e(w.length,_),d[p]=!i&&(t||a>=120&&w.length>=120)?new ji(p&&w):o}w=e[0];var A=-1,N=d[0];e:for(;++A<a&&I.length<_;){var q=w[A],z=t?t(q):q;if(q=i||q!==0?q:0,!(N?Qn(N,z):l(I,z,i))){for(p=m;--p;){var J=d[p];if(!(J?Qn(J,z):l(e[p],z,i)))continue e}N&&N.push(z),I.push(q)}}return I}function Af(e,t,i,l){return Vt(e,function(a,m,p){t(l,i(a),m,p)}),l}function rr(e,t,i){t=Ii(t,e),e=rc(e,t);var l=e==null?e:e[kt(vt(t))];return l==null?o:st(l,e,i)}function ha(e){return xe(e)&&ke(e)==nn}function Bf(e){return xe(e)&&ke(e)==Kn}function Rf(e){return xe(e)&&ke(e)==Gn}function or(e,t,i,l,a){return e===t?!0:e==null||t==null||!xe(e)&&!xe(t)?e!==e&&t!==t:Df(e,t,i,l,or,a)}function Df(e,t,i,l,a,m){var p=Q(e),d=Q(t),_=p?xr:He(e),I=d?xr:He(t);_=_==nn?oi:_,I=I==nn?oi:I;var w=_==oi,A=I==oi,N=_==I;if(N&&Ai(e)){if(!Ai(t))return!1;p=!0,w=!1}if(N&&!w)return m||(m=new Ut),p||bn(e)?Za(e,t,i,l,a,m):o0(e,t,_,i,l,a,m);if(!(i&rt)){var q=w&&me.call(e,"__wrapped__"),z=A&&me.call(t,"__wrapped__");if(q||z){var J=q?e.value():e,Y=z?t.value():t;return m||(m=new Ut),a(J,Y,i,l,m)}}return N?(m||(m=new Ut),l0(e,t,i,l,a,m)):!1}function Of(e){return xe(e)&&He(e)==Lt}function Ml(e,t,i,l){var a=i.length,m=a,p=!l;if(e==null)return!m;for(e=fe(e);a--;){var d=i[a];if(p&&d[2]?d[1]!==e[d[0]]:!(d[0]in e))return!1}for(;++a<m;){d=i[a];var _=d[0],I=e[_],w=d[1];if(p&&d[2]){if(I===o&&!(_ in e))return!1}else{var A=new Ut;if(l)var N=l(I,w,_,e,t,A);if(!(N===o?or(w,I,rt|ii,l,A):N))return!1}}return!0}function Ta(e){if(!ve(e)||g0(e))return!1;var t=pi(e)?Dp:Cm;return t.test(Qi(e))}function Lf(e){return xe(e)&&ke(e)==jn}function Nf(e){return xe(e)&&He(e)==Nt}function Ff(e){return xe(e)&&uo(e.length)&&!!be[ke(e)]}function va(e){return typeof e=="function"?e:e==null?Xe:typeof e=="object"?Q(e)?ya(e[0],e[1]):Ca(e):Wc(e)}function El(e){if(!ar(e))return Pp(e);var t=[];for(var i in fe(e))me.call(e,i)&&i!="constructor"&&t.push(i);return t}function Uf(e){if(!ve(e))return T0(e);var t=ar(e),i=[];for(var l in e)l=="constructor"&&(t||!me.call(e,l))||i.push(l);return i}function Il(e,t){return e<t}function xa(e,t){var i=-1,l=Qe(e)?C(e.length):[];return Mi(e,function(a,m,p){l[++i]=t(a,m,p)}),l}function Ca(e){var t=Wl(e);return t.length==1&&t[0][2]?ic(t[0][0],t[0][1]):function(i){return i===e||Ml(i,e,t)}}function ya(e,t){return Gl(e)&&tc(t)?ic(kt(e),t):function(i){var l=es(i,e);return l===o&&l===t?ts(i,e):or(t,l,rt|ii)}}function Yr(e,t,i,l,a){e!==t&&xl(t,function(m,p){if(a||(a=new Ut),ve(m))Pf(e,t,p,i,Yr,l,a);else{var d=l?l(jl(e,p),m,p+"",e,t,a):o;d===o&&(d=m),Tl(e,p,d)}},Ze)}function Pf(e,t,i,l,a,m,p){var d=jl(e,i),_=jl(t,i),I=p.get(_);if(I){Tl(e,i,I);return}var w=m?m(d,_,i+"",e,t,p):o,A=w===o;if(A){var N=Q(_),q=!N&&Ai(_),z=!N&&!q&&bn(_);w=_,N||q||z?Q(d)?w=d:Ee(d)?w=Ke(d):q?(A=!1,w=Na(_,!0)):z?(A=!1,w=Fa(_,!0)):w=[]:ur(_)||Zi(_)?(w=d,Zi(d)?w=Dc(d):(!ve(d)||pi(d))&&(w=ec(_))):A=!1}A&&(p.set(_,w),a(w,_,l,m,p),p.delete(_)),Tl(e,i,w)}function Sa(e,t){var i=e.length;if(i)return t+=t<0?i:0,mi(t,i)?e[t]:o}function Ma(e,t,i){t.length?t=he(t,function(m){return Q(m)?function(p){return Yi(p,m.length===1?m[0]:m)}:m}):t=[Xe];var l=-1;t=he(t,at(k()));var a=xa(e,function(m,p,d){var _=he(t,function(I){return I(m)});return{criteria:_,index:++l,value:m}});return up(a,function(m,p){return Zf(m,p,i)})}function qf(e,t){return Ea(e,t,function(i,l){return ts(e,l)})}function Ea(e,t,i){for(var l=-1,a=t.length,m={};++l<a;){var p=t[l],d=Yi(e,p);i(d,p)&&lr(m,Ii(p,e),d)}return m}function $f(e){return function(t){return Yi(t,e)}}function wl(e,t,i,l){var a=l?cp:ln,m=-1,p=t.length,d=e;for(e===t&&(t=Ke(t)),i&&(d=he(e,at(i)));++m<p;)for(var _=0,I=t[m],w=i?i(I):I;(_=a(d,w,_,l))>-1;)d!==e&&Pr.call(d,_,1),Pr.call(e,_,1);return e}function Ia(e,t){for(var i=e?t.length:0,l=i-1;i--;){var a=t[i];if(i==l||a!==m){var m=a;mi(a)?Pr.call(e,a,1):Dl(e,a)}}return e}function Al(e,t){return e+Hr(sa()*(t-e+1))}function Hf(e,t,i,l){for(var a=-1,m=Be($r((t-e)/(i||1)),0),p=C(m);m--;)p[l?m:++a]=e,e+=i;return p}function Bl(e,t){var i="";if(!e||t<1||t>Ti)return i;do t%2&&(i+=e),t=Hr(t/2),t&&(e+=e);while(t);return i}function ee(e,t){return zl(nc(e,t,Xe),e+"")}function Wf(e){return ua(_n(e))}function Vf(e,t){var i=_n(e);return ro(i,zi(t,0,i.length))}function lr(e,t,i,l){if(!ve(e))return e;t=Ii(t,e);for(var a=-1,m=t.length,p=m-1,d=e;d!=null&&++a<m;){var _=kt(t[a]),I=i;if(_==="__proto__"||_==="constructor"||_==="prototype")return e;if(a!=p){var w=d[_];I=l?l(w,_,d):o,I===o&&(I=ve(w)?w:mi(t[a+1])?[]:{})}ir(d,_,I),d=d[_]}return e}var wa=Wr?function(e,t){return Wr.set(e,t),e}:Xe,Gf=qr?function(e,t){return qr(e,"toString",{configurable:!0,enumerable:!1,value:ns(t),writable:!0})}:Xe;function kf(e){return ro(_n(e))}function Tt(e,t,i){var l=-1,a=e.length;t<0&&(t=-t>a?0:a+t),i=i>a?a:i,i<0&&(i+=a),a=t>i?0:i-t>>>0,t>>>=0;for(var m=C(a);++l<a;)m[l]=e[l+t];return m}function jf(e,t){var i;return Mi(e,function(l,a,m){return i=t(l,a,m),!i}),!!i}function Kr(e,t,i){var l=0,a=e==null?l:e.length;if(typeof t=="number"&&t===t&&a<=zu){for(;l<a;){var m=l+a>>>1,p=e[m];p!==null&&!ut(p)&&(i?p<=t:p<t)?l=m+1:a=m}return a}return Rl(e,t,Xe,i)}function Rl(e,t,i,l){var a=0,m=e==null?0:e.length;if(m===0)return 0;t=i(t);for(var p=t!==t,d=t===null,_=ut(t),I=t===o;a<m;){var w=Hr((a+m)/2),A=i(e[w]),N=A!==o,q=A===null,z=A===A,J=ut(A);if(p)var Y=l||z;else I?Y=z&&(l||N):d?Y=z&&N&&(l||!q):_?Y=z&&N&&!q&&(l||!J):q||J?Y=!1:Y=l?A<=t:A<t;Y?a=w+1:m=w}return $e(m,ju)}function Aa(e,t){for(var i=-1,l=e.length,a=0,m=[];++i<l;){var p=e[i],d=t?t(p):p;if(!i||!Pt(d,_)){var _=d;m[a++]=p===0?0:p}}return m}function Ba(e){return typeof e=="number"?e:ut(e)?vr:+e}function ct(e){if(typeof e=="string")return e;if(Q(e))return he(e,ct)+"";if(ut(e))return aa?aa.call(e):"";var t=e+"";return t=="0"&&1/e==-Wi?"-0":t}function Ei(e,t,i){var l=-1,a=wr,m=e.length,p=!0,d=[],_=d;if(i)p=!1,a=ll;else if(m>=n){var I=t?null:n0(e);if(I)return Br(I);p=!1,a=Qn,_=new ji}else _=t?[]:d;e:for(;++l<m;){var w=e[l],A=t?t(w):w;if(w=i||w!==0?w:0,p&&A===A){for(var N=_.length;N--;)if(_[N]===A)continue e;t&&_.push(A),d.push(w)}else a(_,A,i)||(_!==d&&_.push(A),d.push(w))}return d}function Dl(e,t){return t=Ii(t,e),e=rc(e,t),e==null||delete e[kt(vt(t))]}function Ra(e,t,i,l){return lr(e,t,i(Yi(e,t)),l)}function Qr(e,t,i,l){for(var a=e.length,m=l?a:-1;(l?m--:++m<a)&&t(e[m],m,e););return i?Tt(e,l?0:m,l?m+1:a):Tt(e,l?m+1:0,l?a:m)}function Da(e,t){var i=e;return i instanceof ie&&(i=i.value()),sl(t,function(l,a){return a.func.apply(a.thisArg,xi([l],a.args))},i)}function Ol(e,t,i){var l=e.length;if(l<2)return l?Ei(e[0]):[];for(var a=-1,m=C(l);++a<l;)for(var p=e[a],d=-1;++d<l;)d!=a&&(m[a]=nr(m[a]||p,e[d],t,i));return Ei(Ne(m,1),t,i)}function Oa(e,t,i){for(var l=-1,a=e.length,m=t.length,p={};++l<a;){var d=l<m?t[l]:o;i(p,e[l],d)}return p}function Ll(e){return Ee(e)?e:[]}function Nl(e){return typeof e=="function"?e:Xe}function Ii(e,t){return Q(e)?e:Gl(e,t)?[e]:ac(ce(e))}var zf=ee;function wi(e,t,i){var l=e.length;return i=i===o?l:i,!t&&i>=l?e:Tt(e,t,i)}var La=Op||function(e){return Re.clearTimeout(e)};function Na(e,t){if(t)return e.slice();var i=e.length,l=ia?ia(i):new e.constructor(i);return e.copy(l),l}function Fl(e){var t=new e.constructor(e.byteLength);return new Fr(t).set(new Fr(e)),t}function Yf(e,t){var i=t?Fl(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}function Kf(e){var t=new e.constructor(e.source,hs.exec(e));return t.lastIndex=e.lastIndex,t}function Qf(e){return tr?fe(tr.call(e)):{}}function Fa(e,t){var i=t?Fl(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}function Ua(e,t){if(e!==t){var i=e!==o,l=e===null,a=e===e,m=ut(e),p=t!==o,d=t===null,_=t===t,I=ut(t);if(!d&&!I&&!m&&e>t||m&&p&&_&&!d&&!I||l&&p&&_||!i&&_||!a)return 1;if(!l&&!m&&!I&&e<t||I&&i&&a&&!l&&!m||d&&i&&a||!p&&a||!_)return-1}return 0}function Zf(e,t,i){for(var l=-1,a=e.criteria,m=t.criteria,p=a.length,d=i.length;++l<p;){var _=Ua(a[l],m[l]);if(_){if(l>=d)return _;var I=i[l];return _*(I=="desc"?-1:1)}}return e.index-t.index}function Pa(e,t,i,l){for(var a=-1,m=e.length,p=i.length,d=-1,_=t.length,I=Be(m-p,0),w=C(_+I),A=!l;++d<_;)w[d]=t[d];for(;++a<p;)(A||a<m)&&(w[i[a]]=e[a]);for(;I--;)w[d++]=e[a++];return w}function qa(e,t,i,l){for(var a=-1,m=e.length,p=-1,d=i.length,_=-1,I=t.length,w=Be(m-d,0),A=C(w+I),N=!l;++a<w;)A[a]=e[a];for(var q=a;++_<I;)A[q+_]=t[_];for(;++p<d;)(N||a<m)&&(A[q+i[p]]=e[a++]);return A}function Ke(e,t){var i=-1,l=e.length;for(t||(t=C(l));++i<l;)t[i]=e[i];return t}function Gt(e,t,i,l){var a=!i;i||(i={});for(var m=-1,p=t.length;++m<p;){var d=t[m],_=l?l(i[d],e[d],d,i,e):o;_===o&&(_=e[d]),a?ai(i,d,_):ir(i,d,_)}return i}function Xf(e,t){return Gt(e,Vl(e),t)}function Jf(e,t){return Gt(e,Xa(e),t)}function Zr(e,t){return function(i,l){var a=Q(i)?np:xf,m=t?t():{};return a(i,e,k(l,2),m)}}function fn(e){return ee(function(t,i){var l=-1,a=i.length,m=a>1?i[a-1]:o,p=a>2?i[2]:o;for(m=e.length>3&&typeof m=="function"?(a--,m):o,p&&je(i[0],i[1],p)&&(m=a<3?o:m,a=1),t=fe(t);++l<a;){var d=i[l];d&&e(t,d,l,m)}return t})}function $a(e,t){return function(i,l){if(i==null)return i;if(!Qe(i))return e(i,l);for(var a=i.length,m=t?a:-1,p=fe(i);(t?m--:++m<a)&&l(p[m],m,p)!==!1;);return i}}function Ha(e){return function(t,i,l){for(var a=-1,m=fe(t),p=l(t),d=p.length;d--;){var _=p[e?d:++a];if(i(m[_],_,m)===!1)break}return t}}function e0(e,t,i){var l=t&Ge,a=sr(e);function m(){var p=this&&this!==Re&&this instanceof m?a:e;return p.apply(l?i:this,arguments)}return m}function Wa(e){return function(t){t=ce(t);var i=sn(t)?Ft(t):o,l=i?i[0]:t.charAt(0),a=i?wi(i,1).join(""):t.slice(1);return l[e]()+a}}function dn(e){return function(t){return sl($c(qc(t).replace(Vm,"")),e,"")}}function sr(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var i=pn(e.prototype),l=e.apply(i,t);return ve(l)?l:i}}function t0(e,t,i){var l=sr(e);function a(){for(var m=arguments.length,p=C(m),d=m,_=gn(a);d--;)p[d]=arguments[d];var I=m<3&&p[0]!==_&&p[m-1]!==_?[]:Ci(p,_);if(m-=I.length,m<i)return za(e,t,Xr,a.placeholder,o,p,I,o,o,i-m);var w=this&&this!==Re&&this instanceof a?l:e;return st(w,this,p)}return a}function Va(e){return function(t,i,l){var a=fe(t);if(!Qe(t)){var m=k(i,3);t=De(t),i=function(d){return m(a[d],d,a)}}var p=e(t,i,l);return p>-1?a[m?t[p]:p]:o}}function Ga(e){return ui(function(t){var i=t.length,l=i,a=_t.prototype.thru;for(e&&t.reverse();l--;){var m=t[l];if(typeof m!="function")throw new bt(c);if(a&&!p&&io(m)=="wrapper")var p=new _t([],!0)}for(l=p?l:i;++l<i;){m=t[l];var d=io(m),_=d=="wrapper"?Hl(m):o;_&&kl(_[0])&&_[1]==(ft|ot|lt|Wn)&&!_[4].length&&_[9]==1?p=p[io(_[0])].apply(p,_[3]):p=m.length==1&&kl(m)?p[d]():p.thru(m)}return function(){var I=arguments,w=I[0];if(p&&I.length==1&&Q(w))return p.plant(w).value();for(var A=0,N=i?t[A].apply(this,I):w;++A<i;)N=t[A].call(this,N);return N}})}function Xr(e,t,i,l,a,m,p,d,_,I){var w=t&ft,A=t&Ge,N=t&Ht,q=t&(ot|ni),z=t&Ho,J=N?o:sr(e);function Y(){for(var te=arguments.length,ne=C(te),mt=te;mt--;)ne[mt]=arguments[mt];if(q)var ze=gn(Y),pt=pp(ne,ze);if(l&&(ne=Pa(ne,l,a,q)),m&&(ne=qa(ne,m,p,q)),te-=pt,q&&te<I){var Ie=Ci(ne,ze);return za(e,t,Xr,Y.placeholder,i,ne,Ie,d,_,I-te)}var qt=A?i:this,di=N?qt[e]:e;return te=ne.length,d?ne=x0(ne,d):z&&te>1&&ne.reverse(),w&&_<te&&(ne.length=_),this&&this!==Re&&this instanceof Y&&(di=J||sr(di)),di.apply(qt,ne)}return Y}function ka(e,t){return function(i,l){return Af(i,e,t(l),{})}}function Jr(e,t){return function(i,l){var a;if(i===o&&l===o)return t;if(i!==o&&(a=i),l!==o){if(a===o)return l;typeof i=="string"||typeof l=="string"?(i=ct(i),l=ct(l)):(i=Ba(i),l=Ba(l)),a=e(i,l)}return a}}function Ul(e){return ui(function(t){return t=he(t,at(k())),ee(function(i){var l=this;return e(t,function(a){return st(a,l,i)})})})}function eo(e,t){t=t===o?" ":ct(t);var i=t.length;if(i<2)return i?Bl(t,e):t;var l=Bl(t,$r(e/an(t)));return sn(t)?wi(Ft(l),0,e).join(""):l.slice(0,e)}function i0(e,t,i,l){var a=t&Ge,m=sr(e);function p(){for(var d=-1,_=arguments.length,I=-1,w=l.length,A=C(w+_),N=this&&this!==Re&&this instanceof p?m:e;++I<w;)A[I]=l[I];for(;_--;)A[I++]=arguments[++d];return st(N,a?i:this,A)}return p}function ja(e){return function(t,i,l){return l&&typeof l!="number"&&je(t,i,l)&&(i=l=o),t=fi(t),i===o?(i=t,t=0):i=fi(i),l=l===o?t<i?1:-1:fi(l),Hf(t,i,l,e)}}function to(e){return function(t,i){return typeof t=="string"&&typeof i=="string"||(t=xt(t),i=xt(i)),e(t,i)}}function za(e,t,i,l,a,m,p,d,_,I){var w=t&ot,A=w?p:o,N=w?o:p,q=w?m:o,z=w?o:m;t|=w?lt:ri,t&=~(w?ri:lt),t&Hn||(t&=~(Ge|Ht));var J=[e,t,a,q,A,z,N,d,_,I],Y=i.apply(o,J);return kl(e)&&oc(Y,J),Y.placeholder=l,lc(Y,e,t)}function Pl(e){var t=Ae[e];return function(i,l){if(i=xt(i),l=l==null?0:$e(X(l),292),l&&la(i)){var a=(ce(i)+"e").split("e"),m=t(a[0]+"e"+(+a[1]+l));return a=(ce(m)+"e").split("e"),+(a[0]+"e"+(+a[1]-l))}return t(i)}}var n0=un&&1/Br(new un([,-0]))[1]==Wi?function(e){return new un(e)}:ls;function Ya(e){return function(t){var i=He(t);return i==Lt?dl(t):i==Nt?Tp(t):mp(t,e(t))}}function ci(e,t,i,l,a,m,p,d){var _=t&Ht;if(!_&&typeof e!="function")throw new bt(c);var I=l?l.length:0;if(I||(t&=~(lt|ri),l=a=o),p=p===o?p:Be(X(p),0),d=d===o?d:X(d),I-=a?a.length:0,t&ri){var w=l,A=a;l=a=o}var N=_?o:Hl(e),q=[e,t,i,l,a,w,A,m,p,d];if(N&&h0(q,N),e=q[0],t=q[1],i=q[2],l=q[3],a=q[4],d=q[9]=q[9]===o?_?0:e.length:Be(q[9]-I,0),!d&&t&(ot|ni)&&(t&=~(ot|ni)),!t||t==Ge)var z=e0(e,t,i);else t==ot||t==ni?z=t0(e,t,d):(t==lt||t==(Ge|lt))&&!a.length?z=i0(e,t,i,l):z=Xr.apply(o,q);var J=N?wa:oc;return lc(J(z,q),e,t)}function Ka(e,t,i,l){return e===o||Pt(e,cn[i])&&!me.call(l,i)?t:e}function Qa(e,t,i,l,a,m){return ve(e)&&ve(t)&&(m.set(t,e),Yr(e,t,o,Qa,m),m.delete(t)),e}function r0(e){return ur(e)?o:e}function Za(e,t,i,l,a,m){var p=i&rt,d=e.length,_=t.length;if(d!=_&&!(p&&_>d))return!1;var I=m.get(e),w=m.get(t);if(I&&w)return I==t&&w==e;var A=-1,N=!0,q=i&ii?new ji:o;for(m.set(e,t),m.set(t,e);++A<d;){var z=e[A],J=t[A];if(l)var Y=p?l(J,z,A,t,e,m):l(z,J,A,e,t,m);if(Y!==o){if(Y)continue;N=!1;break}if(q){if(!al(t,function(te,ne){if(!Qn(q,ne)&&(z===te||a(z,te,i,l,m)))return q.push(ne)})){N=!1;break}}else if(!(z===J||a(z,J,i,l,m))){N=!1;break}}return m.delete(e),m.delete(t),N}function o0(e,t,i,l,a,m,p){switch(i){case rn:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Kn:return!(e.byteLength!=t.byteLength||!m(new Fr(e),new Fr(t)));case Vn:case Gn:case kn:return Pt(+e,+t);case Cr:return e.name==t.name&&e.message==t.message;case jn:case zn:return e==t+"";case Lt:var d=dl;case Nt:var _=l&rt;if(d||(d=Br),e.size!=t.size&&!_)return!1;var I=p.get(e);if(I)return I==t;l|=ii,p.set(e,t);var w=Za(d(e),d(t),l,a,m,p);return p.delete(e),w;case Sr:if(tr)return tr.call(e)==tr.call(t)}return!1}function l0(e,t,i,l,a,m){var p=i&rt,d=ql(e),_=d.length,I=ql(t),w=I.length;if(_!=w&&!p)return!1;for(var A=_;A--;){var N=d[A];if(!(p?N in t:me.call(t,N)))return!1}var q=m.get(e),z=m.get(t);if(q&&z)return q==t&&z==e;var J=!0;m.set(e,t),m.set(t,e);for(var Y=p;++A<_;){N=d[A];var te=e[N],ne=t[N];if(l)var mt=p?l(ne,te,N,t,e,m):l(te,ne,N,e,t,m);if(!(mt===o?te===ne||a(te,ne,i,l,m):mt)){J=!1;break}Y||(Y=N=="constructor")}if(J&&!Y){var ze=e.constructor,pt=t.constructor;ze!=pt&&"constructor"in e&&"constructor"in t&&!(typeof ze=="function"&&ze instanceof ze&&typeof pt=="function"&&pt instanceof pt)&&(J=!1)}return m.delete(e),m.delete(t),J}function ui(e){return zl(nc(e,o,pc),e+"")}function ql(e){return _a(e,De,Vl)}function $l(e){return _a(e,Ze,Xa)}var Hl=Wr?function(e){return Wr.get(e)}:ls;function io(e){for(var t=e.name+"",i=mn[t],l=me.call(mn,t)?i.length:0;l--;){var a=i[l],m=a.func;if(m==null||m==e)return a.name}return t}function gn(e){var t=me.call(u,"placeholder")?u:e;return t.placeholder}function k(){var e=u.iteratee||rs;return e=e===rs?va:e,arguments.length?e(arguments[0],arguments[1]):e}function no(e,t){var i=e.__data__;return d0(t)?i[typeof t=="string"?"string":"hash"]:i.map}function Wl(e){for(var t=De(e),i=t.length;i--;){var l=t[i],a=e[l];t[i]=[l,a,tc(a)]}return t}function Ki(e,t){var i=bp(e,t);return Ta(i)?i:o}function s0(e){var t=me.call(e,Gi),i=e[Gi];try{e[Gi]=o;var l=!0}catch{}var a=Lr.call(e);return l&&(t?e[Gi]=i:delete e[Gi]),a}var Vl=bl?function(e){return e==null?[]:(e=fe(e),vi(bl(e),function(t){return ra.call(e,t)}))}:ss,Xa=bl?function(e){for(var t=[];e;)xi(t,Vl(e)),e=Ur(e);return t}:ss,He=ke;(_l&&He(new _l(new ArrayBuffer(1)))!=rn||Xn&&He(new Xn)!=Lt||hl&&He(hl.resolve())!=ds||un&&He(new un)!=Nt||Jn&&He(new Jn)!=Yn)&&(He=function(e){var t=ke(e),i=t==oi?e.constructor:o,l=i?Qi(i):"";if(l)switch(l){case Wp:return rn;case Vp:return Lt;case Gp:return ds;case kp:return Nt;case jp:return Yn}return t});function a0(e,t,i){for(var l=-1,a=i.length;++l<a;){var m=i[l],p=m.size;switch(m.type){case"drop":e+=p;break;case"dropRight":t-=p;break;case"take":t=$e(t,e+p);break;case"takeRight":e=Be(e,t-p);break}}return{start:e,end:t}}function c0(e){var t=e.match(dm);return t?t[1].split(gm):[]}function Ja(e,t,i){t=Ii(t,e);for(var l=-1,a=t.length,m=!1;++l<a;){var p=kt(t[l]);if(!(m=e!=null&&i(e,p)))break;e=e[p]}return m||++l!=a?m:(a=e==null?0:e.length,!!a&&uo(a)&&mi(p,a)&&(Q(e)||Zi(e)))}function u0(e){var t=e.length,i=new e.constructor(t);return t&&typeof e[0]=="string"&&me.call(e,"index")&&(i.index=e.index,i.input=e.input),i}function ec(e){return typeof e.constructor=="function"&&!ar(e)?pn(Ur(e)):{}}function m0(e,t,i){var l=e.constructor;switch(t){case Kn:return Fl(e);case Vn:case Gn:return new l(+e);case rn:return Yf(e,i);case Wo:case Vo:case Go:case ko:case jo:case zo:case Yo:case Ko:case Qo:return Fa(e,i);case Lt:return new l;case kn:case zn:return new l(e);case jn:return Kf(e);case Nt:return new l;case Sr:return Qf(e)}}function p0(e,t){var i=t.length;if(!i)return e;var l=i-1;return t[l]=(i>1?"& ":"")+t[l],t=t.join(i>2?", ":" "),e.replace(fm,`{
/* [wrapped with `+t+`] */
`)}function f0(e){return Q(e)||Zi(e)||!!(oa&&e&&e[oa])}function mi(e,t){var i=typeof e;return t=t??Ti,!!t&&(i=="number"||i!="symbol"&&Sm.test(e))&&e>-1&&e%1==0&&e<t}function je(e,t,i){if(!ve(i))return!1;var l=typeof t;return(l=="number"?Qe(i)&&mi(t,i.length):l=="string"&&t in i)?Pt(i[t],e):!1}function Gl(e,t){if(Q(e))return!1;var i=typeof e;return i=="number"||i=="symbol"||i=="boolean"||e==null||ut(e)?!0:cm.test(e)||!am.test(e)||t!=null&&e in fe(t)}function d0(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function kl(e){var t=io(e),i=u[t];if(typeof i!="function"||!(t in ie.prototype))return!1;if(e===i)return!0;var l=Hl(i);return!!l&&e===l[0]}function g0(e){return!!ta&&ta in e}var b0=Dr?pi:as;function ar(e){var t=e&&e.constructor,i=typeof t=="function"&&t.prototype||cn;return e===i}function tc(e){return e===e&&!ve(e)}function ic(e,t){return function(i){return i==null?!1:i[e]===t&&(t!==o||e in fe(i))}}function _0(e){var t=ao(e,function(l){return i.size===E&&i.clear(),l}),i=t.cache;return t}function h0(e,t){var i=e[1],l=t[1],a=i|l,m=a<(Ge|Ht|ft),p=l==ft&&i==ot||l==ft&&i==Wn&&e[7].length<=t[8]||l==(ft|Wn)&&t[7].length<=t[8]&&i==ot;if(!(m||p))return e;l&Ge&&(e[2]=t[2],a|=i&Ge?0:Hn);var d=t[3];if(d){var _=e[3];e[3]=_?Pa(_,d,t[4]):d,e[4]=_?Ci(e[3],R):t[4]}return d=t[5],d&&(_=e[5],e[5]=_?qa(_,d,t[6]):d,e[6]=_?Ci(e[5],R):t[6]),d=t[7],d&&(e[7]=d),l&ft&&(e[8]=e[8]==null?t[8]:$e(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=a,e}function T0(e){var t=[];if(e!=null)for(var i in fe(e))t.push(i);return t}function v0(e){return Lr.call(e)}function nc(e,t,i){return t=Be(t===o?e.length-1:t,0),function(){for(var l=arguments,a=-1,m=Be(l.length-t,0),p=C(m);++a<m;)p[a]=l[t+a];a=-1;for(var d=C(t+1);++a<t;)d[a]=l[a];return d[t]=i(p),st(e,this,d)}}function rc(e,t){return t.length<2?e:Yi(e,Tt(t,0,-1))}function x0(e,t){for(var i=e.length,l=$e(t.length,i),a=Ke(e);l--;){var m=t[l];e[l]=mi(m,i)?a[m]:o}return e}function jl(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var oc=sc(wa),cr=Np||function(e,t){return Re.setTimeout(e,t)},zl=sc(Gf);function lc(e,t,i){var l=t+"";return zl(e,p0(l,C0(c0(l),i)))}function sc(e){var t=0,i=0;return function(){var l=qp(),a=Wu-(l-i);if(i=l,a>0){if(++t>=Hu)return arguments[0]}else t=0;return e.apply(o,arguments)}}function ro(e,t){var i=-1,l=e.length,a=l-1;for(t=t===o?l:t;++i<t;){var m=Al(i,a),p=e[m];e[m]=e[i],e[i]=p}return e.length=t,e}var ac=_0(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(um,function(i,l,a,m){t.push(a?m.replace(hm,"$1"):l||i)}),t});function kt(e){if(typeof e=="string"||ut(e))return e;var t=e+"";return t=="0"&&1/e==-Wi?"-0":t}function Qi(e){if(e!=null){try{return Or.call(e)}catch{}try{return e+""}catch{}}return""}function C0(e,t){return gt(Yu,function(i){var l="_."+i[0];t&i[1]&&!wr(e,l)&&e.push(l)}),e.sort()}function cc(e){if(e instanceof ie)return e.clone();var t=new _t(e.__wrapped__,e.__chain__);return t.__actions__=Ke(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function y0(e,t,i){(i?je(e,t,i):t===o)?t=1:t=Be(X(t),0);var l=e==null?0:e.length;if(!l||t<1)return[];for(var a=0,m=0,p=C($r(l/t));a<l;)p[m++]=Tt(e,a,a+=t);return p}function S0(e){for(var t=-1,i=e==null?0:e.length,l=0,a=[];++t<i;){var m=e[t];m&&(a[l++]=m)}return a}function M0(){var e=arguments.length;if(!e)return[];for(var t=C(e-1),i=arguments[0],l=e;l--;)t[l-1]=arguments[l];return xi(Q(i)?Ke(i):[i],Ne(t,1))}var E0=ee(function(e,t){return Ee(e)?nr(e,Ne(t,1,Ee,!0)):[]}),I0=ee(function(e,t){var i=vt(t);return Ee(i)&&(i=o),Ee(e)?nr(e,Ne(t,1,Ee,!0),k(i,2)):[]}),w0=ee(function(e,t){var i=vt(t);return Ee(i)&&(i=o),Ee(e)?nr(e,Ne(t,1,Ee,!0),o,i):[]});function A0(e,t,i){var l=e==null?0:e.length;return l?(t=i||t===o?1:X(t),Tt(e,t<0?0:t,l)):[]}function B0(e,t,i){var l=e==null?0:e.length;return l?(t=i||t===o?1:X(t),t=l-t,Tt(e,0,t<0?0:t)):[]}function R0(e,t){return e&&e.length?Qr(e,k(t,3),!0,!0):[]}function D0(e,t){return e&&e.length?Qr(e,k(t,3),!0):[]}function O0(e,t,i,l){var a=e==null?0:e.length;return a?(i&&typeof i!="number"&&je(e,t,i)&&(i=0,l=a),Mf(e,t,i,l)):[]}function uc(e,t,i){var l=e==null?0:e.length;if(!l)return-1;var a=i==null?0:X(i);return a<0&&(a=Be(l+a,0)),Ar(e,k(t,3),a)}function mc(e,t,i){var l=e==null?0:e.length;if(!l)return-1;var a=l-1;return i!==o&&(a=X(i),a=i<0?Be(l+a,0):$e(a,l-1)),Ar(e,k(t,3),a,!0)}function pc(e){var t=e==null?0:e.length;return t?Ne(e,1):[]}function L0(e){var t=e==null?0:e.length;return t?Ne(e,Wi):[]}function N0(e,t){var i=e==null?0:e.length;return i?(t=t===o?1:X(t),Ne(e,t)):[]}function F0(e){for(var t=-1,i=e==null?0:e.length,l={};++t<i;){var a=e[t];l[a[0]]=a[1]}return l}function fc(e){return e&&e.length?e[0]:o}function U0(e,t,i){var l=e==null?0:e.length;if(!l)return-1;var a=i==null?0:X(i);return a<0&&(a=Be(l+a,0)),ln(e,t,a)}function P0(e){var t=e==null?0:e.length;return t?Tt(e,0,-1):[]}var q0=ee(function(e){var t=he(e,Ll);return t.length&&t[0]===e[0]?Sl(t):[]}),$0=ee(function(e){var t=vt(e),i=he(e,Ll);return t===vt(i)?t=o:i.pop(),i.length&&i[0]===e[0]?Sl(i,k(t,2)):[]}),H0=ee(function(e){var t=vt(e),i=he(e,Ll);return t=typeof t=="function"?t:o,t&&i.pop(),i.length&&i[0]===e[0]?Sl(i,o,t):[]});function W0(e,t){return e==null?"":Up.call(e,t)}function vt(e){var t=e==null?0:e.length;return t?e[t-1]:o}function V0(e,t,i){var l=e==null?0:e.length;if(!l)return-1;var a=l;return i!==o&&(a=X(i),a=a<0?Be(l+a,0):$e(a,l-1)),t===t?xp(e,t,a):Ar(e,zs,a,!0)}function G0(e,t){return e&&e.length?Sa(e,X(t)):o}var k0=ee(dc);function dc(e,t){return e&&e.length&&t&&t.length?wl(e,t):e}function j0(e,t,i){return e&&e.length&&t&&t.length?wl(e,t,k(i,2)):e}function z0(e,t,i){return e&&e.length&&t&&t.length?wl(e,t,o,i):e}var Y0=ui(function(e,t){var i=e==null?0:e.length,l=vl(e,t);return Ia(e,he(t,function(a){return mi(a,i)?+a:a}).sort(Ua)),l});function K0(e,t){var i=[];if(!(e&&e.length))return i;var l=-1,a=[],m=e.length;for(t=k(t,3);++l<m;){var p=e[l];t(p,l,e)&&(i.push(p),a.push(l))}return Ia(e,a),i}function Yl(e){return e==null?e:Hp.call(e)}function Q0(e,t,i){var l=e==null?0:e.length;return l?(i&&typeof i!="number"&&je(e,t,i)?(t=0,i=l):(t=t==null?0:X(t),i=i===o?l:X(i)),Tt(e,t,i)):[]}function Z0(e,t){return Kr(e,t)}function X0(e,t,i){return Rl(e,t,k(i,2))}function J0(e,t){var i=e==null?0:e.length;if(i){var l=Kr(e,t);if(l<i&&Pt(e[l],t))return l}return-1}function ed(e,t){return Kr(e,t,!0)}function td(e,t,i){return Rl(e,t,k(i,2),!0)}function id(e,t){var i=e==null?0:e.length;if(i){var l=Kr(e,t,!0)-1;if(Pt(e[l],t))return l}return-1}function nd(e){return e&&e.length?Aa(e):[]}function rd(e,t){return e&&e.length?Aa(e,k(t,2)):[]}function od(e){var t=e==null?0:e.length;return t?Tt(e,1,t):[]}function ld(e,t,i){return e&&e.length?(t=i||t===o?1:X(t),Tt(e,0,t<0?0:t)):[]}function sd(e,t,i){var l=e==null?0:e.length;return l?(t=i||t===o?1:X(t),t=l-t,Tt(e,t<0?0:t,l)):[]}function ad(e,t){return e&&e.length?Qr(e,k(t,3),!1,!0):[]}function cd(e,t){return e&&e.length?Qr(e,k(t,3)):[]}var ud=ee(function(e){return Ei(Ne(e,1,Ee,!0))}),md=ee(function(e){var t=vt(e);return Ee(t)&&(t=o),Ei(Ne(e,1,Ee,!0),k(t,2))}),pd=ee(function(e){var t=vt(e);return t=typeof t=="function"?t:o,Ei(Ne(e,1,Ee,!0),o,t)});function fd(e){return e&&e.length?Ei(e):[]}function dd(e,t){return e&&e.length?Ei(e,k(t,2)):[]}function gd(e,t){return t=typeof t=="function"?t:o,e&&e.length?Ei(e,o,t):[]}function Kl(e){if(!(e&&e.length))return[];var t=0;return e=vi(e,function(i){if(Ee(i))return t=Be(i.length,t),!0}),pl(t,function(i){return he(e,cl(i))})}function gc(e,t){if(!(e&&e.length))return[];var i=Kl(e);return t==null?i:he(i,function(l){return st(t,o,l)})}var bd=ee(function(e,t){return Ee(e)?nr(e,t):[]}),_d=ee(function(e){return Ol(vi(e,Ee))}),hd=ee(function(e){var t=vt(e);return Ee(t)&&(t=o),Ol(vi(e,Ee),k(t,2))}),Td=ee(function(e){var t=vt(e);return t=typeof t=="function"?t:o,Ol(vi(e,Ee),o,t)}),vd=ee(Kl);function xd(e,t){return Oa(e||[],t||[],ir)}function Cd(e,t){return Oa(e||[],t||[],lr)}var yd=ee(function(e){var t=e.length,i=t>1?e[t-1]:o;return i=typeof i=="function"?(e.pop(),i):o,gc(e,i)});function bc(e){var t=u(e);return t.__chain__=!0,t}function Sd(e,t){return t(e),e}function oo(e,t){return t(e)}var Md=ui(function(e){var t=e.length,i=t?e[0]:0,l=this.__wrapped__,a=function(m){return vl(m,e)};return t>1||this.__actions__.length||!(l instanceof ie)||!mi(i)?this.thru(a):(l=l.slice(i,+i+(t?1:0)),l.__actions__.push({func:oo,args:[a],thisArg:o}),new _t(l,this.__chain__).thru(function(m){return t&&!m.length&&m.push(o),m}))});function Ed(){return bc(this)}function Id(){return new _t(this.value(),this.__chain__)}function wd(){this.__values__===o&&(this.__values__=Bc(this.value()));var e=this.__index__>=this.__values__.length,t=e?o:this.__values__[this.__index__++];return{done:e,value:t}}function Ad(){return this}function Bd(e){for(var t,i=this;i instanceof Gr;){var l=cc(i);l.__index__=0,l.__values__=o,t?a.__wrapped__=l:t=l;var a=l;i=i.__wrapped__}return a.__wrapped__=e,t}function Rd(){var e=this.__wrapped__;if(e instanceof ie){var t=e;return this.__actions__.length&&(t=new ie(this)),t=t.reverse(),t.__actions__.push({func:oo,args:[Yl],thisArg:o}),new _t(t,this.__chain__)}return this.thru(Yl)}function Dd(){return Da(this.__wrapped__,this.__actions__)}var Od=Zr(function(e,t,i){me.call(e,i)?++e[i]:ai(e,i,1)});function Ld(e,t,i){var l=Q(e)?ks:Sf;return i&&je(e,t,i)&&(t=o),l(e,k(t,3))}function Nd(e,t){var i=Q(e)?vi:ga;return i(e,k(t,3))}var Fd=Va(uc),Ud=Va(mc);function Pd(e,t){return Ne(lo(e,t),1)}function qd(e,t){return Ne(lo(e,t),Wi)}function $d(e,t,i){return i=i===o?1:X(i),Ne(lo(e,t),i)}function _c(e,t){var i=Q(e)?gt:Mi;return i(e,k(t,3))}function hc(e,t){var i=Q(e)?rp:da;return i(e,k(t,3))}var Hd=Zr(function(e,t,i){me.call(e,i)?e[i].push(t):ai(e,i,[t])});function Wd(e,t,i,l){e=Qe(e)?e:_n(e),i=i&&!l?X(i):0;var a=e.length;return i<0&&(i=Be(a+i,0)),mo(e)?i<=a&&e.indexOf(t,i)>-1:!!a&&ln(e,t,i)>-1}var Vd=ee(function(e,t,i){var l=-1,a=typeof t=="function",m=Qe(e)?C(e.length):[];return Mi(e,function(p){m[++l]=a?st(t,p,i):rr(p,t,i)}),m}),Gd=Zr(function(e,t,i){ai(e,i,t)});function lo(e,t){var i=Q(e)?he:xa;return i(e,k(t,3))}function kd(e,t,i,l){return e==null?[]:(Q(t)||(t=t==null?[]:[t]),i=l?o:i,Q(i)||(i=i==null?[]:[i]),Ma(e,t,i))}var jd=Zr(function(e,t,i){e[i?0:1].push(t)},function(){return[[],[]]});function zd(e,t,i){var l=Q(e)?sl:Ks,a=arguments.length<3;return l(e,k(t,4),i,a,Mi)}function Yd(e,t,i){var l=Q(e)?op:Ks,a=arguments.length<3;return l(e,k(t,4),i,a,da)}function Kd(e,t){var i=Q(e)?vi:ga;return i(e,co(k(t,3)))}function Qd(e){var t=Q(e)?ua:Wf;return t(e)}function Zd(e,t,i){(i?je(e,t,i):t===o)?t=1:t=X(t);var l=Q(e)?Tf:Vf;return l(e,t)}function Xd(e){var t=Q(e)?vf:kf;return t(e)}function Jd(e){if(e==null)return 0;if(Qe(e))return mo(e)?an(e):e.length;var t=He(e);return t==Lt||t==Nt?e.size:El(e).length}function eg(e,t,i){var l=Q(e)?al:jf;return i&&je(e,t,i)&&(t=o),l(e,k(t,3))}var tg=ee(function(e,t){if(e==null)return[];var i=t.length;return i>1&&je(e,t[0],t[1])?t=[]:i>2&&je(t[0],t[1],t[2])&&(t=[t[0]]),Ma(e,Ne(t,1),[])}),so=Lp||function(){return Re.Date.now()};function ig(e,t){if(typeof t!="function")throw new bt(c);return e=X(e),function(){if(--e<1)return t.apply(this,arguments)}}function Tc(e,t,i){return t=i?o:t,t=e&&t==null?e.length:t,ci(e,ft,o,o,o,o,t)}function vc(e,t){var i;if(typeof t!="function")throw new bt(c);return e=X(e),function(){return--e>0&&(i=t.apply(this,arguments)),e<=1&&(t=o),i}}var Ql=ee(function(e,t,i){var l=Ge;if(i.length){var a=Ci(i,gn(Ql));l|=lt}return ci(e,l,t,i,a)}),xc=ee(function(e,t,i){var l=Ge|Ht;if(i.length){var a=Ci(i,gn(xc));l|=lt}return ci(t,l,e,i,a)});function Cc(e,t,i){t=i?o:t;var l=ci(e,ot,o,o,o,o,o,t);return l.placeholder=Cc.placeholder,l}function yc(e,t,i){t=i?o:t;var l=ci(e,ni,o,o,o,o,o,t);return l.placeholder=yc.placeholder,l}function Sc(e,t,i){var l,a,m,p,d,_,I=0,w=!1,A=!1,N=!0;if(typeof e!="function")throw new bt(c);t=xt(t)||0,ve(i)&&(w=!!i.leading,A="maxWait"in i,m=A?Be(xt(i.maxWait)||0,t):m,N="trailing"in i?!!i.trailing:N);function q(Ie){var qt=l,di=a;return l=a=o,I=Ie,p=e.apply(di,qt),p}function z(Ie){return I=Ie,d=cr(te,t),w?q(Ie):p}function J(Ie){var qt=Ie-_,di=Ie-I,Vc=t-qt;return A?$e(Vc,m-di):Vc}function Y(Ie){var qt=Ie-_,di=Ie-I;return _===o||qt>=t||qt<0||A&&di>=m}function te(){var Ie=so();if(Y(Ie))return ne(Ie);d=cr(te,J(Ie))}function ne(Ie){return d=o,N&&l?q(Ie):(l=a=o,p)}function mt(){d!==o&&La(d),I=0,l=_=a=d=o}function ze(){return d===o?p:ne(so())}function pt(){var Ie=so(),qt=Y(Ie);if(l=arguments,a=this,_=Ie,qt){if(d===o)return z(_);if(A)return La(d),d=cr(te,t),q(_)}return d===o&&(d=cr(te,t)),p}return pt.cancel=mt,pt.flush=ze,pt}var ng=ee(function(e,t){return fa(e,1,t)}),rg=ee(function(e,t,i){return fa(e,xt(t)||0,i)});function og(e){return ci(e,Ho)}function ao(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new bt(c);var i=function(){var l=arguments,a=t?t.apply(this,l):l[0],m=i.cache;if(m.has(a))return m.get(a);var p=e.apply(this,l);return i.cache=m.set(a,p)||m,p};return i.cache=new(ao.Cache||si),i}ao.Cache=si;function co(e){if(typeof e!="function")throw new bt(c);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function lg(e){return vc(2,e)}var sg=zf(function(e,t){t=t.length==1&&Q(t[0])?he(t[0],at(k())):he(Ne(t,1),at(k()));var i=t.length;return ee(function(l){for(var a=-1,m=$e(l.length,i);++a<m;)l[a]=t[a].call(this,l[a]);return st(e,this,l)})}),Zl=ee(function(e,t){var i=Ci(t,gn(Zl));return ci(e,lt,o,t,i)}),Mc=ee(function(e,t){var i=Ci(t,gn(Mc));return ci(e,ri,o,t,i)}),ag=ui(function(e,t){return ci(e,Wn,o,o,o,t)});function cg(e,t){if(typeof e!="function")throw new bt(c);return t=t===o?t:X(t),ee(e,t)}function ug(e,t){if(typeof e!="function")throw new bt(c);return t=t==null?0:Be(X(t),0),ee(function(i){var l=i[t],a=wi(i,0,t);return l&&xi(a,l),st(e,this,a)})}function mg(e,t,i){var l=!0,a=!0;if(typeof e!="function")throw new bt(c);return ve(i)&&(l="leading"in i?!!i.leading:l,a="trailing"in i?!!i.trailing:a),Sc(e,t,{leading:l,maxWait:t,trailing:a})}function pg(e){return Tc(e,1)}function fg(e,t){return Zl(Nl(t),e)}function dg(){if(!arguments.length)return[];var e=arguments[0];return Q(e)?e:[e]}function gg(e){return ht(e,Z)}function bg(e,t){return t=typeof t=="function"?t:o,ht(e,Z,t)}function _g(e){return ht(e,F|Z)}function hg(e,t){return t=typeof t=="function"?t:o,ht(e,F|Z,t)}function Tg(e,t){return t==null||pa(e,t,De(t))}function Pt(e,t){return e===t||e!==e&&t!==t}var vg=to(yl),xg=to(function(e,t){return e>=t}),Zi=ha(function(){return arguments}())?ha:function(e){return xe(e)&&me.call(e,"callee")&&!ra.call(e,"callee")},Q=C.isArray,Cg=qs?at(qs):Bf;function Qe(e){return e!=null&&uo(e.length)&&!pi(e)}function Ee(e){return xe(e)&&Qe(e)}function yg(e){return e===!0||e===!1||xe(e)&&ke(e)==Vn}var Ai=Fp||as,Sg=$s?at($s):Rf;function Mg(e){return xe(e)&&e.nodeType===1&&!ur(e)}function Eg(e){if(e==null)return!0;if(Qe(e)&&(Q(e)||typeof e=="string"||typeof e.splice=="function"||Ai(e)||bn(e)||Zi(e)))return!e.length;var t=He(e);if(t==Lt||t==Nt)return!e.size;if(ar(e))return!El(e).length;for(var i in e)if(me.call(e,i))return!1;return!0}function Ig(e,t){return or(e,t)}function wg(e,t,i){i=typeof i=="function"?i:o;var l=i?i(e,t):o;return l===o?or(e,t,o,i):!!l}function Xl(e){if(!xe(e))return!1;var t=ke(e);return t==Cr||t==Qu||typeof e.message=="string"&&typeof e.name=="string"&&!ur(e)}function Ag(e){return typeof e=="number"&&la(e)}function pi(e){if(!ve(e))return!1;var t=ke(e);return t==yr||t==fs||t==Ku||t==Xu}function Ec(e){return typeof e=="number"&&e==X(e)}function uo(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Ti}function ve(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function xe(e){return e!=null&&typeof e=="object"}var Ic=Hs?at(Hs):Of;function Bg(e,t){return e===t||Ml(e,t,Wl(t))}function Rg(e,t,i){return i=typeof i=="function"?i:o,Ml(e,t,Wl(t),i)}function Dg(e){return wc(e)&&e!=+e}function Og(e){if(b0(e))throw new K(s);return Ta(e)}function Lg(e){return e===null}function Ng(e){return e==null}function wc(e){return typeof e=="number"||xe(e)&&ke(e)==kn}function ur(e){if(!xe(e)||ke(e)!=oi)return!1;var t=Ur(e);if(t===null)return!0;var i=me.call(t,"constructor")&&t.constructor;return typeof i=="function"&&i instanceof i&&Or.call(i)==Bp}var Jl=Ws?at(Ws):Lf;function Fg(e){return Ec(e)&&e>=-Ti&&e<=Ti}var Ac=Vs?at(Vs):Nf;function mo(e){return typeof e=="string"||!Q(e)&&xe(e)&&ke(e)==zn}function ut(e){return typeof e=="symbol"||xe(e)&&ke(e)==Sr}var bn=Gs?at(Gs):Ff;function Ug(e){return e===o}function Pg(e){return xe(e)&&He(e)==Yn}function qg(e){return xe(e)&&ke(e)==em}var $g=to(Il),Hg=to(function(e,t){return e<=t});function Bc(e){if(!e)return[];if(Qe(e))return mo(e)?Ft(e):Ke(e);if(Zn&&e[Zn])return hp(e[Zn]());var t=He(e),i=t==Lt?dl:t==Nt?Br:_n;return i(e)}function fi(e){if(!e)return e===0?e:0;if(e=xt(e),e===Wi||e===-Wi){var t=e<0?-1:1;return t*ku}return e===e?e:0}function X(e){var t=fi(e),i=t%1;return t===t?i?t-i:t:0}function Rc(e){return e?zi(X(e),0,Wt):0}function xt(e){if(typeof e=="number")return e;if(ut(e))return vr;if(ve(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ve(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Qs(e);var i=xm.test(e);return i||ym.test(e)?tp(e.slice(2),i?2:8):vm.test(e)?vr:+e}function Dc(e){return Gt(e,Ze(e))}function Wg(e){return e?zi(X(e),-Ti,Ti):e===0?e:0}function ce(e){return e==null?"":ct(e)}var Vg=fn(function(e,t){if(ar(t)||Qe(t)){Gt(t,De(t),e);return}for(var i in t)me.call(t,i)&&ir(e,i,t[i])}),Oc=fn(function(e,t){Gt(t,Ze(t),e)}),po=fn(function(e,t,i,l){Gt(t,Ze(t),e,l)}),Gg=fn(function(e,t,i,l){Gt(t,De(t),e,l)}),kg=ui(vl);function jg(e,t){var i=pn(e);return t==null?i:ma(i,t)}var zg=ee(function(e,t){e=fe(e);var i=-1,l=t.length,a=l>2?t[2]:o;for(a&&je(t[0],t[1],a)&&(l=1);++i<l;)for(var m=t[i],p=Ze(m),d=-1,_=p.length;++d<_;){var I=p[d],w=e[I];(w===o||Pt(w,cn[I])&&!me.call(e,I))&&(e[I]=m[I])}return e}),Yg=ee(function(e){return e.push(o,Qa),st(Lc,o,e)});function Kg(e,t){return js(e,k(t,3),Vt)}function Qg(e,t){return js(e,k(t,3),Cl)}function Zg(e,t){return e==null?e:xl(e,k(t,3),Ze)}function Xg(e,t){return e==null?e:ba(e,k(t,3),Ze)}function Jg(e,t){return e&&Vt(e,k(t,3))}function eb(e,t){return e&&Cl(e,k(t,3))}function tb(e){return e==null?[]:zr(e,De(e))}function ib(e){return e==null?[]:zr(e,Ze(e))}function es(e,t,i){var l=e==null?o:Yi(e,t);return l===o?i:l}function nb(e,t){return e!=null&&Ja(e,t,Ef)}function ts(e,t){return e!=null&&Ja(e,t,If)}var rb=ka(function(e,t,i){t!=null&&typeof t.toString!="function"&&(t=Lr.call(t)),e[t]=i},ns(Xe)),ob=ka(function(e,t,i){t!=null&&typeof t.toString!="function"&&(t=Lr.call(t)),me.call(e,t)?e[t].push(i):e[t]=[i]},k),lb=ee(rr);function De(e){return Qe(e)?ca(e):El(e)}function Ze(e){return Qe(e)?ca(e,!0):Uf(e)}function sb(e,t){var i={};return t=k(t,3),Vt(e,function(l,a,m){ai(i,t(l,a,m),l)}),i}function ab(e,t){var i={};return t=k(t,3),Vt(e,function(l,a,m){ai(i,a,t(l,a,m))}),i}var cb=fn(function(e,t,i){Yr(e,t,i)}),Lc=fn(function(e,t,i,l){Yr(e,t,i,l)}),ub=ui(function(e,t){var i={};if(e==null)return i;var l=!1;t=he(t,function(m){return m=Ii(m,e),l||(l=m.length>1),m}),Gt(e,$l(e),i),l&&(i=ht(i,F|de|Z,r0));for(var a=t.length;a--;)Dl(i,t[a]);return i});function mb(e,t){return Nc(e,co(k(t)))}var pb=ui(function(e,t){return e==null?{}:qf(e,t)});function Nc(e,t){if(e==null)return{};var i=he($l(e),function(l){return[l]});return t=k(t),Ea(e,i,function(l,a){return t(l,a[0])})}function fb(e,t,i){t=Ii(t,e);var l=-1,a=t.length;for(a||(a=1,e=o);++l<a;){var m=e==null?o:e[kt(t[l])];m===o&&(l=a,m=i),e=pi(m)?m.call(e):m}return e}function db(e,t,i){return e==null?e:lr(e,t,i)}function gb(e,t,i,l){return l=typeof l=="function"?l:o,e==null?e:lr(e,t,i,l)}var Fc=Ya(De),Uc=Ya(Ze);function bb(e,t,i){var l=Q(e),a=l||Ai(e)||bn(e);if(t=k(t,4),i==null){var m=e&&e.constructor;a?i=l?new m:[]:ve(e)?i=pi(m)?pn(Ur(e)):{}:i={}}return(a?gt:Vt)(e,function(p,d,_){return t(i,p,d,_)}),i}function _b(e,t){return e==null?!0:Dl(e,t)}function hb(e,t,i){return e==null?e:Ra(e,t,Nl(i))}function Tb(e,t,i,l){return l=typeof l=="function"?l:o,e==null?e:Ra(e,t,Nl(i),l)}function _n(e){return e==null?[]:fl(e,De(e))}function vb(e){return e==null?[]:fl(e,Ze(e))}function xb(e,t,i){return i===o&&(i=t,t=o),i!==o&&(i=xt(i),i=i===i?i:0),t!==o&&(t=xt(t),t=t===t?t:0),zi(xt(e),t,i)}function Cb(e,t,i){return t=fi(t),i===o?(i=t,t=0):i=fi(i),e=xt(e),wf(e,t,i)}function yb(e,t,i){if(i&&typeof i!="boolean"&&je(e,t,i)&&(t=i=o),i===o&&(typeof t=="boolean"?(i=t,t=o):typeof e=="boolean"&&(i=e,e=o)),e===o&&t===o?(e=0,t=1):(e=fi(e),t===o?(t=e,e=0):t=fi(t)),e>t){var l=e;e=t,t=l}if(i||e%1||t%1){var a=sa();return $e(e+a*(t-e+ep("1e-"+((a+"").length-1))),t)}return Al(e,t)}var Sb=dn(function(e,t,i){return t=t.toLowerCase(),e+(i?Pc(t):t)});function Pc(e){return is(ce(e).toLowerCase())}function qc(e){return e=ce(e),e&&e.replace(Mm,fp).replace(Gm,"")}function Mb(e,t,i){e=ce(e),t=ct(t);var l=e.length;i=i===o?l:zi(X(i),0,l);var a=i;return i-=t.length,i>=0&&e.slice(i,a)==t}function Eb(e){return e=ce(e),e&&om.test(e)?e.replace(bs,dp):e}function Ib(e){return e=ce(e),e&&mm.test(e)?e.replace(Zo,"\\$&"):e}var wb=dn(function(e,t,i){return e+(i?"-":"")+t.toLowerCase()}),Ab=dn(function(e,t,i){return e+(i?" ":"")+t.toLowerCase()}),Bb=Wa("toLowerCase");function Rb(e,t,i){e=ce(e),t=X(t);var l=t?an(e):0;if(!t||l>=t)return e;var a=(t-l)/2;return eo(Hr(a),i)+e+eo($r(a),i)}function Db(e,t,i){e=ce(e),t=X(t);var l=t?an(e):0;return t&&l<t?e+eo(t-l,i):e}function Ob(e,t,i){e=ce(e),t=X(t);var l=t?an(e):0;return t&&l<t?eo(t-l,i)+e:e}function Lb(e,t,i){return i||t==null?t=0:t&&(t=+t),$p(ce(e).replace(Xo,""),t||0)}function Nb(e,t,i){return(i?je(e,t,i):t===o)?t=1:t=X(t),Bl(ce(e),t)}function Fb(){var e=arguments,t=ce(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var Ub=dn(function(e,t,i){return e+(i?"_":"")+t.toLowerCase()});function Pb(e,t,i){return i&&typeof i!="number"&&je(e,t,i)&&(t=i=o),i=i===o?Wt:i>>>0,i?(e=ce(e),e&&(typeof t=="string"||t!=null&&!Jl(t))&&(t=ct(t),!t&&sn(e))?wi(Ft(e),0,i):e.split(t,i)):[]}var qb=dn(function(e,t,i){return e+(i?" ":"")+is(t)});function $b(e,t,i){return e=ce(e),i=i==null?0:zi(X(i),0,e.length),t=ct(t),e.slice(i,i+t.length)==t}function Hb(e,t,i){var l=u.templateSettings;i&&je(e,t,i)&&(t=o),e=ce(e),t=po({},t,l,Ka);var a=po({},t.imports,l.imports,Ka),m=De(a),p=fl(a,m),d,_,I=0,w=t.interpolate||Mr,A="__p += '",N=gl((t.escape||Mr).source+"|"+w.source+"|"+(w===_s?Tm:Mr).source+"|"+(t.evaluate||Mr).source+"|$","g"),q="//# sourceURL="+(me.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Km+"]")+`
`;e.replace(N,function(Y,te,ne,mt,ze,pt){return ne||(ne=mt),A+=e.slice(I,pt).replace(Em,gp),te&&(d=!0,A+=`' +
__e(`+te+`) +
'`),ze&&(_=!0,A+=`';
`+ze+`;
__p += '`),ne&&(A+=`' +
((__t = (`+ne+`)) == null ? '' : __t) +
'`),I=pt+Y.length,Y}),A+=`';
`;var z=me.call(t,"variable")&&t.variable;if(!z)A=`with (obj) {
`+A+`
}
`;else if(_m.test(z))throw new K(f);A=(_?A.replace(tm,""):A).replace(im,"$1").replace(nm,"$1;"),A="function("+(z||"obj")+`) {
`+(z?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(d?", __e = _.escape":"")+(_?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+A+`return __p
}`;var J=Hc(function(){return ae(m,q+"return "+A).apply(o,p)});if(J.source=A,Xl(J))throw J;return J}function Wb(e){return ce(e).toLowerCase()}function Vb(e){return ce(e).toUpperCase()}function Gb(e,t,i){if(e=ce(e),e&&(i||t===o))return Qs(e);if(!e||!(t=ct(t)))return e;var l=Ft(e),a=Ft(t),m=Zs(l,a),p=Xs(l,a)+1;return wi(l,m,p).join("")}function kb(e,t,i){if(e=ce(e),e&&(i||t===o))return e.slice(0,ea(e)+1);if(!e||!(t=ct(t)))return e;var l=Ft(e),a=Xs(l,Ft(t))+1;return wi(l,0,a).join("")}function jb(e,t,i){if(e=ce(e),e&&(i||t===o))return e.replace(Xo,"");if(!e||!(t=ct(t)))return e;var l=Ft(e),a=Zs(l,Ft(t));return wi(l,a).join("")}function zb(e,t){var i=qu,l=$u;if(ve(t)){var a="separator"in t?t.separator:a;i="length"in t?X(t.length):i,l="omission"in t?ct(t.omission):l}e=ce(e);var m=e.length;if(sn(e)){var p=Ft(e);m=p.length}if(i>=m)return e;var d=i-an(l);if(d<1)return l;var _=p?wi(p,0,d).join(""):e.slice(0,d);if(a===o)return _+l;if(p&&(d+=_.length-d),Jl(a)){if(e.slice(d).search(a)){var I,w=_;for(a.global||(a=gl(a.source,ce(hs.exec(a))+"g")),a.lastIndex=0;I=a.exec(w);)var A=I.index;_=_.slice(0,A===o?d:A)}}else if(e.indexOf(ct(a),d)!=d){var N=_.lastIndexOf(a);N>-1&&(_=_.slice(0,N))}return _+l}function Yb(e){return e=ce(e),e&&rm.test(e)?e.replace(gs,Cp):e}var Kb=dn(function(e,t,i){return e+(i?" ":"")+t.toUpperCase()}),is=Wa("toUpperCase");function $c(e,t,i){return e=ce(e),t=i?o:t,t===o?_p(e)?Mp(e):ap(e):e.match(t)||[]}var Hc=ee(function(e,t){try{return st(e,o,t)}catch(i){return Xl(i)?i:new K(i)}}),Qb=ui(function(e,t){return gt(t,function(i){i=kt(i),ai(e,i,Ql(e[i],e))}),e});function Zb(e){var t=e==null?0:e.length,i=k();return e=t?he(e,function(l){if(typeof l[1]!="function")throw new bt(c);return[i(l[0]),l[1]]}):[],ee(function(l){for(var a=-1;++a<t;){var m=e[a];if(st(m[0],this,l))return st(m[1],this,l)}})}function Xb(e){return yf(ht(e,F))}function ns(e){return function(){return e}}function Jb(e,t){return e==null||e!==e?t:e}var e_=Ga(),t_=Ga(!0);function Xe(e){return e}function rs(e){return va(typeof e=="function"?e:ht(e,F))}function i_(e){return Ca(ht(e,F))}function n_(e,t){return ya(e,ht(t,F))}var r_=ee(function(e,t){return function(i){return rr(i,e,t)}}),o_=ee(function(e,t){return function(i){return rr(e,i,t)}});function os(e,t,i){var l=De(t),a=zr(t,l);i==null&&!(ve(t)&&(a.length||!l.length))&&(i=t,t=e,e=this,a=zr(t,De(t)));var m=!(ve(i)&&"chain"in i)||!!i.chain,p=pi(e);return gt(a,function(d){var _=t[d];e[d]=_,p&&(e.prototype[d]=function(){var I=this.__chain__;if(m||I){var w=e(this.__wrapped__),A=w.__actions__=Ke(this.__actions__);return A.push({func:_,args:arguments,thisArg:e}),w.__chain__=I,w}return _.apply(e,xi([this.value()],arguments))})}),e}function l_(){return Re._===this&&(Re._=Rp),this}function ls(){}function s_(e){return e=X(e),ee(function(t){return Sa(t,e)})}var a_=Ul(he),c_=Ul(ks),u_=Ul(al);function Wc(e){return Gl(e)?cl(kt(e)):$f(e)}function m_(e){return function(t){return e==null?o:Yi(e,t)}}var p_=ja(),f_=ja(!0);function ss(){return[]}function as(){return!1}function d_(){return{}}function g_(){return""}function b_(){return!0}function __(e,t){if(e=X(e),e<1||e>Ti)return[];var i=Wt,l=$e(e,Wt);t=k(t),e-=Wt;for(var a=pl(l,t);++i<e;)t(i);return a}function h_(e){return Q(e)?he(e,kt):ut(e)?[e]:Ke(ac(ce(e)))}function T_(e){var t=++Ap;return ce(e)+t}var v_=Jr(function(e,t){return e+t},0),x_=Pl("ceil"),C_=Jr(function(e,t){return e/t},1),y_=Pl("floor");function S_(e){return e&&e.length?jr(e,Xe,yl):o}function M_(e,t){return e&&e.length?jr(e,k(t,2),yl):o}function E_(e){return Ys(e,Xe)}function I_(e,t){return Ys(e,k(t,2))}function w_(e){return e&&e.length?jr(e,Xe,Il):o}function A_(e,t){return e&&e.length?jr(e,k(t,2),Il):o}var B_=Jr(function(e,t){return e*t},1),R_=Pl("round"),D_=Jr(function(e,t){return e-t},0);function O_(e){return e&&e.length?ml(e,Xe):0}function L_(e,t){return e&&e.length?ml(e,k(t,2)):0}return u.after=ig,u.ary=Tc,u.assign=Vg,u.assignIn=Oc,u.assignInWith=po,u.assignWith=Gg,u.at=kg,u.before=vc,u.bind=Ql,u.bindAll=Qb,u.bindKey=xc,u.castArray=dg,u.chain=bc,u.chunk=y0,u.compact=S0,u.concat=M0,u.cond=Zb,u.conforms=Xb,u.constant=ns,u.countBy=Od,u.create=jg,u.curry=Cc,u.curryRight=yc,u.debounce=Sc,u.defaults=zg,u.defaultsDeep=Yg,u.defer=ng,u.delay=rg,u.difference=E0,u.differenceBy=I0,u.differenceWith=w0,u.drop=A0,u.dropRight=B0,u.dropRightWhile=R0,u.dropWhile=D0,u.fill=O0,u.filter=Nd,u.flatMap=Pd,u.flatMapDeep=qd,u.flatMapDepth=$d,u.flatten=pc,u.flattenDeep=L0,u.flattenDepth=N0,u.flip=og,u.flow=e_,u.flowRight=t_,u.fromPairs=F0,u.functions=tb,u.functionsIn=ib,u.groupBy=Hd,u.initial=P0,u.intersection=q0,u.intersectionBy=$0,u.intersectionWith=H0,u.invert=rb,u.invertBy=ob,u.invokeMap=Vd,u.iteratee=rs,u.keyBy=Gd,u.keys=De,u.keysIn=Ze,u.map=lo,u.mapKeys=sb,u.mapValues=ab,u.matches=i_,u.matchesProperty=n_,u.memoize=ao,u.merge=cb,u.mergeWith=Lc,u.method=r_,u.methodOf=o_,u.mixin=os,u.negate=co,u.nthArg=s_,u.omit=ub,u.omitBy=mb,u.once=lg,u.orderBy=kd,u.over=a_,u.overArgs=sg,u.overEvery=c_,u.overSome=u_,u.partial=Zl,u.partialRight=Mc,u.partition=jd,u.pick=pb,u.pickBy=Nc,u.property=Wc,u.propertyOf=m_,u.pull=k0,u.pullAll=dc,u.pullAllBy=j0,u.pullAllWith=z0,u.pullAt=Y0,u.range=p_,u.rangeRight=f_,u.rearg=ag,u.reject=Kd,u.remove=K0,u.rest=cg,u.reverse=Yl,u.sampleSize=Zd,u.set=db,u.setWith=gb,u.shuffle=Xd,u.slice=Q0,u.sortBy=tg,u.sortedUniq=nd,u.sortedUniqBy=rd,u.split=Pb,u.spread=ug,u.tail=od,u.take=ld,u.takeRight=sd,u.takeRightWhile=ad,u.takeWhile=cd,u.tap=Sd,u.throttle=mg,u.thru=oo,u.toArray=Bc,u.toPairs=Fc,u.toPairsIn=Uc,u.toPath=h_,u.toPlainObject=Dc,u.transform=bb,u.unary=pg,u.union=ud,u.unionBy=md,u.unionWith=pd,u.uniq=fd,u.uniqBy=dd,u.uniqWith=gd,u.unset=_b,u.unzip=Kl,u.unzipWith=gc,u.update=hb,u.updateWith=Tb,u.values=_n,u.valuesIn=vb,u.without=bd,u.words=$c,u.wrap=fg,u.xor=_d,u.xorBy=hd,u.xorWith=Td,u.zip=vd,u.zipObject=xd,u.zipObjectDeep=Cd,u.zipWith=yd,u.entries=Fc,u.entriesIn=Uc,u.extend=Oc,u.extendWith=po,os(u,u),u.add=v_,u.attempt=Hc,u.camelCase=Sb,u.capitalize=Pc,u.ceil=x_,u.clamp=xb,u.clone=gg,u.cloneDeep=_g,u.cloneDeepWith=hg,u.cloneWith=bg,u.conformsTo=Tg,u.deburr=qc,u.defaultTo=Jb,u.divide=C_,u.endsWith=Mb,u.eq=Pt,u.escape=Eb,u.escapeRegExp=Ib,u.every=Ld,u.find=Fd,u.findIndex=uc,u.findKey=Kg,u.findLast=Ud,u.findLastIndex=mc,u.findLastKey=Qg,u.floor=y_,u.forEach=_c,u.forEachRight=hc,u.forIn=Zg,u.forInRight=Xg,u.forOwn=Jg,u.forOwnRight=eb,u.get=es,u.gt=vg,u.gte=xg,u.has=nb,u.hasIn=ts,u.head=fc,u.identity=Xe,u.includes=Wd,u.indexOf=U0,u.inRange=Cb,u.invoke=lb,u.isArguments=Zi,u.isArray=Q,u.isArrayBuffer=Cg,u.isArrayLike=Qe,u.isArrayLikeObject=Ee,u.isBoolean=yg,u.isBuffer=Ai,u.isDate=Sg,u.isElement=Mg,u.isEmpty=Eg,u.isEqual=Ig,u.isEqualWith=wg,u.isError=Xl,u.isFinite=Ag,u.isFunction=pi,u.isInteger=Ec,u.isLength=uo,u.isMap=Ic,u.isMatch=Bg,u.isMatchWith=Rg,u.isNaN=Dg,u.isNative=Og,u.isNil=Ng,u.isNull=Lg,u.isNumber=wc,u.isObject=ve,u.isObjectLike=xe,u.isPlainObject=ur,u.isRegExp=Jl,u.isSafeInteger=Fg,u.isSet=Ac,u.isString=mo,u.isSymbol=ut,u.isTypedArray=bn,u.isUndefined=Ug,u.isWeakMap=Pg,u.isWeakSet=qg,u.join=W0,u.kebabCase=wb,u.last=vt,u.lastIndexOf=V0,u.lowerCase=Ab,u.lowerFirst=Bb,u.lt=$g,u.lte=Hg,u.max=S_,u.maxBy=M_,u.mean=E_,u.meanBy=I_,u.min=w_,u.minBy=A_,u.stubArray=ss,u.stubFalse=as,u.stubObject=d_,u.stubString=g_,u.stubTrue=b_,u.multiply=B_,u.nth=G0,u.noConflict=l_,u.noop=ls,u.now=so,u.pad=Rb,u.padEnd=Db,u.padStart=Ob,u.parseInt=Lb,u.random=yb,u.reduce=zd,u.reduceRight=Yd,u.repeat=Nb,u.replace=Fb,u.result=fb,u.round=R_,u.runInContext=g,u.sample=Qd,u.size=Jd,u.snakeCase=Ub,u.some=eg,u.sortedIndex=Z0,u.sortedIndexBy=X0,u.sortedIndexOf=J0,u.sortedLastIndex=ed,u.sortedLastIndexBy=td,u.sortedLastIndexOf=id,u.startCase=qb,u.startsWith=$b,u.subtract=D_,u.sum=O_,u.sumBy=L_,u.template=Hb,u.times=__,u.toFinite=fi,u.toInteger=X,u.toLength=Rc,u.toLower=Wb,u.toNumber=xt,u.toSafeInteger=Wg,u.toString=ce,u.toUpper=Vb,u.trim=Gb,u.trimEnd=kb,u.trimStart=jb,u.truncate=zb,u.unescape=Yb,u.uniqueId=T_,u.upperCase=Kb,u.upperFirst=is,u.each=_c,u.eachRight=hc,u.first=fc,os(u,function(){var e={};return Vt(u,function(t,i){me.call(u.prototype,i)||(e[i]=t)}),e}(),{chain:!1}),u.VERSION=r,gt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){u[e].placeholder=u}),gt(["drop","take"],function(e,t){ie.prototype[e]=function(i){i=i===o?1:Be(X(i),0);var l=this.__filtered__&&!t?new ie(this):this.clone();return l.__filtered__?l.__takeCount__=$e(i,l.__takeCount__):l.__views__.push({size:$e(i,Wt),type:e+(l.__dir__<0?"Right":"")}),l},ie.prototype[e+"Right"]=function(i){return this.reverse()[e](i).reverse()}}),gt(["filter","map","takeWhile"],function(e,t){var i=t+1,l=i==ps||i==Gu;ie.prototype[e]=function(a){var m=this.clone();return m.__iteratees__.push({iteratee:k(a,3),type:i}),m.__filtered__=m.__filtered__||l,m}}),gt(["head","last"],function(e,t){var i="take"+(t?"Right":"");ie.prototype[e]=function(){return this[i](1).value()[0]}}),gt(["initial","tail"],function(e,t){var i="drop"+(t?"":"Right");ie.prototype[e]=function(){return this.__filtered__?new ie(this):this[i](1)}}),ie.prototype.compact=function(){return this.filter(Xe)},ie.prototype.find=function(e){return this.filter(e).head()},ie.prototype.findLast=function(e){return this.reverse().find(e)},ie.prototype.invokeMap=ee(function(e,t){return typeof e=="function"?new ie(this):this.map(function(i){return rr(i,e,t)})}),ie.prototype.reject=function(e){return this.filter(co(k(e)))},ie.prototype.slice=function(e,t){e=X(e);var i=this;return i.__filtered__&&(e>0||t<0)?new ie(i):(e<0?i=i.takeRight(-e):e&&(i=i.drop(e)),t!==o&&(t=X(t),i=t<0?i.dropRight(-t):i.take(t-e)),i)},ie.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},ie.prototype.toArray=function(){return this.take(Wt)},Vt(ie.prototype,function(e,t){var i=/^(?:filter|find|map|reject)|While$/.test(t),l=/^(?:head|last)$/.test(t),a=u[l?"take"+(t=="last"?"Right":""):t],m=l||/^find/.test(t);a&&(u.prototype[t]=function(){var p=this.__wrapped__,d=l?[1]:arguments,_=p instanceof ie,I=d[0],w=_||Q(p),A=function(te){var ne=a.apply(u,xi([te],d));return l&&N?ne[0]:ne};w&&i&&typeof I=="function"&&I.length!=1&&(_=w=!1);var N=this.__chain__,q=!!this.__actions__.length,z=m&&!N,J=_&&!q;if(!m&&w){p=J?p:new ie(this);var Y=e.apply(p,d);return Y.__actions__.push({func:oo,args:[A],thisArg:o}),new _t(Y,N)}return z&&J?e.apply(this,d):(Y=this.thru(A),z?l?Y.value()[0]:Y.value():Y)})}),gt(["pop","push","shift","sort","splice","unshift"],function(e){var t=Rr[e],i=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",l=/^(?:pop|shift)$/.test(e);u.prototype[e]=function(){var a=arguments;if(l&&!this.__chain__){var m=this.value();return t.apply(Q(m)?m:[],a)}return this[i](function(p){return t.apply(Q(p)?p:[],a)})}}),Vt(ie.prototype,function(e,t){var i=u[t];if(i){var l=i.name+"";me.call(mn,l)||(mn[l]=[]),mn[l].push({name:t,func:i})}}),mn[Xr(o,Ht).name]=[{name:"wrapper",func:o}],ie.prototype.clone=zp,ie.prototype.reverse=Yp,ie.prototype.value=Kp,u.prototype.at=Md,u.prototype.chain=Ed,u.prototype.commit=Id,u.prototype.next=wd,u.prototype.plant=Bd,u.prototype.reverse=Rd,u.prototype.toJSON=u.prototype.valueOf=u.prototype.value=Dd,u.prototype.first=u.prototype.head,Zn&&(u.prototype[Zn]=Ad),u},yi=Ep();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(Re._=yi,define(function(){return yi})):Vi?((Vi.exports=yi)._=yi,rl._=yi):Re._=yi}).call($n)});var Ye=class extends Ri{idUser;idTimbre;acquis;doublon;constructor(r,n,s,c){super(),this.idUser=r||null,this.idTimbre=n||null,this.acquis=s||!1,this.doublon=c||!1}getIdUser(){return this.idUser}setIdUser(r){this.idUser=r}getIdTimbre(){return this.idTimbre}setIdTimbre(r){this.idTimbre=r}isAcquis(){return this.acquis}setAcquis(r){this.acquis=r}isDoublon(){return this.doublon}setDoublon(r){this.doublon=r}};re([oe("Identifiant Utilisateur")],Ye.prototype,"idUser",2),re([oe("Identifiant timbre")],Ye.prototype,"idTimbre",2),re([oe("Acquis")],Ye.prototype,"acquis",2),re([oe("Doublon")],Ye.prototype,"doublon",2);var fr=class{key;dossier;maxWidth;maxHeight;getKey(){return this.key}setKey(r){this.key=r}getDossier(){return this.dossier}setDossier(r){this.dossier=r}getMaxWidth(){return this.maxWidth}setMaxWidth(r){this.maxWidth=r}getMaxHeight(){return this.maxHeight}setMaxHeight(r){this.maxHeight=r}};var qi=class{dossier;nom;alignLabel;detail;file;getDossier(){return this.dossier}setDossier(r){this.dossier=r}getNom(){return this.nom}setNom(r){this.nom=r}getAlignLabel(){return this.alignLabel}setAlignLabel(r){this.alignLabel=r}getDetail(){return this.detail}setDetail(r){this.detail=r}getFile(){return this.file}setFile(r){this.file=r}};var Me=class o{constructor(r,n){this.authService=r;this.firestore=n}reinitResume$=new _e(!0);initUpload(){let r=new qi;r.setDossier("table"),r.setNom(new Date().getTime()?.toString());let n=new fr;n.setMaxWidth(100),n.setMaxHeight(100),n.setDossier("autre");let s=new fr;return s.setMaxWidth(700),s.setMaxHeight(700),s.setDossier("zoom"),r.setDetail([n,s]),r}getAnneesAsync(r){return this.firestore.collection(r,n=>{let s=n;return s=s.orderBy("annee","desc"),s}).valueChanges().pipe(jt(n=>{let s=n.map(c=>Number(c.annee)).filter(c=>S(c)&&c!=0);return Array.from(new Set(s))}))}getTimbresByCritereAsync(r){return this.getAllTimbres(r).pipe(jt(n=>this.constructTimbres(n,null,null)))}getAllTimbres(r){return this.firestore.collection("/timbres",n=>{let s=n;return S(r)&&(S(r.getAnnees())&&r.getAnnees()?.length>0&&(s=s.where("annee","in",r.getAnnees())),r?.getType()?.length==0||r?.getType()?.length==1&&r?.getType()?.find(c=>c=="TIMBRE")?s=s.where("idBloc","==",null):r?.getType()?.length>0&&!r?.getType()?.find(c=>c=="TIMBRE")?s=s.where("idBloc","!=",null):S(r.getIdBloc())&&(s=s.where("idBloc","==",r.getIdBloc()))),s=s.orderBy("id","asc"),s}).valueChanges()}constructTimbres(r,n,s,c){let f=[];return r?.length>0&&r.forEach(b=>{let E=this.constructTimbre(b,n,s),R=!1;S(c)?((c?.getType()?.find(F=>F=="TIMBRE")&&Oe(E?.getTimbreBlocModel())||c?.getType()?.find(F=>F=="BLOC")&&S(E?.getTimbreBlocModel())&&E?.getTimbreBlocModel()?.getType()=="BLOC"||c?.getType()?.find(F=>F=="CARNET")&&S(E?.getTimbreBlocModel())&&E?.getTimbreBlocModel()?.getType()=="CARNET")&&(R=!0),S(E.getTimbreAcquisModel())&&(S(c.getAcquis())&&!(c.getAcquis()=="TOUS"||c.getAcquis()=="OUI"&&E.getTimbreAcquisModel().isAcquis()||c.getAcquis()=="NON"&&!E.getTimbreAcquisModel().isAcquis())&&(R=!1),S(c.getDoublon())&&!(c.getDoublon()=="TOUS"||c.getDoublon()=="OUI"&&E.getTimbreAcquisModel().isDoublon()||c.getDoublon()=="NON"&&!E.getTimbreAcquisModel().isDoublon())&&(R=!1))):R=!0,R==!0&&f.push(E)}),f}constructTimbre(r,n,s){let c=Di(Dt,r);if(S(s)){let f=s.find(b=>b.getId()==c?.getIdBloc());S(f)&&c.setTimbreBlocModel(f)}if(S(n)){let f=n.find(b=>b.idTimbre==c.getId());S(f)?c.setTimbreAcquisModel(Di(Ye,f)):c.setTimbreAcquisModel(new Ye)}return c}supprimerTimbreAcquis(r){this.firestore.collection("/timbres_acquis").ref.where("idTimbre","==",r.getId()).get().then(n=>{n.forEach(s=>{s.ref.delete()})})}supprimerTimbre(r){this.firestore.collection("/timbres").ref.where("id","==",r.getId()).get().then(n=>{n.forEach(s=>{s.ref.delete()})}).catch(n=>{console.error("Erreur de suppression :",n)})}acquis(r,n,s){this.authService.userSelect$.pipe(P(c=>S(c))).subscribe(c=>{this.firestore.collection("/timbres_acquis").ref.where("idTimbre","==",r.getId()).where("idUser","==",c.getId()).get().then(f=>{f?.size==0&&this.addAcquis(c.getId(),r,n),f.forEach(b=>{let E=Di(Ye,b.data());n?(E.setAcquis(!0),E.setDoublon(s||!E.isDoublon())):(E.setAcquis(s||!E.isAcquis()),E.isAcquis()||E.setDoublon(!1)),b.ref.update(Object.assign(new Object,E)).then(R=>{r.setTimbreAcquisModel(E)}).catch(R=>{console.error("Erreur de mise \xE0 jour:",R)})})}).catch(f=>{console.error("Erreur de mise \xE0 jour id introuvable :",f)}),this.reinitResume$.next(!0)})}supprimerAcquisTimbreByUser(r,n,s,c){this.firestore.collection("/timbres_acquis").ref.where("idTimbre","==",n.getId()).where("idUser","==",r).get().then(f=>{f?.size==0&&c&&this.addAcquis(r,n,s),f.forEach(b=>{b.ref.delete().then(E=>{c&&this.supprimerTimbreAcquis(n)})})}).catch(f=>{console.error("Erreur de suppression :",f)})}addAcquis(r,n,s){let c=new Ye;c.setIdUser(r),c.setIdTimbre(n.getId()),c.setAcquis(!0),c.setDoublon(s),n.setTimbreAcquisModel(c),this.firestore.collection("/timbres_acquis").add(Object.assign(new Object,c))}static \u0275fac=function(n){return new(n||o)(Te(tt),Te(vn))};static \u0275prov=Bi({token:o,factory:o.\u0275fac})};var Ot=class extends Ri{idUser;idBloc;acquis;doublon;constructor(r,n,s,c){super(),this.idUser=r||null,this.idBloc=n||null,this.acquis=s||!1,this.doublon=c||!1}getIdUser(){return this.idUser}setIdUser(r){this.idUser=r}getIdBloc(){return this.idBloc}setIdBloc(r){this.idBloc=r}isAcquis(){return this.acquis}setAcquis(r){this.acquis=r}isDoublon(){return this.doublon}setDoublon(r){this.doublon=r}};re([oe("Identifiant Utilisateur")],Ot.prototype,"idUser",2),re([oe("Identifiant bloc")],Ot.prototype,"idBloc",2),re([oe("Acquis")],Ot.prototype,"acquis",2),re([oe("Doublon")],Ot.prototype,"doublon",2);var W_=["canvas"];function V_(o,r){if(o&1&&(T(0,"span",6)(1,"b"),B(2),x()()),o&2){let n=y();h(2),$("N\xB0",n.timbreModel==null?null:n.timbreModel.getId(),"")}}function G_(o,r){o&1&&G(0,"lib-spinner",7),o&2&&v("textSpec","Chargement en cours ...")}function k_(o,r){if(o&1&&(G(0,"mat-error",27),O(1,"async")),o&2){let n=y(2);v("innerHTML",L(1,1,n.messageError$),hn)}}function j_(o,r){if(o&1&&(T(0,"mat-option",18),B(1),x()),o&2){let n=r.$implicit,s=y(2);v("value",n),h(),Yc(" ",n.getAnnee()," - ",n.getId()," ",(n==null?null:n.getType())==s.TypeTimbreEnum.CARNET?" (carnet)":""," ")}}function z_(o,r){if(o&1){let n=ue();T(0,"img",28),j("click",function(){let c;H(n);let f=y(2);return W(f.utilsService.zoom(f.timbreModel==null||(c=f.timbreModel.getTimbreBlocModel())==null?null:c.getImageZoom()))}),x()}if(o&2){let n,s=y(2);v("src",s.timbreModel==null||(n=s.timbreModel.getTimbreBlocModel())==null?null:n.getImage(),Tn)}}function Y_(o,r){if(o&1){let n=ue();T(0,"form",8,1),j("ngSubmit",function(){H(n);let c=ye(1),f=y();return W(f.valider(c))}),T(2,"div",9),D(3,k_,2,3,"mat-error",10),O(4,"async"),T(5,"div",11)(6,"div",12)(7,"label"),G(8,"lib-libelle-model",13),x(),T(9,"input",14),Pe("ngModelChange",function(c){H(n);let f=y();return Ue(f.timbreModel.annee,c)||(f.timbreModel.annee=c),W(c)}),j("ngModelChange",function(c){H(n);let f=y();return W(f.changeAnnee(c))}),x()(),T(10,"div",15)(11,"label"),G(12,"lib-libelle-model",13),x(),T(13,"div",16)(14,"mat-select",17),O(15,"async"),j("ngModelChange",function(c){H(n);let f=y();return W(f.changeBloc(c))}),G(16,"mat-option",18),D(17,j_,2,4,"mat-option",19),O(18,"async"),x(),D(19,z_,1,1,"img",20),x()()(),T(20,"div",11)(21,"div",12)(22,"label"),G(23,"lib-libelle-model",13),x(),T(24,"input",21),Pe("ngModelChange",function(c){H(n);let f=y();return Ue(f.timbreModel.yt,c)||(f.timbreModel.yt=c),W(c)}),x()(),T(25,"div",12)(26,"label"),G(27,"lib-libelle-model",13),x(),T(28,"input",22),Pe("ngModelChange",function(c){H(n);let f=y();return Ue(f.timbreModel.type,c)||(f.timbreModel.type=c),W(c)}),x()()(),T(29,"lib-upload",23),j("outPutObject",function(c){H(n);let f=y();return W(f.timbreModel=c)}),x()(),T(30,"div",24)(31,"button",25),j("click",function(){H(n);let c=y();return W(c.close())}),B(32," Annuler "),x(),T(33,"button",26),B(34," Enregistrer "),x()()()}if(o&2){let n,s,c=ye(1),f=y();v("ngClass",c!=null&&c.submitted?"red-color":"blue-color"),h(3),v("ngIf",L(4,27,f.messageError$)),h(5),v("object",f.timbreModel)("key","annee"),h(),Fe("ngModel",f.timbreModel.annee),v("max",f.maxAnnee)("zMax",f.maxAnnee)("disabled",!!(f.timbreModel!=null&&f.timbreModel.getId())),h(3),v("object",f.timbreModel)("key","timbreBlocModel"),h(2),v("ngModel",f.timbreModel.getTimbreBlocModel())("placeholder","Choix bloc")("disabled",!!(f.timbreModel!=null&&f.timbreModel.getId())||((n=L(15,29,f.timbreBlocService.timbresBlocModel$))==null?null:n.length)<=0),h(2),v("value",null),h(),v("ngForOf",L(18,31,f.timbreBlocService.timbresBlocModel$)),h(2),v("ngIf",f.timbreModel==null||(s=f.timbreModel.getTimbreBlocModel())==null?null:s.getImage()),h(4),v("object",f.timbreModel)("key","yt"),h(),Fe("ngModel",f.timbreModel.yt),h(3),v("object",f.timbreModel)("key","type"),h(),Fe("ngModel",f.timbreModel.type),h(),v("object",f.timbreModel)("key","image")("zoom",f.timbreModel.getImageZoom())("maxWidth",f.DimensionImageEnum.WIDTH_TIMBRE)("maxHeight",f.DimensionImageEnum.HEIGTH_TIMBRE)}}var Nn=class o{constructor(r,n,s,c,f,b){this.httpResponseHandlerService=r;this.dialogRef=n;this.timbreService=s;this.timbreBlocService=c;this.timbreUtilsService=f;this.utilsService=b}canvas;messageError$=new _e(null);load$=new _e(null);id;maxAnnee=new Date().getFullYear();timbreModel=new Dt;fileUploadModel=new qi;TypeTimbreEnum=$t;DimensionImageEnum=Xi;ngOnInit(){this.fileUploadModel=this.timbreUtilsService.initUpload(),this.load$.next(!1),S(this.id)?this.timbreService.getTimbreByIdAsync(this.id).subscribe(r=>{this.timbreModel=r,S(r.getTimbreBlocModel())&&(this.timbreModel.setAnnee(r.getTimbreBlocModel().getAnnee()),this.timbreModel.setMonnaie(r.getTimbreBlocModel().getMonnaie())),this.load$.next(!0)}):(this.timbreModel.setAnnee(new Date().getFullYear()),this.timbreModel.setMonnaie("E"),this.load$.next(!0)),this.changeAnnee(this.timbreModel.getAnnee())}valider(r){if(this.messageError$.next(null),r?.valid)if(S(this.timbreModel.getImage()))this.saveData();else{this.messageError$.next("Veuillez s\xE9lectionner une image");return}}saveData(){this.load$.next(!1),S(this.timbreModel.getId())?this.save():this.ajouter()}ajouter(){this.utilsService.getMaxIdentAsync("/timbres").pipe(P()).subscribe(r=>{this.timbreModel.setId(r),this.save(!0)})}save(r){this.timbreModel.getAnnee()>=2002?this.timbreModel.setMonnaie("E"):this.timbreModel.getAnnee()>=1999?this.timbreModel.setMonnaie("FE"):this.timbreModel.setMonnaie("F");try{We([this.timbreService.upload(this.timbreModel,"autre"),this.timbreService.upload(this.timbreModel,"table"),this.timbreService.upload(this.timbreModel,"zoom")]).pipe(P(([n,s,c])=>S(n)&&S(c)&&S(s))).subscribe(([n,s,c])=>{S(n)&&n!="nok"&&this.timbreModel.setImage(n),S(s)&&s!="nok"&&this.timbreModel.setImageTable(s),S(c)&&c!="nok"&&this.timbreModel.setImageZoom(c),r?this.timbreService.ajouter(this.timbreModel,!0):this.timbreService.modifier(this.timbreModel),this.httpResponseHandlerService.showNotificationSuccess("Transaction termin\xE9e","Votre timbre a bien \xE9t\xE9 modifi\xE9e."),this.load$.next(!0),this.dialogRef.close()})}catch{this.httpResponseHandlerService.showNotificationError("Transaction non aboutie","Votre timbre n'a pas pu \xEAtre modifi\xE9."),this.load$.next(!0)}}close(){this.dialogRef.close()}changeAnnee(r){if(this.timbreModel.setTimbreBlocModel(null),S(r)){let n=new pr;n.initCritereBloc(),n.setAnnees([r]),n.setSort("desc"),this.timbreBlocService.getBlocs(n,!1)}}changeBloc(r){S(r)?(this.timbreModel.setIdBloc(r.getId()),this.timbreModel.setTimbreBlocModel(r),this.timbreModel.setMonnaie(r.getMonnaie()),this.timbreModel.setAnnee(r.getAnnee())):(this.timbreModel.setIdBloc(null),this.timbreModel.setTimbreBlocModel(null),this.timbreModel.setMonnaie("E"))}static \u0275fac=function(n){return new(n||o)(V(Co),V(Qt),V(Le),V(Ve),V(Me),V(nt))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-modifier"]],viewQuery:function(n,s){if(n&1&&gi(W_,5),n&2){let c;bi(c=_i())&&(s.canvas=c.first)}},decls:9,vars:6,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],["class","accent",4,"ngIf"],[3,"ngIf","ngIfElse"],[1,"accent"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","space-between stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","column","fxLayoutGap","20px",1,"bloc-modal"],[3,"innerHTML",4,"ngIf"],["fxLayout","row","fxLayout.lt-lg","column","fxLayoutGap","30px","fxLayoutGap.lt-lg","5px"],["fxLayout","column",1,"form-input"],[3,"object","key"],["name","page","type","number","minlength","4","maxlength","4","min","1900","zMin","1900","required","","zControl","",1,"annee",2,"width","60px !important",3,"ngModelChange","ngModel","max","zMax","disabled"],["fxLayout","column",1,"form-input","select"],["fxLayout","row","fxLayoutGap","15px"],["name","bloc",2,"width","180px !important",3,"ngModelChange","ngModel","placeholder","disabled"],[1,"selectMin",3,"value"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],["style","max-height: 40px","class","click",3,"src","click",4,"ngIf"],["name","yt","type","text","trim","","zControl","",3,"ngModelChange","ngModel"],["name","type","type","text","trim","","zControl","",3,"ngModelChange","ngModel"],[3,"outPutObject","object","key","zoom","maxWidth","maxHeight"],["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"],[3,"innerHTML"],[1,"click",2,"max-height","40px",3,"click","src"]],template:function(n,s){if(n&1&&(T(0,"div",2)(1,"div",3)(2,"span"),B(3),x(),D(4,V_,3,1,"span",4),x(),D(5,G_,1,1,"ng-template",5),O(6,"async"),D(7,Y_,35,33,"ng-template",null,0,Je),x()),n&2){let c=ye(8);h(3),$("",s.timbreModel!=null&&s.timbreModel.getId()?"MODIFICATION":"AJOUT"," "),h(),v("ngIf",s.timbreModel==null?null:s.timbreModel.getId()),h(),v("ngIf",L(6,4,s.load$)==!1)("ngIfElse",c)}},dependencies:[it,wn,Bt,wt,Ct,et,Se,zt,Oi,Kt,Yt,Li,Mt,Ui,xn,Cn,Et,Ni,Mn,En,In,Sn,yn,It,Fi,Rt,Bn,An,yo,Rn,Dn,So,we],encapsulation:2})};var Le=class o{constructor(r,n,s,c,f,b,E,R){this.firestore=r;this.authService=n;this.timbreBlocService=s;this.uploadService=c;this.utilsService=f;this.timbreUtilsService=b;this.dialog=E;this.preferenceService=R}total$=new _e(0);timbres$=new _e(null);load$=new _e(!1);getTimbre(r){return this.firestore.collection("/timbres",n=>n.where("id","==",r)).valueChanges()}getTimbreByIdAsync(r){return We([this.getTimbre(r),this.timbreBlocService.getBlocsAsync()]).pipe(jt(([n,s])=>this.timbreUtilsService.constructTimbre(n[0],null,s)))}setTotal(r){this.total$.pipe(P()).subscribe(n=>{this.total$.next(n+r)})}getTotal(r){this.total$.next(null),this.timbreUtilsService.getAllTimbres(r).subscribe(n=>{this.total$.next(n?.length)})}getTimbres(r,n){n&&this.getTotal(),this.timbres$.next(null),this.load$.next(!1),We([this.timbreUtilsService.getAllTimbres(r),this.getTimbreAcquis(),this.timbreBlocService.getBlocsAsync(r)]).pipe(P()).subscribe(([s,c,f])=>{let b=this.timbreUtilsService.constructTimbres(s,c,f,r);b?.length>0&&(b=b.sort((E,R)=>E.getIdBloc()-R.getIdBloc()).sort((E,R)=>E?.getTimbreBlocModel()?.getNbTimbres()-R?.getTimbreBlocModel()?.getNbTimbres())),this.timbres$.next(b),this.load$.next(!0)})}getTimbreAcquis(){return this.authService.userSelect$.pipe(P(r=>S(r)),fo(r=>S(r)?this.getTimbreAcquisByUser(r.getId()).pipe(P(),jt(n=>n)):null))}getTimbreAcquisByUser(r){return this.firestore.collection("/timbres_acquis",n=>n.where("idUser","==",r)).valueChanges()}ajouterSansId(r){this.utilsService.getMaxIdentAsync("/timbres").pipe(P()).subscribe(n=>{r.setId(n),S(r.getIdBloc())&&r.setMonnaie(null),this.ajouter(r,!0)})}ajouter(r,n){this.getTimbre(r.getId()).pipe(P()).subscribe(s=>{Oe(s)||Oe(s[0])||S(s[0])&&s[0]?.length==0?(r.setTimbreAcquisModel(null),r.setTimbreBlocModel(null),this.firestore.collection("/timbres").add(Object.assign(new Object,r)).then(c=>{n&&(this.preferenceService.getTimbreCritere("timbreCritere").pipe(P()).subscribe(f=>{S(f.getAnnees().find(b=>b==r.getAnnee()))&&this.timbres$.pipe(P()).subscribe(b=>{Oe(b)&&(b=[]),b.push(r),this.setTotal(1)})}),this.timbreUtilsService.reinitResume$.next(!0))}).catch(c=>{console.error("Erreur d'ajout :",c)})):console.error("timbre "+r.getId()+" d\xE9j\xE0 existant")})}modifier(r){r.setTimbreBlocModel(null),r.setTimbreAcquisModel(null),this.firestore.collection("/timbres").ref.where("id","==",r.getId()).get().then(n=>{n.forEach(s=>{s.ref.update(Object.assign(new Object,r)).then(c=>{this.timbres$.pipe(P(f=>S(f)&&f?.length>0)).subscribe(f=>{let b=f.find(E=>E.getId()==r.getId());S(b)&&Object.assign(b,r)})}).catch(c=>{console.error("Erreur de mise \xE0 jour :",c)})})}).catch(n=>{console.error("Erreur de mise \xE0 jour id introuvable :",n)})}supprimerTimbre(r){this.firestore.collection("/timbres").ref.where("id","==",r.getId()).get().then(n=>{n.forEach(s=>{s.ref.delete().then(c=>{this.timbres$.pipe(P()).subscribe(f=>{let b=f.findIndex(E=>E.getId()==r.getId());b>=0&&(f.splice(b,1),this.setTotal(-1))})}).catch(c=>{console.error("Erreur de suppression :",c)})})}).catch(n=>{console.error("Erreur de suppression id introuvable :",n)})}supprimer(r){this.timbreUtilsService.supprimerTimbreAcquis(r),this.supprimerTimbre(r),this.timbreUtilsService.reinitResume$.next(!0)}getBouchon(){let r=new Dt;return r.setAnnee(new Date().getFullYear()),r.setMonnaie("E"),r.setType(""),r.setYt(""),r}upload(r,n,s){let c=100,f=100;return n=="table"?(c=c*(50/f),f=50):n=="zoom"&&(c=c*(700/f),f=700),this.uploadService.processAndUploadImage(r?.getImage(),c,f,S(s)?s:r?.getId(),this.getDossier(r,n))}getDossier(r,n){let s="timbre2//";return S(r.getIdBloc())?s=s+r.getTimbreBlocModel().getAnnee():s=s+r.getAnnee(),S(n)&&(s=s+"/"+n),S(r.getIdBloc())&&(s=s+"/bloc/"+r.getIdBloc()),s}acquisDoublon(r,n){this.authService.user$.pipe(P(s=>S(s))).subscribe(s=>{s?.getDroit()>=9?this.timbreUtilsService.acquis(r,n):this.utilsService.droitInsuffisant()})}modifierDialog(r){let n=this.dialog.open(Nn,{height:"75vh",maxHeight:"750px",width:"30%"});n.componentInstance.id=r.getId(),n.afterClosed().subscribe(()=>{n.close()})}supprimerDialog(r){let n=this.dialog.open(Ji,{maxHeight:"95vh",data:{titre:"Confirmation",message:"Souhaitez-vous supprimer le timbre <b>n\xB0 "+r?.getId()+"</b> ?",btnDroite:"Oui",btnGauche:"Non"}});n.afterClosed().subscribe(()=>{n.componentInstance.data.resultat==="valider"&&this.supprimer(r)})}static \u0275fac=function(n){return new(n||o)(Te(vn),Te(tt),Te(Ve),Te(On),Te(nt),Te(Me),Te(At),Te(Xt))};static \u0275prov=Bi({token:o,factory:o.\u0275fac})};var K_=["canvas"];function Q_(o,r){if(o&1&&(le(0),G(1,"img",6),se()),o&2){let n=r.$implicit;h(),v("src",n,Tn)}}function Z_(o,r){if(o&1&&(T(0,"div",4),D(1,Q_,2,1,"ng-container",5),x()),o&2){let n=y();h(),v("ngForOf",n.selectedImages)}}var Ro=class o{constructor(r){this.utilsService=r}canvas;label="Choisir les images";maxWidth=100;maxHeight=200;alignLabel;outPutFiles=new zc;selectedImages=[];id="file"+Math.floor(Math.random()*Math.floor(1e3));FontAwesomeEnum=St;FontAwesomeTypeEnum=yt;triggerFileInput(){document.getElementById(this.id).click()}onFileSelected(r){let n=r.target.files;this.selectedImages=[];let s=[];n&&n?.length>0&&(Array.from(n).forEach(c=>{let f=new FileReader;f.onload=b=>{b.target?.result&&this.selectedImages.push(b.target.result)},f.readAsDataURL(c),s.push(c)}),this.outPutFiles.emit(s))}static \u0275fac=function(n){return new(n||o)(V(nt))};static \u0275cmp=Ce({type:o,selectors:[["lib-upload-multiple"]],viewQuery:function(n,s){if(n&1&&gi(K_,5),n&2){let c;bi(c=_i())&&(s.canvas=c.first)}},inputs:{label:"label",maxWidth:"maxWidth",maxHeight:"maxHeight",alignLabel:"alignLabel"},outputs:{outPutFiles:"outPutFiles"},decls:5,vars:3,consts:[[1,"form-input","uploadMultiple"],["type","file","accept","image/*","multiple","","hidden","",3,"change","id"],["type","button","mat-raised-button","","color","accent",1,"rounded","large","color-white",3,"click"],["class","listeImage",4,"ngIf"],[1,"listeImage"],[4,"ngFor","ngForOf"],["alt","Image preview",1,"imgSelect",3,"src"]],template:function(n,s){n&1&&(T(0,"div",0)(1,"input",1),j("change",function(f){return s.onFileSelected(f)}),x(),T(2,"button",2),j("click",function(){return s.triggerFileInput()}),B(3),x(),D(4,Z_,2,1,"div",3),x()),n&2&&(h(),bo("id",s.id),h(2),$(" ",s.label," "),h(),v("ngIf",s.selectedImages.length))},dependencies:[et,Se,it],styles:[".uploadMultiple[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:start;align-items:stretch;gap:10px;width:100%}.uploadMultiple[_ngcontent-%COMP%]   .listeImage[_ngcontent-%COMP%]{flex-direction:row;flex-wrap:wrap;justify-content:left;width:100%}.uploadMultiple[_ngcontent-%COMP%]   .listeImage[_ngcontent-%COMP%]   .imgSelect[_ngcontent-%COMP%]{margin:5px;max-width:100px;max-height:150px}"]})};var Un=class o{transform(r,n){let s=[],c=Object.keys(r),f=Object.values(r);for(let b=0;b<c.length;b++)s.push({key:c[b],value:f[b]});return n=="sort"?s?.sort(function(b,E){return b.key<E.key?-1:b.key>E.key?1:0}):s}static \u0275fac=function(n){return new(n||o)};static \u0275pipe=go({name:"enumToArray",type:o,pure:!0})};var Pn=class o{transform(r,n){return S(r)&&typeof r=="string"?(r=r.toLowerCase(),r.charAt(0).toUpperCase()+r.slice(1)):r}static \u0275fac=function(n){return new(n||o)};static \u0275pipe=go({name:"capitalize",type:o,pure:!0})};var J_=["canvas"];function eh(o,r){o&1&&G(0,"lib-spinner",5),o&2&&v("textSpec","Chargement en cours ...")}function th(o,r){if(o&1&&(G(0,"mat-error",23),O(1,"async")),o&2){let n=y(2);v("innerHTML",L(1,1,n.messageError$),hn)}}function ih(o,r){if(o&1&&(T(0,"mat-option",25),B(1),O(2,"capitalize"),x()),o&2){let n=y().$implicit;v("value",n.value),h(),$(" ",L(2,2,n.value)," ")}}function nh(o,r){if(o&1&&(le(0),D(1,ih,3,4,"mat-option",24),se()),o&2){let n=r.$implicit,s=y(2);h(),v("ngIf",n.value!=s.TypeTimbreEnum.TIMBRE)}}function rh(o,r){if(o&1){let n=ue();T(0,"form",6,1),j("ngSubmit",function(){H(n);let c=ye(1),f=y();return W(f.valider(c))}),T(2,"div",7),D(3,th,2,3,"mat-error",8),O(4,"async"),T(5,"div",9)(6,"div",10)(7,"label"),G(8,"lib-libelle-model",11),x(),T(9,"input",12),Pe("ngModelChange",function(c){H(n);let f=y();return Ue(f.timbreBlocModel.annee,c)||(f.timbreBlocModel.annee=c),W(c)}),x()(),T(10,"div",13)(11,"label"),G(12,"lib-libelle-model",11),x(),T(13,"mat-select",14),Pe("ngModelChange",function(c){H(n);let f=y();return Ue(f.timbreBlocModel.type,c)||(f.timbreBlocModel.type=c),W(c)}),D(14,nh,2,1,"ng-container",15),O(15,"enumToArray"),x()()(),T(16,"div",9)(17,"div",10)(18,"label"),G(19,"lib-libelle-model",11),x(),T(20,"input",16),Pe("ngModelChange",function(c){H(n);let f=y();return Ue(f.timbreBlocModel.yt,c)||(f.timbreBlocModel.yt=c),W(c)}),x()(),G(21,"div",17),x(),T(22,"lib-upload",18),j("outPutObject",function(c){H(n);let f=y();return W(f.timbreBlocModel=c)}),x(),T(23,"lib-upload-multiple",19),j("outPutFiles",function(c){H(n);let f=y();return W(f.selectTimbres(c))}),x()(),T(24,"div",20)(25,"button",21),j("click",function(){H(n);let c=y();return W(c.close())}),B(26," Annuler "),x(),T(27,"button",22),B(28," Enregistrer "),x()()()}if(o&2){let n=ye(1),s=y();v("ngClass",n!=null&&n.submitted?"red-color":"blue-color"),h(3),v("ngIf",L(4,23,s.messageError$)),h(5),v("object",s.timbreBlocModel)("key","annee"),h(),Fe("ngModel",s.timbreBlocModel.annee),v("max",s.maxAnnee)("zMax",s.maxAnnee),h(3),v("object",s.timbreBlocModel)("key","type"),h(),Fe("ngModel",s.timbreBlocModel.type),v("placeholder","Type"),h(),v("ngForOf",L(15,25,s.TypeTimbreEnum)),h(5),v("object",s.timbreBlocModel)("key","yt"),h(),Fe("ngModel",s.timbreBlocModel.yt),h(2),v("object",s.timbreBlocModel)("key","image")("zoom",s.timbreBlocModel.getImageZoom())("maxWidth",s.DimensionImageEnum.WIDTH_TIMBRE)("maxHeight",s.DimensionImageEnum.HEIGTH_TIMBRE),h(),v("label","Timbres")("maxWidth",s.DimensionImageEnum.WIDTH_TIMBRE)("maxHeight",s.DimensionImageEnum.HEIGTH_TIMBRE)}}var qn=class o{constructor(r,n,s,c,f,b){this.httpResponseHandlerService=r;this.dialogRef=n;this.utilsService=s;this.timbreBlocService=c;this.timbreService=f;this.timbreUtilsService=b}canvas;messageError$=new _e(null);load$=new _e(null);id;maxAnnee=new Date().getFullYear()+1;timbreBlocModel=new Pi;fileUploadModel=new qi;DimensionImageEnum=Xi;TypeTimbreEnum=$t;ngOnInit(){this.fileUploadModel=this.timbreUtilsService.initUpload(),this.load$.next(!1),S(this.id)?this.timbreBlocService.getBlocByIdAsync(this.id).subscribe(r=>{this.timbreBlocModel=r,this.load$.next(!0)}):(this.timbreBlocModel.setAnnee(new Date().getFullYear()),this.timbreBlocModel.setMonnaie("E"),this.load$.next(!0))}valider(r){if(this.messageError$.next(null),r?.valid)if(S(this.timbreBlocModel.getImage()))this.saveData();else{this.messageError$.next("Veuillez s\xE9lectionner une image");return}}saveData(){this.load$.next(!1),S(this.timbreBlocModel.getId())?this.save():this.ajouter()}ajouter(){this.utilsService.getMaxIdentAsync("/timbres_bloc").pipe(P()).subscribe(r=>{this.timbreBlocModel.setId(r),this.save(!0)})}save(r){this.timbreBlocModel.getAnnee()>=2002?this.timbreBlocModel.setMonnaie("E"):this.timbreBlocModel.getAnnee()>=1999?this.timbreBlocModel.setMonnaie("FE"):this.timbreBlocModel.setMonnaie("F");try{We([this.timbreBlocService.upload(this.timbreBlocModel,"autre"),this.timbreBlocService.upload(this.timbreBlocModel,"table"),this.timbreBlocService.upload(this.timbreBlocModel,"zoom")]).pipe(P(([n,s,c])=>S(n)&&S(c)&&S(s))).subscribe(([n,s,c])=>{S(n)&&n!="nok"&&this.timbreBlocModel.setImage(n),S(s)&&s!="nok"&&this.timbreBlocModel.setImageTable(s),S(c)&&c!="nok"&&this.timbreBlocModel.setImageZoom(c),r?this.timbreBlocService.ajouter(this.timbreBlocModel,!0):this.timbreBlocService.modifier(this.timbreBlocModel),this.timbreBlocModel?.getTimbres()?.length>0?this.saveTimbres():this.validSuccess()})}catch{this.httpResponseHandlerService.showNotificationError("Transaction non aboutie","Votre timbre n'a pas pu \xEAtre modifi\xE9."),this.load$.next(!0)}}validSuccess(){this.httpResponseHandlerService.showNotificationSuccess("Transaction termin\xE9e","Votre timbre a bien \xE9t\xE9 modifi\xE9e."),this.load$.next(!0),this.dialogRef.close()}saveTimbres(){this.timbreBlocModel?.getTimbres()?.length>0&&this.utilsService.getMaxIdentAsync("/timbres").pipe(P()).subscribe(r=>{this.timbreBlocModel?.getTimbres().forEach((n,s)=>{n.setIdBloc(this.timbreBlocModel.getId()),n.setTimbreBlocModel(this.timbreBlocModel),n.setMonnaie(this.timbreBlocModel.getMonnaie()),n.setAnnee(this.timbreBlocModel.getAnnee()),n.setId(r),r++,We([this.timbreService.upload(n,"autre"),this.timbreService.upload(n,"table"),this.timbreService.upload(n,"zoom")]).pipe(P(([c,f,b])=>S(c)&&S(b)&&S(f))).subscribe(([c,f,b])=>{S(c)&&c!="nok"&&n.setImage(c),S(f)&&f!="nok"&&n.setImageTable(f),S(b)&&b!="nok"&&n.setImageZoom(b),this.timbreService.ajouter(n,!0),this.httpResponseHandlerService.showNotificationSuccess("Transaction termin\xE9e","Votre timbre a bien \xE9t\xE9 modifi\xE9e."),s==this.timbreBlocModel.getTimbres().length-1&&this.validSuccess()})})})}close(){this.dialogRef.close()}selectTimbres(r){this.timbreBlocModel.setTimbres(null),S(r)&&r?.length>0&&r.forEach(n=>{let s=new Dt;s.setImage(n),s.setYt(n?.name?.replace(/\.([a-z]+)$/,"")),this.timbreBlocModel.addTimbre(s)})}static \u0275fac=function(n){return new(n||o)(V(Co),V(Qt),V(nt),V(Ve),V(Le),V(Me))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-modifier-bloc"]],viewQuery:function(n,s){if(n&1&&gi(J_,5),n&2){let c;bi(c=_i())&&(s.canvas=c.first)}},decls:10,vars:6,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","space-between stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","column","fxLayoutGap","20px",1,"bloc-modal"],[3,"innerHTML",4,"ngIf"],["fxLayout","row","fxLayout.lt-lg","column","fxLayoutGap","30px","fxLayoutGap.lt-lg","5px"],["fxLayout","column",1,"form-input"],[3,"object","key"],["name","page","type","number","minlength","4","maxlength","4","min","1900","zMin","1900","required","","zControl","",1,"annee",2,"width","60px !important",3,"ngModelChange","ngModel","max","zMax"],[1,"form-input","select"],["name","type","required","",1,"scrollBarAccent",2,"width","100px",3,"ngModelChange","ngModel","placeholder"],[4,"ngFor","ngForOf"],["name","yt","type","text","trim","","zControl","",3,"ngModelChange","ngModel"],["fxHide.lt-lg","","fxLayout","column",1,"form-input"],[3,"outPutObject","object","key","zoom","maxWidth","maxHeight"],[3,"outPutFiles","label","maxWidth","maxHeight"],["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"],[3,"innerHTML"],["class","selectMin",3,"value",4,"ngIf"],[1,"selectMin",3,"value"]],template:function(n,s){if(n&1&&(T(0,"div",2)(1,"div",3)(2,"span"),B(3),x(),T(4,"span"),B(5),x()(),D(6,eh,1,1,"ng-template",4),O(7,"async"),D(8,rh,29,27,"ng-template",null,0,Je),x()),n&2){let c=ye(9);h(3),$("",s.timbreBlocModel!=null&&s.timbreBlocModel.getId()?"MODIFICATION":"AJOUT"," BLOC "),h(2),_o(s.timbreBlocModel==null?null:s.timbreBlocModel.getId()),h(),v("ngIf",L(7,4,s.load$)==!1)("ngIfElse",c)}},dependencies:[it,wn,Bt,wt,Ct,et,Se,zt,Oi,Kt,Yt,Li,To,Mt,Ui,xn,Cn,Et,Ni,Mn,En,In,Sn,yn,It,Fi,Bn,Rt,An,yo,Rn,Dn,So,Ro,we,Un,Pn],encapsulation:2})};var tn=class extends Ri{type;total;constructor(r,n){super(),this.type=r||null,this.total=n||null}getType(){return this.type}setType(r){this.type=r}getTotal(){return this.total}setTotal(r){this.total=r}};re([oe("Type")],tn.prototype,"type",2),re([oe("Total")],tn.prototype,"total",2);var ms=Gc(Lu());var Ve=class o{constructor(r,n,s,c,f,b,E){this.firestore=r;this.authService=n;this.uploadService=s;this.utilsService=c;this.timbreUtilsService=f;this.dialog=b;this.preferenceService=E}total$=new _e([]);timbresBlocModel$=new _e(null);load$=new _e(!1);upload(r,n,s){let c=100,f=100;return n=="table"?(c=c*(50/f),f=50):n=="zoom"&&(c=c*(700/f),f=700),this.uploadService.processAndUploadImage(r?.getImage(),c,f,"bloc-"+r.getId(),this.getDossier(r,n,s))}setTotal(r,n){this.total$.pipe(P()).subscribe(s=>{let c=s.find(f=>f.getType()==r?.getType());S(c)?c.setTotal(c.getTotal()+1):s.push(new tn(r?.getType(),1)),this.total$.next(s)})}getTotal(r){this.total$.next(null),this.getAllBlocs(r).subscribe(n=>{let s=[];Object.keys($t).forEach(c=>{c!="TIMBRE"&&s.push(new tn(c,n?.filter(f=>f.type==c)?.length))}),this.total$.next(s)})}getBloc(r){return this.firestore.collection("/timbres_bloc",n=>n.where("id","==",r)).valueChanges()}getBlocByIdAsync(r){return this.getBloc(r).pipe(jt(n=>Di(Pi,n[0])))}getRef(r,n){let s=r;return S(n)&&(S(n.getAnnees())&&n.getAnnees()?.length>0&&(s=s.where("annee","in",n.getAnnees())),S(n.getType())&&n.getType()?.length>0&&(s=s.where("type","in",n.getType()))),s=s.orderBy("id",n?.getSort()=="desc"?"desc":"asc"),s}getAllBlocs(r){return this.firestore.collection("/timbres_bloc",n=>this.getRef(n,r)).valueChanges()}getTimbreBlocAcquis(){return this.authService.userSelect$.pipe(P(r=>S(r)),fo(r=>S(r)?this.getTimbreBlocAcquisByUser(r.getId()).pipe(P(),jt(n=>n)):null))}getTimbreBlocAcquisByUser(r){return this.firestore.collection("/timbres_bloc_acquis",n=>n.where("idUser","==",r)).valueChanges()}getBlocs(r,n){this.load$.next(!1),this.timbresBlocModel$.next(null),n&&this.getTotal(),We([this.getAllBlocs(r),this.getTimbreBlocAcquis()]).pipe(P()).subscribe(([s,c])=>{this.timbresBlocModel$.next(this.constructBlocs(s,c,r)),this.load$.next(!0)})}getBlocsAsync(r){return this.timbresBlocModel$.next(null),this.getAllBlocs(r).pipe(P(),jt(n=>this.constructBlocs(n,null,r)))}constructBloc(r,n){let s=Di(Pi,r);if(S(n)){let c=n.find(f=>f.idBloc==s.getId());S(c)?s.setTimbreBlocAcquisModel(Di(Ot,c)):s.setTimbreBlocAcquisModel(new Ot)}return s}constructBlocs(r,n,s){let c=[];return r?.length>0&&r.forEach(f=>{let b=this.constructBloc(f,n);this.getTimbresByBlocAsync(b.getId()).subscribe(R=>{b.setNbTimbres(R?.length)});let E=!0;S(s)?S(b.getTimbreBlocAcquisModel())&&(S(s.getAcquis())&&!(s.getAcquis()=="TOUS"||s.getAcquis()=="OUI"&&b.getTimbreBlocAcquisModel().isAcquis()||s.getAcquis()=="NON"&&!b.getTimbreBlocAcquisModel().isAcquis())&&(E=!1),S(s.getDoublon())&&!(s.getDoublon()=="TOUS"||s.getDoublon()=="OUI"&&b.getTimbreBlocAcquisModel().isDoublon()||s.getDoublon()=="NON"&&!b.getTimbreBlocAcquisModel().isDoublon())&&(E=!1)):E=!0,E==!0&&c.push(b)}),c}acquis(r,n){return this.authService.userSelect$.pipe(P(s=>S(s))).subscribe(s=>{S(r?.getTimbreBlocAcquisModel()?.getIdUser())?this.firestore.collection("/timbres_bloc_acquis").ref.where("idBloc","==",r.getId()).where("idUser","==",s.getId()).get().then(c=>{c.forEach(f=>{let b=r.getTimbreBlocAcquisModel();n?(b.setAcquis(!0),b.setDoublon(!b.isDoublon())):(b.setAcquis(!b.isAcquis()),b.isAcquis()||b.setDoublon(!1)),f.ref.update(Object.assign(new Object,b)).then(E=>{r.setTimbreBlocAcquisModel(b)}).catch(E=>{console.error("Erreur de mise \xE0 jour:",E)})})}).catch(c=>{console.error("Erreur de mise \xE0 jour:",c)}):this.addAcquis(s?.getId(),r,n),this.timbreUtilsService.reinitResume$.next(!0)})}addAcquis(r,n,s){let c=new Ot;c.setIdUser(r),c.setIdBloc(n.getId()),c.setAcquis(!0),c.setDoublon(s),n.setTimbreBlocAcquisModel(c),this.firestore.collection("/timbres_bloc_acquis").add(Object.assign(new Object,c))}ajouterSansId(r){this.utilsService.getMaxIdentAsync("/timbres_bloc").pipe(P()).subscribe(n=>{r.setId(n),this.ajouter(r,!0)})}ajouter(r,n){let s=(0,ms.cloneDeep)(r);this.getBloc(s.getId()).pipe(P()).subscribe(c=>{Oe(c)||Oe(c[0])||S(c[0])&&c[0]?.length==0?(s.setTimbreBlocAcquisModel(null),s.setTimbres(null),s.setIdOrigine(null),this.firestore.collection("/timbres_bloc").add(Object.assign(new Object,s)).then(f=>{this.preferenceService.getTimbreCritere("timbreCritere").pipe(P()).subscribe(b=>{S(b.getAnnees().find(E=>E==s.getAnnee()))&&this.timbresBlocModel$.pipe(P()).subscribe(E=>{Oe(E)&&(E=[]),E.push(s),this.setTotal(s,1)})}),this.timbreUtilsService.reinitResume$.next(!0)}).catch(f=>{console.error("Erreur d'ajout :",f)})):console.error("bloc "+s.getId()+" d\xE9j\xE0 existant")})}isCarnet(r){this.authService.user$.pipe(P(n=>S(n))).subscribe(n=>{n?.getDroit()>=9?(r.getType()=="BLOC"?r.setType("CARNET"):r.getType()=="CARNET"?r.setType("COLLECTOR"):r.setType("BLOC"),this.modifier(r)):this.utilsService.droitInsuffisant()})}modifier(r){let n=(0,ms.cloneDeep)(r);n.setTimbreBlocAcquisModel(null),n.setTimbres(null),this.firestore.collection("/timbres_bloc").ref.where("id","==",n.getId()).get().then(s=>{s.forEach(c=>{c.ref.update(Object.assign(new Object,n)).then(f=>{this.timbresBlocModel$.pipe(P(b=>S(b)&&b?.length>0)).subscribe(b=>{let E=b.find(R=>R.getId()==n.getId());S(E)&&Object.assign(E,n)})}).catch(f=>{console.error("Erreur de mise \xE0 jour :",f)})})}).catch(s=>{console.error("Erreur de mise \xE0 jour id introuvable :",s)})}getTimbresByBlocAsync(r){let n=new pr;return n.setIdBloc(r),this.timbreUtilsService.getTimbresByCritereAsync(n)}supprimer(r){this.getTimbresByBlocAsync(r.getId()).pipe(P()).subscribe(n=>{n.forEach(s=>{this.timbreUtilsService.supprimerTimbreAcquis(s),this.timbreUtilsService.supprimerTimbre(s)})}),this.firestore.collection("/timbres_bloc_acquis").ref.where("idBloc","==",r.getId()).get().then(n=>{n.forEach(s=>{s.ref.delete()})}),this.firestore.collection("/timbres_bloc").ref.where("id","==",r.getId()).get().then(n=>{n.forEach(s=>{s.ref.delete().then(c=>{this.timbresBlocModel$.pipe(P()).subscribe(f=>{let b=f.findIndex(E=>E.getId()==r.getId());b>=0&&(f.splice(b,1),this.setTotal(r,-1))})}).catch(c=>{console.error("Erreur de suppression :",c)})})}).catch(n=>{console.error("Erreur de suppression id introuvable :",n)}),this.timbreUtilsService.reinitResume$.next(!0)}getDossier(r,n,s){let c="timbre2//"+r.getAnnee();return S(n)&&(c=c+"/"+n),c=c+"/bloc/"+(S(s)?s:r.getId()),c}getBouchon(){let r=new Pi;return r.setAnnee(new Date().getFullYear()),r.setMonnaie("E"),r}acquisDoublon(r,n){this.authService.user$.pipe(P(s=>S(s))).subscribe(s=>{s?.getDroit()>=9?r?.getType()=="CARNET"?this.acquisCarnetDialog(r,n):this.acquis(r,n):this.utilsService.droitInsuffisant()})}acquisCarnetDialog(r,n){let s="";r?.getTimbreBlocAcquisModel()?.isDoublon()&&n?s="enlever les doublons":r?.getTimbreBlocAcquisModel()?.isAcquis()?s="enlever les acquis":s="mettre en "+(n?"doublon":"acquis")+" tous";let c=this.dialog.open(Ji,{maxHeight:"95vh",data:{titre:"Confirmation",message:"Souhaitez-vous <b>"+s+"</b> les timbres du "+r?.getType()?.toLowerCase()+" ?",btnDroite:"Oui",btnGauche:"Non"}});c.afterClosed().subscribe(()=>{c.componentInstance.data.resultat==="valider"&&this.authService.userSelect$.pipe(P(f=>S(f))).subscribe(f=>{this.getTimbresByBlocAsync(r.getId()).pipe(P()).subscribe(b=>{b.forEach(E=>{this.timbreUtilsService.acquis(E,n,!r?.getTimbreBlocAcquisModel()?.isAcquis())})}),this.acquis(r,n)})})}modifierDialog(r){let n=this.dialog.open(qn,{height:"75vh",maxHeight:"750px",width:"30%"});n.componentInstance.id=r.getId(),n.afterClosed().subscribe(()=>{n.close()})}supprimerDialog(r){this.getTimbresByBlocAsync(r.getId()).pipe(P()).subscribe(n=>{let s="";S(n)&&n?.length>0&&(s="<span class='warn'>Attention <b>"+n.length+"</b> timbre",n?.length>1?s+="s sont reli\xE9s":s+=" est reli\xE9",s+=" \xE0 ce bloc.</span></br></br>"),s+="Souhaitez-vous supprimer le bloc <b>n\xB0 "+r?.getId()+"</b> ?";let c=this.dialog.open(Ji,{maxHeight:"95vh",data:{titre:"Confirmation",message:s,btnDroite:"Oui",btnGauche:"Non"}});c.afterClosed().subscribe(()=>{c.componentInstance.data.resultat==="valider"&&this.supprimer(r)})})}modifAll(){let r=new pr;this.getAllBlocs(r).pipe(P(n=>n?.length>0)).subscribe(n=>{n.forEach(s=>{s.carnet==!0?s.type="CARNET":s.type="BLOC",this.firestore.collection("/timbres_bloc").ref.where("id","==",s.id).get().then(c=>{c.forEach(f=>{f.ref.update(s)})})})})}static \u0275fac=function(n){return new(n||o)(Te(vn),Te(tt),Te(On),Te(nt),Te(Me),Te(At),Te(Xt))};static \u0275prov=Bi({token:o,factory:o.\u0275fac})};var pe=class extends Ri{annee;total;nombre;acquis;doublon;nombreCarnet;nombreTimbresCarnet;acquisTimbresCarnet;doublonTimbresCarnet;nombreCollector;acquisCollector;doublonCollector;nombreTimbresCollector;acquisTimbresCollector;doublonTimbresCollector;nombreBloc;acquisBloc;doublonBloc;nombreTimbresBloc;acquisTimbresBloc;doublonTimbresBloc;constructor(r,n,s,c,f,b,E,R,F,de,Z,rt,ii,Ge,Ht,Hn,ot,ni,lt,ri,ft){super(),this.annee=r||null,this.total=n||0,this.nombre=s||0,this.acquis=c||0,this.doublon=f||0,this.nombreCarnet=b||0,this.nombreTimbresCarnet=E||0,this.acquisTimbresCarnet=R||0,this.doublonTimbresCarnet=F||0,this.nombreCollector=de||0,this.nombreCollector=de||0,this.acquisCollector=Z||0,this.nombreTimbresCollector=ii||0,this.acquisTimbresCollector=Ge||0,this.doublonTimbresCollector=Ht||0,this.nombreBloc=Hn||0,this.acquisBloc=ot||0,this.doublonBloc=ni||0,this.nombreTimbresBloc=lt||0,this.acquisTimbresBloc=ri||0,this.doublonTimbresBloc=ft||0}getAnnee(){return this.annee}setAnnee(r){this.annee=r}getTotal(){return this.total}setTotal(r){this.total=r}getNombre(){return this.nombre}setNombre(r){this.nombre=r}getAcquis(){return this.acquis}setAcquis(r){this.acquis=r}getDoublon(){return this.doublon}setDoublon(r){this.doublon=r}getNombreCarnet(){return this.nombreCarnet}setNombreCarnet(r){this.nombreCarnet=r}getNombreTimbresCarnet(){return this.nombreTimbresCarnet}setNombreTimbresCarnet(r){this.nombreTimbresCarnet=r}getAcquisTimbresCarnet(){return this.acquisTimbresCarnet}setAcquisTimbresCarnet(r){this.acquisTimbresCarnet=r}getDoublonTimbresCarnet(){return this.doublonTimbresCarnet}setDoublonTimbresCarnet(r){this.doublonTimbresCarnet=r}getNombreCollector(){return this.nombreCollector}setNombreCollector(r){this.nombreCollector=r}getAcquisCollector(){return this.acquisCollector}setAcquisCollector(r){this.acquisCollector=r}getDoublonCollector(){return this.doublonCollector}setDoublonCollector(r){this.doublonCollector=r}getNombreTimbresCollector(){return this.nombreTimbresCollector}setNombreTimbresCollector(r){this.nombreTimbresCollector=r}getAcquisTimbresCollector(){return this.acquisTimbresCollector}setAcquisTimbresCollector(r){this.acquisTimbresCollector=r}getDoublonTimbresCollector(){return this.doublonTimbresCollector}setDoublonTimbresCollector(r){this.doublonTimbresCollector=r}getNombreBloc(){return this.nombreBloc}setNombreBloc(r){this.nombreBloc=r}getAcquisBloc(){return this.acquisBloc}setAcquisBloc(r){this.acquisBloc=r}getDoublonBloc(){return this.doublonBloc}setDoublonBloc(r){this.doublonBloc=r}getNombreTimbresBloc(){return this.nombreTimbresBloc}setNombreTimbresBloc(r){this.nombreTimbresBloc=r}getAcquisTimbresBloc(){return this.acquisTimbresBloc}setAcquisTimbresBloc(r){this.acquisTimbresBloc=r}getDoublonTimbresBloc(){return this.doublonTimbresBloc}setDoublonTimbresBloc(r){this.doublonTimbresBloc=r}};re([oe("Ann\xE9e")],pe.prototype,"annee",2),re([oe("Total")],pe.prototype,"total",2),re([oe("Nombre timbres")],pe.prototype,"nombre",2),re([oe("Total de timbres acquis")],pe.prototype,"acquis",2),re([oe("Total de timbres en doublon")],pe.prototype,"doublon",2),re([oe("Carnet")],pe.prototype,"nombreCarnet",2),re([oe("Timbres carnet")],pe.prototype,"nombreTimbresCarnet",2),re([oe("Total timbres carnet acquis")],pe.prototype,"acquisTimbresCarnet",2),re([oe("Total timbres carnet en doublon")],pe.prototype,"doublonTimbresCarnet",2),re([oe("Collector")],pe.prototype,"nombreCollector",2),re([oe("Total bloc collector")],pe.prototype,"acquisCollector",2),re([oe("Total bloc en collector")],pe.prototype,"doublonCollector",2),re([oe("Timbres collector")],pe.prototype,"nombreTimbresCollector",2),re([oe("Total timbres collector acquis")],pe.prototype,"acquisTimbresCollector",2),re([oe("Total timbres collector en doublon")],pe.prototype,"doublonTimbresCollector",2),re([oe("Collector")],pe.prototype,"nombreBloc",2),re([oe("Total bloc acquis")],pe.prototype,"acquisBloc",2),re([oe("Total bloc en doublon")],pe.prototype,"doublonBloc",2),re([oe("Timbres bloc")],pe.prototype,"nombreTimbresBloc",2),re([oe("Total timbres bloc acquis")],pe.prototype,"acquisTimbresBloc",2),re([oe("Total timbres bloc en doublon")],pe.prototype,"doublonTimbresBloc",2);var Do=class o{constructor(r,n,s){this.timbreService=r;this.timbreBlocService=n;this.timbreUtilsService=s}load$=new _e(!1);timbresResume$=new _e(null);totalTimbreResume$=new _e(null);getResume(r){this.load$.next(!1),this.timbresResume$.next(null),this.totalTimbreResume$.next(null),We([this.timbreUtilsService.getAllTimbres(r),this.timbreService.getTimbreAcquis(),this.timbreBlocService.getAllBlocs(r),this.timbreBlocService.getTimbreBlocAcquis()]).pipe(P()).subscribe(([n,s,c,f])=>{this.timbresResume$.next(this.construct(n,s,c,f)),this.timbreUtilsService.reinitResume$.next(!1)})}construct(r,n,s,c){let f=[];if(r?.length>0&&(r.forEach(b=>{let E=b.annee;if(S(s)&&Oe(b.annee)&&S(b.idBloc)){let de=s.find(Z=>Z.id==b.idBloc);S(de)&&(E=de.annee)}let R=f.find(de=>de.getAnnee()==E);Oe(R)&&(R=new pe,R.setAnnee(E),f.push(R)),R.setTotal(R.getTotal()+1);let F=S(b.idBloc)?s.find(de=>de.id==b.idBloc):null;if(S(b.idBloc)?S(F)&&F.type=="CARNET"?R.setNombreTimbresCarnet(R.getNombreTimbresCarnet()+1):S(F)&&F.type=="COLLECTOR"?R.setNombreTimbresCollector(R.getNombreTimbresCollector()+1):R.setNombreTimbresBloc(R.getNombreTimbresBloc()+1):R.setNombre(R.getNombre()+1),S(n)){let de=n.find(Z=>Z.idTimbre==b.id);S(de)&&(de.acquis==!0&&(S(b.idBloc)?S(F)&&F.type=="CARNET"?R.setAcquisTimbresCarnet(R.getAcquisTimbresCarnet()+1):S(F)&&F.type=="COLLECTOR"?R.setAcquisTimbresCollector(R.getAcquisTimbresCollector()+1):R.setAcquisTimbresBloc(R.getAcquisTimbresBloc()+1):R.setAcquis(R.getAcquis()+1)),de.doublon==!0&&(S(b.idBloc)?S(F)&&F.type=="CARNET"?R.setDoublonTimbresCarnet(R.getDoublonTimbresCarnet()+1):S(F)&&F.type=="COLLECTOR"?R.setDoublonTimbresCollector(R.getDoublonTimbresCollector()+1):R.setDoublonTimbresBloc(R.getDoublonTimbresBloc()+1):R.setDoublon(R.getDoublon()+1)))}}),s.forEach(b=>{let E=f.find(R=>R.getAnnee()==b.annee);if(Oe(E)&&(E=new pe,E.setAnnee(b.annee),f.push(E)),b.type=="CARNET"?E.setNombreCarnet(E.getNombreCarnet()+1):b.type=="COLLECTOR"?E.setNombreCollector(E.getNombreCollector()+1):E.setNombreBloc(E.getNombreBloc()+1),S(c)){let R=c.find(F=>F.idBloc==b.id);S(R)&&(R.acquis==!0&&(Oe(b.type)||b.type=="BLOC"?E.setAcquisBloc(E.getAcquisBloc()+1):b.type=="COLLECTOR"&&E.setAcquisCollector(E.getAcquisCollector()+1)),R.doublon==!0&&(Oe(b.type)||b.type=="BLOC"?E.setDoublonBloc(E.getDoublonBloc()+1):b.type=="COLLECTOR"&&E.setDoublonCollector(E.getDoublonCollector()+1)))}})),S(f)&&f?.length>0){let b=new pe;f.forEach(E=>{b.setTotal(b.getTotal()+E.getTotal()),b.setNombre(b.getNombre()+E.getNombre()),b.setAcquis(b.getAcquis()+E.getAcquis()),b.setDoublon(b.getDoublon()+E.getDoublon()),b.setNombreCarnet(b.getNombreCarnet()+E.getNombreCarnet()),b.setNombreTimbresCarnet(b.getNombreTimbresCarnet()+E.getNombreTimbresCarnet()),b.setAcquisTimbresCarnet(b.getAcquisTimbresCarnet()+E.getAcquisTimbresCarnet()),b.setDoublonTimbresCarnet(b.getDoublonTimbresCarnet()+E.getDoublonTimbresCarnet()),b.setNombreBloc(b.getNombreBloc()+E.getNombreBloc()),b.setAcquisBloc(b.getAcquisBloc()+E.getAcquisBloc()),b.setDoublonBloc(b.getDoublonBloc()+E.getDoublonBloc()),b.setNombreTimbresBloc(b.getNombreTimbresBloc()+E.getNombreTimbresBloc()),b.setAcquisTimbresBloc(b.getAcquisTimbresBloc()+E.getAcquisTimbresBloc()),b.setDoublonTimbresBloc(b.getDoublonTimbresBloc()+E.getDoublonTimbresBloc()),b.setNombreCollector(b.getNombreCollector()+E.getNombreCollector()),b.setAcquisCollector(b.getAcquisCollector()+E.getAcquisCollector()),b.setDoublonCollector(b.getDoublonCollector()+E.getDoublonCollector()),b.setNombreTimbresCollector(b.getNombreTimbresCollector()+E.getNombreTimbresCollector()),b.setAcquisTimbresCollector(b.getAcquisTimbresCollector()+E.getAcquisTimbresCollector()),b.setDoublonTimbresCollector(b.getDoublonTimbresCollector()+E.getDoublonTimbresCollector())}),this.totalTimbreResume$.next(b)}return this.load$.next(!0),f}static \u0275fac=function(n){return new(n||o)(Te(Le),Te(Ve),Te(Me))};static \u0275prov=Bi({token:o,factory:o.\u0275fac})};var Nu=class o{static \u0275fac=function(n){return new(n||o)};static \u0275mod=jc({type:o});static \u0275inj=kc({imports:[Kc,eu,tu,nu,ru,ou,iu,su,lu,yu,it,Su,wt,Bt,xo]})};var Fu=o=>({accent50:o});function lh(o,r){o&1&&G(0,"lib-spinner",2),o&2&&v("textSpec","Chargement en cours ...")}function sh(o,r){if(o&1&&(T(0,"th",34),G(1,"lib-libelle-model",35),x()),o&2){let n=y(2);h(),v("object",n.timbreResumeModel)("key","annee")}}function ah(o,r){if(o&1&&(T(0,"td",36),B(1),x()),o&2){let n=r.$implicit;h(),$(" ",n==null?null:n.getAnnee()," ")}}function ch(o,r){o&1&&G(0,"td",37)}function uh(o,r){if(o&1&&(T(0,"th",34),G(1,"lib-libelle-model",35),x()),o&2){let n=y(2);h(),v("object",n.timbreResumeModel)("key","total")}}function mh(o,r){if(o&1&&(T(0,"td",36),B(1),x()),o&2){let n=r.$implicit;h(),$(" ",n==null?null:n.getTotal()," ")}}function ph(o,r){if(o&1&&(T(0,"td",37)(1,"b"),B(2),O(3,"async"),x()()),o&2){let n,s=y(2);h(2),$("",(n=L(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getTotal()," ")}}function fh(o,r){if(o&1&&(T(0,"th",38),G(1,"lib-libelle-model",35),x()),o&2){let n=y(2);h(),v("object",n.timbreResumeModel)("key","nombre")}}function dh(o,r){if(o&1&&(T(0,"td",39),B(1),x()),o&2){let n=r.$implicit;h(),$(" ",n==null?null:n.getNombre()," ")}}function gh(o,r){if(o&1&&(T(0,"td",37)(1,"b"),B(2),O(3,"async"),x()()),o&2){let n,s=y(2);h(2),$("",(n=L(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombre()," ")}}function bh(o,r){if(o&1&&(T(0,"th",38),G(1,"lib-icon",40),x()),o&2){let n=y(2);h(),v("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK)("info",n.timbreResumeModel.getPropertyLibelle("acquis"))}}function _h(o,r){if(o&1&&(T(0,"td",41),B(1),x()),o&2){let n=r.$implicit;v("ngClass",mr(2,Fu,(n==null?null:n.getNombre())==(n==null?null:n.getAcquis()))),h(),$(" ",n==null?null:n.getAcquis()," ")}}function hh(o,r){if(o&1&&(T(0,"td",37)(1,"b"),B(2),O(3,"async"),x()()),o&2){let n,s=y(2);h(2),$("",(n=L(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquis()," ")}}function Th(o,r){if(o&1&&(T(0,"th",38),G(1,"lib-icon",40),x()),o&2){let n=y(2);h(),v("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK_DOUBLE)("info",n.timbreResumeModel.getPropertyLibelle("doublon"))}}function vh(o,r){if(o&1&&(T(0,"td",41),B(1),x()),o&2){let n=r.$implicit;v("ngClass",mr(2,Fu,(n==null?null:n.getNombre())==(n==null?null:n.getDoublon()))),h(),$(" ",n==null?null:n.getDoublon()," ")}}function xh(o,r){if(o&1&&(T(0,"td",37)(1,"b"),B(2),O(3,"async"),x()()),o&2){let n,s=y(2);h(2),$("",(n=L(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getDoublon()," ")}}function Ch(o,r){if(o&1&&(T(0,"th",38),G(1,"lib-libelle-model",35),x()),o&2){let n=y(2);h(),v("object",n.timbreResumeModel)("key","nombreCarnet")}}function yh(o,r){if(o&1&&(T(0,"td",41),B(1),x()),o&2){let n=r.$implicit;v("ngClass",(n==null?null:n.getNombreCarnet())==0?"gray25":"primary25"),h(),$(" ",(n==null?null:n.getNombreCarnet())>0?n==null?null:n.getNombreCarnet():""," ")}}function Sh(o,r){if(o&1&&(T(0,"td",37)(1,"b"),B(2),O(3,"async"),x()()),o&2){let n,s=y(2);h(2),$("",(n=L(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombreCarnet()," ")}}function Mh(o,r){if(o&1&&(T(0,"th",38),G(1,"lib-libelle-model",35),x()),o&2){let n=y(2);h(),v("object",n.timbreResumeModel)("key","nombreTimbresCarnet")}}function Eh(o,r){if(o&1&&(T(0,"td",41),B(1),x()),o&2){let n=r.$implicit;v("ngClass",(n==null?null:n.getNombreCarnet())==0?"gray25":"primary25"),h(),$(" ",(n==null?null:n.getNombreCarnet())>0?n==null?null:n.getNombreTimbresCarnet():""," ")}}function Ih(o,r){if(o&1&&(T(0,"td",37)(1,"b"),B(2),O(3,"async"),x()()),o&2){let n,s=y(2);h(2),$("",(n=L(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombreTimbresCarnet()," ")}}function wh(o,r){if(o&1&&(T(0,"th",38),G(1,"lib-icon",40),x()),o&2){let n=y(2);h(),v("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK)("info",n.timbreResumeModel.getPropertyLibelle("acquisTimbresCarnet"))}}function Ah(o,r){if(o&1&&(T(0,"td",41),B(1),x()),o&2){let n=r.$implicit;v("ngClass",(n==null?null:n.getNombreTimbresCarnet())==0?"gray25":(n==null?null:n.getNombreTimbresCarnet())==(n==null?null:n.getAcquisTimbresCarnet())?"accent50":"primary25"),h(),$(" ",(n==null?null:n.getNombreCarnet())>0?n==null?null:n.getAcquisTimbresCarnet():""," ")}}function Bh(o,r){if(o&1&&(T(0,"td",37)(1,"b"),B(2),O(3,"async"),x()()),o&2){let n,s=y(2);h(2),$("",(n=L(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquisTimbresCarnet()," ")}}function Rh(o,r){if(o&1&&(T(0,"th",38),G(1,"lib-icon",40),x()),o&2){let n=y(2);h(),v("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK_DOUBLE)("info",n.timbreResumeModel.getPropertyLibelle("doublonTimbresCarnet"))}}function Dh(o,r){if(o&1&&(T(0,"td",41),B(1),x()),o&2){let n=r.$implicit;v("ngClass",(n==null?null:n.getNombreTimbresCarnet())==0?"gray25":(n==null?null:n.getNombreTimbresCarnet())==(n==null?null:n.getDoublonTimbresCarnet())?"accent50":"primary25"),h(),$(" ",(n==null?null:n.getNombreCarnet())>0?n==null?null:n.getDoublonTimbresCarnet():""," ")}}function Oh(o,r){if(o&1&&(T(0,"td",37)(1,"b"),B(2),O(3,"async"),x()()),o&2){let n,s=y(2);h(2),$("",(n=L(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getDoublonTimbresCarnet()," ")}}function Lh(o,r){if(o&1&&(T(0,"th",38),G(1,"lib-libelle-model",35),x()),o&2){let n=y(2);h(),v("object",n.timbreResumeModel)("key","nombreBloc")}}function Nh(o,r){if(o&1&&(T(0,"td",41),B(1),x()),o&2){let n=r.$implicit;v("ngClass",(n==null?null:n.getNombreBloc())==0?"gray25":""),h(),$(" ",(n==null?null:n.getNombreBloc())>0?n==null?null:n.getNombreBloc():""," ")}}function Fh(o,r){if(o&1&&(T(0,"td",37)(1,"b"),B(2),O(3,"async"),x()()),o&2){let n,s=y(2);h(2),$("",(n=L(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombreBloc()," ")}}function Uh(o,r){if(o&1&&(T(0,"th",38),G(1,"lib-icon",40),x()),o&2){let n=y(2);h(),v("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK)("info",n.timbreResumeModel.getPropertyLibelle("acquisBloc"))}}function Ph(o,r){if(o&1&&(T(0,"td",41),B(1),x()),o&2){let n=r.$implicit;v("ngClass",(n==null?null:n.getNombreBloc())==0?"gray25":n.getNombreBloc()==(n==null?null:n.getAcquisBloc())?"accent50":""),h(),$(" ",(n==null?null:n.getNombreBloc())>0?n==null?null:n.getAcquisBloc():""," ")}}function qh(o,r){if(o&1&&(T(0,"td",37)(1,"b"),B(2),O(3,"async"),x()()),o&2){let n,s=y(2);h(2),$("",(n=L(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquisBloc()," ")}}function $h(o,r){if(o&1&&(T(0,"th",38),G(1,"lib-icon",40),x()),o&2){let n=y(2);h(),v("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK_DOUBLE)("info",n.timbreResumeModel.getPropertyLibelle("doublonBloc"))}}function Hh(o,r){if(o&1&&(T(0,"td",41),B(1),x()),o&2){let n=r.$implicit;v("ngClass",(n==null?null:n.getNombreBloc())==0?"gray25":n.getNombreBloc()==(n==null?null:n.getDoublonBloc())?"accent50":""),h(),$(" ",(n==null?null:n.getNombreBloc())>0?n==null?null:n.getDoublonBloc():""," ")}}function Wh(o,r){if(o&1&&(T(0,"td",37)(1,"b"),B(2),O(3,"async"),x()()),o&2){let n,s=y(2);h(2),$("",(n=L(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getDoublonBloc()," ")}}function Vh(o,r){if(o&1&&(T(0,"th",38),G(1,"lib-libelle-model",35),x()),o&2){let n=y(2);h(),v("object",n.timbreResumeModel)("key","nombreTimbresBloc")}}function Gh(o,r){if(o&1&&(T(0,"td",41),B(1),x()),o&2){let n=r.$implicit;v("ngClass",(n==null?null:n.getNombreTimbresBloc())==0?"gray25":"primary25"),h(),$(" ",(n==null?null:n.getNombreTimbresBloc())>0?n==null?null:n.getNombreTimbresBloc():""," ")}}function kh(o,r){if(o&1&&(T(0,"td",37)(1,"b"),B(2),O(3,"async"),x()()),o&2){let n,s=y(2);h(2),$("",(n=L(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombreTimbresBloc()," ")}}function jh(o,r){if(o&1&&(T(0,"th",38),G(1,"lib-icon",40),x()),o&2){let n=y(2);h(),v("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK)("info",n.timbreResumeModel.getPropertyLibelle("acquisTimbresBloc"))}}function zh(o,r){if(o&1&&(T(0,"td",41),B(1),x()),o&2){let n=r.$implicit;v("ngClass",(n==null?null:n.getNombreTimbresBloc())==0?"gray25":(n==null?null:n.getNombreTimbresBloc())==(n==null?null:n.getAcquisTimbresBloc())?"accent50":"primary25"),h(),$(" ",(n==null?null:n.getNombreTimbresBloc())>0?n==null?null:n.getAcquisTimbresBloc():""," ")}}function Yh(o,r){if(o&1&&(T(0,"td",37)(1,"b"),B(2),O(3,"async"),x()()),o&2){let n,s=y(2);h(2),$("",(n=L(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquisTimbresBloc()," ")}}function Kh(o,r){if(o&1&&(T(0,"th",38),G(1,"lib-icon",40),x()),o&2){let n=y(2);h(),v("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK_DOUBLE)("info",n.timbreResumeModel.getPropertyLibelle("doublonTimbresBloc"))}}function Qh(o,r){if(o&1&&(T(0,"td",41),B(1),x()),o&2){let n=r.$implicit;v("ngClass",(n==null?null:n.getNombreTimbresBloc())==0?"gray25":(n==null?null:n.getNombreTimbresBloc())==(n==null?null:n.getDoublonTimbresBloc())?"accent50":"primary25"),h(),$(" ",(n==null?null:n.getNombreTimbresBloc())>0?n==null?null:n.getDoublonTimbresBloc():""," ")}}function Zh(o,r){if(o&1&&(T(0,"td",37)(1,"b"),B(2),O(3,"async"),x()()),o&2){let n,s=y(2);h(2),$("",(n=L(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getDoublonTimbresBloc()," ")}}function Xh(o,r){if(o&1&&(T(0,"th",38),G(1,"lib-libelle-model",35),x()),o&2){let n=y(2);h(),v("object",n.timbreResumeModel)("key","nombreCollector")}}function Jh(o,r){if(o&1&&(T(0,"td",41),B(1),x()),o&2){let n=r.$implicit;v("ngClass",(n==null?null:n.getNombreCollector())==0?"gray25":"primary25"),h(),$(" ",(n==null?null:n.getNombreCollector())>0?n==null?null:n.getNombreCollector():""," ")}}function e1(o,r){if(o&1&&(T(0,"td",37)(1,"b"),B(2),O(3,"async"),x()()),o&2){let n,s=y(2);h(2),$("",(n=L(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombreCollector()," ")}}function t1(o,r){if(o&1&&(T(0,"th",38),G(1,"lib-icon",40),x()),o&2){let n=y(2);h(),v("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK)("info",n.timbreResumeModel.getPropertyLibelle("acquisCollector"))}}function i1(o,r){if(o&1&&(T(0,"td",41),B(1),x()),o&2){let n=r.$implicit;v("ngClass",(n==null?null:n.getNombreCollector())==0?"gray25":n.getNombreCollector()==(n==null?null:n.getAcquisCollector())?"accent50":""),h(),$(" ",(n==null?null:n.getNombreCollector())>0?n==null?null:n.getAcquisCollector():""," ")}}function n1(o,r){if(o&1&&(T(0,"td",37)(1,"b"),B(2),O(3,"async"),x()()),o&2){let n,s=y(2);h(2),$("",(n=L(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquisCollector()," ")}}function r1(o,r){if(o&1&&(T(0,"th",38),G(1,"lib-icon",40),x()),o&2){let n=y(2);h(),v("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK_DOUBLE)("info",n.timbreResumeModel.getPropertyLibelle("doublonCollector"))}}function o1(o,r){if(o&1&&(T(0,"td",41),B(1),x()),o&2){let n=r.$implicit;v("ngClass",(n==null?null:n.getNombreCollector())==0?"gray25":n.getNombreCollector()==(n==null?null:n.getDoublonCollector())?"accent50":""),h(),$(" ",(n==null?null:n.getNombreCollector())>0?n==null?null:n.getDoublonCollector():""," ")}}function l1(o,r){if(o&1&&(T(0,"td",37)(1,"b"),B(2),O(3,"async"),x()()),o&2){let n,s=y(2);h(2),$("",(n=L(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getDoublonCollector()," ")}}function s1(o,r){if(o&1&&(T(0,"th",38),G(1,"lib-libelle-model",35),x()),o&2){let n=y(2);h(),v("object",n.timbreResumeModel)("key","nombreTimbresCollector")}}function a1(o,r){if(o&1&&(T(0,"td",41),B(1),x()),o&2){let n=r.$implicit;v("ngClass",(n==null?null:n.getNombreCollector())==0?"gray25":"primary25"),h(),$(" ",(n==null?null:n.getNombreCollector())>0?n==null?null:n.getNombreTimbresCollector():""," ")}}function c1(o,r){if(o&1&&(T(0,"td",37)(1,"b"),B(2),O(3,"async"),x()()),o&2){let n,s=y(2);h(2),$("",(n=L(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getNombreTimbresCollector()," ")}}function u1(o,r){if(o&1&&(T(0,"th",38),G(1,"lib-icon",40),x()),o&2){let n=y(2);h(),v("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK)("info",n.timbreResumeModel.getPropertyLibelle("acquisTimbresCollector"))}}function m1(o,r){if(o&1&&(T(0,"td",41),B(1),x()),o&2){let n=r.$implicit;v("ngClass",(n==null?null:n.getNombreTimbresCollector())==0?"gray25":(n==null?null:n.getNombreTimbresCollector())==(n==null?null:n.getAcquisTimbresCollector())?"accent50":"primary25"),h(),$(" ",(n==null?null:n.getNombreCollector())>0?n==null?null:n.getAcquisTimbresCollector():""," ")}}function p1(o,r){if(o&1&&(T(0,"td",37)(1,"b"),B(2),O(3,"async"),x()()),o&2){let n,s=y(2);h(2),$("",(n=L(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getAcquisTimbresCollector()," ")}}function f1(o,r){if(o&1&&(T(0,"th",38),G(1,"lib-icon",40),x()),o&2){let n=y(2);h(),v("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.CHECK_DOUBLE)("info",n.timbreResumeModel.getPropertyLibelle("doublonTimbresCollector"))}}function d1(o,r){if(o&1&&(T(0,"td",41),B(1),x()),o&2){let n=r.$implicit;v("ngClass",(n==null?null:n.getNombreTimbresCollector())==0?"gray25":(n==null?null:n.getNombreTimbresCollector())==(n==null?null:n.getDoublonTimbresCollector())?"accent50":"primary25"),h(),$(" ",(n==null?null:n.getNombreCollector())>0?n==null?null:n.getDoublonTimbresCollector():""," ")}}function g1(o,r){if(o&1&&(T(0,"td",37)(1,"b"),B(2),O(3,"async"),x()()),o&2){let n,s=y(2);h(2),$("",(n=L(3,1,s.timbreResumeService.totalTimbreResume$))==null?null:n.getDoublonTimbresCollector()," ")}}function b1(o,r){o&1&&G(0,"tr",42)}function _1(o,r){if(o&1){let n=ue();T(0,"tr",43),j("click",function(){let c=H(n).$implicit,f=y(2);return W(f.filtreParAnnee(c))}),x()}}function h1(o,r){o&1&&G(0,"tr",44)}function T1(o,r){if(o&1){let n=ue();T(0,"table",3),j("matSortChange",function(c){H(n);let f=y();return W(f.sortData(c))}),le(1,4),D(2,sh,2,2,"th",5)(3,ah,2,1,"td",6)(4,ch,1,0,"td",7),se(),le(5,8),D(6,uh,2,2,"th",5)(7,mh,2,1,"td",6)(8,ph,4,3,"td",7),se(),le(9,9),D(10,fh,2,2,"th",10)(11,dh,2,1,"td",11)(12,gh,4,3,"td",7),se(),le(13,12),D(14,bh,2,3,"th",10)(15,_h,2,4,"td",13)(16,hh,4,3,"td",7),se(),le(17,14),D(18,Th,2,3,"th",10)(19,vh,2,4,"td",13)(20,xh,4,3,"td",7),se(),le(21,15),D(22,Ch,2,2,"th",10)(23,yh,2,2,"td",13)(24,Sh,4,3,"td",7),se(),le(25,16),D(26,Mh,2,2,"th",10)(27,Eh,2,2,"td",13)(28,Ih,4,3,"td",7),se(),le(29,17),D(30,wh,2,3,"th",10)(31,Ah,2,2,"td",13)(32,Bh,4,3,"td",7),se(),le(33,18),D(34,Rh,2,3,"th",10)(35,Dh,2,2,"td",13)(36,Oh,4,3,"td",7),se(),le(37,19),D(38,Lh,2,2,"th",10)(39,Nh,2,2,"td",13)(40,Fh,4,3,"td",7),se(),le(41,20),D(42,Uh,2,3,"th",10)(43,Ph,2,2,"td",13)(44,qh,4,3,"td",7),se(),le(45,21),D(46,$h,2,3,"th",10)(47,Hh,2,2,"td",13)(48,Wh,4,3,"td",7),se(),le(49,22),D(50,Vh,2,2,"th",10)(51,Gh,2,2,"td",13)(52,kh,4,3,"td",7),se(),le(53,23),D(54,jh,2,3,"th",10)(55,zh,2,2,"td",13)(56,Yh,4,3,"td",7),se(),le(57,24),D(58,Kh,2,3,"th",10)(59,Qh,2,2,"td",13)(60,Zh,4,3,"td",7),se(),le(61,25),D(62,Xh,2,2,"th",10)(63,Jh,2,2,"td",13)(64,e1,4,3,"td",7),se(),B(65,"> "),le(66,26),D(67,t1,2,3,"th",10)(68,i1,2,2,"td",13)(69,n1,4,3,"td",7),se(),le(70,27),D(71,r1,2,3,"th",10)(72,o1,2,2,"td",13)(73,l1,4,3,"td",7),se(),le(74,28),D(75,s1,2,2,"th",10)(76,a1,2,2,"td",13)(77,c1,4,3,"td",7),se(),le(78,29),D(79,u1,2,3,"th",10)(80,m1,2,2,"td",13)(81,p1,4,3,"td",7),se(),le(82,30),D(83,f1,2,3,"th",10)(84,d1,2,2,"td",13)(85,g1,4,3,"td",7),se(),D(86,b1,1,0,"tr",31)(87,_1,1,0,"tr",32)(88,h1,1,0,"tr",33),x()}if(o&2){let n=y();v("dataSource",n.dataSource),h(86),v("matHeaderRowDef",n.displayedColumns)("matHeaderRowDefSticky",!0),h(),v("matRowDefColumns",n.displayedColumns),h(),v("matFooterRowDef",n.displayedColumns)("matFooterRowDefSticky",!0)}}var Oo=class o{constructor(r,n,s,c,f,b){this.dialogRef=r;this.timbreResumeService=n;this.timbreService=s;this.timbreBlocService=c;this.timbreUtilsService=f;this.preferenceService=b;this.dataSource=new cs([])}paginator;sort;dataSource=new cs;displayedColumns=["annee","total","nombre","acquis","doublon","nombreCarnet","nombreTimbresCarnet","acquisTimbresCarnet","doublonTimbresCarnet","nombreBloc","acquisBloc","doublonBloc","nombreTimbresBloc","acquisTimbresBloc","doublonTimbresBloc","nombreCollector","acquisCollector"];timbreResumeModel=new pe;FontAwesomeEnum=St;FontAwesomeTypeEnum=yt;ngOnInit(){this.timbreUtilsService.reinitResume$.pipe(P()).subscribe(r=>{r==!0&&this.timbreResumeService.getResume(),this.initData()})}initData(){this.timbreResumeService.timbresResume$.pipe(P(r=>S(r)&&r?.length>0)).subscribe(r=>{this.dataSource.data=r})}ngAfterViewInit(){this.dataSource.paginator=this.paginator}sortData(r){S(r)&&(this.dataSource.sort=this.sort)}filtreParAnnee(r){window.location.href.indexOf("bloc")>0?this.preferenceService.getTimbreCritere("blocCritere").pipe(P()).subscribe(n=>{n.initCritereBloc(),n.setAnnees([r.getAnnee()]),this.preferenceService.modifier("blocCritere",n),this.timbreBlocService.getBlocs(n,!1)}):this.preferenceService.getTimbreCritere("timbreCritere").pipe(P()).subscribe(n=>{n.initCritere(),n.setAnnees([r.getAnnee()]),this.preferenceService.modifier("timbreCritere",n),this.timbreService.getTimbres(n,!1)}),this.dialogRef.close()}static \u0275fac=function(n){return new(n||o)(V(Qt),V(Do),V(Le),V(Ve),V(Me),V(Xt))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-resume"]],viewQuery:function(n,s){if(n&1&&(gi(au,5),gi(vo,5)),n&2){let c;bi(c=_i())&&(s.paginator=c.first),bi(c=_i())&&(s.sort=c.first)}},decls:4,vars:4,consts:[["load",""],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["mat-table","","matSort","",3,"matSortChange","dataSource"],["matColumnDef","annee","sticky",""],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","primary50",4,"matCellDef"],["mat-footer-cell","",4,"matFooterCellDef"],["matColumnDef","total","sticky",""],["matColumnDef","nombre"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","acquis"],["mat-cell","",3,"ngClass",4,"matCellDef"],["matColumnDef","doublon"],["matColumnDef","nombreCarnet"],["matColumnDef","nombreTimbresCarnet"],["matColumnDef","acquisTimbresCarnet"],["matColumnDef","doublonTimbresCarnet"],["matColumnDef","nombreBloc"],["matColumnDef","acquisBloc"],["matColumnDef","doublonBloc"],["matColumnDef","nombreTimbresBloc"],["matColumnDef","acquisTimbresBloc"],["matColumnDef","doublonTimbresBloc"],["matColumnDef","nombreCollector"],["matColumnDef","acquisCollector"],["matColumnDef","doublonCollector"],["matColumnDef","nombreTimbresCollector"],["matColumnDef","acquisTimbresCollector"],["matColumnDef","doublonTimbresCollector"],["mat-header-row","","class","bg-primary color-white",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","mat-row",3,"click",4,"matRowDef","matRowDefColumns"],["mat-footer-row","","class","bg-primary color-white",4,"matFooterRowDef","matFooterRowDefSticky"],["mat-header-cell","","mat-sort-header",""],[3,"object","key"],["mat-cell","",1,"primary50"],["mat-footer-cell",""],["mat-header-cell",""],["mat-cell",""],[1,"click",2,"font-size","1.2em",3,"type","icone","info"],["mat-cell","",3,"ngClass"],["mat-header-row","",1,"bg-primary","color-white"],["mat-row","",1,"mat-row",3,"click"],["mat-footer-row","",1,"bg-primary","color-white"]],template:function(n,s){if(n&1&&(D(0,lh,1,1,"ng-template",1),O(1,"async"),D(2,T1,89,6,"ng-template",null,0,Je)),n&2){let c=ye(3);v("ngIf",L(1,2,s.timbreResumeService.load$)==!1)("ngIfElse",c)}},dependencies:[cu,mu,_u,fu,uu,Tu,pu,hu,du,bu,gu,vu,Cu,xu,vo,xo,Ct,Se,Yt,Mt,Rt,Zt,Bn,we],styles:["th[_ngcontent-%COMP%], tr[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{text-align:center}th[_ngcontent-%COMP%]{width:40px!important;max-width:40px!important}.mat-row[_ngcontent-%COMP%]{padding:0!important;height:30px}.mat-row[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{width:40px!important}@media screen and (max-width: 800px){th[_ngcontent-%COMP%]{width:25px!important;max-width:25px!important}.mat-row[_ngcontent-%COMP%]{padding:0!important;height:15px}.mat-row[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{width:25px!important}th[_ngcontent-%COMP%], .mat-row[_ngcontent-%COMP%]{font-size:.8em}}"]})};var Uu=Gc(F_());function v1(o,r){if(o&1&&(T(0,"mat-option",7),B(1),O(2,"capitalize"),x()),o&2){let n=y().$implicit;v("value",n.value),h(),$(" ",L(2,2,n.value)," ")}}function x1(o,r){if(o&1&&(le(0),D(1,v1,3,4,"mat-option",12),se()),o&2){let n=r.$implicit,s=y(2);h(),v("ngIf",n.value!=s.TypeTimbreEnum.COLLECTOR)}}function C1(o,r){if(o&1&&(T(0,"mat-option",7),B(1),x()),o&2){let n=r.$implicit;v("value",n),h(),$(" ",n," ")}}function y1(o,r){if(o&1){let n=ue();T(0,"div",1)(1,"div",2)(2,"mat-select",3),Pe("ngModelChange",function(c){H(n);let f=y();return Ue(f.preferenceService.timbreCritereModel.type,c)||(f.preferenceService.timbreCritereModel.type=c),W(c)}),j("ngModelChange",function(){H(n);let c=y();return W(c.filtreByCritere())}),D(3,x1,2,1,"ng-container",4),O(4,"enumToArray"),x()(),T(5,"div",5)(6,"mat-select",6),Pe("ngModelChange",function(c){H(n);let f=y();return Ue(f.preferenceService.timbreCritereModel.acquis,c)||(f.preferenceService.timbreCritereModel.acquis=c),W(c)}),j("ngModelChange",function(){H(n);let c=y();return W(c.filtreByCritere())}),T(7,"mat-option",7),B(8," Oui"),x(),T(9,"mat-option",7),B(10," Non"),x(),T(11,"mat-option",7),B(12," Tous"),x()()(),T(13,"div",5)(14,"mat-select",8),Pe("ngModelChange",function(c){H(n);let f=y();return Ue(f.preferenceService.timbreCritereModel.doublon,c)||(f.preferenceService.timbreCritereModel.doublon=c),W(c)}),j("ngModelChange",function(){H(n);let c=y();return W(c.filtreByCritere())}),T(15,"mat-option",7),B(16," Oui"),x(),T(17,"mat-option",7),B(18," Non"),x(),T(19,"mat-option",7),B(20," Tous"),x()()(),T(21,"div",9)(22,"mat-select",10),Pe("ngModelChange",function(c){H(n);let f=y();return Ue(f.preferenceService.timbreCritereModel.annees,c)||(f.preferenceService.timbreCritereModel.annees=c),W(c)}),j("ngModelChange",function(){H(n);let c=y();return W(c.filtreByCritere())}),D(23,C1,2,2,"mat-option",11),O(24,"async"),x()()()}if(o&2){let n=y();h(2),Fe("ngModel",n.preferenceService.timbreCritereModel.type),v("placeholder","Type"),h(),v("ngForOf",L(4,16,n.TypeTimbreEnum)),h(3),Fe("ngModel",n.preferenceService.timbreCritereModel.acquis),v("placeholder","Acquis"),h(),v("value","OUI"),h(2),v("value","NON"),h(2),v("value","TOUS"),h(3),Fe("ngModel",n.preferenceService.timbreCritereModel.doublon),v("placeholder","Doublon"),h(),v("value","OUI"),h(2),v("value","NON"),h(2),v("value","TOUS"),h(3),Fe("ngModel",n.preferenceService.timbreCritereModel.annees),v("placeholder","Ann\xE9es"),h(),v("ngForOf",L(24,18,n.annees$))}}var No=class o{constructor(r,n,s,c){this.authService=r;this.timbreService=n;this.timbreUtilsService=s;this.preferenceService=c}modif=!0;annees$;TypeTimbreEnum=$t;ngOnInit(){this.annees$=this.timbreUtilsService.getAnneesAsync("/timbres")}filtreByCritere(){this.preferenceService.timbreCritereModel.getAcquis()=="NON"&&this.preferenceService.timbreCritereModel.setDoublon("TOUS"),this.preferenceService.modifier("timbreCritere",this.preferenceService.timbreCritereModel),this.recherche()}recherche(){S(this.preferenceService.timbreCritereModel.getAnnees())&&this.preferenceService.timbreCritereModel.getAnnees().length>0&&this.timbreService.getTimbres(this.preferenceService.timbreCritereModel,!1)}static \u0275fac=function(n){return new(n||o)(V(tt),V(Le),V(Me),V(Xt))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-recherche"]],inputs:{modif:"modif"},decls:1,vars:1,consts:[["class","menuRecherche",4,"ngIf"],[1,"menuRecherche"],[1,"form-input","select",2,"width","120px"],["name","type","multiple","",1,"scrollBarAccent",3,"ngModelChange","ngModel","placeholder"],[4,"ngFor","ngForOf"],[1,"form-input","select",2,"width","100px"],["name","acquis",3,"ngModelChange","ngModel","placeholder"],[1,"selectMin",3,"value"],["name","doublon",1,"scrollBarAccent",3,"ngModelChange","ngModel","placeholder"],[1,"form-input","select",2,"width","150px"],["name","anneeSelect","multiple","",3,"ngModelChange","ngModel","placeholder"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],["class","selectMin",3,"value",4,"ngIf"]],template:function(n,s){n&1&&D(0,y1,25,20,"div",0),n&2&&v("ngIf",s.modif)},dependencies:[Bt,wt,et,Se,Et,It,we,Un,Pn],styles:[".menuRecherche[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:left;width:100%}.menuRecherche[_ngcontent-%COMP%] > .form-input[_ngcontent-%COMP%]{margin:0 10px;display:flex;flex-direction:column;justify-content:space-between;align-items:stretch}@media screen and (max-width: 800px){.menuRecherche[_ngcontent-%COMP%] > .form-input[_ngcontent-%COMP%]{margin:5px 10px}}"]})};function M1(o,r){if(o&1&&(T(0,"div",3)(1,"span"),B(2,"Nombre de timbres : "),x(),T(3,"span",4),B(4),O(5,"async"),x()()),o&2){let n=y();h(4),_o(L(5,1,n.total$))}}var Fo=class o{constructor(r){this.dialog=r}total$;FontAwesomeEnum=St;FontAwesomeTypeEnum=yt;resume(){this.dialog.open(Oo,{height:"auto",maxHeight:"95vh",width:"1200px"})}static \u0275fac=function(n){return new(n||o)(V(At))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-total"]],inputs:{total$:"total$"},decls:4,vars:6,consts:[[1,"timbreTotal"],["class","nbTimbre",4,"ngIf"],[1,"accent","click",3,"click","icone","type","info"],[1,"nbTimbre"],[1,"bold"]],template:function(n,s){n&1&&(T(0,"div",0),D(1,M1,6,3,"div",1),O(2,"async"),T(3,"lib-icon",2),j("click",function(){return s.resume()}),x()()),n&2&&(h(),v("ngIf",L(2,4,s.total$)),h(2),v("icone",s.FontAwesomeEnum.CHART_LINE_UP)("type",s.FontAwesomeTypeEnum.TYPE_SOLID)("info","D\xE9tail par ann\xE9e"))},dependencies:[Se,Zt,we],styles:[".timbreTotal[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:start;align-content:center;gap:10px}.timbreTotal[_ngcontent-%COMP%]   .nbTimbre[_ngcontent-%COMP%]{font-size:1.2em}.timbreTotal[_ngcontent-%COMP%]   lib-icon[_ngcontent-%COMP%]{font-size:1.5em}@media screen and (max-width: 800px){.timbreTotal[_ngcontent-%COMP%]{height:25px;gap:5px}.timbreTotal[_ngcontent-%COMP%]   .nbTimbre[_ngcontent-%COMP%]{font-size:1em}.timbreTotal[_ngcontent-%COMP%]   lib-icon[_ngcontent-%COMP%]{font-size:1.2em}}"]})};function I1(o,r){if(o&1){let n=ue();T(0,"img",21),j("click",function(){H(n);let c=y().$implicit,f=y();return W(f.utilsService.zoom(c==null?null:c.getImageZoom()))}),x()}if(o&2){let n=y().$implicit;v("src",n==null?null:n.getImage(),Tn)}}function w1(o,r){if(o&1&&B(0),o&2){let n,s=y().$implicit;$(" ",s==null||(n=s.getTimbreBlocModel())==null?null:n.getAnnee()," ")}}function A1(o,r){if(o&1&&B(0),o&2){let n=y().$implicit;$(" ",n==null?null:n.getAnnee()," ")}}function B1(o,r){if(o&1){let n=ue();T(0,"lib-icon",22),j("click",function(){let c;H(n);let f=y().$implicit,b=y();return W(b.utilsService.zoom(f==null||(c=f.getTimbreBlocModel())==null?null:c.getImageZoom()))}),x()}if(o&2){let n,s=y().$implicit,c=y();v("classIcone","primary")("type",c.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",c.FontAwesomeEnum.IMAGE_POLAROID)("classInfo","imageHoverBloc")("info","<img src='"+(s==null||(n=s.getTimbreBlocModel())==null?null:n.getImageZoom())+"'/>")}}function R1(o,r){if(o&1&&G(0,"lib-icon",23),o&2){let n=y().$implicit,s=y();v("classIcone","primary")("type",s.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",s.FontAwesomeEnum.CIRCLE_INFO)("info",n==null?null:n.getYt())}}function D1(o,r){if(o&1){let n=ue();T(0,"div",8)(1,"div",9)(2,"div",10)(3,"lib-icon",11),j("click",function(){let c=H(n).$implicit,f=y();return W(f.timbreService.acquisDoublon(c,!1))}),x(),T(4,"lib-icon",11),j("click",function(){let c=H(n).$implicit,f=y();return W(f.timbreService.acquisDoublon(c,!0))}),x()(),T(5,"div",12)(6,"lib-icon",13),j("click",function(){let c=H(n).$implicit,f=y();return W(f.timbreService.modifierDialog(c))}),x(),T(7,"lib-icon",13),j("click",function(){let c=H(n).$implicit,f=y();return W(f.timbreService.supprimerDialog(c))}),x()()(),T(8,"div",14),D(9,I1,1,1,"img",15),x(),T(10,"div",16),D(11,w1,1,1,"ng-template",17)(12,A1,1,1,"ng-template",null,0,Je),T(14,"div",18),D(15,B1,1,5,"lib-icon",19)(16,R1,1,4,"lib-icon",20),x()()()}if(o&2){let n,s,c,f,b,E,R,F=r.$implicit,de=ye(13),Z=y();v("ngClass",!(F==null||(n=F.getTimbreAcquisModel())==null)&&n.isAcquis()?"border-accent bg-accentA200":"border-primary"),h(3),v("classIcone",!(F==null||(s=F.getTimbreAcquisModel())==null)&&s.isAcquis()?"accent":"primary")("type",Z.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",!(F==null||(c=F.getTimbreAcquisModel())==null)&&c.isAcquis()?Z.FontAwesomeEnum.CIRCLE_MINUS:Z.FontAwesomeEnum.CIRCLE_PLUS)("info",!(F==null||(f=F.getTimbreAcquisModel())==null)&&f.isAcquis()?"pas acquis":"acquis"),h(),v("classIcone",!(F==null||(b=F.getTimbreAcquisModel())==null)&&b.isDoublon()?"accent":"primary")("type",Z.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",!(F==null||(E=F.getTimbreAcquisModel())==null)&&E.isDoublon()?Z.FontAwesomeEnum.CIRCLE_MINUS:Z.FontAwesomeEnum.CIRCLE_PLUS)("info",!(F==null||(R=F.getTimbreAcquisModel())==null)&&R.isDoublon()?"pas en double":"en double"),h(2),v("type",Z.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",Z.FontAwesomeEnum.PENCIL)("info","Modifier"),h(),v("type",Z.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",Z.FontAwesomeEnum.TRASH)("info","Supprimer"),h(2),v("ngIf",F==null?null:F.getImage()),h(2),v("ngIf",F==null?null:F.getIdBloc())("ngIfElse",de),h(4),v("ngIf",F==null?null:F.getIdBloc()),h(),v("ngIf",F==null?null:F.getYt())}}var Uo=class o{constructor(r,n,s,c){this.authService=r;this.timbreService=n;this.timbreUtilsService=s;this.utilsService=c}timbres$;load$;total$;modif=!0;timbre=new Dt;annees$;FontAwesomeEnum=St;FontAwesomeTypeEnum=yt;ngOnInit(){this.annees$=this.timbreUtilsService.getAnneesAsync("/timbres"),this.timbre.setTimbreAcquisModel(new Ye)}static \u0275fac=function(n){return new(n||o)(V(tt),V(Le),V(Me),V(nt))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-resultat"]],inputs:{timbres$:"timbres$",load$:"load$",total$:"total$",modif:"modif"},decls:10,vars:12,consts:[["noBloc",""],[1,"responsiveDirection","responsiveMenu"],[3,"total$"],[3,"modif"],[1,"spinner",3,"fxHide","textSpec"],[3,"fxHide"],[1,"listeTimbre","primary"],["class","detailTimbre",3,"ngClass",4,"ngFor","ngForOf"],[1,"detailTimbre",3,"ngClass"],[1,"headerTimbre"],[1,"actionTimbre"],[1,"click",3,"click","classIcone","type","icone","info"],[1,"actionTimbre2"],[1,"primary","click",3,"click","type","icone","info"],[1,"imgTimbre"],["class","image click",3,"src","click",4,"ngIf"],[1,"footerTimbre"],[3,"ngIf","ngIfElse"],[1,"infoTimbre"],["class","click",3,"classIcone","type","icone","classInfo","info","click",4,"ngIf"],["class","click",3,"classIcone","type","icone","info",4,"ngIf"],[1,"image","click",3,"click","src"],[1,"click",3,"click","classIcone","type","icone","classInfo","info"],[1,"click",3,"classIcone","type","icone","info"]],template:function(n,s){n&1&&(T(0,"div",1),G(1,"app-timbre-total",2)(2,"app-timbre-recherche",3),x(),G(3,"lib-spinner",4),O(4,"async"),T(5,"section",5),O(6,"async"),T(7,"div",6),D(8,D1,17,20,"div",7),O(9,"async"),x()()),n&2&&(h(),v("total$",s.total$),h(),v("modif",s.modif),h(),v("fxHide",L(4,6,s.load$)==!0)("textSpec","Chargement en cours ..."),h(2),v("fxHide",L(6,8,s.load$)==!1),h(3),v("ngForOf",L(9,10,s.timbres$)))},dependencies:[Ct,et,Se,To,Mt,Rt,Zt,No,Fo,we],styles:[".spinner[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;align-items:stretch;flex:100%;height:100%}.listeTimbre[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:left;width:100%}.listeTimbre[_ngcontent-%COMP%]   lib-icon[_ngcontent-%COMP%]{font-size:1.2em}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]{margin:10px;width:115px;height:150px;border-radius:10px;border:1px solid;padding:5px 10px;display:flex;flex-direction:column;justify-content:space-between;align-items:stretch}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .headerTimbre[_ngcontent-%COMP%]{height:25px;display:flex;flex-direction:row;justify-content:space-between;align-items:end;width:100%;padding-bottom:5px}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .headerTimbre[_ngcontent-%COMP%]   .actionTimbre[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:start;gap:5px}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .headerTimbre[_ngcontent-%COMP%]   .actionTimbre2[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:end;gap:5px}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .imgTimbre[_ngcontent-%COMP%]{width:100%;display:flex;flex:auto;justify-content:center;align-items:center}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .imgTimbre[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100px;max-height:100px}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .footerTimbre[_ngcontent-%COMP%]{height:25px;display:flex;flex-direction:row;justify-content:space-between;align-items:end;width:100%}.listeTimbre[_ngcontent-%COMP%]   .detailTimbre[_ngcontent-%COMP%]   .footerTimbre[_ngcontent-%COMP%]   .infoTimbre[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:end;align-items:end;gap:5px}@media screen and (max-width: 800px){.listeTimbre[_ngcontent-%COMP%]{justify-content:space-evenly}}"]})};function L1(o,r){if(o&1&&(G(0,"lib-spinner",5),O(1,"async")),o&2){let n=y();v("textSpec",L(1,1,n.messageLoad$))}}function N1(o,r){if(o&1&&(G(0,"mat-error",16),O(1,"async")),o&2){let n=y(2);v("innerHTML",L(1,1,n.messageError$),hn)}}function F1(o,r){if(o&1&&G(0,"app-timbre-resultat",17),o&2){let n=y(2);v("load$",n.load$)("timbres$",n.timbres$)("modif",!1)}}function U1(o,r){if(o&1&&(T(0,"mat-option",21),B(1),x()),o&2){let n=r.$implicit;v("value",n),h(),$(" ",n," ")}}function P1(o,r){if(o&1){let n=ue();T(0,"div",18)(1,"mat-select",19),Pe("ngModelChange",function(c){H(n);let f=y(2);return Ue(f.annees,c)||(f.annees=c),W(c)}),D(2,U1,2,2,"mat-option",20),x()()}if(o&2){let n=y(2);h(),Fe("ngModel",n.annees),v("placeholder","Ann\xE9es"),h(),v("ngForOf",n.anneesDispo)}}function q1(o,r){o&1&&(T(0,"button",22),B(1," Enregistrer "),x())}function $1(o,r){if(o&1){let n=ue();T(0,"form",6,1),j("ngSubmit",function(){H(n);let c=ye(1),f=y();return W(f.valider(c))}),T(2,"div",7),D(3,N1,2,3,"mat-error",8),O(4,"async"),D(5,F1,1,3,"app-timbre-resultat",9),O(6,"async"),x(),T(7,"div",10),D(8,P1,3,3,"div",11),O(9,"async"),O(10,"async"),T(11,"button",12),j("click",function(){H(n);let c=y();return W(c.close())}),B(12," Annuler "),x(),T(13,"input",13),j("change",function(c){H(n);let f=y();return W(f.onFileChange(c))}),x(),T(14,"button",14),j("click",function(){H(n);let c=y();return W(c.triggerFileInput())}),B(15," Choisir un fichier "),x(),D(16,q1,2,0,"button",15),O(17,"async"),x()()}if(o&2){let n,s,c,f=ye(1),b=y();v("ngClass",f!=null&&f.submitted?"red-color":"blue-color"),h(3),v("ngIf",L(4,6,b.messageError$)),h(2),v("ngIf",((n=L(6,8,b.timbres$))==null?null:n.length)>0),h(3),v("ngIf",!L(9,10,b.timbres$)||((s=L(10,12,b.timbres$))==null?null:s.length)==0),h(5),bo("id",b.idFile),h(3),v("ngIf",((c=L(17,14,b.timbres$))==null?null:c.length)>0)}}var Po=class o{constructor(r,n,s,c,f,b,E){this.authService=r;this.timbreService=n;this.timbreBlocService=s;this.timbreUtilsService=c;this.uploadService=f;this.utilsService=b;this.dialogRef=E}dossier="/assets/images/timbres/";timbres$=new _e(null);messageError$=new _e(null);messageLoad$=new _e("Chargement en cours ...");load$=new _e(null);idFile="fileImport";identTimbre=1;identBloc=1;timbresModel=[];timbresBlocsModel=[];anneesDispo=[];annees=[new Date().getFullYear()];ngOnInit(){for(let r=new Date().getFullYear();r>=1900;r--)this.anneesDispo.push(r)}triggerFileInput(){document.getElementById(this.idFile).click()}onFileChange(r){let n=r.target.files[0];n&&(this.load$.next(!1),this.messageLoad$.next("Chargement en cours ..."),this.saveCsv(n))}saveCsv(r){let n=new FileReader;n.onload=()=>{let s=n.result;this.parseCsv(s)},n.readAsText(r)}parseCsv(r){S(this.annees)&&this.annees.length>0&&We([this.utilsService.getMaxIdentAsync("/timbres"),this.utilsService.getMaxIdentAsync("/timbres_bloc"),this.authService.userSelect$]).pipe(P(([n,s,c])=>S(c))).subscribe(([n,s,c])=>{this.identTimbre=n,this.identBloc=s,this.timbresModel=[],this.timbres$.next(null),Uu.parse(r,{header:!0,skipEmptyLines:!0,complete:f=>{S(f.data)&&f.data?.length>0&&(this.timbresBlocsModel=[],f.data.forEach((b,E)=>{let R=this.setTimbre(b,c);S(R?.getId())&&(this.timbresModel.push(R),this.identTimbre++),E==f.data.length-1&&(this.timbres$.next(this.timbresModel),this.load$.next(!0))}))},error:f=>{console.error("Erreur lors du parsing du CSV :",f)}})})}setTimbre(r,n){let s=new Dt,c=r.CODE!="NULL"&&r.CODE!=""?Number(r.CODE):null,f=r.IDENT_BLOC!="NULL"&&r.IDENT_BLOC!=""&&S(r.IDENT_BLOC)?Number(r.IDENT_BLOC):null,b=r.ANNEE!="NULL"&&r.ANNEE!=""?Number(r.ANNEE):null,E=r.MONNAIE!="NULL"&&r.MONNAIE!=""?r.MONNAIE:null;if(this.annees.includes(b)){s.setId(this.identTimbre),s.setType(r.TYPE!="NULL"&&r.TYPE!=""?r.TYPE:null),s.setYt(r.YT!="NULL"&&r.YT!=""?r.YT:null),s.setAnnee(b);let R=new Ye;R.setIdTimbre(s.getId()),R.setIdUser(n.getId()),R.setAcquis(r.ACQUIS=="1"),R.setDoublon(r.DOUBLON=="1"),s.setTimbreAcquisModel(R);let F=this.dossier+b+"/",de="";if(S(f)){if(F+="bloc/"+f,de=F+".png",F+="-",s.setTimbreBlocModel(this.timbresBlocsModel.find(Z=>Z.getAnnee()==b&&Z.idOrigine==f)),Oe(s.getTimbreBlocModel())){let Z=new Pi;Z.setId(this.identBloc),Z.setAnnee(b),Z.setMonnaie(E),Z.setType(r.CARNET=="1"?"CARNET":"BLOC"),Z.idOrigine=f;let rt=new Ot;rt.setIdBloc(this.identBloc),rt.setIdUser(n.getId()),rt.setAcquis(r.ACQUIS_BLOC=="1"),rt.setDoublon(r.DOUBLON_BLOC=="1"),Z.setTimbreBlocAcquisModel(rt),this.uploadService.checkIfImageExists(de).pipe(P()).subscribe(ii=>{ii&&(Z.setImage(de),Z.setImageTable(de),Z.setImageZoom(de))}),this.timbresBlocsModel.push(Z),s.setTimbreBlocModel(Z),this.identBloc++}s.setIdBloc(s.getTimbreBlocModel()?.getId())}else s.setMonnaie(E);F+=c+".png",this.uploadService.checkIfImageExists(F).pipe(P()).subscribe(Z=>{Z&&(s.setImage(F),s.setImageTable(F),s.setImageZoom(F))})}return s}valider(r){this.messageError$.next(null),r?.valid&&(this.load$.next(!1),this.messageLoad$.next("Import en cours ..."),S(this.timbresBlocsModel)&&this.timbresBlocsModel?.length>0&&this.timbresBlocsModel.forEach((n,s)=>{this.saveBloc(n)}),this.timbres$.pipe(P()).subscribe(n=>{if(S(n)&&n?.length>0)n.forEach((s,c)=>{this.saveTimbre(s,c==n.length-1)});else{this.messageError$.next("Donn\xE9es incorrectes");return}}))}saveBloc(r){We([this.timbreBlocService.upload(r,"autre"),this.timbreBlocService.upload(r,"table"),this.timbreBlocService.upload(r,"zoom")]).pipe(P(([n,s,c])=>S(n)&&S(c)&&S(s))).subscribe(([n,s,c])=>{S(n)&&n!="nok"&&r.setImage(n),S(s)&&s!="nok"&&r.setImageTable(s),S(c)&&c!="nok"&&r.setImageZoom(c),r?.getTimbreBlocAcquisModel()?.isAcquis()&&this.timbreBlocService.addAcquis(r?.getTimbreBlocAcquisModel()?.getIdUser(),r,r?.getTimbreBlocAcquisModel()?.isDoublon()),this.timbreBlocService.ajouter(r,!1)})}saveTimbre(r,n){We([this.timbreService.upload(r,"autre"),this.timbreService.upload(r,"table"),this.timbreService.upload(r,"zoom")]).pipe(P(([s,c,f])=>S(s)&&S(f)&&S(c))).subscribe(([s,c,f])=>{S(s)&&s!="nok"&&r.setImage(s),S(c)&&c!="nok"&&r.setImageTable(c),S(f)&&f!="nok"&&r.setImageZoom(f),r?.getTimbreAcquisModel()?.isAcquis()&&this.timbreUtilsService.addAcquis(r?.getTimbreAcquisModel()?.getIdUser(),r,r?.getTimbreAcquisModel()?.isDoublon()),this.timbreService.ajouter(r,n),n&&(this.load$.next(!0),this.close())})}close(){this.dialogRef.close()}static \u0275fac=function(n){return new(n||o)(V(tt),V(Le),V(Ve),V(Me),V(On),V(nt),V(Qt))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-importer"]],decls:8,vars:4,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","start stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","column","fxLayoutGap","20px",1,"bloc-modal"],[3,"innerHTML",4,"ngIf"],[3,"load$","timbres$","modif",4,"ngIf"],["fxLayout","row","fxLayoutGap","20px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["fxLayout","row","fxLayoutAlign","end center","class","form-input select noError","style","width: 150px",4,"ngIf"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","file","accept",".xls, .xlsx, .csv","hidden","","required","",3,"change","id"],["type","button","mat-raised-button","","color","accent",1,"rounded","large","color-white",3,"click"],["type","submit","class","rounded large color-white","mat-raised-button","","color","accent",4,"ngIf"],[3,"innerHTML"],[3,"load$","timbres$","modif"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input","select","noError",2,"width","150px"],["name","anneeSelect","multiple","",3,"ngModelChange","ngModel","placeholder"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],[1,"selectMin",3,"value"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"]],template:function(n,s){if(n&1&&(T(0,"div",2)(1,"div",3)(2,"span"),B(3,"TIMBRE IMPORTER"),x()(),D(4,L1,2,3,"ng-template",4),O(5,"async"),D(6,$1,18,16,"ng-template",null,0,Je),x()),n&2){let c=ye(7);h(4),v("ngIf",L(5,2,s.load$)==!1)("ngIfElse",c)}},dependencies:[it,wn,Bt,wt,Ct,et,Se,zt,Oi,Kt,Yt,Li,Mt,Ui,Et,Ni,It,Fi,Rt,Uo,we]})};function W1(o,r){o&1&&G(0,"lib-spinner",5),o&2&&v("textSpec","Suppression en cours")}function V1(o,r){if(o&1){let n=ue();T(0,"form",6,1),j("ngSubmit",function(){H(n);let c=ye(1),f=y();return W(f.valider(c))}),T(2,"div",7)(3,"div",8)(4,"input",9),Pe("ngModelChange",function(c){H(n);let f=y();return Ue(f.annee,c)||(f.annee=c),W(c)}),x()(),T(5,"button",10),j("click",function(){H(n);let c=y();return W(c.close())}),B(6," Annuler "),x(),T(7,"button",11),B(8," Supprimer "),x()()()}if(o&2){let n=ye(1),s=y();v("ngClass",n!=null&&n.submitted?"red-color":"blue-color"),h(4),Fe("ngModel",s.annee),v("max",s.maxAnnee)("zMax",s.maxAnnee)}}var qo=class o{constructor(r,n,s){this.dialog=r;this.dialogRef=n;this.timbreSupprimService=s}maxAnnee=new Date().getFullYear();annee=new Date().getFullYear();valider(r){if(r?.valid){let n=this.dialog.open(Ji,{maxHeight:"95vh",data:{titre:"Confirmation",message:"Souhaitez-vous supprimer les timbres ?",btnDroite:"Oui",btnGauche:"Non"}});n.afterClosed().subscribe(()=>{n.componentInstance.data.resultat==="valider"&&(this.timbreSupprimService.loadGlob$.next(!1),this.timbreSupprimService.supprimerTimbres(this.annee),this.timbreSupprimService.load$.pipe(P(s=>s==!0)).subscribe(s=>{this.timbreSupprimService.supprimerBlocs(this.annee),this.timbreSupprimService.load$.pipe(P(c=>c==!0)).subscribe(c=>{this.timbreSupprimService.loadGlob$.next(!0)})}))})}}close(){this.dialogRef.close()}static \u0275fac=function(n){return new(n||o)(V(At),V(Qt),V(Mo))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-supprim-choix-annee"]],decls:8,vars:4,consts:[["load",""],["formModif","ngForm"],["fxFlexFill","","fxLayout","column","fxLayoutAlign","space-between stretch",1,"dialog-modal"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","start center",1,"titre-modal","bg-primary","color-white"],[3,"ngIf","ngIfElse"],["fxFlexFill","",3,"textSpec"],["ngForm","formModif","fxLayoutGap","20px","fxFlex","100","fxLayout","column","fxLayoutAlign","start stretch",1,"formulaire-box-elevation",3,"ngSubmit","ngClass"],["fxLayout","row","fxLayoutGap","20px","fxLayoutAlign","end end",1,"bloc-bouton-modal"],["fxLayout","column","fxFlex","20","fxLayoutAlign","end end",1,"form-input","noError"],["name","annee","type","number","minlength","4","maxlength","4","min","1900","zMin","1900","required","","zControl","",2,"width","60px !important",3,"ngModelChange","ngModel","max","zMax"],["type","button","mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],["type","submit","mat-raised-button","","color","accent",1,"rounded","large","color-white"]],template:function(n,s){if(n&1&&(T(0,"div",2)(1,"div",3)(2,"span"),B(3,"TIMBRE IMPORTER"),x()(),D(4,W1,1,1,"ng-template",4),O(5,"async"),D(6,V1,9,4,"ng-template",null,0,Je),x()),n&2){let c=ye(7);h(4),v("ngIf",L(5,2,s.timbreSupprimService.loadGlob$)==!1)("ngIfElse",c)}},dependencies:[it,Ct,Se,zt,Oi,Kt,Yt,Li,Mt,Ui,xn,Cn,Et,Ni,Mn,En,In,Sn,yn,It,Fi,Rt,An,Rn,Dn,we],encapsulation:2})};var G1=o=>[o];function k1(o,r){if(o&1){let n=ue();T(0,"lib-icon",2),j("click",function(){H(n);let c=y();return W(c.supprimer())}),x()}if(o&2){let n=y();v("icone",n.FontAwesomeEnum.ROTATE)("type",n.FontAwesomeTypeEnum.TYPE_SOLID)("attribs",mr(4,G1,n.FontAwesomeAttributEnum.SPIN))("info","Supprimer en cours")}}function j1(o,r){if(o&1){let n=ue();T(0,"lib-icon",3),j("click",function(){H(n);let c=y();return W(c.supprimer())}),x()}if(o&2){let n=y();v("icone",n.FontAwesomeEnum.TRASH)("type",n.FontAwesomeTypeEnum.TYPE_SOLID)("info","Supprimer les timbres")}}var $o=class o{constructor(r,n){this.dialog=r;this.timbreSupprimService=n}FontAwesomeEnum=St;FontAwesomeTypeEnum=yt;FontAwesomeAttributEnum=Zc;supprimer(){this.dialog.open(qo,{maxHeight:"50vh",width:"300px"})}static \u0275fac=function(n){return new(n||o)(V(At),V(Mo))};static \u0275cmp=Ce({type:o,selectors:[["app-timbre-supprim"]],decls:4,vars:6,consts:[["class","warn click","style","font-size: 2em",3,"icone","type","attribs","info","click",4,"ngIf"],["class","warn click","style","font-size: 2em",3,"icone","type","info","click",4,"ngIf"],[1,"warn","click",2,"font-size","2em",3,"click","icone","type","attribs","info"],[1,"warn","click",2,"font-size","2em",3,"click","icone","type","info"]],template:function(n,s){n&1&&(D(0,k1,1,6,"lib-icon",0),O(1,"async"),D(2,j1,1,3,"lib-icon",1),O(3,"async")),n&2&&(v("ngIf",L(1,2,s.timbreSupprimService.loadGlob$)==!1),h(2),v("ngIf",L(3,4,s.timbreSupprimService.loadGlob$)==!0))},dependencies:[Se,Zt,we],encapsulation:2})};function Y1(o,r){if(o&1){let n=ue();T(0,"button",9),j("click",function(){H(n);let c=y(2);return W(c.ajouter())}),B(1," Ajouter "),x()}}function K1(o,r){o&1&&(le(0),B(1,"\xA0Bloc"),se())}function Q1(o,r){if(o&1){let n=ue();le(0),D(1,Y1,2,0,"button",8),O(2,"async"),T(3,"button",9),j("click",function(){H(n);let c=y();return W(c.ajouterBloc())}),B(4," Ajouter "),D(5,K1,2,0,"ng-container",3),O(6,"async"),x(),se()}if(o&2){let n=y();h(),v("ngIf",L(2,2,n.headerService.route$)==n.RouteEnum.TIMBRE),h(4),v("ngIf",L(6,4,n.headerService.route$)==n.RouteEnum.TIMBRE)}}function Z1(o,r){if(o&1){let n=ue();le(0),T(1,"lib-icon",11),j("click",function(){let c=H(n).$implicit,f=y(2);return W(f.headerService.setRoute(c.getRoute()))}),x(),se()}if(o&2){let n=r.$implicit;h(),v("icone",n==null?null:n.getIcone())("type",n==null?null:n.getType())("info",n==null?null:n.getInfo())}}function X1(o,r){if(o&1&&(le(0),D(1,Z1,2,3,"ng-container",10),O(2,"async"),se()),o&2){let n=y();h(),v("ngForOf",L(2,1,n.headerService.choixRoutesTimbre$))}}function J1(o,r){if(o&1){let n=ue();T(0,"lib-icon",13),j("click",function(){H(n);let c=y(2);return W(c.headerService.mode=c.ModeEnum.TABLE)}),x()}if(o&2){let n=y(2);v("icone",n.FontAwesomeEnum.TABLE)("type",n.FontAwesomeTypeEnum.TYPE_SOLID)("info","Mode tableau")}}function eT(o,r){if(o&1){let n=ue();T(0,"lib-icon",13),j("click",function(){H(n);let c=y(2);return W(c.headerService.mode=c.ModeEnum.GRAPH)}),x()}if(o&2){let n=y(2);v("icone",n.FontAwesomeEnum.MEMO)("type",n.FontAwesomeTypeEnum.TYPE_SOLID)("info","Mode tableau")}}function tT(o,r){if(o&1&&(le(0),D(1,J1,1,3,"ng-template",12)(2,eT,1,3,"ng-template",null,0,Je),se()),o&2){let n=ye(3),s=y();h(),v("ngIf",s.headerService.mode==s.ModeEnum.GRAPH)("ngIfElse",n)}}function iT(o,r){if(o&1){let n=ue();T(0,"lib-icon",14),j("click",function(){H(n);let c=y();return W(c.importer())}),x()}if(o&2){let n=y();v("icone",n.FontAwesomeEnum.UPLOAD)("type",n.FontAwesomeTypeEnum.TYPE_SOLID)("info","Importer les timbres")}}function nT(o,r){o&1&&G(0,"app-timbre-supprim",15)}function rT(o,r){if(o&1&&(T(0,"mat-option",19),B(1),x()),o&2){let n=r.$implicit;v("value",n),h(),$(" ",n==null?null:n.getPrenom()," ")}}function oT(o,r){if(o&1){let n=ue();T(0,"div",16)(1,"mat-select",17),O(2,"async"),j("ngModelChange",function(c){H(n);let f=y();return W(f.setUser(c))}),D(3,rT,2,2,"mat-option",18),O(4,"async"),x()()}if(o&2){let n=y();h(),v("ngModel",L(2,3,n.authService.userSelect$))("placeholder","Utilisateur"),h(2),v("ngForOf",L(4,5,n.authService.users$))}}var Pu=class o{constructor(r,n,s,c,f,b,E){this.preferenceService=r;this.authService=n;this.headerService=s;this.timbreService=c;this.timbreBlocService=f;this.timbreUtilsService=b;this.dialog=E;this.verifRoute()}FontAwesomeEnum=St;RouteEnum=Qc;FontAwesomeTypeEnum=yt;DroitEnum=ho;ModeEnum=Xc;ajouter(){let r=this.dialog.open(Nn,{maxHeight:"95vh",width:"30%",minWidth:"300px"});r.afterClosed().subscribe(()=>{r.close()})}ajouterBloc(){let r=this.dialog.open(qn,{maxHeight:"95vh",width:"30%",minWidth:"300px"});r.afterClosed().subscribe(()=>{r.close()})}ajouterBouchon(){this.timbreService.ajouterSansId(this.timbreService.getBouchon())}importer(){let r=this.dialog.open(Po,{height:"90vh",width:"70%",minWidth:"300px"});r.afterClosed().subscribe(()=>{r.close()})}verifRoute(){window.location.href.indexOf("bloc")>0?this.preferenceService.getTimbreCritere("blocCritere").pipe(P()).subscribe(r=>{S(r.getAnnees())&&r.getAnnees().length>0?this.timbreBlocService.getBlocs(r,!0):this.timbreUtilsService.getAnneesAsync("/timbres_bloc").pipe(P(n=>S(n)&&n?.length>0)).subscribe(n=>{r.initCritere(),r.setAcquis("NON"),r.setAnnees([n[0]]),this.preferenceService.timbreCritereBlocModel=r,this.preferenceService.modifier("blocCritere",r),this.timbreBlocService.getBlocs(r,!0)})}):this.preferenceService.getTimbreCritere("timbreCritere").pipe(P()).subscribe(r=>{S(r.getAnnees())&&r.getAnnees().length>0?this.timbreService.getTimbres(r,!0):this.timbreUtilsService.getAnneesAsync("/timbres").pipe(P(n=>S(n)&&n?.length>0)).subscribe(n=>{r.initCritere(),r.setAcquis("NON"),r.setAnnees([n[0]]),this.preferenceService.timbreCritereModel=r,this.preferenceService.modifier("timbreCritere",r),this.timbreService.getTimbres(r,!0)})})}setUser(r){this.authService.userSelect$.next(r),this.verifRoute(),this.timbreUtilsService.reinitResume$.next(!0)}static \u0275fac=function(n){return new(n||o)(V(Xt),V(tt),V(Jc),V(Le),V(Ve),V(Me),V(At))};static \u0275cmp=Ce({type:o,selectors:[["app-menu"]],decls:21,vars:30,consts:[["modeTable",""],[1,"menu"],[1,"sousMenu","sousMenuBouton"],[4,"ngIf"],[1,"sousMenu"],["class","accent click hide-on-mobile","style","font-size: 2em",3,"icone","type","info","click",4,"ngIf"],["class","hide-on-mobile",4,"ngIf"],["fxLayout","row","fxLayoutAlign","end center","class","form-input select","style","width: 120px",4,"ngIf"],["class","rounded large color-white","mat-raised-button","","color","primary",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"],[4,"ngFor","ngForOf"],[1,"primary","click",2,"font-size","2em",3,"click","icone","type","info"],[3,"ngIf","ngIfElse"],[1,"primary","click","hide-on-mobile",2,"font-size","2em",3,"click","icone","type","info"],[1,"accent","click","hide-on-mobile",2,"font-size","2em",3,"click","icone","type","info"],[1,"hide-on-mobile"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input","select",2,"width","120px"],["name","user",1,"scrollBarAccent",3,"ngModelChange","ngModel","placeholder"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],[1,"selectMin",3,"value"]],template:function(n,s){if(n&1&&(T(0,"div",1)(1,"div",2),D(2,Q1,7,6,"ng-container",3),O(3,"async"),x(),T(4,"div",4),D(5,X1,3,3,"ng-container",3),O(6,"async"),D(7,tT,4,2,"ng-container",3),O(8,"async"),O(9,"async"),O(10,"async"),D(11,iT,1,3,"lib-icon",5),O(12,"async"),O(13,"async"),D(14,nT,1,0,"app-timbre-supprim",6),O(15,"async"),O(16,"async"),D(17,oT,5,7,"div",7),O(18,"async"),O(19,"async"),O(20,"async"),x()()),n&2){let c,f,b,E,R,F;h(2),v("ngIf",((c=L(3,6,s.authService.user$))==null?null:c.getDroit())==s.DroitEnum.TOTAL),h(3),v("ngIf",((f=L(6,8,s.headerService.choixRoutesTimbre$))==null?null:f.length)>0),h(2),v("ngIf",((b=L(8,10,s.authService.user$))==null?null:b.getDroit())==s.DroitEnum.TOTAL&&(L(9,12,s.headerService.route$)==s.RouteEnum.TIMBRE||L(10,14,s.headerService.route$)==s.RouteEnum.BLOC)),h(4),v("ngIf",((E=L(12,16,s.authService.user$))==null?null:E.getDroit())==s.DroitEnum.TOTAL&&L(13,18,s.headerService.route$)==s.RouteEnum.TIMBRE),h(3),v("ngIf",((R=L(15,20,s.authService.user$))==null?null:R.getDroit())==s.DroitEnum.TOTAL&&L(16,22,s.headerService.route$)==s.RouteEnum.TIMBRE),h(3),v("ngIf",(((F=L(18,24,s.authService.user$))==null?null:F.getDroit())==s.DroitEnum.TOTAL||((F=L(19,26,s.authService.user$))==null?null:F.getDroit())==s.DroitEnum.CONSULT_TOTAL)&&((F=L(20,28,s.authService.users$))==null?null:F.length)>0)}},dependencies:[et,Se,zt,Kt,Et,It,Zt,it,$o,wt,Bt,we],styles:[".menu[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:10px;padding:0 5px}.menu[_ngcontent-%COMP%]   .sousMenu[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:15px}@media screen and (max-width: 800px){.menu[_ngcontent-%COMP%]{flex-direction:column}.menu[_ngcontent-%COMP%]   .sousMenuBouton[_ngcontent-%COMP%]{justify-content:space-between}.menu[_ngcontent-%COMP%]   .sousMenu[_ngcontent-%COMP%]{gap:10px}}"]})};export{Ot as a,Ye as b,Me as c,Un as d,Pn as e,Ve as f,Le as g,No as h,Do as i,Oo as j,Fo as k,Uo as l,Po as m,Pu as n,Nu as o};

import{d as Ne,f as je,g as Ue,h as j,i as v,j as V}from"./chunk-P5U4AYP2.js";import{a as Ve,b as $e,g as Xe,h as U,i as Je,j as ze,l as We}from"./chunk-U3ZSWC23.js";import{C as Ge}from"./chunk-W3XNXTU3.js";import{e as Oe,f as Pe,g as qe,h as He}from"./chunk-LMRVNFCC.js";import"./chunk-YKK6WNC6.js";import{A as T,Ab as k,Ac as ve,Ba as le,Bb as de,Bc as we,Ca as re,Cb as fe,Cc as Be,Dc as Ee,Ec as De,Fa as ae,Fc as Le,Ga as me,Gb as be,Gc as Re,Hc as Ie,Ia as ce,Ic as J,J as ie,Jb as _e,Jc as Ae,K as m,Kc as Fe,L as C,Lc as ke,Pa as Q,Q as f,R as c,Rb as Ce,Tb as ge,W as l,Wb as he,X as r,Y as s,Z as b,_,aa as y,ab as Z,ba as d,c as ee,ca as p,ea as G,fa as W,ga as Y,hc as Te,ia as u,ja as ne,ka as x,l as te,lc as q,ma as D,na as L,oa as R,pb as I,q as w,qb as A,ra as oe,rb as pe,rc as ye,tb as se,u as B,ua as S,uc as H,v as E,va as M,vb as O,wb as F,wc as N,xb as P,xc as xe,yc as Se,z as h,zb as ue,zc as Me}from"./chunk-EDS3JHJR.js";import"./chunk-65CH3ZW6.js";import{g as Ze}from"./chunk-GV7GV3NK.js";var Ye=Ze(Je());var nt=()=>[10,20,50,100];function ot(t,i){if(t&1&&(l(0,"mat-option",7),u(1),r()),t&2){let e=i.$implicit;c("value",e),m(),x(" ",e," ")}}function lt(t,i){if(t&1&&(l(0,"th",35),s(1,"lib-libelle-model",36),r()),t&2){let e=p();m(),c("object",e.timbre)("key","image")}}function rt(t,i){if(t&1){let e=y();l(0,"img",39),d("click",function(){h(e);let a=p().$implicit,o=p();return T(o.utilsService.zoom(a==null?null:a.getImageZoom()))}),r()}if(t&2){let e=p().$implicit;c("src",e==null?null:e.getImageTable(),ie)}}function at(t,i){if(t&1&&(l(0,"td",37),f(1,rt,1,1,"img",38),r()),t&2){let e=i.$implicit;m(),c("ngIf",e==null?null:e.getImageTable())}}function mt(t,i){if(t&1&&(l(0,"th",40),s(1,"lib-libelle-model",41),r()),t&2){let e=p();m(),c("object",e.timbre)("key","id")}}function ct(t,i){if(t&1&&(l(0,"td",42),u(1),r()),t&2){let e=i.$implicit;m(),x(" ",e==null?null:e.getId()," ")}}function pt(t,i){if(t&1&&(l(0,"th",40),s(1,"lib-libelle-model",41),r()),t&2){let e=p();m(),c("object",e.timbre)("key","annee")}}function st(t,i){if(t&1&&(l(0,"td",42),u(1),r()),t&2){let e=i.$implicit;m(),x(" ",e==null?null:e.getAnnee()," ")}}function ut(t,i){if(t&1&&(l(0,"th",43),s(1,"lib-libelle-model",41),r()),t&2){let e=p();m(),c("object",e.timbre)("key","nbTimbres")}}function dt(t,i){if(t&1&&(l(0,"td",44),u(1),r()),t&2){let e=i.$implicit;m(),x(" ",e==null?null:e.getNbTimbres()," ")}}function ft(t,i){if(t&1&&(l(0,"th",43),s(1,"lib-libelle-model",41),r()),t&2){let e=p();m(),c("object",e.timbre)("key","monnaie")}}function bt(t,i){if(t&1&&(l(0,"td",44),u(1),r()),t&2){let e=i.$implicit;m(),x(" ",(e==null?null:e.getMonnaie())=="E"?"\u20AC":"Francs"," ")}}function _t(t,i){if(t&1&&(l(0,"th",40),s(1,"lib-libelle-model",41),r()),t&2){let e=p();m(),c("object",e.timbre==null?null:e.timbre.getTimbreBlocAcquisModel())("key","acquis")}}function Ct(t,i){if(t&1){let e=y();l(0,"td",37)(1,"lib-icon",45),d("click",function(){let a=h(e).$implicit,o=p();return T(o.acquis(a))}),r()()}if(t&2){let e,n,a,o=i.$implicit,g=p();m(),c("classIcone",!(o==null||(e=o.getTimbreBlocAcquisModel())==null)&&e.isAcquis()?"accent":"primary")("type",g.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",!(o==null||(n=o.getTimbreBlocAcquisModel())==null)&&n.isAcquis()?g.FontAwesomeEnum.CIRCLE_MINUS:g.FontAwesomeEnum.CIRCLE_PLUS)("info",!(o==null||(a=o.getTimbreBlocAcquisModel())==null)&&a.isAcquis()?"pas acquis":"acquis")}}function gt(t,i){if(t&1&&(l(0,"th",40),s(1,"lib-libelle-model",41),r()),t&2){let e=p();m(),c("object",e.timbre==null?null:e.timbre.getTimbreBlocAcquisModel())("key","doublon")}}function ht(t,i){if(t&1){let e=y();l(0,"td",37)(1,"lib-icon",45),d("click",function(){let a=h(e).$implicit,o=p();return T(o.doublon(a))}),r()()}if(t&2){let e,n,a,o=i.$implicit,g=p();m(),c("classIcone",!(o==null||(e=o.getTimbreBlocAcquisModel())==null)&&e.isDoublon()?"accent":"primary")("type",g.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",!(o==null||(n=o.getTimbreBlocAcquisModel())==null)&&n.isDoublon()?g.FontAwesomeEnum.CIRCLE_MINUS:g.FontAwesomeEnum.CIRCLE_PLUS)("info",!(o==null||(a=o.getTimbreBlocAcquisModel())==null)&&a.isDoublon()?"pas en double":"en double")}}function Tt(t,i){if(t&1&&(l(0,"th",46),s(1,"lib-icon",47),r()),t&2){let e=p();m(),c("type",e.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",e.FontAwesomeEnum.PENCIL)("info","Modifier")}}function yt(t,i){if(t&1){let e=y();l(0,"td",37)(1,"lib-icon",48),d("click",function(){let a=h(e).$implicit,o=p();return T(o.modifier(a))}),r()()}if(t&2){let e=p();m(),c("type",e.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",e.FontAwesomeEnum.PENCIL)("info","Modifier")}}function xt(t,i){if(t&1&&(l(0,"th",46),s(1,"lib-icon",47),r()),t&2){let e=p();m(),c("type",e.FontAwesomeTypeEnum.TYPE_SOLID)("icone",e.FontAwesomeEnum.TRASH)("info","Modifier")}}function St(t,i){if(t&1){let e=y();l(0,"td",37)(1,"lib-icon",48),d("click",function(){let a=h(e).$implicit,o=p();return T(o.supprimer(a))}),r()()}if(t&2){let e=p();m(),c("type",e.FontAwesomeTypeEnum.TYPE_SOLID)("icone",e.FontAwesomeEnum.TRASH)("info","Supprimer")}}function Mt(t,i){t&1&&s(0,"tr",49)}function vt(t,i){t&1&&s(0,"tr",50)}var $=class t{constructor(i,e,n,a){this.timbreBlocService=i;this.timbreUtilsService=e;this.dialog=n;this.utilsService=a;this.dataSource=new J([])}paginator;sort;load$=new ee(!1);dataSource=new J;displayedColumns;timbreCritereModel=new Ne;timbre=new je;annees$;modif=!0;FontAwesomeEnum=A;FontAwesomeTypeEnum=I;ngOnInit(){this.annees$=this.timbreUtilsService.getAnneesAsync("/timbres_bloc"),this.timbre.setTimbreBlocAcquisModel(new Ue),this.displayedColumns=["image","id","annee","monnaie","nbTimbres","acquis","doublon"],this.modif&&this.displayedColumns.push("modifier","supprimer"),this.load$.next(!1),this.timbreBlocService.timbresBlocModel$.subscribe(i=>{this.dataSource.data=i,this.load$.next(!0)})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.sort.active="id",this.sort.direction="asc",this.dataSource.sort=this.sort}sortData(i){Z(i)&&(this.dataSource.sort=this.sort)}filtreByCritere(){this.timbreCritereModel.getAcquis()=="NON"&&this.timbreCritereModel.setDoublon("TOUS"),this.timbreBlocService.getBlocs(this.timbreCritereModel)}applyFilter(i){let e=i.target.value;this.dataSource.filter=e.trim().toLowerCase()}acquis(i){this.timbreBlocService.acquis(i,!1)}doublon(i){this.timbreBlocService.acquis(i,!0)}modifier(i){let e=this.dialog.open(V,{height:"75vh",maxHeight:"750px",width:"30%"});e.componentInstance.id=i.getId(),e.afterClosed().subscribe(()=>{e.close()})}supprimer(i){this.timbreBlocService.getTimbresByBlocAsync(i.getId()).pipe(te()).subscribe(e=>{let n="";Z(e)&&e?.length>0&&(n="<span class='warn'>Attention <b>"+e.length+"</b> timbre",e?.length>1?n+="s sont reli\xE9s":n+=" est reli\xE9",n+=" \xE0 ce bloc.</span></br></br>"),n+="Souhaitez-vous supprimer le bloc <b>n\xB0 "+i?.getId()+"</b> ?";let a=this.dialog.open(ze,{maxHeight:"95vh",data:{titre:"Confirmation",message:n,btnDroite:"Oui",btnGauche:"Non"}});a.afterClosed().subscribe(()=>{a.componentInstance.data.resultat==="valider"&&this.timbreBlocService.supprimer(i)})})}exportTable(){let i=U.json_to_sheet(this.dataSource.data),e=U.book_new();U.book_append_sheet(e,i,"Donn\xE9es");let n=Xe(e,{bookType:"xlsx",type:"array"}),a=new Blob([n],{type:"application/octet-stream"});(0,Ye.saveAs)(a,"export_timbres.xlsx")}static \u0275fac=function(e){return new(e||t)(C(v),C(j),C(q),C($e))};static \u0275cmp=B({type:t,selectors:[["app-timbre-bloc-resultat"]],viewQuery:function(e,n){if(e&1&&(G(H,5),G(N,5)),e&2){let a;W(a=Y())&&(n.paginator=a.first),W(a=Y())&&(n.sort=a.first)}},decls:66,vars:36,consts:[["fxFlexFill","",3,"fxHide","textSpec"],[3,"fxHide"],["fxLayout","row","fxLayoutAlign","space-between center","fxLayoutGap","15px"],["fxFlex","",2,"font-size","1.2em"],[1,"bold"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input","select",2,"width","100px"],["name","acquis",3,"ngModelChange","ngModel","placeholder"],[1,"selectMin",3,"value"],["name","doublon",1,"scrollBarAccent",3,"ngModelChange","ngModel","placeholder"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input","select",2,"width","150px"],["name","anneeSelect","multiple","",3,"ngModelChange","ngModel","placeholder"],["class","selectMin",3,"value",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","end center",1,"form-input",2,"width","200px","min-height","55px","height","55px"],["placeholder","Filtrer les donn\xE9es","type","text",3,"input"],[1,"primary","click",2,"font-size","1.7em",3,"click","type","icone","info"],["id","pdf-content","mat-table","","matSort","",3,"matSortChange","dataSource"],["matColumnDef","image"],["mat-header-cell","","class","image",4,"matHeaderCellDef"],["mat-cell","","class","alignCenter",4,"matCellDef"],["matColumnDef","id"],["mat-header-cell","","matSort","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","annee"],["matColumnDef","nbTimbres"],["mat-header-cell","","matSort","","mat-sort-header","","class","hide-on-mobile",4,"matHeaderCellDef"],["mat-cell","","class","hide-on-mobile",4,"matCellDef"],["matColumnDef","monnaie"],["matColumnDef","acquis"],["matColumnDef","doublon"],["matColumnDef","modifier"],["mat-header-cell","","class","alignCenter",4,"matHeaderCellDef"],["matColumnDef","supprimer"],["mat-header-row","","class","bg-primary color-white",4,"matHeaderRowDef"],["mat-row","","class","mat-row",4,"matRowDef","matRowDefColumns"],[3,"pageSize","pageSizeOptions"],["mat-header-cell","",1,"image"],[1,"hide-on-mobile",3,"object","key"],["mat-cell","",1,"alignCenter"],["class","image click",3,"src","click",4,"ngIf"],[1,"image","click",3,"click","src"],["mat-header-cell","","matSort","","mat-sort-header",""],[3,"object","key"],["mat-cell",""],["mat-header-cell","","matSort","","mat-sort-header","",1,"hide-on-mobile"],["mat-cell","",1,"hide-on-mobile"],[1,"click",2,"font-size","1.2em",3,"click","classIcone","type","icone","info"],["mat-header-cell","",1,"alignCenter"],[2,"font-size","1.2em",3,"type","icone","info"],[1,"primary","click",2,"font-size","1.2em",3,"click","type","icone","info"],["mat-header-row","",1,"bg-primary","color-white"],["mat-row","",1,"mat-row"]],template:function(e,n){e&1&&(s(0,"lib-spinner",0),S(1,"async"),l(2,"section",1),S(3,"async"),l(4,"div",2)(5,"div",3)(6,"span"),u(7,"Nombre de blocs : "),r(),l(8,"span",4),u(9),S(10,"async"),S(11,"async"),r()(),l(12,"div",5)(13,"mat-select",6),R("ngModelChange",function(o){return L(n.timbreCritereModel.acquis,o)||(n.timbreCritereModel.acquis=o),o}),d("ngModelChange",function(){return n.filtreByCritere()}),l(14,"mat-option",7),u(15," Oui"),r(),l(16,"mat-option",7),u(17," Non"),r(),l(18,"mat-option",7),u(19," Tous"),r()()(),l(20,"div",5)(21,"mat-select",8),R("ngModelChange",function(o){return L(n.timbreCritereModel.doublon,o)||(n.timbreCritereModel.doublon=o),o}),d("ngModelChange",function(){return n.filtreByCritere()}),l(22,"mat-option",7),u(23," Oui"),r(),l(24,"mat-option",7),u(25," Non"),r(),l(26,"mat-option",7),u(27," Tous"),r()()(),l(28,"div",9)(29,"mat-select",10),R("ngModelChange",function(o){return L(n.timbreCritereModel.annees,o)||(n.timbreCritereModel.annees=o),o}),d("ngModelChange",function(){return n.filtreByCritere()}),f(30,ot,2,2,"mat-option",11),S(31,"async"),r()(),l(32,"div",12)(33,"input",13),d("input",function(o){return n.applyFilter(o)}),r()(),l(34,"lib-icon",14),d("click",function(){return n.exportTable()}),r()(),l(35,"table",15),d("matSortChange",function(o){return n.sortData(o)}),b(36,16),f(37,lt,2,2,"th",17)(38,at,2,1,"td",18),_(),b(39,19),f(40,mt,2,2,"th",20)(41,ct,2,1,"td",21),_(),b(42,22),f(43,pt,2,2,"th",20)(44,st,2,1,"td",21),_(),b(45,23),f(46,ut,2,2,"th",24)(47,dt,2,1,"td",25),_(),b(48,26),f(49,ft,2,2,"th",24)(50,bt,2,1,"td",25),_(),b(51,27),f(52,_t,2,2,"th",20)(53,Ct,2,4,"td",18),_(),b(54,28),f(55,gt,2,2,"th",20)(56,ht,2,4,"td",18),_(),b(57,29),f(58,Tt,2,3,"th",30)(59,yt,2,3,"td",18),_(),b(60,31),f(61,xt,2,3,"th",30)(62,St,2,3,"td",18),_(),f(63,Mt,1,0,"tr",32)(64,vt,1,0,"tr",33),r(),s(65,"mat-paginator",34),r()),e&2&&(c("fxHide",M(1,25,n.load$)==!0)("textSpec","Chargement en cours ..."),m(2),c("fxHide",M(3,27,n.load$)==!1),m(7),ne(M(10,29,n.timbreBlocService.total$)?M(11,31,n.timbreBlocService.total$):n.dataSource==null||n.dataSource.data==null?null:n.dataSource.data.length),m(4),D("ngModel",n.timbreCritereModel.acquis),c("placeholder","Acquis"),m(),c("value","OUI"),m(2),c("value","NON"),m(2),c("value","TOUS"),m(3),D("ngModel",n.timbreCritereModel.doublon),c("placeholder","Doublon"),m(),c("value","OUI"),m(2),c("value","NON"),m(2),c("value","TOUS"),m(3),D("ngModel",n.timbreCritereModel.annees),c("placeholder","Ann\xE9es"),m(),c("ngForOf",M(31,33,n.annees$)),m(4),c("type",n.FontAwesomeTypeEnum.TYPE_LIGHT)("icone",n.FontAwesomeEnum.FILE_EXEL)("info","Exporter tableau"),m(),c("dataSource",n.dataSource),m(28),c("matHeaderRowDef",n.displayedColumns),m(),c("matRowDefColumns",n.displayedColumns),m(),c("pageSize",15)("pageSizeOptions",oe(35,nt)))},dependencies:[ye,ge,Se,ve,De,we,Me,Le,Be,Ee,Re,Ie,H,N,xe,le,re,O,F,k,ue,P,se,be,_e,Fe,He,Oe,ae],styles:[".mat-row[_ngcontent-%COMP%]{height:35px}.image[_ngcontent-%COMP%]{max-height:30px!important}.mat-column-acquis[_ngcontent-%COMP%], .mat-column-doublon[_ngcontent-%COMP%]{width:60px!important;max-width:60px!important;padding:0!important}.mat-column-ajouter[_ngcontent-%COMP%], .mat-column-modifier[_ngcontent-%COMP%], .mat-column-supprimer[_ngcontent-%COMP%]{width:35px!important;max-width:35px!important;padding:0!important}@media screen and (max-width: 800px){.mat-row[_ngcontent-%COMP%]{height:25px}.image[_ngcontent-%COMP%]{max-height:20px!important}.mat-column-acquis[_ngcontent-%COMP%], .mat-column-doublon[_ngcontent-%COMP%]{width:50px!important;max-width:50px!important;padding:0!important}.mat-column-ajouter[_ngcontent-%COMP%], .mat-column-modifier[_ngcontent-%COMP%], .mat-column-supprimer[_ngcontent-%COMP%]{width:20px!important;max-width:20px!important;padding:0!important}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:0 5px!important}th[_ngcontent-%COMP%], .mat-row[_ngcontent-%COMP%]{font-size:.8em}.mat-column-libelle[_ngcontent-%COMP%],   .mat-column-libelle .mat-sort-header-container{width:40px!important;max-width:40px!important}.mat-column-drapeau[_ngcontent-%COMP%],   .mat-column-drapeau span{width:15px!important;max-width:15px!important}.mat-column-classeur[_ngcontent-%COMP%],   .mat-column-classeur .mat-sort-header-container, .mat-column-page[_ngcontent-%COMP%],   .mat-column-page .mat-sort-header-container{width:15px!important;max-width:15px!important}.mat-column-total[_ngcontent-%COMP%],   .mat-column-total .mat-sort-header-container{width:25px!important;max-width:25px!important}.hide-on-mobile[_ngcontent-%COMP%]{display:none}}"]})};var X=class t{constructor(i,e,n){this.headerService=i;this.timbreBlocService=e;this.dialog=n}FontAwesomeTypeEnum=I;FontAwesomeEnum=A;ngOnInit(){this.headerService.titre$.next("TIMBRES - BLOC"),this.timbreBlocService.getBlocs()}ajouterBloc(){let i=this.dialog.open(V,{maxHeight:"95vh",width:"30%"});i.afterClosed().subscribe(()=>{i.close()})}static \u0275fac=function(e){return new(e||t)(C(pe),C(v),C(q))};static \u0275cmp=B({type:t,selectors:[["app-timbre-bloc-layout"]],decls:8,vars:0,consts:[["fxLayout","row","fxLayoutAlign","space-between stretch"],["fxFlex","5"],["fxFlex","","fxLayout","column","fxLayoutGap","20px"],["fxLayout","row","fxLayoutGap","20px"],["mat-raised-button","","color","primary",1,"rounded","large","color-white",3,"click"]],template:function(e,n){e&1&&(l(0,"div",0),s(1,"div",1),l(2,"div",2)(3,"div",3)(4,"button",4),d("click",function(){return n.ajouterBloc()}),u(5," Ajouter "),r()(),s(6,"app-timbre-bloc-resultat"),r(),s(7,"div",1),r())},dependencies:[Te,O,F,k,P,$],encapsulation:2})};var Bt=[{path:"",component:X}],z=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=E({type:t});static \u0275inj=w({imports:[Q.forChild(Bt),Q]})};var Qe=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=E({type:t});static \u0275inj=w({providers:[v,j,Ve,ce()],imports:[z,Ae,me,de,fe,Ce,ke,qe,Pe,he,We,Ge]})};export{Qe as TimbreBlocModule};
